
      merge  into FAWDBTCORE.stg_mobile_events DBT_INTERNAL_DEST
          using o$pt_stg_mobile_events153617262010 DBT_INTERNAL_SOURCE
          on (
            DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
        )
        when matched then
          update set
          DBT_INTERNAL_DEST.EVENT_TYPE = DBT_INTERNAL_SOURCE.EVENT_TYPE, 
          DBT_INTERNAL_DEST.EVENT_TIMESTAMP = DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
          DBT_INTERNAL_DEST.USER_ID = DBT_INTERNAL_SOURCE.USER_ID, 
          DBT_INTERNAL_DEST.APP_NAME = DBT_INTERNAL_SOURCE.APP_NAME, 
          DBT_INTERNAL_DEST.OPERATING_SYSTEM = DBT_INTERNAL_SOURCE.OPERATING_SYSTEM, 
          DBT_INTERNAL_DEST.COUNTRY = DBT_INTERNAL_SOURCE.COUNTRY, 
          DBT_INTERNAL_DEST.DURATION_SECONDS = DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
          DBT_INTERNAL_DEST.CONVERSION_STATUS = DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
          DBT_INTERNAL_DEST.CREATED_AT = DBT_INTERNAL_SOURCE.CREATED_AT
          when not matched then
          insert(EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, APP_NAME, OPERATING_SYSTEM, COUNTRY, DURATION_SECONDS, CONVERSION_STATUS, CREATED_AT)
          values(
            DBT_INTERNAL_SOURCE.EVENT_ID, 
            DBT_INTERNAL_SOURCE.EVENT_TYPE, 
            DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
            DBT_INTERNAL_SOURCE.USER_ID, 
            DBT_INTERNAL_SOURCE.APP_NAME, 
            DBT_INTERNAL_SOURCE.OPERATING_SYSTEM, 
            DBT_INTERNAL_SOURCE.COUNTRY, 
            DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
            DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
            DBT_INTERNAL_SOURCE.CREATED_AT
            )
  