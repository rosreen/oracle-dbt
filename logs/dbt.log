[0m12:10:45.292204 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m12:10:45.297433 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m12:10:45.297698 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m12:10:45.297872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:45.298043 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:10:47.078973 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m12:10:47.213540 [debug] [ThreadPool]: On list_None: Close
[0m12:10:47.346590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m12:10:47.349856 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m12:10:47.350157 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m12:10:47.350330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:47.350504 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:10:49.086166 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m12:10:49.095730 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m12:10:49.096178 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m12:10:49.221086 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:10:49.569375 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m12:10:49.678650 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m12:10:49.806431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ec8aca4-bd10-4302-8b08-0f139cf7fead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063019d0>]}
[0m12:10:49.807310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:49.807669 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:10:51.214001 [debug] [MainThread]: On master: COMMIT
[0m12:10:51.216356 [debug] [MainThread]: Using oracle connection "master"
[0m12:10:51.217028 [debug] [MainThread]: On master: COMMIT
[0m12:10:51.340240 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:10:51.341076 [debug] [MainThread]: On master: Close
[0m12:10:51.540382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:10:51.541323 [info ] [MainThread]: 
[0m12:10:51.544738 [debug] [Thread-1 (]: Began running node model.oracle_dbt.test
[0m12:10:51.545158 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.test ................................ [RUN]
[0m12:10:51.545648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.test)
[0m12:10:51.545934 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.test
[0m12:10:51.563172 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m12:10:51.564541 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (compile): 12:10:51.546126 => 12:10:51.564325
[0m12:10:51.564929 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.test
[0m12:10:51.577116 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m12:10:51.577538 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m12:10:51.588755 [info ] [Thread-1 (]: Python model materialization is table
[0m12:10:51.589169 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m12:10:52.442823 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (execute): 12:10:51.565143 => 12:10:52.442017
[0m12:10:52.444922 [error] [Thread-1 (]: [31mUnhandled error while executing target/run/oracle_dbt/models/staging/test.py[0m
Expecting value: line 1 column 1 (char 0)
[0m12:10:52.461687 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/requests/models.py", line 971, in json
    return complexjson.loads(self.text, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/base.py", line 388, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/base.py", line 337, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/base.py", line 436, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/run.py", line 291, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 119, in macro
  File "/opt/homebrew/lib/python3.11/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 55, in macro
  File "/opt/homebrew/lib/python3.11/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/context/providers.py", line 1292, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/oracle/impl.py", line 383, in submit_python_job
    oml_oauth_access_token = self.get_oml_auth_token()
                             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/oracle/impl.py", line 366, in get_oml_auth_token
    return r.json()["accessToken"]
           ^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/requests/models.py", line 975, in json
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

[0m12:10:52.465396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec8aca4-bd10-4302-8b08-0f139cf7fead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dee50>]}
[0m12:10:52.466192 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.test ....................... [[31mERROR[0m in 0.92s]
[0m12:10:52.466694 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.test
[0m12:10:52.468373 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:10:52.468854 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:10:53.732779 [debug] [MainThread]: On master: COMMIT
[0m12:10:53.733123 [debug] [MainThread]: Using oracle connection "master"
[0m12:10:53.733291 [debug] [MainThread]: On master: COMMIT
[0m12:10:53.832551 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:10:53.832915 [debug] [MainThread]: On master: Close
[0m12:10:53.931858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:53.932175 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m12:10:53.932370 [info ] [MainThread]: 
[0m12:10:53.935627 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.64 seconds (8.64s).
[0m12:10:53.935968 [debug] [MainThread]: Command end result
[0m12:10:53.940088 [info ] [MainThread]: 
[0m12:10:53.940421 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:10:53.940627 [info ] [MainThread]: 
[0m12:10:53.940789 [error] [MainThread]: [33mExpecting value: line 1 column 1 (char 0)[0m
[0m12:10:53.940936 [info ] [MainThread]: 
[0m12:10:53.941094 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:10:53.941388 [debug] [MainThread]: Command `dbt run` failed at 12:10:53.941343 after 9.19 seconds
[0m12:10:53.941664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105217a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d1e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100696c50>]}
[0m12:10:53.941918 [debug] [MainThread]: Flushing usage events
[0m12:11:47.406983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b37b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b43ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b43f90>]}


============================== 12:11:47.409389 | 33d66e58-de48-4eb7-9896-26ce44ecc425 ==============================
[0m12:11:47.409389 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:11:47.409708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:11:47.452136 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m12:11:47.474758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33d66e58-de48-4eb7-9896-26ce44ecc425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b78f50>]}
[0m12:11:47.481432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33d66e58-de48-4eb7-9896-26ce44ecc425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106266a90>]}
[0m12:11:47.514142 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:11:47.519554 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m12:11:47.519807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33d66e58-de48-4eb7-9896-26ce44ecc425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063785d0>]}
[0m12:11:47.850723 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m12:11:47.857550 [debug] [MainThread]: 1603: static parser failed on combined_categorized_events.sql
[0m12:11:47.862385 [debug] [MainThread]: 1602: parser fallback to jinja rendering on combined_categorized_events.sql
[0m12:11:47.863529 [debug] [MainThread]: 1699: static parser successfully parsed event_counts_by_platform.sql
[0m12:11:47.865520 [debug] [MainThread]: 1699: static parser successfully parsed average_duration_by_platform_country.sql
[0m12:11:47.867530 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m12:11:47.869815 [debug] [MainThread]: 1699: static parser successfully parsed most_frequent_browser.sql
[0m12:11:47.871861 [debug] [MainThread]: 1699: static parser successfully parsed most_active_mobile_users.sql
[0m12:11:47.873891 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
[0m12:11:47.875686 [debug] [MainThread]: 1603: static parser failed on staging/stg_web_events.sql
[0m12:11:47.878201 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_web_events.sql
[0m12:11:47.879124 [debug] [MainThread]: 1603: static parser failed on staging/stg_mobile_events.sql
[0m12:11:47.881430 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_mobile_events.sql
[0m12:11:47.918428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33d66e58-de48-4eb7-9896-26ce44ecc425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630afd0>]}
[0m12:11:47.928610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33d66e58-de48-4eb7-9896-26ce44ecc425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064507d0>]}
[0m12:11:47.928960 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:11:47.929133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33d66e58-de48-4eb7-9896-26ce44ecc425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106363450>]}
[0m12:11:47.929866 [info ] [MainThread]: 
[0m12:11:47.930254 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m12:11:47.930799 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m12:11:47.935791 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m12:11:47.936039 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m12:11:47.936212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:47.936388 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:11:49.627372 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m12:11:49.754145 [debug] [ThreadPool]: On list_None: Close
[0m12:11:49.878135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m12:11:49.881298 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m12:11:49.881582 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m12:11:49.881750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:49.881920 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:11:51.326842 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m12:11:51.336741 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m12:11:51.337584 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m12:11:51.470512 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:11:51.691397 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m12:11:51.801213 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m12:11:51.921604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33d66e58-de48-4eb7-9896-26ce44ecc425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063aedd0>]}
[0m12:11:51.922545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:51.922869 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:11:53.477582 [debug] [MainThread]: On master: COMMIT
[0m12:11:53.479086 [debug] [MainThread]: Using oracle connection "master"
[0m12:11:53.479611 [debug] [MainThread]: On master: COMMIT
[0m12:11:53.597664 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:11:53.600114 [debug] [MainThread]: On master: Close
[0m12:11:53.714578 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:11:53.715309 [info ] [MainThread]: 
[0m12:11:53.721265 [debug] [Thread-1 (]: Began running node model.oracle_dbt.test
[0m12:11:53.722021 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.test ................................ [RUN]
[0m12:11:53.723069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.test)
[0m12:11:53.723652 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.test
[0m12:11:53.739146 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m12:11:53.740426 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (compile): 12:11:53.723968 => 12:11:53.740199
[0m12:11:53.740900 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.test
[0m12:11:53.752567 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m12:11:53.753019 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m12:11:53.764514 [info ] [Thread-1 (]: Python model materialization is table
[0m12:11:53.764944 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m12:11:56.873256 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.test"
[0m12:11:56.874313 [debug] [Thread-1 (]: On model.oracle_dbt.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.test"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODcyOTE5MTUsImlhdCI6MTY4NzI4ODMxNX0.U8U6YJo5w1jQC9bOFsRIEGu63ztZvLkOhP_PJcugYHi8nSA0nAF3kniWf-0HpPv7SR7iiGhUPh7h44lcEHITI8wGYCb1gZZXAl6TNfMvq64v5VA7fnSUGiG1-kBlqqvW_5bH6D-cJS9_YND7n27YtvLGlxK3GNeV7WSV9jdcrt8Vl6osqdVbKjryc8FvkNRnzI6YMRrHpO0uN6D-t29lcV1tYYxq3YYCbSkulAq9_1Wiop2YWRPQbNNbLVqfjErQQQTr7ivJGbM9m7NVqF94oaW2piJk2WzR_U5JbNoWhenIgVTEbrHhL5RhJbtpJQbhhgPYJLoKS_aS0gbVzZrpCQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('test_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "test"
        def __repr__(self):
            return "FAWDBTCORE.test"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source('FAWDBTCORE', 'web_events')
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_test_tmp_191156 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''test_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_test_tmp_191156';
                   sys.pyqScriptDrop('test_dbt_py_script');
                END;
        
[0m12:11:56.875225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:56.875651 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:11:58.501862 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06550: line 61, column 28:
PLS-00103: Encountered the symbol "FAWDBTCORE" when expecting one of the following:

   ) , * & = - + < / > at in is mod remainder not rem =>
   <an exponent (**)> <> or != or ~= >= <= <> and or like like2
   like4 likec between || multiset member submultiset
[0m12:11:58.503987 [debug] [Thread-1 (]: On model.oracle_dbt.test: Close
[0m12:11:58.618647 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (execute): 12:11:53.741236 => 12:11:58.617224
[0m12:11:58.640221 [debug] [Thread-1 (]: Database Error in model test (models/staging/test.py)
  ORA-06550: line 61, column 28:
  PLS-00103: Encountered the symbol "FAWDBTCORE" when expecting one of the following:
  
     ) , * & = - + < / > at in is mod remainder not rem =>
     <an exponent (**)> <> or != or ~= >= <= <> and or like like2
     like4 likec between || multiset member submultiset
  compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m12:11:58.642957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33d66e58-de48-4eb7-9896-26ce44ecc425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065521d0>]}
[0m12:11:58.643728 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.test ....................... [[31mERROR[0m in 4.92s]
[0m12:11:58.644286 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.test
[0m12:11:58.645995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:58.646713 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:11:59.948839 [debug] [MainThread]: On master: COMMIT
[0m12:11:59.951419 [debug] [MainThread]: Using oracle connection "master"
[0m12:11:59.952234 [debug] [MainThread]: On master: COMMIT
[0m12:12:00.057676 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:12:00.059880 [debug] [MainThread]: On master: Close
[0m12:12:00.175205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:00.175935 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m12:12:00.176340 [info ] [MainThread]: 
[0m12:12:00.176657 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.25 seconds (12.25s).
[0m12:12:00.177170 [debug] [MainThread]: Command end result
[0m12:12:00.188608 [info ] [MainThread]: 
[0m12:12:00.189342 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:12:00.189686 [info ] [MainThread]: 
[0m12:12:00.189987 [error] [MainThread]: [33mDatabase Error in model test (models/staging/test.py)[0m
[0m12:12:00.190272 [error] [MainThread]:   ORA-06550: line 61, column 28:
[0m12:12:00.190573 [error] [MainThread]:   PLS-00103: Encountered the symbol "FAWDBTCORE" when expecting one of the following:
[0m12:12:00.190829 [error] [MainThread]:   
[0m12:12:00.191088 [error] [MainThread]:      ) , * & = - + < / > at in is mod remainder not rem =>
[0m12:12:00.191343 [error] [MainThread]:      <an exponent (**)> <> or != or ~= >= <= <> and or like like2
[0m12:12:00.191596 [error] [MainThread]:      like4 likec between || multiset member submultiset
[0m12:12:00.191848 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m12:12:00.192100 [info ] [MainThread]: 
[0m12:12:00.192392 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:12:00.192970 [debug] [MainThread]: Command `dbt run` failed at 12:12:00.192882 after 12.80 seconds
[0m12:12:00.193409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b57690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10247ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102478e10>]}
[0m12:12:00.193823 [debug] [MainThread]: Flushing usage events
[0m12:13:13.912401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106917a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106917f90>]}


============================== 12:13:13.916623 | 8d1bb439-2260-46f4-b552-3eee43d2bf05 ==============================
[0m12:13:13.916623 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:13:13.916958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:13:13.961758 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m12:13:13.984749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d1bb439-2260-46f4-b552-3eee43d2bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106908e10>]}
[0m12:13:13.990860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d1bb439-2260-46f4-b552-3eee43d2bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079cce90>]}
[0m12:13:14.022857 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:13:14.057147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:13:14.057465 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/test.py
[0m12:13:14.076454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d1bb439-2260-46f4-b552-3eee43d2bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b8c510>]}
[0m12:13:14.081887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d1bb439-2260-46f4-b552-3eee43d2bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e9690>]}
[0m12:13:14.082088 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:13:14.082263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d1bb439-2260-46f4-b552-3eee43d2bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040e28d0>]}
[0m12:13:14.082925 [info ] [MainThread]: 
[0m12:13:14.083299 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m12:13:14.083798 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m12:13:14.088816 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m12:13:14.089087 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m12:13:14.089220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:14.089349 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:13:15.911652 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m12:13:16.015242 [debug] [ThreadPool]: On list_None: Close
[0m12:13:16.284416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m12:13:16.287323 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m12:13:16.287512 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m12:13:16.287662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:16.287800 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:13:17.663188 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m12:13:17.673009 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m12:13:17.673561 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m12:13:17.800095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:18.000515 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m12:13:18.106298 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m12:13:18.215747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d1bb439-2260-46f4-b552-3eee43d2bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a04150>]}
[0m12:13:18.216429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:18.216717 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:13:19.601207 [debug] [MainThread]: On master: COMMIT
[0m12:13:19.603194 [debug] [MainThread]: Using oracle connection "master"
[0m12:13:19.603915 [debug] [MainThread]: On master: COMMIT
[0m12:13:19.710665 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:13:19.713178 [debug] [MainThread]: On master: Close
[0m12:13:19.845414 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:13:19.847161 [info ] [MainThread]: 
[0m12:13:19.856211 [debug] [Thread-1 (]: Began running node model.oracle_dbt.test
[0m12:13:19.856720 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.test ................................ [RUN]
[0m12:13:19.857921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.test)
[0m12:13:19.858315 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.test
[0m12:13:19.877236 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m12:13:19.878594 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (compile): 12:13:19.858542 => 12:13:19.878326
[0m12:13:19.878934 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.test
[0m12:13:19.889458 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m12:13:19.889784 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m12:13:19.900583 [info ] [Thread-1 (]: Python model materialization is table
[0m12:13:19.901066 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m12:13:22.688376 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.test"
[0m12:13:22.689241 [debug] [Thread-1 (]: On model.oracle_dbt.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.test"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODcyOTIwMDEsImlhdCI6MTY4NzI4ODQwMX0.UxS3nDbTVC1MP9VYiRxQQyxOFHj6agcKbfX0ELIRNDVr1kMjl7NaTP2rvcC7VE2jWTq7up6KoMbY_nT1-r8LutCGpAcZZ6n9cbrLjWEfjc38TqIeqqEWn5iQdwG_xpA6JNreMUtl0B3TJKy26yLcluA7m1WPaTygwZ6G6Q_yc-W7Twslbp1re2N1u6k1S1C9PmjFo93O1ZfENwj6pr8jSHYigZ673_F8FmFj88HRekHZ5bVy9TzZ_XM6nYalBHLKGgebwEPW0EtBbB8OBY8jVBwJCCsc9jWTJwd_U96n1Do3JaMGI_7NgXg0ZxCkoQ2E3TgGZloyJdiIyw1BGYvFOg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('test_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "test"
        def __repr__(self):
            return "FAWDBTCORE.test"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_test_tmp_191322 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''test_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_test_tmp_191322';
                   sys.pyqScriptDrop('test_dbt_py_script');
                END;
        
[0m12:13:22.689748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:22.690043 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:13:24.934723 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20101: ACL privilege not granted for current user
ORA-06512: at "SYS.PYQSETAUTHTOKENIMPL", line 24
ORA-06512: at "SYS.PYQSETAUTHTOKENIMPL", line 18
ORA-06512: at "SYS.PYQSETAUTHTOKEN", line 9
ORA-06512: at line 4
[0m12:13:24.937052 [debug] [Thread-1 (]: On model.oracle_dbt.test: Close
[0m12:13:25.043721 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (execute): 12:13:19.879101 => 12:13:25.042216
[0m12:13:25.053419 [debug] [Thread-1 (]: Database Error in model test (models/staging/test.py)
  ORA-20101: ACL privilege not granted for current user
  ORA-06512: at "SYS.PYQSETAUTHTOKENIMPL", line 24
  ORA-06512: at "SYS.PYQSETAUTHTOKENIMPL", line 18
  ORA-06512: at "SYS.PYQSETAUTHTOKEN", line 9
  ORA-06512: at line 4
  compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m12:13:25.055633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d1bb439-2260-46f4-b552-3eee43d2bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd7050>]}
[0m12:13:25.056305 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.test ....................... [[31mERROR[0m in 5.20s]
[0m12:13:25.056790 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.test
[0m12:13:25.058403 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:13:25.058705 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:13:26.371122 [debug] [MainThread]: On master: COMMIT
[0m12:13:26.371489 [debug] [MainThread]: Using oracle connection "master"
[0m12:13:26.371655 [debug] [MainThread]: On master: COMMIT
[0m12:13:26.478191 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:13:26.478561 [debug] [MainThread]: On master: Close
[0m12:13:26.623989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:26.624301 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m12:13:26.624571 [info ] [MainThread]: 
[0m12:13:26.624886 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.54 seconds (12.54s).
[0m12:13:26.625375 [debug] [MainThread]: Command end result
[0m12:13:26.638536 [info ] [MainThread]: 
[0m12:13:26.639008 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:13:26.639340 [info ] [MainThread]: 
[0m12:13:26.639603 [error] [MainThread]: [33mDatabase Error in model test (models/staging/test.py)[0m
[0m12:13:26.639850 [error] [MainThread]:   ORA-20101: ACL privilege not granted for current user
[0m12:13:26.640076 [error] [MainThread]:   ORA-06512: at "SYS.PYQSETAUTHTOKENIMPL", line 24
[0m12:13:26.640302 [error] [MainThread]:   ORA-06512: at "SYS.PYQSETAUTHTOKENIMPL", line 18
[0m12:13:26.640523 [error] [MainThread]:   ORA-06512: at "SYS.PYQSETAUTHTOKEN", line 9
[0m12:13:26.640739 [error] [MainThread]:   ORA-06512: at line 4
[0m12:13:26.640950 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m12:13:26.641176 [info ] [MainThread]: 
[0m12:13:26.641426 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:13:26.641888 [debug] [MainThread]: Command `dbt run` failed at 12:13:26.641815 after 12.75 seconds
[0m12:13:26.642170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102897e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102897d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106216990>]}
[0m12:13:26.642429 [debug] [MainThread]: Flushing usage events
[0m12:20:31.839435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e54c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e77fd0>]}


============================== 12:20:31.842148 | b5822ae4-21d9-44ef-b18a-8e5e7d48be3e ==============================
[0m12:20:31.842148 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:20:31.842464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:20:31.886529 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m12:20:31.908842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5822ae4-21d9-44ef-b18a-8e5e7d48be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea5350>]}
[0m12:20:31.915110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5822ae4-21d9-44ef-b18a-8e5e7d48be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108589290>]}
[0m12:20:31.946969 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:20:31.981547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:20:31.981756 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:20:31.984931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5822ae4-21d9-44ef-b18a-8e5e7d48be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e69f10>]}
[0m12:20:31.989199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5822ae4-21d9-44ef-b18a-8e5e7d48be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10856dd10>]}
[0m12:20:31.989421 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:20:31.989604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5822ae4-21d9-44ef-b18a-8e5e7d48be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d26a10>]}
[0m12:20:31.990293 [info ] [MainThread]: 
[0m12:20:31.990811 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m12:20:31.991551 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m12:20:31.996850 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m12:20:31.997097 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m12:20:31.997220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:31.997348 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:20:33.496459 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m12:20:33.601062 [debug] [ThreadPool]: On list_None: Close
[0m12:20:33.702436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m12:20:33.705420 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m12:20:33.705593 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m12:20:33.705708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:33.705830 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:20:35.048856 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m12:20:35.058009 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m12:20:35.058524 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m12:20:35.192576 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:20:35.398123 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m12:20:35.500347 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m12:20:35.609627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5822ae4-21d9-44ef-b18a-8e5e7d48be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f38ad0>]}
[0m12:20:35.610329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:20:35.610631 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:20:36.872288 [debug] [MainThread]: On master: COMMIT
[0m12:20:36.873926 [debug] [MainThread]: Using oracle connection "master"
[0m12:20:36.874589 [debug] [MainThread]: On master: COMMIT
[0m12:20:36.981329 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:20:36.983396 [debug] [MainThread]: On master: Close
[0m12:20:37.089355 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:20:37.090224 [info ] [MainThread]: 
[0m12:20:37.096160 [debug] [Thread-1 (]: Began running node model.oracle_dbt.test
[0m12:20:37.096709 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.test ................................ [RUN]
[0m12:20:37.097389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.test)
[0m12:20:37.097667 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.test
[0m12:20:37.119901 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m12:20:37.122458 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (compile): 12:20:37.097845 => 12:20:37.122276
[0m12:20:37.122682 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.test
[0m12:20:37.130846 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m12:20:37.131170 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m12:20:37.140043 [info ] [Thread-1 (]: Python model materialization is table
[0m12:20:37.140421 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m12:20:40.243612 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.test"
[0m12:20:40.244548 [debug] [Thread-1 (]: On model.oracle_dbt.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.test"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODcyOTI0MzksImlhdCI6MTY4NzI4ODgzOX0.Wl4xJNpU57oH7zuiLKHzsg7w8VWVysKXSy6Cvvov_qXqMD0-p99_OiVRd0Vb691k_7E5-FOPqstgQ9E28jOJmhy50IyChNw4G935T5a_eEpwkbejhgtvkPNCOyEEIVyAsgAZhNiaWVUwjcwlBfopDJC1bpuYrnpL_rijABtpDvJHLmuXINmQw1J-gElva_ebkcO5yCcR7nVedYZwEkO05gu_9xeQhsukowAUkOD2m4rnRCCozF9TKOQ16gNX0MIqYpbpuPOIwAnIid7Uep-cplXEkhppJH5JPnLliv2rvqRcf-GF6bKDwYm9dqp6Am3lmJMnw6gqrpXcQjk1aQN_Sg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('test_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "test"
        def __repr__(self):
            return "FAWDBTCORE.test"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_test_tmp_192040 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''test_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_test_tmp_192040';
                   sys.pyqScriptDrop('test_dbt_py_script');
                END;
        
[0m12:20:40.245062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:40.245355 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:20:43.400575 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-24263: Certificate of the remote server does not match the target address.
ORA-06512: at "SYS.UTL_HTTP", line 380
ORA-06512: at "SYS.UTL_HTTP", line 1209
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 83
[0m12:20:43.403364 [debug] [Thread-1 (]: On model.oracle_dbt.test: Close
[0m12:20:43.515736 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (execute): 12:20:37.122788 => 12:20:43.513991
[0m12:20:43.524408 [debug] [Thread-1 (]: Database Error in model test (models/staging/test.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-24263: Certificate of the remote server does not match the target address.
  ORA-06512: at "SYS.UTL_HTTP", line 380
  ORA-06512: at "SYS.UTL_HTTP", line 1209
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 83
  compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m12:20:43.526851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5822ae4-21d9-44ef-b18a-8e5e7d48be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e0d50>]}
[0m12:20:43.527380 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.test ....................... [[31mERROR[0m in 6.43s]
[0m12:20:43.527752 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.test
[0m12:20:43.529409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:20:43.529761 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:20:44.756816 [debug] [MainThread]: On master: COMMIT
[0m12:20:44.757480 [debug] [MainThread]: Using oracle connection "master"
[0m12:20:44.757685 [debug] [MainThread]: On master: COMMIT
[0m12:20:44.856571 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:20:44.858071 [debug] [MainThread]: On master: Close
[0m12:20:44.963841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:44.964217 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m12:20:44.964492 [info ] [MainThread]: 
[0m12:20:44.964827 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.97 seconds (12.97s).
[0m12:20:44.965322 [debug] [MainThread]: Command end result
[0m12:20:44.973258 [info ] [MainThread]: 
[0m12:20:44.973695 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:20:44.973952 [info ] [MainThread]: 
[0m12:20:44.974200 [error] [MainThread]: [33mDatabase Error in model test (models/staging/test.py)[0m
[0m12:20:44.974447 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m12:20:44.974676 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m12:20:44.974898 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m12:20:44.975113 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m12:20:44.975326 [error] [MainThread]:   ORA-24263: Certificate of the remote server does not match the target address.
[0m12:20:44.975543 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 380
[0m12:20:44.975759 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1209
[0m12:20:44.975968 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
[0m12:20:44.976182 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m12:20:44.976393 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m12:20:44.976942 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m12:20:44.977358 [error] [MainThread]:   ORA-06512: at line 83
[0m12:20:44.977621 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m12:20:44.977875 [info ] [MainThread]: 
[0m12:20:44.978157 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:20:44.978691 [debug] [MainThread]: Command `dbt run` failed at 12:20:44.978609 after 13.16 seconds
[0m12:20:44.978997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ace90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047aec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef4ed0>]}
[0m12:20:44.979303 [debug] [MainThread]: Flushing usage events
[0m13:26:09.714521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c174d0>]}


============================== 13:26:09.717360 | d86d2ac0-4651-4489-91d7-4618bc202c9c ==============================
[0m13:26:09.717360 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:26:09.717713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:26:09.718072 [info ] [MainThread]: dbt version: 1.5.1
[0m13:26:09.718341 [info ] [MainThread]: python version: 3.11.3
[0m13:26:09.718531 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m13:26:09.718684 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m13:26:09.718831 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/Desktop/oracle-dbt/profiles.yml
[0m13:26:09.718987 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m13:26:09.719125 [info ] [MainThread]: Configuration:
[0m13:26:09.792022 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:26:09.809275 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:26:09.818142 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:26:09.818574 [info ] [MainThread]: Required dependencies:
[0m13:26:09.818869 [debug] [MainThread]: Executing "git --help"
[0m13:26:09.827877 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:26:09.828555 [debug] [MainThread]: STDERR: "b''"
[0m13:26:09.828749 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:26:09.828968 [info ] [MainThread]: Connection:
[0m13:26:09.829156 [info ] [MainThread]:   user: fawdbtcore
[0m13:26:09.829300 [info ] [MainThread]:   database: None
[0m13:26:09.829430 [info ] [MainThread]:   schema: FAWDBTCORE
[0m13:26:09.829556 [info ] [MainThread]:   protocol: None
[0m13:26:09.829688 [info ] [MainThread]:   host: None
[0m13:26:09.829811 [info ] [MainThread]:   port: None
[0m13:26:09.829928 [info ] [MainThread]:   tns_name: cfg57adw_low
[0m13:26:09.830492 [info ] [MainThread]:   service: None
[0m13:26:09.830682 [info ] [MainThread]:   connection_string: None
[0m13:26:09.830828 [info ] [MainThread]:   shardingkey: []
[0m13:26:09.830962 [info ] [MainThread]:   supershardingkey: []
[0m13:26:09.831093 [info ] [MainThread]:   cclass: None
[0m13:26:09.831235 [info ] [MainThread]:   purity: None
[0m13:26:09.831363 [info ] [MainThread]:   retry_count: 1
[0m13:26:09.831490 [info ] [MainThread]:   retry_delay: 3
[0m13:26:09.831619 [info ] [MainThread]:   oml_auth_token_uri: https://tv1lg8pdut4n8vc-cfg57adw.adb.us-ashburn-1.oraclecloudapps.com/omlusers/api/oauth2/v1/token
[0m13:26:09.837240 [debug] [MainThread]: Acquiring new oracle connection 'debug'
[0m13:26:09.838005 [debug] [MainThread]: Using oracle connection "debug"
[0m13:26:09.838149 [debug] [MainThread]: On debug: select 1 as id from dual
[0m13:26:09.838298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:09.838472 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:26:12.958776 [debug] [MainThread]: SQL status: OK in 3.0 seconds
[0m13:26:12.961666 [debug] [MainThread]: On debug: Close
[0m13:26:13.266191 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:26:13.268134 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:26:13.269665 [debug] [MainThread]: Command `dbt debug` succeeded at 13:26:13.269482 after 3.58 seconds
[0m13:26:13.270215 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:26:13.270694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c17e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c17e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103122790>]}
[0m13:26:13.271260 [debug] [MainThread]: Flushing usage events
[0m13:26:20.383562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106617dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106617d90>]}


============================== 13:26:20.386415 | 4d82f9c0-9874-4253-97ce-e7f422ec78ee ==============================
[0m13:26:20.386415 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:26:20.386766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:26:20.434289 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:26:20.457058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d82f9c0-9874-4253-97ce-e7f422ec78ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106628910>]}
[0m13:26:20.463387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d82f9c0-9874-4253-97ce-e7f422ec78ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d39fd0>]}
[0m13:26:20.497517 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:26:20.535388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:20.535635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:20.538920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d82f9c0-9874-4253-97ce-e7f422ec78ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df6b10>]}
[0m13:26:20.543823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d82f9c0-9874-4253-97ce-e7f422ec78ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d43c90>]}
[0m13:26:20.544062 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m13:26:20.544243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d82f9c0-9874-4253-97ce-e7f422ec78ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea7f90>]}
[0m13:26:20.544937 [info ] [MainThread]: 
[0m13:26:20.545303 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:26:20.545870 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:26:20.551135 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:26:20.551366 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:26:20.551499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:20.551633 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:26:23.485491 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m13:26:23.814989 [debug] [ThreadPool]: On list_None: Close
[0m13:26:24.031074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:26:24.040915 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:26:24.041620 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:26:24.042070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:24.043202 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:26:26.577287 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m13:26:26.580712 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:26:26.580949 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:26:26.884491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:26:27.198279 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:26:27.400215 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:26:27.707405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d82f9c0-9874-4253-97ce-e7f422ec78ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d08e50>]}
[0m13:26:27.708136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:27.708512 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:26:30.324678 [debug] [MainThread]: On master: COMMIT
[0m13:26:30.325342 [debug] [MainThread]: Using oracle connection "master"
[0m13:26:30.325692 [debug] [MainThread]: On master: COMMIT
[0m13:26:30.573111 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:26:30.573822 [debug] [MainThread]: On master: Close
[0m13:26:31.102459 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:26:31.103858 [info ] [MainThread]: 
[0m13:26:31.124533 [debug] [Thread-1 (]: Began running node model.oracle_dbt.test
[0m13:26:31.125524 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.test ................................ [RUN]
[0m13:26:31.126875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.test)
[0m13:26:31.127111 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.test
[0m13:26:31.140544 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m13:26:31.141560 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (compile): 13:26:31.127221 => 13:26:31.141383
[0m13:26:31.141817 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.test
[0m13:26:31.150741 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m13:26:31.150983 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m13:26:31.159039 [info ] [Thread-1 (]: Python model materialization is table
[0m13:26:31.159389 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m13:26:37.009147 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.test"
[0m13:26:37.011046 [debug] [Thread-1 (]: On model.oracle_dbt.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.test"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODcyOTYzOTUsImlhdCI6MTY4NzI5Mjc5NX0.p1n4zoaSRfTjpG_5-MglT7JRfTQXA5naWiOwhLWiLvct25QYs80R8ulH1iwWwqcSqw_8zxUMO4utc8V4RlojuC5Z2cpennxoJuO96_cfP58KovAWa9ozkzP2TeAKCoenq7CC1VllDssoHGX1jMmBrbNx3Bzb78o38zRFJkyh97IvfHGtMdvrJv0VdZ-kR2m5Y1Ix9ylmswyR_9XxuRszjugIWrQ0uXqkK8rAOFHYCENlAe5MNv-PCqyEghLD6PDwstSChtkfceiKsuxqRBakXIHCfX_6e_wHJMtWfWOPgJo2elD0hXKZm_lc6UKuMgnmz9KheUex4LlpEH7aRUk-lA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('test_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "test"
        def __repr__(self):
            return "FAWDBTCORE.test"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_test_tmp_202637 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''test_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_test_tmp_202637';
                   sys.pyqScriptDrop('test_dbt_py_script');
                END;
        
[0m13:26:37.012536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:37.013508 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:26:41.136810 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-24263: Certificate of the remote server does not match the target address.
ORA-06512: at "SYS.UTL_HTTP", line 380
ORA-06512: at "SYS.UTL_HTTP", line 1209
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 83
[0m13:26:41.137737 [debug] [Thread-1 (]: On model.oracle_dbt.test: Close
[0m13:26:41.403724 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (execute): 13:26:31.141921 => 13:26:41.402182
[0m13:26:41.418022 [debug] [Thread-1 (]: Database Error in model test (models/staging/test.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-24263: Certificate of the remote server does not match the target address.
  ORA-06512: at "SYS.UTL_HTTP", line 380
  ORA-06512: at "SYS.UTL_HTTP", line 1209
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 83
  compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m13:26:41.421383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d82f9c0-9874-4253-97ce-e7f422ec78ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f86050>]}
[0m13:26:41.422359 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.test ....................... [[31mERROR[0m in 10.29s]
[0m13:26:41.423062 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.test
[0m13:26:41.425202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:26:41.425576 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:26:45.105580 [debug] [MainThread]: On master: COMMIT
[0m13:26:45.106253 [debug] [MainThread]: Using oracle connection "master"
[0m13:26:45.106769 [debug] [MainThread]: On master: COMMIT
[0m13:26:45.374177 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:26:45.375970 [debug] [MainThread]: On master: Close
[0m13:26:45.643723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:45.645210 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m13:26:45.645798 [info ] [MainThread]: 
[0m13:26:45.646522 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 25.10 seconds (25.10s).
[0m13:26:45.647593 [debug] [MainThread]: Command end result
[0m13:26:45.666285 [info ] [MainThread]: 
[0m13:26:45.666924 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:26:45.667232 [info ] [MainThread]: 
[0m13:26:45.667511 [error] [MainThread]: [33mDatabase Error in model test (models/staging/test.py)[0m
[0m13:26:45.667768 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m13:26:45.668008 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m13:26:45.668234 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m13:26:45.668448 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m13:26:45.668665 [error] [MainThread]:   ORA-24263: Certificate of the remote server does not match the target address.
[0m13:26:45.668964 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 380
[0m13:26:45.669313 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1209
[0m13:26:45.669509 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
[0m13:26:45.669687 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:26:45.669849 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:26:45.670013 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:26:45.670171 [error] [MainThread]:   ORA-06512: at line 83
[0m13:26:45.670333 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m13:26:45.670506 [info ] [MainThread]: 
[0m13:26:45.670712 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:26:45.671251 [debug] [MainThread]: Command `dbt run` failed at 13:26:45.671168 after 25.31 seconds
[0m13:26:45.671642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106617850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106617810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102738e10>]}
[0m13:26:45.671954 [debug] [MainThread]: Flushing usage events
[0m13:50:23.343916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104817610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104817fd0>]}


============================== 13:50:23.346295 | 7180b947-566f-4d3d-854a-8d064c1b15aa ==============================
[0m13:50:23.346295 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:50:23.346617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:50:23.390920 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:50:23.413721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7180b947-566f-4d3d-854a-8d064c1b15aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104829b50>]}
[0m13:50:23.419983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7180b947-566f-4d3d-854a-8d064c1b15aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cd790>]}
[0m13:50:23.450818 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:50:23.483132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:23.483326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:23.486454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7180b947-566f-4d3d-854a-8d064c1b15aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb24d0>]}
[0m13:50:23.490394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7180b947-566f-4d3d-854a-8d064c1b15aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cdbd0>]}
[0m13:50:23.490589 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m13:50:23.490765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7180b947-566f-4d3d-854a-8d064c1b15aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4bf90>]}
[0m13:50:23.491435 [info ] [MainThread]: 
[0m13:50:23.491809 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:50:23.492272 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:50:23.497562 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:50:23.497883 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:50:23.498062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:23.498210 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:25.998013 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:50:26.321253 [debug] [ThreadPool]: On list_None: Close
[0m13:50:26.629905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:50:26.635659 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:50:26.635983 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:50:26.636214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:26.636467 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:30.107039 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m13:50:30.116478 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:50:30.117057 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:50:30.607528 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:50:30.929881 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:50:31.232604 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:50:31.750207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7180b947-566f-4d3d-854a-8d064c1b15aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf02d0>]}
[0m13:50:31.750971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:31.751252 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:34.561081 [debug] [MainThread]: On master: COMMIT
[0m13:50:34.563045 [debug] [MainThread]: Using oracle connection "master"
[0m13:50:34.563844 [debug] [MainThread]: On master: COMMIT
[0m13:50:34.779673 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:50:34.781487 [debug] [MainThread]: On master: Close
[0m13:50:35.026340 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:50:35.026970 [info ] [MainThread]: 
[0m13:50:35.032172 [debug] [Thread-1 (]: Began running node model.oracle_dbt.test
[0m13:50:35.032613 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.test ................................ [RUN]
[0m13:50:35.033148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.test)
[0m13:50:35.033372 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.test
[0m13:50:35.057187 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m13:50:35.058271 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (compile): 13:50:35.033549 => 13:50:35.058108
[0m13:50:35.058535 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.test
[0m13:50:35.069529 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m13:50:35.069914 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m13:50:35.080487 [info ] [Thread-1 (]: Python model materialization is table
[0m13:50:35.080819 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m13:50:38.787988 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.test"
[0m13:50:38.788985 [debug] [Thread-1 (]: On model.oracle_dbt.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.test"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODcyOTc4MzcsImlhdCI6MTY4NzI5NDIzN30.n8qRixT172dQV4QzdJ1iT78l7pE9gcGuOtnvmFoKLpfNDau0C0_ZVGMpVpZaQBR61_et0aVDomzo-PayNdbEt99lynvulcgwbhIUobwjfbpEOiMxI0r5xrA14jc7OZcYLi0kPeJph66g58B9CLAOQh1SetcAgvLz36x-kT1Ter53uQEKDZQiZayQekLw08tJv6aC2oJLLz5PEuA78U0kU2ZWT1wvwFHuwnN2eJisC97nfDOoPvFyQdOqx_NMJ1QgzoQmyEgbDMiIcKyr-TfGq-tnJptVLu9VF1pLzcwW5ZXbY-exIwczDjbVSKJRdI32JgFfkIR4c4bGqS0wk1ClnQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('test_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "test"
        def __repr__(self):
            return "FAWDBTCORE.test"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_test_tmp_205038 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''test_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_test_tmp_205038';
                   sys.pyqScriptDrop('test_dbt_py_script');
                END;
        
[0m13:50:38.789486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:38.789799 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:42.086936 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-24263: Certificate of the remote server does not match the target address.
ORA-06512: at "SYS.UTL_HTTP", line 380
ORA-06512: at "SYS.UTL_HTTP", line 1209
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 83
[0m13:50:42.089345 [debug] [Thread-1 (]: On model.oracle_dbt.test: Close
[0m13:50:42.291097 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (execute): 13:50:35.058684 => 13:50:42.289730
[0m13:50:42.301297 [debug] [Thread-1 (]: Database Error in model test (models/staging/test.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-24263: Certificate of the remote server does not match the target address.
  ORA-06512: at "SYS.UTL_HTTP", line 380
  ORA-06512: at "SYS.UTL_HTTP", line 1209
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 83
  compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m13:50:42.303806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7180b947-566f-4d3d-854a-8d064c1b15aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdfc50>]}
[0m13:50:42.304404 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.test ....................... [[31mERROR[0m in 7.27s]
[0m13:50:42.304877 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.test
[0m13:50:42.306798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:42.307233 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:44.482080 [debug] [MainThread]: On master: COMMIT
[0m13:50:44.484289 [debug] [MainThread]: Using oracle connection "master"
[0m13:50:44.486507 [debug] [MainThread]: On master: COMMIT
[0m13:50:44.666613 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:50:44.668264 [debug] [MainThread]: On master: Close
[0m13:50:44.851456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:44.852066 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m13:50:44.852371 [info ] [MainThread]: 
[0m13:50:44.852730 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.36 seconds (21.36s).
[0m13:50:44.853225 [debug] [MainThread]: Command end result
[0m13:50:44.860764 [info ] [MainThread]: 
[0m13:50:44.861345 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:50:44.861664 [info ] [MainThread]: 
[0m13:50:44.861967 [error] [MainThread]: [33mDatabase Error in model test (models/staging/test.py)[0m
[0m13:50:44.862255 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m13:50:44.862524 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m13:50:44.862784 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m13:50:44.863035 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m13:50:44.863289 [error] [MainThread]:   ORA-24263: Certificate of the remote server does not match the target address.
[0m13:50:44.863536 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 380
[0m13:50:44.863783 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1209
[0m13:50:44.864029 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
[0m13:50:44.864274 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:50:44.864516 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:50:44.864760 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:50:44.864997 [error] [MainThread]:   ORA-06512: at line 83
[0m13:50:44.865242 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m13:50:44.865495 [info ] [MainThread]: 
[0m13:50:44.865783 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:50:44.866306 [debug] [MainThread]: Command `dbt run` failed at 13:50:44.866223 after 21.54 seconds
[0m13:50:44.866630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027de090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10083bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f8090>]}
[0m13:50:44.866930 [debug] [MainThread]: Flushing usage events
[0m13:52:06.906547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b17610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b17fd0>]}


============================== 13:52:06.909249 | 2386cbf1-d9ee-4975-865e-f2741ab5b794 ==============================
[0m13:52:06.909249 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:52:06.909579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:52:06.955478 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:52:06.977628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2386cbf1-d9ee-4975-865e-f2741ab5b794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2b5d0>]}
[0m13:52:06.983773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2386cbf1-d9ee-4975-865e-f2741ab5b794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e6610>]}
[0m13:52:07.014892 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:52:07.046894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:07.047092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:07.050142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2386cbf1-d9ee-4975-865e-f2741ab5b794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b09b50>]}
[0m13:52:07.054101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2386cbf1-d9ee-4975-865e-f2741ab5b794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b48e50>]}
[0m13:52:07.054299 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m13:52:07.054476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2386cbf1-d9ee-4975-865e-f2741ab5b794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644bf90>]}
[0m13:52:07.055119 [info ] [MainThread]: 
[0m13:52:07.055493 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:52:07.056003 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:52:07.061023 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:52:07.061288 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:52:07.061427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:07.061557 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:52:08.984784 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:52:09.132828 [debug] [ThreadPool]: On list_None: Close
[0m13:52:09.287335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:52:09.290267 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:52:09.290433 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:52:09.290562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:09.290688 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:52:10.837116 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:52:10.843370 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:52:10.843673 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:52:11.178066 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:52:11.388337 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:52:11.488944 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:52:11.597185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2386cbf1-d9ee-4975-865e-f2741ab5b794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d51d0>]}
[0m13:52:11.598566 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:11.599231 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:52:12.863505 [debug] [MainThread]: On master: COMMIT
[0m13:52:12.865489 [debug] [MainThread]: Using oracle connection "master"
[0m13:52:12.866250 [debug] [MainThread]: On master: COMMIT
[0m13:52:12.967714 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:52:12.968962 [debug] [MainThread]: On master: Close
[0m13:52:13.075499 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:52:13.077184 [info ] [MainThread]: 
[0m13:52:13.091682 [debug] [Thread-1 (]: Began running node model.oracle_dbt.test
[0m13:52:13.092390 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.test ................................ [RUN]
[0m13:52:13.093086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.test)
[0m13:52:13.093387 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.test
[0m13:52:13.116351 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m13:52:13.119179 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (compile): 13:52:13.093582 => 13:52:13.118933
[0m13:52:13.119536 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.test
[0m13:52:13.130719 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m13:52:13.131017 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m13:52:13.139897 [info ] [Thread-1 (]: Python model materialization is table
[0m13:52:13.140388 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m13:52:15.482988 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.test"
[0m13:52:15.485837 [debug] [Thread-1 (]: On model.oracle_dbt.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.test"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODcyOTc5MzQsImlhdCI6MTY4NzI5NDMzNH0.NilaxqCHvLf7apMK0GnrvroUS-W_JMOWJAfoRFmAVZ-EyZMKoCdj4F4bRiasQ0uFhkptl0XJtpGLPOlI8Xjr9l_rUrYe6OXZPpoaTKO1cybroApvqBnWKmNh0g79stSHv4E8qHEndK667dNnXzPE0Dq6wZ375pmLV9Vh3vDsHJIxdtXUQLCVLXFgF9-ZQ4hGz-NaHRwk98FT9IDJuAZurcFzbjCVwJ5vnY_bWM-xVFtiGAl_G9EqH0biYywQD6C_ZrFUBHOWSXI7Fhsgc346bG6NNjCI9lHkcfxtypfKzNkin9K1qw608ugWPkGleWUYPFuXfsY4xOBwRHSgWARggA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('test_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "test"
        def __repr__(self):
            return "FAWDBTCORE.test"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_test_tmp_205215 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''test_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_test_tmp_205215';
                   sys.pyqScriptDrop('test_dbt_py_script');
                END;
        
[0m13:52:15.487974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:15.489206 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:52:17.806767 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-24263: Certificate of the remote server does not match the target address.
ORA-06512: at "SYS.UTL_HTTP", line 380
ORA-06512: at "SYS.UTL_HTTP", line 1209
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 83
[0m13:52:17.809331 [debug] [Thread-1 (]: On model.oracle_dbt.test: Close
[0m13:52:17.966235 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (execute): 13:52:13.119719 => 13:52:17.964702
[0m13:52:17.998411 [debug] [Thread-1 (]: Database Error in model test (models/staging/test.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-24263: Certificate of the remote server does not match the target address.
  ORA-06512: at "SYS.UTL_HTTP", line 380
  ORA-06512: at "SYS.UTL_HTTP", line 1209
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 83
  compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m13:52:18.004668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2386cbf1-d9ee-4975-865e-f2741ab5b794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ebf90>]}
[0m13:52:18.006408 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.test ....................... [[31mERROR[0m in 4.91s]
[0m13:52:18.006974 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.test
[0m13:52:18.008780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:18.009117 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:52:20.131763 [debug] [MainThread]: On master: COMMIT
[0m13:52:20.133738 [debug] [MainThread]: Using oracle connection "master"
[0m13:52:20.134607 [debug] [MainThread]: On master: COMMIT
[0m13:52:20.241187 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:52:20.242456 [debug] [MainThread]: On master: Close
[0m13:52:20.806890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:20.809467 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m13:52:20.810298 [info ] [MainThread]: 
[0m13:52:20.811197 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.75 seconds (13.75s).
[0m13:52:20.812607 [debug] [MainThread]: Command end result
[0m13:52:20.825275 [info ] [MainThread]: 
[0m13:52:20.825994 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:52:20.826829 [info ] [MainThread]: 
[0m13:52:20.827391 [error] [MainThread]: [33mDatabase Error in model test (models/staging/test.py)[0m
[0m13:52:20.827832 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m13:52:20.828237 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m13:52:20.828618 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m13:52:20.828991 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m13:52:20.829350 [error] [MainThread]:   ORA-24263: Certificate of the remote server does not match the target address.
[0m13:52:20.829722 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 380
[0m13:52:20.830054 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1209
[0m13:52:20.830338 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
[0m13:52:20.830626 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:52:20.830912 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:52:20.831195 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:52:20.831479 [error] [MainThread]:   ORA-06512: at line 83
[0m13:52:20.831762 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m13:52:20.832058 [info ] [MainThread]: 
[0m13:52:20.832408 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:52:20.833035 [debug] [MainThread]: Command `dbt run` failed at 13:52:20.832936 after 13.94 seconds
[0m13:52:20.833422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101056c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010578d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ce5d0>]}
[0m13:52:20.833768 [debug] [MainThread]: Flushing usage events
[0m13:52:48.883573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10419bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a7f90>]}


============================== 13:52:48.885874 | ead8bf8e-4124-4c90-a16c-708594de62ae ==============================
[0m13:52:48.885874 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:52:48.886181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:52:48.927529 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:52:48.949656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ead8bf8e-4124-4c90-a16c-708594de62ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b8890>]}
[0m13:52:48.955765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ead8bf8e-4124-4c90-a16c-708594de62ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471dfd0>]}
[0m13:52:48.986717 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:52:49.016997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:49.017256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:49.020690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ead8bf8e-4124-4c90-a16c-708594de62ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d6010>]}
[0m13:52:49.025776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ead8bf8e-4124-4c90-a16c-708594de62ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f3fd0>]}
[0m13:52:49.025983 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m13:52:49.026160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ead8bf8e-4124-4c90-a16c-708594de62ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a37c10>]}
[0m13:52:49.026826 [info ] [MainThread]: 
[0m13:52:49.027201 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:52:49.027891 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:52:49.033226 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:52:49.033469 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:52:49.033600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:49.033733 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:52:52.243940 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m13:52:52.391521 [debug] [ThreadPool]: On list_None: Close
[0m13:52:52.540958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:52:52.547034 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:52:52.547360 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:52:52.547591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:52.547834 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:52:54.776234 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:52:54.779522 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:52:54.779719 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:52:55.008966 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:52:55.368538 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:52:55.588704 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:52:55.806421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ead8bf8e-4124-4c90-a16c-708594de62ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047380d0>]}
[0m13:52:55.807132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:55.807432 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:52:58.484481 [debug] [MainThread]: On master: COMMIT
[0m13:52:58.486067 [debug] [MainThread]: Using oracle connection "master"
[0m13:52:58.486629 [debug] [MainThread]: On master: COMMIT
[0m13:52:58.788706 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:52:58.790092 [debug] [MainThread]: On master: Close
[0m13:52:59.201986 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:52:59.203166 [info ] [MainThread]: 
[0m13:52:59.222978 [debug] [Thread-1 (]: Began running node model.oracle_dbt.test
[0m13:52:59.223383 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.test ................................ [RUN]
[0m13:52:59.223975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.test)
[0m13:52:59.224339 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.test
[0m13:52:59.240551 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m13:52:59.241576 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (compile): 13:52:59.224481 => 13:52:59.241429
[0m13:52:59.241788 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.test
[0m13:52:59.250497 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m13:52:59.250765 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m13:52:59.261316 [info ] [Thread-1 (]: Python model materialization is table
[0m13:52:59.261764 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m13:53:01.837560 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.test"
[0m13:53:01.838661 [debug] [Thread-1 (]: On model.oracle_dbt.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.test"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODcyOTc5ODAsImlhdCI6MTY4NzI5NDM4MH0.O8Eq3j8evDXayT1c1b0MKpOsYjZbFkAnXJGS52V5Nyo3moxz_h3OvPbl2JFqCe8QxnIA3WvVyH7bpdF50ex-fhz9Om4sW4HPUviQ0A9ls6wC7vhMWFuZ1x90kTCporIY8GV1R4IUgA1qdw-zTx9dJnkNOq54jGVxO5eJisXiMg4YC1mZgdUP1Yb9ahcYVRBD03f1ZeAnZhzABFdMjcLrgz_wpk5_v8XxKRxgPRfbssyUU0_CpVOVcUnB0As0xuG4hLVANAfdHk4K2Sznf-U5ecYezYFyPDDheZj83fg0ZaL-SkES9F9d60eLrMzPycAYlJpG9Dizspxq_qAtzX2tIw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('test_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "test"
        def __repr__(self):
            return "FAWDBTCORE.test"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_test_tmp_205301 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''test_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_test_tmp_205301';
                   sys.pyqScriptDrop('test_dbt_py_script');
                END;
        
[0m13:53:01.839485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:01.839910 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:53:05.733419 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-24263: Certificate of the remote server does not match the target address.
ORA-06512: at "SYS.UTL_HTTP", line 380
ORA-06512: at "SYS.UTL_HTTP", line 1209
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 83
[0m13:53:05.735728 [debug] [Thread-1 (]: On model.oracle_dbt.test: Close
[0m13:53:06.017531 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (execute): 13:52:59.241907 => 13:53:06.015283
[0m13:53:06.038673 [debug] [Thread-1 (]: Database Error in model test (models/staging/test.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-24263: Certificate of the remote server does not match the target address.
  ORA-06512: at "SYS.UTL_HTTP", line 380
  ORA-06512: at "SYS.UTL_HTTP", line 1209
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 83
  compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m13:53:06.043206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ead8bf8e-4124-4c90-a16c-708594de62ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b26ad0>]}
[0m13:53:06.043820 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.test ....................... [[31mERROR[0m in 6.82s]
[0m13:53:06.044184 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.test
[0m13:53:06.045716 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:53:06.046045 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:53:09.439312 [debug] [MainThread]: On master: COMMIT
[0m13:53:09.441719 [debug] [MainThread]: Using oracle connection "master"
[0m13:53:09.442653 [debug] [MainThread]: On master: COMMIT
[0m13:53:09.705533 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:53:09.706969 [debug] [MainThread]: On master: Close
[0m13:53:09.983608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:09.984668 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m13:53:09.985242 [info ] [MainThread]: 
[0m13:53:09.985802 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.96 seconds (20.96s).
[0m13:53:09.986610 [debug] [MainThread]: Command end result
[0m13:53:10.002530 [info ] [MainThread]: 
[0m13:53:10.003129 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:53:10.003413 [info ] [MainThread]: 
[0m13:53:10.003944 [error] [MainThread]: [33mDatabase Error in model test (models/staging/test.py)[0m
[0m13:53:10.004365 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m13:53:10.004655 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m13:53:10.004925 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m13:53:10.005180 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m13:53:10.005442 [error] [MainThread]:   ORA-24263: Certificate of the remote server does not match the target address.
[0m13:53:10.005699 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 380
[0m13:53:10.005947 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1209
[0m13:53:10.006191 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
[0m13:53:10.006443 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:53:10.006692 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:53:10.006947 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:53:10.007190 [error] [MainThread]:   ORA-06512: at line 83
[0m13:53:10.007405 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m13:53:10.007642 [info ] [MainThread]: 
[0m13:53:10.007924 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:53:10.008534 [debug] [MainThread]: Command `dbt run` failed at 13:53:10.008435 after 21.14 seconds
[0m13:53:10.008903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040561d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100adce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100adce10>]}
[0m13:53:10.009228 [debug] [MainThread]: Flushing usage events
[0m13:54:00.317553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11800bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118017c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118017f90>]}


============================== 13:54:00.320137 | a2f5cccf-ef19-4d84-b6f9-c8c39b78d210 ==============================
[0m13:54:00.320137 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:54:00.320446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:54:00.373200 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:54:00.395664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2f5cccf-ef19-4d84-b6f9-c8c39b78d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118045350>]}
[0m13:54:00.401936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2f5cccf-ef19-4d84-b6f9-c8c39b78d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11873af50>]}
[0m13:54:00.434572 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:54:00.473851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:00.474041 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:00.477102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2f5cccf-ef19-4d84-b6f9-c8c39b78d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187eca90>]}
[0m13:54:00.481914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2f5cccf-ef19-4d84-b6f9-c8c39b78d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11870e610>]}
[0m13:54:00.482121 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m13:54:00.482302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2f5cccf-ef19-4d84-b6f9-c8c39b78d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118089e50>]}
[0m13:54:00.482982 [info ] [MainThread]: 
[0m13:54:00.483441 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:54:00.483933 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:54:00.488894 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:54:00.489131 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:54:00.489258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:00.489394 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:54:03.144353 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m13:54:03.435799 [debug] [ThreadPool]: On list_None: Close
[0m13:54:03.668001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:54:03.673998 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:54:03.674316 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:54:03.674542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:03.674789 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:54:06.021716 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:54:06.031197 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:54:06.031644 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:54:06.189416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:06.423725 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:54:06.564989 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:54:06.705749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2f5cccf-ef19-4d84-b6f9-c8c39b78d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11870d290>]}
[0m13:54:06.706425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:06.706699 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:54:08.495221 [debug] [MainThread]: On master: COMMIT
[0m13:54:08.496680 [debug] [MainThread]: Using oracle connection "master"
[0m13:54:08.497082 [debug] [MainThread]: On master: COMMIT
[0m13:54:08.678869 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:08.681227 [debug] [MainThread]: On master: Close
[0m13:54:08.859336 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:54:08.860250 [info ] [MainThread]: 
[0m13:54:08.864736 [debug] [Thread-1 (]: Began running node model.oracle_dbt.test
[0m13:54:08.865203 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.test ................................ [RUN]
[0m13:54:08.865847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.test)
[0m13:54:08.866111 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.test
[0m13:54:08.889342 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m13:54:08.891794 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (compile): 13:54:08.866275 => 13:54:08.891562
[0m13:54:08.892132 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.test
[0m13:54:08.902479 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m13:54:08.902735 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m13:54:08.911065 [info ] [Thread-1 (]: Python model materialization is table
[0m13:54:08.911371 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m13:54:11.367505 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.test"
[0m13:54:11.367917 [debug] [Thread-1 (]: On model.oracle_dbt.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.test"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODcyOTgwNTAsImlhdCI6MTY4NzI5NDQ1MH0.LGq61eFrRsULxxmrDV-T6aIntWy26zI-MxF56b3uA2kUUiRO8dewR7VzWLWo6Ya5L7szUef-R3OgHTp213zqon9JVFE6GQX68RnB8cqkIz-FBqI9Y5sEzhNt4iJbHMzmm48-yeKB6omATaHMsq6k6N96Xfjr6k0AeXYN_ODlW68d7cll0X05dfzYDVFXEP-Zrj5dxFrluC3N2C4cPwLL6uNcPXAlaRO-fUkQaryRwJ6c1BbE8zg9wC8vFe8pBDOUbxf3Pejh5CAjERW36jSqsJtEpFNCS87lvhhpbc21lwirfeRw8EqYSsF6-7xJLX4N93bgQO9SMBqpfaXSgvPQUA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('test_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "test"
        def __repr__(self):
            return "FAWDBTCORE.test"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_test_tmp_205411 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''test_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_test_tmp_205411';
                   sys.pyqScriptDrop('test_dbt_py_script');
                END;
        
[0m13:54:11.368220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:11.368431 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:54:14.214204 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-24263: Certificate of the remote server does not match the target address.
ORA-06512: at "SYS.UTL_HTTP", line 380
ORA-06512: at "SYS.UTL_HTTP", line 1209
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 83
[0m13:54:14.218178 [debug] [Thread-1 (]: On model.oracle_dbt.test: Close
[0m13:54:14.417644 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (execute): 13:54:08.892304 => 13:54:14.416598
[0m13:54:14.428613 [debug] [Thread-1 (]: Database Error in model test (models/staging/test.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-24263: Certificate of the remote server does not match the target address.
  ORA-06512: at "SYS.UTL_HTTP", line 380
  ORA-06512: at "SYS.UTL_HTTP", line 1209
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 83
  compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m13:54:14.430935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2f5cccf-ef19-4d84-b6f9-c8c39b78d210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180cacd0>]}
[0m13:54:14.431632 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.test ....................... [[31mERROR[0m in 5.57s]
[0m13:54:14.432140 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.test
[0m13:54:14.433772 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:14.434081 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:54:16.497414 [debug] [MainThread]: On master: COMMIT
[0m13:54:16.499272 [debug] [MainThread]: Using oracle connection "master"
[0m13:54:16.499728 [debug] [MainThread]: On master: COMMIT
[0m13:54:16.686416 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:16.688291 [debug] [MainThread]: On master: Close
[0m13:54:16.874941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:16.875499 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m13:54:16.875783 [info ] [MainThread]: 
[0m13:54:16.876130 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.39 seconds (16.39s).
[0m13:54:16.876631 [debug] [MainThread]: Command end result
[0m13:54:16.884088 [info ] [MainThread]: 
[0m13:54:16.884524 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:54:16.884782 [info ] [MainThread]: 
[0m13:54:16.885031 [error] [MainThread]: [33mDatabase Error in model test (models/staging/test.py)[0m
[0m13:54:16.885266 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m13:54:16.885494 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m13:54:16.885720 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m13:54:16.885936 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m13:54:16.886155 [error] [MainThread]:   ORA-24263: Certificate of the remote server does not match the target address.
[0m13:54:16.886366 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 380
[0m13:54:16.886583 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1209
[0m13:54:16.886799 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
[0m13:54:16.887011 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:54:16.887224 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:54:16.887436 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:54:16.887644 [error] [MainThread]:   ORA-06512: at line 83
[0m13:54:16.887857 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m13:54:16.888379 [info ] [MainThread]: 
[0m13:54:16.888806 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:54:16.889411 [debug] [MainThread]: Command `dbt run` failed at 13:54:16.889313 after 16.59 seconds
[0m13:54:16.889768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10244ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11884c0d0>]}
[0m13:54:16.890096 [debug] [MainThread]: Flushing usage events
[0m09:40:36.058430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f6b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f8ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f8bf90>]}


============================== 09:40:36.112893 | 3384366d-d167-42c0-a6e9-7b70296648ba ==============================
[0m09:40:36.112893 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:40:36.114078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:40:36.185286 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ORACLE_USER'
[0m09:40:36.193630 [debug] [MainThread]: Command `dbt run` failed at 09:40:36.187366 after 0.33 seconds
[0m09:40:36.194977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f8b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f8b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e98ad0>]}
[0m09:40:36.196298 [debug] [MainThread]: Flushing usage events
[0m09:42:37.046725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11440b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114417750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114417d90>]}


============================== 09:42:37.050154 | e0766d6f-3144-44b1-8cae-8d1153e77c9a ==============================
[0m09:42:37.050154 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:42:37.050459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:42:37.050746 [info ] [MainThread]: dbt version: 1.5.1
[0m09:42:37.050916 [info ] [MainThread]: python version: 3.11.3
[0m09:42:37.051085 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m09:42:37.051226 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m09:42:37.051367 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/Desktop/oracle-dbt/profiles.yml
[0m09:42:37.051517 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m09:42:37.051648 [info ] [MainThread]: Configuration:
[0m09:42:37.851325 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m09:42:37.907057 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:42:37.918931 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:42:37.919298 [info ] [MainThread]: Required dependencies:
[0m09:42:37.919591 [debug] [MainThread]: Executing "git --help"
[0m09:42:37.930700 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:42:37.931488 [debug] [MainThread]: STDERR: "b''"
[0m09:42:37.931711 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:42:37.932009 [info ] [MainThread]: Connection:
[0m09:42:37.932463 [info ] [MainThread]:   user: fawdbtcore
[0m09:42:37.932688 [info ] [MainThread]:   database: None
[0m09:42:37.932871 [info ] [MainThread]:   schema: FAWDBTCORE
[0m09:42:37.933038 [info ] [MainThread]:   protocol: None
[0m09:42:37.933202 [info ] [MainThread]:   host: None
[0m09:42:37.933361 [info ] [MainThread]:   port: None
[0m09:42:37.933516 [info ] [MainThread]:   tns_name: cfg57adw_low
[0m09:42:37.933674 [info ] [MainThread]:   service: None
[0m09:42:37.933830 [info ] [MainThread]:   connection_string: None
[0m09:42:37.933983 [info ] [MainThread]:   shardingkey: []
[0m09:42:37.934133 [info ] [MainThread]:   supershardingkey: []
[0m09:42:37.934284 [info ] [MainThread]:   cclass: None
[0m09:42:37.934434 [info ] [MainThread]:   purity: None
[0m09:42:37.934584 [info ] [MainThread]:   retry_count: 1
[0m09:42:37.934738 [info ] [MainThread]:   retry_delay: 3
[0m09:42:37.934897 [info ] [MainThread]:   oml_auth_token_uri: https://tv1lg8pdut4n8vc-cfg57adw.adb.us-ashburn-1.oraclecloudapps.com/omlusers/api/oauth2/v1/token
[0m09:42:37.957781 [debug] [MainThread]: Acquiring new oracle connection 'debug'
[0m09:42:37.958453 [debug] [MainThread]: Using oracle connection "debug"
[0m09:42:37.958634 [debug] [MainThread]: On debug: select 1 as id from dual
[0m09:42:37.958800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:37.959028 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:42:40.317404 [debug] [MainThread]: SQL status: OK in 2.0 seconds
[0m09:42:40.320090 [debug] [MainThread]: On debug: Close
[0m09:42:40.464752 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:42:40.466830 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:42:40.468656 [debug] [MainThread]: Command `dbt debug` succeeded at 09:42:40.468415 after 3.44 seconds
[0m09:42:40.469343 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:42:40.470075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105268d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143f7bd0>]}
[0m09:42:40.470558 [debug] [MainThread]: Flushing usage events
[0m09:42:47.805145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c08450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c17f10>]}


============================== 09:42:47.807810 | 1dbd9c53-6108-4163-bbc0-ac431a0c05e9 ==============================
[0m09:42:47.807810 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:42:47.808148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:42:47.867255 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m09:42:47.891211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dbd9c53-6108-4163-bbc0-ac431a0c05e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c17fd0>]}
[0m09:42:47.898364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dbd9c53-6108-4163-bbc0-ac431a0c05e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106329110>]}
[0m09:42:47.950433 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:42:49.606197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:42:49.606923 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:42:49.614083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dbd9c53-6108-4163-bbc0-ac431a0c05e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c16d50>]}
[0m09:42:49.734173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dbd9c53-6108-4163-bbc0-ac431a0c05e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106347f10>]}
[0m09:42:49.736074 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:42:49.736720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dbd9c53-6108-4163-bbc0-ac431a0c05e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ccb690>]}
[0m09:42:49.738948 [info ] [MainThread]: 
[0m09:42:49.739801 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m09:42:49.741484 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m09:42:49.752303 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m09:42:49.752806 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m09:42:49.753103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:49.753395 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:42:51.409070 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m09:42:51.519918 [debug] [ThreadPool]: On list_None: Close
[0m09:42:51.629621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m09:42:51.635595 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m09:42:51.636043 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m09:42:51.636276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:51.636513 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:42:53.247979 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m09:42:53.259338 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m09:42:53.259908 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m09:42:54.156191 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m09:42:54.369737 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m09:42:54.548765 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m09:42:54.726040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dbd9c53-6108-4163-bbc0-ac431a0c05e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106427f10>]}
[0m09:42:54.726900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:54.727462 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:42:56.374883 [debug] [MainThread]: On master: COMMIT
[0m09:42:56.377091 [debug] [MainThread]: Using oracle connection "master"
[0m09:42:56.377631 [debug] [MainThread]: On master: COMMIT
[0m09:42:56.502936 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:42:56.505060 [debug] [MainThread]: On master: Close
[0m09:42:56.635497 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:42:56.636441 [info ] [MainThread]: 
[0m09:42:56.661996 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m09:42:56.662423 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m09:42:56.662952 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m09:42:56.663356 [debug] [Thread-4 (]: Began running node model.oracle_dbt.test
[0m09:42:56.664009 [info ] [Thread-1 (]: 1 of 11 START sql incremental model FAWDBTCORE.stg_mobile_events ............... [RUN]
[0m09:42:56.664358 [info ] [Thread-2 (]: 2 of 11 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m09:42:56.664663 [info ] [Thread-3 (]: 3 of 11 START sql incremental model FAWDBTCORE.stg_web_events .................. [RUN]
[0m09:42:56.664927 [info ] [Thread-4 (]: 4 of 11 START python table model FAWDBTCORE.test ............................... [RUN]
[0m09:42:56.665767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m09:42:56.666359 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m09:42:56.666908 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m09:42:56.667359 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.test'
[0m09:42:56.667776 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m09:42:56.668346 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m09:42:56.668721 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m09:42:56.668932 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.test
[0m09:42:56.678331 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m09:42:56.680047 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m09:42:56.683097 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m09:42:56.696209 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m09:42:56.703490 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 09:42:56.669097 => 09:42:56.703216
[0m09:42:56.703887 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m09:42:56.727556 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.test (compile): 09:42:56.683467 => 09:42:56.727380
[0m09:42:56.728518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:56.729079 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.test
[0m09:42:56.729354 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 09:42:56.678618 => 09:42:56.729266
[0m09:42:56.729651 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 09:42:56.680303 => 09:42:56.729507
[0m09:42:56.729945 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:42:56.738071 [debug] [Thread-4 (]: Preexisting intermediate relation=None
[0m09:42:56.738418 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m09:42:56.738629 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m09:42:56.739006 [debug] [Thread-4 (]: Preexisting backup relation=None
[0m09:42:56.747600 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m09:42:56.749536 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:42:56.751919 [info ] [Thread-4 (]: Python model materialization is table
[0m09:42:56.752341 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:42:56.752645 [debug] [Thread-4 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m09:42:56.771344 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:42:56.771689 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:42:58.615282 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m09:42:58.617494 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m09:42:58.618458 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

        
  
    
      create global temporary table o$pt_stg_web_events094256749220
      on commit preserve rows
      
      as
        


with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  created_at
    FROM FAWDBTCORE.web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned



  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.stg_web_events)


  
      
[0m09:42:58.619293 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m09:42:58.620162 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users
)

select * from users_cleaned


[0m09:42:58.620942 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

        
  
    
      create global temporary table o$pt_stg_mobile_events094256723198
      on commit preserve rows
      
      as
        


with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  created_at
FROM FAWDBTCORE.mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned





  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.stg_mobile_events)


  
      
[0m09:42:58.993731 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m09:42:59.002505 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m09:42:59.003056 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m09:42:59.003490 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m09:42:59.128842 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m09:42:59.138590 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m09:42:59.139489 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m09:42:59.257625 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m09:42:59.272508 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 09:42:56.739186 => 09:42:59.272342
[0m09:42:59.272975 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m09:42:59.385760 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbd9c53-6108-4163-bbc0-ac431a0c05e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110113e10>]}
[0m09:42:59.386992 [info ] [Thread-2 (]: 2 of 11 OK created sql view model FAWDBTCORE.stg_users ......................... [[32mOK[0m in 2.72s]
[0m09:42:59.387624 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m09:42:59.754690 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m09:42:59.766921 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m09:42:59.767723 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_mobile_events094256723198')
        
      order by ordinal_position

  
[0m09:43:00.094248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:43:00.246142 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m09:43:00.246998 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_mobile_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m09:43:00.390619 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.test"
[0m09:43:00.391594 [debug] [Thread-4 (]: On model.oracle_dbt.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.test"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNjkzNzksImlhdCI6MTY4NzM2NTc3OX0.I8sBZyyM4dQEI-E9kpMoAxMvr37bX9rQb9wFCW4tpr5DZOw_-yKONgpjgyG_7qzsNIxIA25vGEdR1jPERZ6OS0l9MxCutFMSFHcnqAC8EVP7EGIrOeU_PP6AuS6ODgG99N5yqK6z1WJUtEilTc1dF-BLfzmf73H-z3XVNj7GYz9_ZdNbBqGl1vwjgNqdcn-T3Gd1hxDdE32QezTFQM0UVvgEo1OS3uiO1xDWI9YhtISIJxTrk_jvxTZQoDGGiIqGEuJTzZP_eqgH-FAZ4hPaNDhhIgi1C0P0k4-6o_HF7eWf8vvit0-VUWqYU6YxRK_4iky23QClmRvAEjN-R_G00A!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('test_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "test"
        def __repr__(self):
            return "FAWDBTCORE.test"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_test_tmp_164300 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''test_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_test_tmp_164300';
                   sys.pyqScriptDrop('test_dbt_py_script');
                END;
        
[0m09:43:00.392478 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:43:00.392897 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:43:00.476374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:43:00.643269 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m09:43:00.644049 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_MOBILE_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m09:43:00.893291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:43:01.063013 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m09:43:01.070378 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m09:43:01.070882 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      merge  into FAWDBTCORE.stg_mobile_events DBT_INTERNAL_DEST
          using o$pt_stg_mobile_events094256723198 DBT_INTERNAL_SOURCE
          on (
            DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
        )
        when matched then
          update set
          DBT_INTERNAL_DEST.EVENT_TYPE = DBT_INTERNAL_SOURCE.EVENT_TYPE, 
          DBT_INTERNAL_DEST.EVENT_TIMESTAMP = DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
          DBT_INTERNAL_DEST.USER_ID = DBT_INTERNAL_SOURCE.USER_ID, 
          DBT_INTERNAL_DEST.APP_NAME = DBT_INTERNAL_SOURCE.APP_NAME, 
          DBT_INTERNAL_DEST.OPERATING_SYSTEM = DBT_INTERNAL_SOURCE.OPERATING_SYSTEM, 
          DBT_INTERNAL_DEST.COUNTRY = DBT_INTERNAL_SOURCE.COUNTRY, 
          DBT_INTERNAL_DEST.DURATION_SECONDS = DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
          DBT_INTERNAL_DEST.CONVERSION_STATUS = DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
          DBT_INTERNAL_DEST.CREATED_AT = DBT_INTERNAL_SOURCE.CREATED_AT
          when not matched then
          insert(EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, APP_NAME, OPERATING_SYSTEM, COUNTRY, DURATION_SECONDS, CONVERSION_STATUS, CREATED_AT)
          values(
            DBT_INTERNAL_SOURCE.EVENT_ID, 
            DBT_INTERNAL_SOURCE.EVENT_TYPE, 
            DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
            DBT_INTERNAL_SOURCE.USER_ID, 
            DBT_INTERNAL_SOURCE.APP_NAME, 
            DBT_INTERNAL_SOURCE.OPERATING_SYSTEM, 
            DBT_INTERNAL_SOURCE.COUNTRY, 
            DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
            DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
            DBT_INTERNAL_SOURCE.CREATED_AT
            )
  
[0m09:43:01.158332 [debug] [Thread-3 (]: SQL status: OK in 3.0 seconds
[0m09:43:01.161390 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m09:43:01.161957 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_events094256749220')
        
      order by ordinal_position

  
[0m09:43:01.453671 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m09:43:01.566170 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m09:43:01.566949 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m09:43:01.805489 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m09:43:01.933223 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m09:43:01.934015 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m09:43:02.145910 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m09:43:02.274407 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m09:43:02.283296 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m09:43:02.283787 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      merge  into FAWDBTCORE.stg_web_events DBT_INTERNAL_DEST
          using o$pt_stg_web_events094256749220 DBT_INTERNAL_SOURCE
          on (
            DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
        )
        when matched then
          update set
          DBT_INTERNAL_DEST.EVENT_TYPE = DBT_INTERNAL_SOURCE.EVENT_TYPE, 
          DBT_INTERNAL_DEST.EVENT_TIMESTAMP = DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
          DBT_INTERNAL_DEST.USER_ID = DBT_INTERNAL_SOURCE.USER_ID, 
          DBT_INTERNAL_DEST.PAGE_URL = DBT_INTERNAL_SOURCE.PAGE_URL, 
          DBT_INTERNAL_DEST.BROWSER = DBT_INTERNAL_SOURCE.BROWSER, 
          DBT_INTERNAL_DEST.DEVICE_TYPE = DBT_INTERNAL_SOURCE.DEVICE_TYPE, 
          DBT_INTERNAL_DEST.COUNTRY = DBT_INTERNAL_SOURCE.COUNTRY, 
          DBT_INTERNAL_DEST.DURATION_SECONDS = DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
          DBT_INTERNAL_DEST.CONVERSION_STATUS = DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
          DBT_INTERNAL_DEST.CREATED_AT = DBT_INTERNAL_SOURCE.CREATED_AT
          when not matched then
          insert(EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, PAGE_URL, BROWSER, DEVICE_TYPE, COUNTRY, DURATION_SECONDS, CONVERSION_STATUS, CREATED_AT)
          values(
            DBT_INTERNAL_SOURCE.EVENT_ID, 
            DBT_INTERNAL_SOURCE.EVENT_TYPE, 
            DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
            DBT_INTERNAL_SOURCE.USER_ID, 
            DBT_INTERNAL_SOURCE.PAGE_URL, 
            DBT_INTERNAL_SOURCE.BROWSER, 
            DBT_INTERNAL_SOURCE.DEVICE_TYPE, 
            DBT_INTERNAL_SOURCE.COUNTRY, 
            DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
            DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
            DBT_INTERNAL_SOURCE.CREATED_AT
            )
  
[0m09:43:03.548560 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m09:43:03.553182 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m09:43:03.553793 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m09:43:03.554143 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m09:43:03.695970 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:43:03.701221 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m09:43:03.701616 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
truncate table o$pt_stg_mobile_events094256723198
[0m09:43:03.785217 [info ] [Thread-4 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-24263: Certificate of the remote server does not match the target address.
ORA-06512: at "SYS.UTL_HTTP", line 380
ORA-06512: at "SYS.UTL_HTTP", line 1209
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 83
[0m09:43:03.785881 [debug] [Thread-4 (]: On model.oracle_dbt.test: Close
[0m09:43:03.830773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:43:03.833324 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m09:43:03.833740 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_mobile_events094256723198 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m09:43:03.914415 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.test (execute): 09:42:56.730138 => 09:43:03.913945
[0m09:43:04.022400 [debug] [Thread-4 (]: Database Error in model test (models/staging/test.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-24263: Certificate of the remote server does not match the target address.
  ORA-06512: at "SYS.UTL_HTTP", line 380
  ORA-06512: at "SYS.UTL_HTTP", line 1209
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 83
  compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m09:43:04.024758 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbd9c53-6108-4163-bbc0-ac431a0c05e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b9e10>]}
[0m09:43:04.025471 [error] [Thread-4 (]: 4 of 11 ERROR creating python table model FAWDBTCORE.test ...................... [[31mERROR[0m in 7.36s]
[0m09:43:04.025951 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.test
[0m09:43:04.268802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:43:04.274684 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 09:42:56.704091 => 09:43:04.274495
[0m09:43:04.275219 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m09:43:04.408779 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m09:43:04.586318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbd9c53-6108-4163-bbc0-ac431a0c05e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110152ad0>]}
[0m09:43:04.588126 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model FAWDBTCORE.stg_mobile_events .......... [[32mOK[0m in 7.92s]
[0m09:43:04.588749 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m09:43:12.454746 [info ] [MainThread]: oracle adapter: Cancelling query 'model.oracle_dbt.stg_web_events' 
[0m09:43:12.641110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:12.641836 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m09:43:12.642119 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m09:43:12.642451 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was left open.
[0m09:43:12.643232 [debug] [MainThread]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m09:43:25.325568 [debug] [Thread-3 (]: SQL status: OK in 23.0 seconds
[0m09:43:45.393009 [debug] [MainThread]: On model.oracle_dbt.stg_web_events: Close
[0m09:43:45.543005 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m09:43:45.545114 [info ] [MainThread]: 
[0m09:43:45.545809 [info ] [MainThread]: Finished running 1 view model, 1 table model, 1 incremental model in 0 hours 0 minutes and 55.81 seconds (55.81s).
[0m09:43:45.548536 [info ] [Thread-3 (]: oracle adapter: Rolling back transaction.
[0m09:43:45.549100 [error] [MainThread]: Encountered an error:

[0m09:43:45.549633 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 09:42:56.747887 => 09:43:45.549470
[0m09:43:45.606023 [debug] [Thread-3 (]: Runtime Error in model stg_web_events (models/staging/stg_web_events.sql)
  connection never acquired for thread {self.thread_id}, have {self.known}
[0m09:43:45.606911 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbd9c53-6108-4163-bbc0-ac431a0c05e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110128b10>]}
[0m09:43:45.607612 [error] [Thread-3 (]: 3 of 11 ERROR creating sql incremental model FAWDBTCORE.stg_web_events ......... [[31mERROR[0m in 48.94s]
[0m09:43:45.608475 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m09:43:45.655054 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 350, in execute_nodes
    self.run_queue(pool)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 258, in run_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/queue.py", line 171, in get
    self.not_empty.wait()
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/main.py", line 565, in run
    results = task.run()
              ^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 441, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 404, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 358, in execute_nodes
    self._cancel_connections(pool)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 323, in _cancel_connections
    for conn_name in adapter.cancel_open_connections():
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1099, in cancel_open_connections
    return self.connections.cancel_open()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 43, in cancel_open
    self.cancel(connection)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/oracle/connections.py", line 241, in cancel
    oracledb.Connection.close(oracle_connection)
  File "/opt/homebrew/lib/python3.11/site-packages/oracledb/connection.py", line 309, in close
    self._impl.close()
  File "src/oracledb/impl/thin/connection.pyx", line 303, in oracledb.thin_impl.ThinConnImpl.close
  File "src/oracledb/impl/thin/protocol.pyx", line 86, in oracledb.thin_impl.Protocol._close
KeyboardInterrupt

[0m09:43:45.656264 [debug] [MainThread]: Command `dbt run` failed at 09:43:45.656155 after 57.88 seconds
[0m09:43:45.656671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c17cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103028d0>]}
[0m09:43:45.657035 [debug] [MainThread]: Flushing usage events
[0m09:44:02.627399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a17b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a17f90>]}


============================== 09:44:02.630193 | c0b729db-e41a-4ff7-96dd-78851b3dd038 ==============================
[0m09:44:02.630193 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:44:02.630515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:44:02.702838 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m09:44:02.726018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0b729db-e41a-4ff7-96dd-78851b3dd038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a17e10>]}
[0m09:44:02.732273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0b729db-e41a-4ff7-96dd-78851b3dd038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112cd290>]}
[0m09:44:02.766903 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:44:02.810848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:44:02.811157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:44:02.814759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0b729db-e41a-4ff7-96dd-78851b3dd038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a43090>]}
[0m09:44:02.820776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0b729db-e41a-4ff7-96dd-78851b3dd038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112addd0>]}
[0m09:44:02.821092 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:44:02.821267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b729db-e41a-4ff7-96dd-78851b3dd038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112ac910>]}
[0m09:44:02.821966 [info ] [MainThread]: 
[0m09:44:02.822350 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m09:44:02.822958 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m09:44:02.828644 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m09:44:02.828987 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m09:44:02.829168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:02.829349 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:44:05.175388 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m09:44:05.317819 [debug] [ThreadPool]: On list_None: Close
[0m09:44:05.452635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m09:44:05.458591 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m09:44:05.459028 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m09:44:05.459313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:05.459605 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:44:07.276778 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m09:44:07.285794 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m09:44:07.286306 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m09:44:07.875370 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m09:44:08.002369 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m09:44:08.106119 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m09:44:08.235533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b729db-e41a-4ff7-96dd-78851b3dd038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a2b650>]}
[0m09:44:08.236379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:08.237228 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:44:09.941227 [debug] [MainThread]: On master: COMMIT
[0m09:44:09.942081 [debug] [MainThread]: Using oracle connection "master"
[0m09:44:09.942398 [debug] [MainThread]: On master: COMMIT
[0m09:44:10.042583 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:44:10.044971 [debug] [MainThread]: On master: Close
[0m09:44:10.160653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:44:10.161385 [info ] [MainThread]: 
[0m09:44:10.167953 [debug] [Thread-1 (]: Began running node model.oracle_dbt.test
[0m09:44:10.168565 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.test ................................ [RUN]
[0m09:44:10.169267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.test)
[0m09:44:10.169612 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.test
[0m09:44:10.192543 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m09:44:10.193864 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (compile): 09:44:10.169846 => 09:44:10.193727
[0m09:44:10.194166 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.test
[0m09:44:10.204558 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m09:44:10.204984 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m09:44:10.215992 [info ] [Thread-1 (]: Python model materialization is table
[0m09:44:10.216451 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m09:44:12.478853 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.test"
[0m09:44:12.479656 [debug] [Thread-1 (]: On model.oracle_dbt.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.test"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNjk0NTEsImlhdCI6MTY4NzM2NTg1MX0.frWHXPg_ZBpQlcI3xQYcrZjuXo3o2rCfNGyBRnbY6HitZ1QUdbTuuuao_Y8b1AyY5p_J2KtlXi53_Uvb9U9UAQK17nT1Dh1uFSKCzLhOPl9_77xuifOtmqn1ifPmd7tZ-STM7kChIz-b7mYpEiADjd27KjLr9bGfdWlgywaJ9eYwPo2TE-MA4RXhd7xzCo-VBFfaH94yy2qGrRxAg4-n6EHJXrb_g1C3Ye-sSdX7JboYUkTKesmkXsVlOMOLSz3YQ-QcaDsQh6GOWP3MHaRlE7G7N26JlRwtLck3pGY-na6L2ir4UxR6fRdxuTbfs1YGz3Cr8aD2t9Us7fxx26Cigw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('test_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "test"
        def __repr__(self):
            return "FAWDBTCORE.test"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_test_tmp_164412 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''test_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_test_tmp_164412';
                   sys.pyqScriptDrop('test_dbt_py_script');
                END;
        
[0m09:44:12.480299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:12.480585 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:44:15.020073 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-24263: Certificate of the remote server does not match the target address.
ORA-06512: at "SYS.UTL_HTTP", line 380
ORA-06512: at "SYS.UTL_HTTP", line 1209
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 83
[0m09:44:15.024168 [debug] [Thread-1 (]: On model.oracle_dbt.test: Close
[0m09:44:15.147135 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (execute): 09:44:10.194430 => 09:44:15.144615
[0m09:44:15.155969 [debug] [Thread-1 (]: Database Error in model test (models/staging/test.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-24263: Certificate of the remote server does not match the target address.
  ORA-06512: at "SYS.UTL_HTTP", line 380
  ORA-06512: at "SYS.UTL_HTTP", line 1209
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 83
  compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m09:44:15.157559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0b729db-e41a-4ff7-96dd-78851b3dd038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ee250>]}
[0m09:44:15.158029 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.test ....................... [[31mERROR[0m in 4.99s]
[0m09:44:15.158346 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.test
[0m09:44:15.159459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:15.159760 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:44:16.637682 [debug] [MainThread]: On master: COMMIT
[0m09:44:16.639322 [debug] [MainThread]: Using oracle connection "master"
[0m09:44:16.639961 [debug] [MainThread]: On master: COMMIT
[0m09:44:16.786998 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:44:16.789221 [debug] [MainThread]: On master: Close
[0m09:44:16.920999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:16.921570 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m09:44:16.921818 [info ] [MainThread]: 
[0m09:44:16.922118 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.10 seconds (14.10s).
[0m09:44:16.922609 [debug] [MainThread]: Command end result
[0m09:44:17.014312 [info ] [MainThread]: 
[0m09:44:17.016239 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:44:17.016739 [info ] [MainThread]: 
[0m09:44:17.016938 [error] [MainThread]: [33mDatabase Error in model test (models/staging/test.py)[0m
[0m09:44:17.017101 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m09:44:17.017248 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m09:44:17.017384 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m09:44:17.017513 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m09:44:17.017639 [error] [MainThread]:   ORA-24263: Certificate of the remote server does not match the target address.
[0m09:44:17.017769 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 380
[0m09:44:17.017898 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1209
[0m09:44:17.018024 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 97
[0m09:44:17.018149 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m09:44:17.018275 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m09:44:17.018399 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m09:44:17.018522 [error] [MainThread]:   ORA-06512: at line 83
[0m09:44:17.018646 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m09:44:17.018786 [info ] [MainThread]: 
[0m09:44:17.018960 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:44:17.019451 [debug] [MainThread]: Command `dbt run` failed at 09:44:17.019376 after 14.41 seconds
[0m09:44:17.019769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f4ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111241510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110312b10>]}
[0m09:44:17.020061 [debug] [MainThread]: Flushing usage events
[0m10:23:21.204522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c17610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c17690>]}


============================== 10:23:21.208835 | 0d5928ff-73be-4caf-8d46-3defbcae11a5 ==============================
[0m10:23:21.208835 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:23:21.209227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:23:21.314918 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:23:21.347933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d5928ff-73be-4caf-8d46-3defbcae11a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c45810>]}
[0m10:23:21.353928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d5928ff-73be-4caf-8d46-3defbcae11a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109329690>]}
[0m10:23:21.403487 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:23:21.496692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:23:21.497010 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:23:21.500520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d5928ff-73be-4caf-8d46-3defbcae11a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879a590>]}
[0m10:23:21.506943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d5928ff-73be-4caf-8d46-3defbcae11a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932bc90>]}
[0m10:23:21.507257 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:23:21.507442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d5928ff-73be-4caf-8d46-3defbcae11a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a7f90>]}
[0m10:23:21.508208 [info ] [MainThread]: 
[0m10:23:21.508781 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:23:21.509446 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:23:21.514503 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:23:21.514721 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:23:21.514885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:21.515061 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:23:23.165693 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:23:23.267144 [debug] [ThreadPool]: On list_None: Close
[0m10:23:23.393813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:23:23.399841 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:23:23.400306 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:23:23.400598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:23.400882 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:23:24.991080 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:23:25.000797 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:23:25.001552 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:23:25.141025 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:23:25.408853 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:23:25.550697 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:23:25.693377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d5928ff-73be-4caf-8d46-3defbcae11a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109361a10>]}
[0m10:23:25.694477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:23:25.695036 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:23:27.267072 [debug] [MainThread]: On master: COMMIT
[0m10:23:27.268714 [debug] [MainThread]: Using oracle connection "master"
[0m10:23:27.269226 [debug] [MainThread]: On master: COMMIT
[0m10:23:27.370015 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:23:27.372953 [debug] [MainThread]: On master: Close
[0m10:23:27.482249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:23:27.483249 [info ] [MainThread]: 
[0m10:23:27.503210 [debug] [Thread-1 (]: Began running node model.oracle_dbt.test
[0m10:23:27.504141 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.test ................................ [RUN]
[0m10:23:27.505227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.test)
[0m10:23:27.505726 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.test
[0m10:23:27.529310 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m10:23:27.532803 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (compile): 10:23:27.506007 => 10:23:27.532585
[0m10:23:27.533204 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.test
[0m10:23:27.543424 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:23:27.543820 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:23:27.553785 [info ] [Thread-1 (]: Python model materialization is table
[0m10:23:27.554111 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m10:23:31.173731 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.test"
[0m10:23:31.175341 [debug] [Thread-1 (]: On model.oracle_dbt.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.test"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzE4MTAsImlhdCI6MTY4NzM2ODIxMH0.gOU2yhd45J6QayLXPpAbKv23brw7lzXqYGwxvfWclFebUxLe9aO7GcbockHl9uyIr0t-mOE5VEQViq9MYmDVIQS_WcWcKY0rsVbOOxKjC51vn37fyEA3nWUKZoqsEDu7_p6M_m0Mn3YDdsQY_d0Bmru1CYbU0-_h5ejXGeOZYfWzpnabHIMXS_6vJ9i_DuI5AP3Oq1fYHBhio-9MrWEYVquxeHAyXk2hWVbqErwB5ZDV5RcsVUjlAbTCQ7Av9HirCcaA6v_55NuVD3MVach7eHKERYQ3WJOcb2rqcWXTdZ9PTmzuiqWXX_uWS4jmbrjLBwPHx_ZGp7do2dDmVLCk6Q!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('test_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "test"
        def __repr__(self):
            return "FAWDBTCORE.test"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_test_tmp_172331 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''test_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_test_tmp_172331';
                   sys.pyqScriptDrop('test_dbt_py_script');
                END;
        
[0m10:23:31.177255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:31.177843 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:24:33.153151 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 83
[0m10:24:33.159704 [debug] [Thread-1 (]: On model.oracle_dbt.test: Close
[0m10:24:33.272174 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (execute): 10:23:27.533401 => 10:24:33.271736
[0m10:24:33.291871 [debug] [Thread-1 (]: Database Error in model test (models/staging/test.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 83
  compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m10:24:33.294215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d5928ff-73be-4caf-8d46-3defbcae11a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094d3610>]}
[0m10:24:33.294882 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.test ....................... [[31mERROR[0m in 65.79s]
[0m10:24:33.295381 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.test
[0m10:24:33.296894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:24:33.297373 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:24:34.889394 [debug] [MainThread]: On master: COMMIT
[0m10:24:34.891629 [debug] [MainThread]: Using oracle connection "master"
[0m10:24:34.892177 [debug] [MainThread]: On master: COMMIT
[0m10:24:35.004246 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:24:35.006106 [debug] [MainThread]: On master: Close
[0m10:24:35.130540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:35.131543 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m10:24:35.131862 [info ] [MainThread]: 
[0m10:24:35.132107 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 13.62 seconds (73.62s).
[0m10:24:35.132514 [debug] [MainThread]: Command end result
[0m10:24:35.142182 [info ] [MainThread]: 
[0m10:24:35.142839 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:24:35.143115 [info ] [MainThread]: 
[0m10:24:35.143378 [error] [MainThread]: [33mDatabase Error in model test (models/staging/test.py)[0m
[0m10:24:35.143628 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m10:24:35.143863 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m10:24:35.144092 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m10:24:35.144309 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m10:24:35.144526 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m10:24:35.144773 [error] [MainThread]:   ORA-29276: transfer timeout
[0m10:24:35.145022 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m10:24:35.145265 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m10:24:35.145511 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m10:24:35.145752 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m10:24:35.145995 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m10:24:35.146235 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m10:24:35.146477 [error] [MainThread]:   ORA-06512: at line 83
[0m10:24:35.146727 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m10:24:35.146983 [info ] [MainThread]: 
[0m10:24:35.147289 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:24:35.147885 [debug] [MainThread]: Command `dbt run` failed at 10:24:35.147789 after 74.00 seconds
[0m10:24:35.148319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105126c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105124e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f3590>]}
[0m10:24:35.148764 [debug] [MainThread]: Flushing usage events
[0m10:24:47.393890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f2c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111617cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111617f90>]}


============================== 10:24:47.403053 | bee30d9a-9ef0-4579-a702-b732d7718454 ==============================
[0m10:24:47.403053 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:24:47.403438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:24:47.504265 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:24:47.536407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bee30d9a-9ef0-4579-a702-b732d7718454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111628950>]}
[0m10:24:47.542943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bee30d9a-9ef0-4579-a702-b732d7718454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eccd10>]}
[0m10:24:47.586150 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:24:47.690713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:47.691041 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:47.694991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bee30d9a-9ef0-4579-a702-b732d7718454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f95c90>]}
[0m10:24:47.706123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bee30d9a-9ef0-4579-a702-b732d7718454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f0c410>]}
[0m10:24:47.706485 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:24:47.706686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bee30d9a-9ef0-4579-a702-b732d7718454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10468be90>]}
[0m10:24:47.707514 [info ] [MainThread]: 
[0m10:24:47.708020 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:24:47.708608 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:24:47.713956 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:24:47.714262 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:24:47.714456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:47.714647 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:24:49.284220 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:24:49.403960 [debug] [ThreadPool]: On list_None: Close
[0m10:24:49.548671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:24:49.552890 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:24:49.553256 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:24:49.553469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:49.553679 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:24:50.962586 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:24:50.974806 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:24:50.975612 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:24:51.113159 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:24:51.455505 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:24:51.566665 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:24:51.683848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bee30d9a-9ef0-4579-a702-b732d7718454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111609b10>]}
[0m10:24:51.685028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:24:51.685598 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:24:53.274389 [debug] [MainThread]: On master: COMMIT
[0m10:24:53.282737 [debug] [MainThread]: Using oracle connection "master"
[0m10:24:53.283653 [debug] [MainThread]: On master: COMMIT
[0m10:24:53.407470 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:24:53.409253 [debug] [MainThread]: On master: Close
[0m10:24:53.554819 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:24:53.555703 [info ] [MainThread]: 
[0m10:24:53.567257 [debug] [Thread-1 (]: Began running node model.oracle_dbt.test
[0m10:24:53.568161 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.test ................................ [RUN]
[0m10:24:53.569087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.test)
[0m10:24:53.569535 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.test
[0m10:24:53.595003 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m10:24:53.604097 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (compile): 10:24:53.569849 => 10:24:53.603865
[0m10:24:53.604497 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.test
[0m10:24:53.615273 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:24:53.615658 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:24:53.626144 [info ] [Thread-1 (]: Python model materialization is table
[0m10:24:53.626550 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m10:24:56.307668 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.test"
[0m10:24:56.309077 [debug] [Thread-1 (]: On model.oracle_dbt.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.test"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzE4OTUsImlhdCI6MTY4NzM2ODI5NX0.aKRoRArKEOeHGkoHKw5qX30YcjKonHlY4dgBA_TqEseNgH3bQE2sM5MYNyw8hyuYtqVRR58ibLyyaVWtGI7aE28e7FH84tsaFI88eH1GTNvNmHUi5tP3GMKHY5lGhRL5VHKjgf23gV2Wh2veaWonstb7KkUyoHXWaOibAordNqKC-wUm5kxQWurqpOt2A3vcuQbD4PbOA9f7Yd5B17vZ128rjKGZKFwU-suIbuLjymzi_pqHqm7ajOr5jq-T3OIWTMWxnjYyvdMjR4GWY3tht8TKTUK9OSjtRWRLI9ElwhECyhzTCnEiz2Cf_rTuI8O6XxbgJW-0nnR80xzKoeH0rw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('test_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "test"
        def __repr__(self):
            return "FAWDBTCORE.test"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_test_tmp_172456 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''test_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_test_tmp_172456';
                   sys.pyqScriptDrop('test_dbt_py_script');
                END;
        
[0m10:24:56.310512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:56.311616 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:24:58.849372 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: HTTP response status code 500, 'errorMessage' check http doc for error code
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 198
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 83
[0m10:24:58.851176 [debug] [Thread-1 (]: On model.oracle_dbt.test: Close
[0m10:24:58.989376 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (execute): 10:24:53.604702 => 10:24:58.988019
[0m10:24:59.035503 [debug] [Thread-1 (]: Database Error in model test (models/staging/test.py)
  ORA-20100: HTTP response status code 500, 'errorMessage' check http doc for error code
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 198
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 83
  compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m10:24:59.038515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bee30d9a-9ef0-4579-a702-b732d7718454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11213e290>]}
[0m10:24:59.039476 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.test ....................... [[31mERROR[0m in 5.47s]
[0m10:24:59.040094 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.test
[0m10:24:59.042198 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:24:59.042752 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:25:00.626529 [debug] [MainThread]: On master: COMMIT
[0m10:25:00.628602 [debug] [MainThread]: Using oracle connection "master"
[0m10:25:00.629900 [debug] [MainThread]: On master: COMMIT
[0m10:25:00.760553 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:25:00.762386 [debug] [MainThread]: On master: Close
[0m10:25:00.923253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:00.924276 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m10:25:00.924985 [info ] [MainThread]: 
[0m10:25:00.925764 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.22 seconds (13.22s).
[0m10:25:00.926464 [debug] [MainThread]: Command end result
[0m10:25:00.970125 [info ] [MainThread]: 
[0m10:25:00.970896 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:25:00.971228 [info ] [MainThread]: 
[0m10:25:00.971615 [error] [MainThread]: [33mDatabase Error in model test (models/staging/test.py)[0m
[0m10:25:00.971929 [error] [MainThread]:   ORA-20100: HTTP response status code 500, 'errorMessage' check http doc for error code
[0m10:25:00.972213 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m10:25:00.972488 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 198
[0m10:25:00.972759 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m10:25:00.973022 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m10:25:00.973285 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m10:25:00.973671 [error] [MainThread]:   ORA-06512: at line 83
[0m10:25:00.974219 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m10:25:00.974773 [info ] [MainThread]: 
[0m10:25:00.975121 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:25:00.975749 [debug] [MainThread]: Command `dbt run` failed at 10:25:00.975648 after 13.62 seconds
[0m10:25:00.976188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104698e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116b1490>]}
[0m10:25:00.976554 [debug] [MainThread]: Flushing usage events
[0m10:25:45.571028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107808790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107808450>]}


============================== 10:25:45.574567 | 02a0ac1f-8453-45bd-993c-39defd36abdb ==============================
[0m10:25:45.574567 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:25:45.575017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:25:45.575404 [info ] [MainThread]: dbt version: 1.5.1
[0m10:25:45.575639 [info ] [MainThread]: python version: 3.11.3
[0m10:25:45.575863 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m10:25:45.576052 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m10:25:45.576233 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/Desktop/oracle-dbt/profiles.yml
[0m10:25:45.576419 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m10:25:45.576582 [info ] [MainThread]: Configuration:
[0m10:25:45.681370 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:25:45.709787 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:25:45.719597 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:25:45.719934 [info ] [MainThread]: Required dependencies:
[0m10:25:45.720200 [debug] [MainThread]: Executing "git --help"
[0m10:25:45.731848 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:25:45.732471 [debug] [MainThread]: STDERR: "b''"
[0m10:25:45.732650 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:25:45.732838 [info ] [MainThread]: Connection:
[0m10:25:45.733030 [info ] [MainThread]:   user: fawdbtcore
[0m10:25:45.733177 [info ] [MainThread]:   database: None
[0m10:25:45.733316 [info ] [MainThread]:   schema: FAWDBTCORE
[0m10:25:45.733451 [info ] [MainThread]:   protocol: None
[0m10:25:45.733585 [info ] [MainThread]:   host: None
[0m10:25:45.733719 [info ] [MainThread]:   port: None
[0m10:25:45.733850 [info ] [MainThread]:   tns_name: cfg57adw_low
[0m10:25:45.733982 [info ] [MainThread]:   service: None
[0m10:25:45.734110 [info ] [MainThread]:   connection_string: None
[0m10:25:45.734241 [info ] [MainThread]:   shardingkey: []
[0m10:25:45.734369 [info ] [MainThread]:   supershardingkey: []
[0m10:25:45.734491 [info ] [MainThread]:   cclass: None
[0m10:25:45.734617 [info ] [MainThread]:   purity: None
[0m10:25:45.734739 [info ] [MainThread]:   retry_count: 1
[0m10:25:45.734864 [info ] [MainThread]:   retry_delay: 3
[0m10:25:45.734989 [info ] [MainThread]:   oml_auth_token_uri: https://tv1lg8pdut4n8vc-cfg57adw.adb.us-ashburn-1.oraclecloudapps.com/omlusers/api/oauth2/v1/token
[0m10:25:45.741565 [debug] [MainThread]: Acquiring new oracle connection 'debug'
[0m10:25:45.742225 [debug] [MainThread]: Using oracle connection "debug"
[0m10:25:45.742361 [debug] [MainThread]: On debug: select 1 as id from dual
[0m10:25:45.742536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:45.742711 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:25:47.868203 [debug] [MainThread]: SQL status: OK in 2.0 seconds
[0m10:25:47.869466 [debug] [MainThread]: On debug: Close
[0m10:25:47.984093 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:25:47.985147 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:25:47.985837 [debug] [MainThread]: Command `dbt debug` succeeded at 10:25:47.985739 after 2.47 seconds
[0m10:25:47.986141 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:25:47.986414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102868d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10251e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f7a90>]}
[0m10:25:47.986766 [debug] [MainThread]: Flushing usage events
[0m10:26:17.813684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11240b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112417910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112417f50>]}


============================== 10:26:17.822596 | e3967037-c4ef-423b-b40d-2916b992a4f8 ==============================
[0m10:26:17.822596 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:26:17.823027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:26:17.823422 [info ] [MainThread]: dbt version: 1.5.1
[0m10:26:17.823658 [info ] [MainThread]: python version: 3.11.3
[0m10:26:17.823875 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m10:26:17.824060 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m10:26:17.824242 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/Desktop/oracle-dbt/profiles.yml
[0m10:26:17.824412 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m10:26:17.824566 [info ] [MainThread]: Configuration:
[0m10:26:17.932821 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:26:17.959361 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:26:17.968621 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:26:17.968966 [info ] [MainThread]: Required dependencies:
[0m10:26:17.969218 [debug] [MainThread]: Executing "git --help"
[0m10:26:17.977108 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:26:17.977765 [debug] [MainThread]: STDERR: "b''"
[0m10:26:17.978025 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:26:17.978323 [info ] [MainThread]: Connection:
[0m10:26:17.978524 [info ] [MainThread]:   user: fawdbtcore
[0m10:26:17.978669 [info ] [MainThread]:   database: None
[0m10:26:17.978799 [info ] [MainThread]:   schema: FAWDBTCORE
[0m10:26:17.978926 [info ] [MainThread]:   protocol: None
[0m10:26:17.979056 [info ] [MainThread]:   host: None
[0m10:26:17.979177 [info ] [MainThread]:   port: None
[0m10:26:17.979297 [info ] [MainThread]:   tns_name: cfg57adw_medium
[0m10:26:17.979416 [info ] [MainThread]:   service: None
[0m10:26:17.979537 [info ] [MainThread]:   connection_string: None
[0m10:26:17.979660 [info ] [MainThread]:   shardingkey: []
[0m10:26:17.979781 [info ] [MainThread]:   supershardingkey: []
[0m10:26:17.979905 [info ] [MainThread]:   cclass: None
[0m10:26:17.980027 [info ] [MainThread]:   purity: None
[0m10:26:17.980151 [info ] [MainThread]:   retry_count: 1
[0m10:26:17.980272 [info ] [MainThread]:   retry_delay: 3
[0m10:26:17.980397 [info ] [MainThread]:   oml_auth_token_uri: https://tv1lg8pdut4n8vc-cfg57adw.adb.us-ashburn-1.oraclecloudapps.com/omlusers/api/oauth2/v1/token
[0m10:26:17.985595 [debug] [MainThread]: Acquiring new oracle connection 'debug'
[0m10:26:17.986286 [debug] [MainThread]: Using oracle connection "debug"
[0m10:26:17.986433 [debug] [MainThread]: On debug: select 1 as id from dual
[0m10:26:17.986594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:17.986732 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:26:21.234317 [debug] [MainThread]: SQL status: OK in 3.0 seconds
[0m10:26:21.239413 [debug] [MainThread]: On debug: Close
[0m10:26:21.467913 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:26:21.469894 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:26:21.471985 [debug] [MainThread]: Command `dbt debug` succeeded at 10:26:21.471677 after 3.69 seconds
[0m10:26:21.472930 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:26:21.473487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b96790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123f7910>]}
[0m10:26:21.474056 [debug] [MainThread]: Flushing usage events
[0m10:26:27.750488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109417ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109417f90>]}


============================== 10:26:27.753203 | 885a62b5-b29c-49df-81be-5ddd5492cab7 ==============================
[0m10:26:27.753203 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:26:27.753588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:26:27.887967 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:26:27.920489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '885a62b5-b29c-49df-81be-5ddd5492cab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947e290>]}
[0m10:26:27.927246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '885a62b5-b29c-49df-81be-5ddd5492cab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109448790>]}
[0m10:26:27.979202 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:26:27.985204 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m10:26:27.985484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '885a62b5-b29c-49df-81be-5ddd5492cab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109417ed0>]}
[0m10:26:28.422371 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m10:26:28.429056 [debug] [MainThread]: 1603: static parser failed on combined_categorized_events.sql
[0m10:26:28.433652 [debug] [MainThread]: 1602: parser fallback to jinja rendering on combined_categorized_events.sql
[0m10:26:28.434684 [debug] [MainThread]: 1699: static parser successfully parsed event_counts_by_platform.sql
[0m10:26:28.436534 [debug] [MainThread]: 1699: static parser successfully parsed average_duration_by_platform_country.sql
[0m10:26:28.440348 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m10:26:28.442361 [debug] [MainThread]: 1699: static parser successfully parsed most_frequent_browser.sql
[0m10:26:28.444427 [debug] [MainThread]: 1699: static parser successfully parsed most_active_mobile_users.sql
[0m10:26:28.446462 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
[0m10:26:28.448177 [debug] [MainThread]: 1603: static parser failed on staging/stg_web_events.sql
[0m10:26:28.450788 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_web_events.sql
[0m10:26:28.451769 [debug] [MainThread]: 1603: static parser failed on staging/stg_mobile_events.sql
[0m10:26:28.454071 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_mobile_events.sql
[0m10:26:28.490909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '885a62b5-b29c-49df-81be-5ddd5492cab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c3e010>]}
[0m10:26:28.504120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '885a62b5-b29c-49df-81be-5ddd5492cab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c1df50>]}
[0m10:26:28.504472 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:26:28.504648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '885a62b5-b29c-49df-81be-5ddd5492cab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c45210>]}
[0m10:26:28.505398 [info ] [MainThread]: 
[0m10:26:28.505781 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:26:28.506333 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:26:28.511377 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:26:28.511634 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:26:28.511806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:28.511975 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:26:31.203903 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:26:31.362325 [debug] [ThreadPool]: On list_None: Close
[0m10:26:31.511625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:26:31.520394 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:26:31.521385 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:26:31.521912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:31.522340 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:26:33.436704 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:26:33.449076 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:26:33.449853 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:26:33.618157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:26:33.857448 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:26:33.991634 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:26:34.133833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '885a62b5-b29c-49df-81be-5ddd5492cab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c10490>]}
[0m10:26:34.134877 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:34.135366 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:26:35.648288 [debug] [MainThread]: On master: COMMIT
[0m10:26:35.650053 [debug] [MainThread]: Using oracle connection "master"
[0m10:26:35.650754 [debug] [MainThread]: On master: COMMIT
[0m10:26:35.799213 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:26:35.801545 [debug] [MainThread]: On master: Close
[0m10:26:35.944621 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:26:35.945530 [info ] [MainThread]: 
[0m10:26:35.952538 [debug] [Thread-1 (]: Began running node model.oracle_dbt.test
[0m10:26:35.953671 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.test ................................ [RUN]
[0m10:26:35.954630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.test)
[0m10:26:35.955099 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.test
[0m10:26:35.972108 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.test"
[0m10:26:35.974651 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (compile): 10:26:35.955428 => 10:26:35.974350
[0m10:26:35.975183 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.test
[0m10:26:35.986314 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:26:35.986744 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:26:35.997861 [info ] [Thread-1 (]: Python model materialization is table
[0m10:26:35.998278 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.test"
[0m10:26:38.255763 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.test"
[0m10:26:38.257125 [debug] [Thread-1 (]: On model.oracle_dbt.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.test"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzE5OTcsImlhdCI6MTY4NzM2ODM5N30.cUWrzLBTyqsO7JMq905107ebh5KayDE004GqMVcDEFsjK13sugxWoY1SaxrzSIWSxLzAAHpK08-GsbRVW8hlLhqizswPmjC19mBq9JeykitglasD1Bv6gIq6qRoN7XoJRhRqVGp9gonyRSb6VccvnV_2RjHpBon5iNyFLKYJW_AVLcC0d_heId58JOrajKUqI3_wO2_nyD4slmVMAmcDaEOwkBpiQRRzq2Ef7vITmOk-NmtTQTgKGUhhFjaE32gIKemVZfQNm-2NN6Xvy0YGLxjwFnHDGGTUjD3Qn0QyB-nxfbCTanNrCrMklilZJWhApETo7gmXSgFM4hh-ideeSQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('test_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "test"
        def __repr__(self):
            return "FAWDBTCORE.test"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_test_tmp_172638 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''test_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_test_tmp_172638';
                   sys.pyqScriptDrop('test_dbt_py_script');
                END;
        
[0m10:26:38.258548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:38.259206 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:27:04.073168 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"ORA-00955: name is already used by an existing object : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 77, in main\n   File \"<string>\", line 68, in materialize\n   File \"oml/core/vector.py\", line 458, in oml.core.vector._Vector.materialize\n   File \"oml/core/vector.py\", line 580, in oml.core.vector._Vector.__create_from_select\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 83
[0m10:27:04.077204 [debug] [Thread-1 (]: On model.oracle_dbt.test: Close
[0m10:27:04.204490 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.test (execute): 10:26:35.975453 => 10:27:04.203368
[0m10:27:04.257136 [debug] [Thread-1 (]: Database Error in model test (models/staging/test.py)
  ORA-20100: {"Unexpected Script Execution Error":"ORA-00955: name is already used by an existing object : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 77, in main\n   File \"<string>\", line 68, in materialize\n   File \"oml/core/vector.py\", line 458, in oml.core.vector._Vector.materialize\n   File \"oml/core/vector.py\", line 580, in oml.core.vector._Vector.__create_from_select\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 83
  compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m10:27:04.260444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885a62b5-b29c-49df-81be-5ddd5492cab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0cf710>]}
[0m10:27:04.261552 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.test ....................... [[31mERROR[0m in 28.31s]
[0m10:27:04.262206 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.test
[0m10:27:04.264301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:27:04.264760 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:27:05.918942 [debug] [MainThread]: On master: COMMIT
[0m10:27:05.921715 [debug] [MainThread]: Using oracle connection "master"
[0m10:27:05.922658 [debug] [MainThread]: On master: COMMIT
[0m10:27:06.048740 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:27:06.050881 [debug] [MainThread]: On master: Close
[0m10:27:06.169842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:06.170978 [debug] [MainThread]: Connection 'model.oracle_dbt.test' was properly closed.
[0m10:27:06.171431 [info ] [MainThread]: 
[0m10:27:06.171808 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 37.67 seconds (37.67s).
[0m10:27:06.172449 [debug] [MainThread]: Command end result
[0m10:27:06.182839 [info ] [MainThread]: 
[0m10:27:06.183439 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:27:06.183996 [info ] [MainThread]: 
[0m10:27:06.184603 [error] [MainThread]: [33mDatabase Error in model test (models/staging/test.py)[0m
[0m10:27:06.185027 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"ORA-00955: name is already used by an existing object : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 77, in main\n   File \"<string>\", line 68, in materialize\n   File \"oml/core/vector.py\", line 458, in oml.core.vector._Vector.materialize\n   File \"oml/core/vector.py\", line 580, in oml.core.vector._Vector.__create_from_select\n"}
[0m10:27:06.185431 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m10:27:06.185749 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m10:27:06.186055 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m10:27:06.186362 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m10:27:06.186658 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m10:27:06.186960 [error] [MainThread]:   ORA-06512: at line 83
[0m10:27:06.187257 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/test.py
[0m10:27:06.187560 [info ] [MainThread]: 
[0m10:27:06.187917 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:27:06.188656 [debug] [MainThread]: Command `dbt run` failed at 10:27:06.188543 after 38.47 seconds
[0m10:27:06.189196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10326ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b2a150>]}
[0m10:27:06.189630 [debug] [MainThread]: Flushing usage events
[0m10:28:48.640845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c17610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c17fd0>]}


============================== 10:28:48.644142 | 8d7c29de-f9d6-4be8-8967-6c4068b0e096 ==============================
[0m10:28:48.644142 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:28:48.644517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:28:48.779897 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:28:48.811979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d7c29de-f9d6-4be8-8967-6c4068b0e096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c96550>]}
[0m10:28:48.818620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d7c29de-f9d6-4be8-8967-6c4068b0e096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cd610>]}
[0m10:28:48.854156 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:28:48.901307 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m10:28:48.901735 [debug] [MainThread]: Partial parsing: added file: oracle_dbt://models/staging/web_events_python.py
[0m10:28:48.901914 [debug] [MainThread]: Partial parsing: deleted file: oracle_dbt://models/staging/test.py
[0m10:28:48.922982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d7c29de-f9d6-4be8-8967-6c4068b0e096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cfc10>]}
[0m10:28:48.932674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d7c29de-f9d6-4be8-8967-6c4068b0e096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c48f90>]}
[0m10:28:48.933032 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:28:48.933214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d7c29de-f9d6-4be8-8967-6c4068b0e096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fd210>]}
[0m10:28:48.933567 [warn ] [MainThread]: The selection criterion 'test' does not match any nodes
[0m10:28:48.934041 [info ] [MainThread]: 
[0m10:28:48.934200 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:28:48.934412 [debug] [MainThread]: Command end result
[0m10:28:49.092827 [debug] [MainThread]: Command `dbt run` succeeded at 10:28:49.092629 after 0.50 seconds
[0m10:28:49.093442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008429d0>]}
[0m10:28:49.094105 [debug] [MainThread]: Flushing usage events
[0m10:29:15.253462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105308e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105317fd0>]}


============================== 10:29:15.258287 | 7dac69b1-2172-4739-b630-a521b02dbfd5 ==============================
[0m10:29:15.258287 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:29:15.258664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:29:15.367050 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:29:15.391771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dac69b1-2172-4739-b630-a521b02dbfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105345710>]}
[0m10:29:15.398131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dac69b1-2172-4739-b630-a521b02dbfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a29390>]}
[0m10:29:15.450616 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:29:15.510191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:15.510498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:15.514072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dac69b1-2172-4739-b630-a521b02dbfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cea010>]}
[0m10:29:15.524378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dac69b1-2172-4739-b630-a521b02dbfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a43fd0>]}
[0m10:29:15.524825 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:29:15.525008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dac69b1-2172-4739-b630-a521b02dbfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a47cd0>]}
[0m10:29:15.525799 [info ] [MainThread]: 
[0m10:29:15.526187 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:29:15.526824 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:29:15.532109 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:29:15.532368 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:29:15.532543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:15.532714 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:29:17.388325 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:29:17.514882 [debug] [ThreadPool]: On list_None: Close
[0m10:29:17.668766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:29:17.677108 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:29:17.677736 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:29:17.678144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:17.678874 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:29:19.327806 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:29:19.339566 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:29:19.340373 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:29:19.468068 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:19.693131 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:29:19.813491 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:29:19.933436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dac69b1-2172-4739-b630-a521b02dbfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a23850>]}
[0m10:29:19.934523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:19.935091 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:29:21.296880 [debug] [MainThread]: On master: COMMIT
[0m10:29:21.302389 [debug] [MainThread]: Using oracle connection "master"
[0m10:29:21.303184 [debug] [MainThread]: On master: COMMIT
[0m10:29:21.414988 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:29:21.419936 [debug] [MainThread]: On master: Close
[0m10:29:21.534836 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:21.535991 [info ] [MainThread]: 
[0m10:29:21.548098 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:29:21.549075 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:29:21.550033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:29:21.550441 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:29:21.574295 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:29:21.575194 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:29:21.550727 => 10:29:21.575056
[0m10:29:21.575486 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:29:21.585790 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:29:21.586159 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:29:21.596840 [info ] [Thread-1 (]: Python model materialization is table
[0m10:29:21.597271 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:29:23.885584 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:29:23.887064 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzIxNjIsImlhdCI6MTY4NzM2ODU2Mn0.iXEgRObqk5FIqSSRYzULZUh5aWCmV3cOm0zNZ1p-njbepzVWQKI9y7p9HQU_0KcQeKuekpsDBSs0XqJlKtNowlk-j6fFcYx22t96EZfB_57CWuGKow7yFpC7cfiA4xrJzk3pvw_lcMyzaeGmlvDiqtQYZk6sQomRcxS9tGQf4cwmGr9PIA9Z6dEw1eUtN7pM6Nr7fxhQeozv8DZkPUqgZ_--ZnLdBOnzx8snb8pJMO9jpiv_IoBe4WZx6epLPpew4Xpw7DKFPCpi93UAia4rfvK7CGCYjlBoz9wOeTuKT_Y2E9ep1rcCyX3PcZ6-rMljpvGNDyoJ5CW3m7k3LcrMUA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_172923 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_172923';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:29:23.888497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:23.889053 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:29:26.864541 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m10:29:26.866665 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:29:27.006337 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:29:21.575675 => 10:29:27.005316
[0m10:29:27.045122 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:29:27.048889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dac69b1-2172-4739-b630-a521b02dbfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c16550>]}
[0m10:29:27.049972 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 5.50s]
[0m10:29:27.050880 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:29:27.052871 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:27.053365 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:29:28.611157 [debug] [MainThread]: On master: COMMIT
[0m10:29:28.611604 [debug] [MainThread]: Using oracle connection "master"
[0m10:29:28.611816 [debug] [MainThread]: On master: COMMIT
[0m10:29:28.744249 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:29:28.745103 [debug] [MainThread]: On master: Close
[0m10:29:28.885436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:28.886289 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:29:28.886756 [info ] [MainThread]: 
[0m10:29:28.887148 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.36 seconds (13.36s).
[0m10:29:28.887790 [debug] [MainThread]: Command end result
[0m10:29:28.904912 [info ] [MainThread]: 
[0m10:29:28.905619 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:29:28.905948 [info ] [MainThread]: 
[0m10:29:28.906266 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:29:28.906577 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m10:29:28.906852 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:29:28.907130 [info ] [MainThread]: 
[0m10:29:28.907445 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:29:28.908225 [debug] [MainThread]: Command `dbt run` failed at 10:29:28.908091 after 13.70 seconds
[0m10:29:28.908804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d10e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d10e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca9190>]}
[0m10:29:28.909245 [debug] [MainThread]: Flushing usage events
[0m10:29:56.065979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f3fd0>]}


============================== 10:29:56.070067 | 0426d0dd-3939-4a4c-bbf8-bcca0cdbe50d ==============================
[0m10:29:56.070067 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:29:56.070484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:29:56.166775 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:29:56.195153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0426d0dd-3939-4a4c-bbf8-bcca0cdbe50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f3d10>]}
[0m10:29:56.201670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0426d0dd-3939-4a4c-bbf8-bcca0cdbe50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084273d0>]}
[0m10:29:56.250064 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:29:56.306680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:56.306995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:56.310506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0426d0dd-3939-4a4c-bbf8-bcca0cdbe50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e4c90>]}
[0m10:29:56.319254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0426d0dd-3939-4a4c-bbf8-bcca0cdbe50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a7550>]}
[0m10:29:56.319606 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:29:56.319784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0426d0dd-3939-4a4c-bbf8-bcca0cdbe50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a6790>]}
[0m10:29:56.320490 [info ] [MainThread]: 
[0m10:29:56.320879 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:29:56.321417 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:29:56.326368 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:29:56.326586 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:29:56.326756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:56.326931 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:29:58.013651 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:29:58.125833 [debug] [ThreadPool]: On list_None: Close
[0m10:29:58.234305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:29:58.241841 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:29:58.242422 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:29:58.242815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:58.243214 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:29:59.705134 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:29:59.717438 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:29:59.718273 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:29:59.854272 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:30:00.060741 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:30:00.166446 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:30:00.281363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0426d0dd-3939-4a4c-bbf8-bcca0cdbe50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae8490>]}
[0m10:30:00.282314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:00.282776 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:30:01.597550 [debug] [MainThread]: On master: COMMIT
[0m10:30:01.599071 [debug] [MainThread]: Using oracle connection "master"
[0m10:30:01.599597 [debug] [MainThread]: On master: COMMIT
[0m10:30:01.715233 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:30:01.717166 [debug] [MainThread]: On master: Close
[0m10:30:01.828503 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:30:01.829363 [info ] [MainThread]: 
[0m10:30:01.842492 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:30:01.843333 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:30:01.844238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:30:01.844673 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:30:01.868194 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:30:01.878204 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:30:01.844966 => 10:30:01.878008
[0m10:30:01.878556 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:30:01.889248 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:30:01.889667 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:30:01.900749 [info ] [Thread-1 (]: Python model materialization is table
[0m10:30:01.901175 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:30:04.347830 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:30:04.349030 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzIyMDMsImlhdCI6MTY4NzM2ODYwM30.jpJv7S63B0ga1eYQJyBFpi9btg-eUUekMdteHAR0rPJrNz6re3AHJkVwVeDVBRavhlq48LF5ggRxLEl42iBjXMntCJp5x64foOf-_u9cWHZr-6GhAk4XHy6G-odc6CfCyEo4hySbN4zftV8AnlIE5IeimXjd0yGiTgtOrZ8B29I2W_h03fKqsM7Pu641Rof_0d5iatSSbXDw2SZ4rGva-V5_9l_BHM0kjetTpl9B88sWJzIymLhR_9zQqc_BrDGWF0JJzqT8q9e6pqyCwEsXsEXa1EZ5GuPARKuHLnhhCaYkuuHmS5nar2AOZp58ZGxNjmKaqAI9qz8cqDo-0Y-Fsg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173004 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173004';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:30:04.350575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:04.351173 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:31:06.220321 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 83
[0m10:31:06.222497 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:31:06.352384 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:30:01.878763 => 10:31:06.351262
[0m10:31:06.365278 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 83
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:31:06.367700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0426d0dd-3939-4a4c-bbf8-bcca0cdbe50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108babe10>]}
[0m10:31:06.368668 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 64.52s]
[0m10:31:06.369309 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:31:06.370957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:31:06.371417 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:31:07.819352 [debug] [MainThread]: On master: COMMIT
[0m10:31:07.821035 [debug] [MainThread]: Using oracle connection "master"
[0m10:31:07.821557 [debug] [MainThread]: On master: COMMIT
[0m10:31:07.923202 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:31:07.923866 [debug] [MainThread]: On master: Close
[0m10:31:08.035133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:08.036255 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:31:08.036942 [info ] [MainThread]: 
[0m10:31:08.037380 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 11.72 seconds (71.72s).
[0m10:31:08.038067 [debug] [MainThread]: Command end result
[0m10:31:08.056542 [info ] [MainThread]: 
[0m10:31:08.057179 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:31:08.057503 [info ] [MainThread]: 
[0m10:31:08.057821 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:31:08.058116 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m10:31:08.058380 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m10:31:08.058644 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m10:31:08.058893 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m10:31:08.059141 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m10:31:08.059610 [error] [MainThread]:   ORA-29276: transfer timeout
[0m10:31:08.060019 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m10:31:08.060321 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m10:31:08.060600 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m10:31:08.060861 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m10:31:08.061122 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m10:31:08.061377 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m10:31:08.061622 [error] [MainThread]:   ORA-06512: at line 83
[0m10:31:08.061868 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:31:08.062142 [info ] [MainThread]: 
[0m10:31:08.062465 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:31:08.063133 [debug] [MainThread]: Command `dbt run` failed at 10:31:08.063028 after 72.04 seconds
[0m10:31:08.063602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ac550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b6350>]}
[0m10:31:08.064052 [debug] [MainThread]: Flushing usage events
[0m10:33:05.119083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b0bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b17190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b17fd0>]}


============================== 10:33:05.122396 | ba54ab9a-53e7-45f5-8060-ba76a58aea1f ==============================
[0m10:33:05.122396 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:33:05.122819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:33:05.237869 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:33:05.266528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba54ab9a-53e7-45f5-8060-ba76a58aea1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b48dd0>]}
[0m10:33:05.273408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba54ab9a-53e7-45f5-8060-ba76a58aea1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11482a190>]}
[0m10:33:05.321640 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:33:05.385827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:33:05.386142 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:33:05.389766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba54ab9a-53e7-45f5-8060-ba76a58aea1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115234050>]}
[0m10:33:05.399913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba54ab9a-53e7-45f5-8060-ba76a58aea1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150f3f50>]}
[0m10:33:05.400291 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:33:05.400480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba54ab9a-53e7-45f5-8060-ba76a58aea1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152a7fd0>]}
[0m10:33:05.401255 [info ] [MainThread]: 
[0m10:33:05.401662 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:33:05.402227 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:33:05.407357 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:33:05.407590 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:33:05.407899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:05.408101 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:33:07.161096 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:33:07.283476 [debug] [ThreadPool]: On list_None: Close
[0m10:33:07.406348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:33:07.415319 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:33:07.415985 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:33:07.416370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:33:07.416769 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:33:08.781116 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:33:08.792117 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:33:08.792891 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:33:08.929445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:33:09.268127 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:33:09.372297 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:33:09.488051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba54ab9a-53e7-45f5-8060-ba76a58aea1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115168110>]}
[0m10:33:09.489010 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:09.489471 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:33:10.783517 [debug] [MainThread]: On master: COMMIT
[0m10:33:10.785789 [debug] [MainThread]: Using oracle connection "master"
[0m10:33:10.786970 [debug] [MainThread]: On master: COMMIT
[0m10:33:10.895089 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:33:10.897143 [debug] [MainThread]: On master: Close
[0m10:33:11.005869 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:33:11.006739 [info ] [MainThread]: 
[0m10:33:11.016648 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:33:11.017463 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:33:11.018269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:33:11.018673 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:33:11.041834 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:33:11.044762 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:33:11.018952 => 10:33:11.044543
[0m10:33:11.045163 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:33:11.055688 [debug] [Thread-1 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m10:33:11.056067 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:33:11.060188 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:33:11.060557 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:33:11.060817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:11.061057 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:33:12.479040 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m10:33:12.496593 [info ] [Thread-1 (]: Python model materialization is table
[0m10:33:12.497114 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:33:19.318320 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:33:19.319779 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzIzOTMsImlhdCI6MTY4NzM2ODc5M30.ccXoxP2DF7hUWwcsWjAL20E-dbMuV3aNBfEHBQm5WTiq_BpS-fWdjUo70Ve8WGk2Kvom11MO26tv11myHYrqZUtD3vMQMsN8CBcx-tsGSNUnrSBjr7F_rCwrD8jtoUR3U64CRskMOWjgCN7a37XXgofEJcQB-dwMigLmUQlGnWdfengCUPEvIgn9PGCYfqrpqT_djNc3b4zk63u1-0mx9mMbSPdHH9SpakP6cR73XrS9LADREIDepky6Q_fvfwsFCtG5EEw5MLCXBsVAgGRVTbTbjmuvIxhcgVmR3jG6pLX05PaxzwezwLlqBG9cMrkDrwWWSX_ssAVBGxtOlm8pYw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_events": "FAWDBTCORE.web_events"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_events")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173319 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173319';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:34:19.942822 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 83
[0m10:34:19.944738 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:34:20.057837 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:33:11.045368 => 10:34:20.054841
[0m10:34:20.096290 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 83
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:34:20.099469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba54ab9a-53e7-45f5-8060-ba76a58aea1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115146210>]}
[0m10:34:20.100317 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 69.08s]
[0m10:34:20.100845 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:34:20.103014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:34:20.103610 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:34:21.658198 [debug] [MainThread]: On master: COMMIT
[0m10:34:21.660897 [debug] [MainThread]: Using oracle connection "master"
[0m10:34:21.661889 [debug] [MainThread]: On master: COMMIT
[0m10:34:21.789190 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:34:21.790197 [debug] [MainThread]: On master: Close
[0m10:34:21.922700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:34:21.923738 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:34:21.924311 [info ] [MainThread]: 
[0m10:34:21.924826 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 16.52 seconds (76.52s).
[0m10:34:21.925602 [debug] [MainThread]: Command end result
[0m10:34:21.939328 [info ] [MainThread]: 
[0m10:34:21.940027 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:34:21.940381 [info ] [MainThread]: 
[0m10:34:21.940733 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:34:21.941082 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m10:34:21.941392 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m10:34:21.941669 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m10:34:21.941922 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m10:34:21.942169 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m10:34:21.942416 [error] [MainThread]:   ORA-29276: transfer timeout
[0m10:34:21.942665 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m10:34:21.942914 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m10:34:21.943165 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m10:34:21.943409 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m10:34:21.944016 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m10:34:21.944342 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m10:34:21.944629 [error] [MainThread]:   ORA-06512: at line 83
[0m10:34:21.944902 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:34:21.945178 [info ] [MainThread]: 
[0m10:34:21.945495 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:34:21.946046 [debug] [MainThread]: Command `dbt run` failed at 10:34:21.945958 after 76.86 seconds
[0m10:34:21.946459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b28210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b287d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e68d10>]}
[0m10:34:21.946828 [debug] [MainThread]: Flushing usage events
[0m10:35:45.784937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a17fd0>]}


============================== 10:35:45.794587 | ea20ef5a-1e43-4fb7-b8a0-fffd1a64371f ==============================
[0m10:35:45.794587 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:35:45.794955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:35:45.902763 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:35:45.928161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea20ef5a-1e43-4fb7-b8a0-fffd1a64371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a45750>]}
[0m10:35:45.934575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea20ef5a-1e43-4fb7-b8a0-fffd1a64371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101cd810>]}
[0m10:35:45.970260 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:35:46.038431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:35:46.039317 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/sources.yml
[0m10:35:46.039618 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:35:46.049501 [debug] [MainThread]: 1699: static parser successfully parsed average_duration_by_platform_country.sql
[0m10:35:46.055862 [debug] [MainThread]: 1699: static parser successfully parsed event_counts_by_platform.sql
[0m10:35:46.058155 [debug] [MainThread]: 1603: static parser failed on combined_categorized_events.sql
[0m10:35:46.063268 [debug] [MainThread]: 1602: parser fallback to jinja rendering on combined_categorized_events.sql
[0m10:35:46.064544 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m10:35:46.066346 [debug] [MainThread]: 1699: static parser successfully parsed most_active_mobile_users.sql
[0m10:35:46.068097 [debug] [MainThread]: 1699: static parser successfully parsed most_frequent_browser.sql
[0m10:35:46.071435 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m10:35:46.073236 [debug] [MainThread]: 1603: static parser failed on staging/stg_web_events.sql
[0m10:35:46.076160 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_web_events.sql
[0m10:35:46.080042 [debug] [MainThread]: 1603: static parser failed on staging/stg_mobile_events.sql
[0m10:35:46.082715 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_mobile_events.sql
[0m10:35:46.095989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea20ef5a-1e43-4fb7-b8a0-fffd1a64371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110492b90>]}
[0m10:35:46.104466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea20ef5a-1e43-4fb7-b8a0-fffd1a64371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f3610>]}
[0m10:35:46.104822 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:35:46.105011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea20ef5a-1e43-4fb7-b8a0-fffd1a64371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110319e90>]}
[0m10:35:46.105735 [info ] [MainThread]: 
[0m10:35:46.106111 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:35:46.106644 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:35:46.112007 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:35:46.112313 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:35:46.112487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:46.112664 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:35:48.321070 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:35:48.515195 [debug] [ThreadPool]: On list_None: Close
[0m10:35:48.679857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:35:48.688360 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:35:48.689059 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:35:48.689455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:48.689862 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:35:50.859403 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:35:50.871266 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:35:50.872150 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:35:51.096671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:35:51.375681 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:35:51.598145 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:35:51.813871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea20ef5a-1e43-4fb7-b8a0-fffd1a64371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5c950>]}
[0m10:35:51.814877 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:35:51.815460 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:35:54.319310 [debug] [MainThread]: On master: COMMIT
[0m10:35:54.320265 [debug] [MainThread]: Using oracle connection "master"
[0m10:35:54.320795 [debug] [MainThread]: On master: COMMIT
[0m10:35:54.528077 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:35:54.531108 [debug] [MainThread]: On master: Close
[0m10:35:54.735551 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:35:54.736777 [info ] [MainThread]: 
[0m10:35:54.743923 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:35:54.744780 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:35:54.745722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:35:54.746191 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:35:54.763539 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:35:54.764894 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:35:54.746502 => 10:35:54.764662
[0m10:35:54.765326 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:35:54.776290 [debug] [Thread-1 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m10:35:54.776730 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:35:54.780747 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:35:54.781051 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:35:54.781301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:54.781537 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:35:56.967765 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m10:35:56.982722 [info ] [Thread-1 (]: Python model materialization is table
[0m10:35:56.983244 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:35:59.781083 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:35:59.782451 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzI1NTgsImlhdCI6MTY4NzM2ODk1OH0.G0KtOsn1xIlm2QiTZVjtyouNtF0rNKzvwQ2e0kGibgPwUTAcSoqWd-mf-Kn4N61smVxYlF9xqnCUFqC7CSWICE4dlAs8ZLi9xn9HRLD0Chbr-dS_G4pVHZg-yIjdrF9_XKSko814uKRV6mbaX8eXTt9Xja5U37uizjBrjOKeXz-i7FhGX0gbGVtOZ5GcWcuxxd4VaU-Vu9JhK7vsPgSAO3V34gw9Qdd4NauBXOr1C-s0juUTxZ5wq_XIIETUonyWj6kOiqdNkVgBF9tqD_7gpLeJYKvDMOzAj39EEwYn_9GKQ3SnRC5f6cJfMxLWYkEtGkiWYu7kJ0UEl1-9DcGDUA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173559 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173559';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:36:25.445599 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m10:36:25.451322 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:36:25.460199 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:36:25.460972 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:36:25.617435 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:36:25.633765 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:36:25.634562 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:36:25.635086 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:36:25.794992 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:36:25.800835 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:36:25.801985 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:36:25.961139 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:36:25.973945 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:35:54.765554 => 10:36:25.973820
[0m10:36:25.974335 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:36:26.136062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea20ef5a-1e43-4fb7-b8a0-fffd1a64371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103c06d0>]}
[0m10:36:26.137549 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 31.39s]
[0m10:36:26.138525 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:36:26.141087 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:36:26.141642 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:36:29.016916 [debug] [MainThread]: On master: COMMIT
[0m10:36:29.018605 [debug] [MainThread]: Using oracle connection "master"
[0m10:36:29.019149 [debug] [MainThread]: On master: COMMIT
[0m10:36:29.167947 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:36:29.171674 [debug] [MainThread]: On master: Close
[0m10:36:29.313647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:29.314371 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:36:29.314868 [info ] [MainThread]: 
[0m10:36:29.315374 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 43.21 seconds (43.21s).
[0m10:36:29.316236 [debug] [MainThread]: Command end result
[0m10:36:29.340701 [info ] [MainThread]: 
[0m10:36:29.341490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:36:29.341894 [info ] [MainThread]: 
[0m10:36:29.342294 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:36:29.343042 [debug] [MainThread]: Command `dbt run` succeeded at 10:36:29.342923 after 43.60 seconds
[0m10:36:29.343530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024c28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024c24d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102624e10>]}
[0m10:36:29.343972 [debug] [MainThread]: Flushing usage events
[0m10:37:29.139959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109117bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109117f90>]}


============================== 10:37:29.153493 | c0585e9e-d05b-4813-99ad-a61b55850c10 ==============================
[0m10:37:29.153493 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:37:29.153966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:37:29.318613 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:37:29.364939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0585e9e-d05b-4813-99ad-a61b55850c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109117d90>]}
[0m10:37:29.372713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0585e9e-d05b-4813-99ad-a61b55850c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109828f90>]}
[0m10:37:29.438961 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:37:29.506408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:37:29.506732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:37:29.510561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0585e9e-d05b-4813-99ad-a61b55850c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f7890>]}
[0m10:37:29.515645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0585e9e-d05b-4813-99ad-a61b55850c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0d350>]}
[0m10:37:29.515927 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:37:29.516101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0585e9e-d05b-4813-99ad-a61b55850c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b4bf90>]}
[0m10:37:29.516811 [info ] [MainThread]: 
[0m10:37:29.517185 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:37:29.517682 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:37:29.522761 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:37:29.522999 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:37:29.523169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:29.523345 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:37:31.833320 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:37:32.017252 [debug] [ThreadPool]: On list_None: Close
[0m10:37:32.178568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:37:32.186953 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:37:32.187658 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:37:32.188073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:32.188479 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:37:34.088809 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:37:34.100213 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:37:34.100967 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:37:34.253069 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:37:34.466027 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:37:34.679936 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:37:34.820825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0585e9e-d05b-4813-99ad-a61b55850c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097fb590>]}
[0m10:37:34.821459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:37:34.821801 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:37:36.993180 [debug] [MainThread]: On master: COMMIT
[0m10:37:36.994913 [debug] [MainThread]: Using oracle connection "master"
[0m10:37:36.995522 [debug] [MainThread]: On master: COMMIT
[0m10:37:37.110687 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:37:37.112340 [debug] [MainThread]: On master: Close
[0m10:37:37.235163 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:37:37.236253 [info ] [MainThread]: 
[0m10:37:37.244145 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:37:37.245019 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:37:37.246004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:37:37.246483 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:37:37.270593 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:37:37.273123 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:37:37.246765 => 10:37:37.272978
[0m10:37:37.273461 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:37:37.283632 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:37:37.284191 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:37:37.295097 [info ] [Thread-1 (]: Python model materialization is table
[0m10:37:37.295541 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:37:39.623786 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:37:39.625131 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzI2NTgsImlhdCI6MTY4NzM2OTA1OH0.dRQniFN1JqMf6LyvyHxXQr9J6aZDhpAIchXaHQYFrHknnud92cUNcC0izBLDcaNR_It3Tt_XK59xFNfZkL-FakheTQ7M2i6NCojl28uNigv6JcKCumb0mttH38cJjNB6dp0ko2etWH65KZi1a9G6NZwyPKOZ0HpsEYsXZN0ZclXyMqe3b6enIE_Sr5VUHXLQvyDwmRQ7FPhdm9geQBNOloU6ikAR3qK108mLgIQXHwheS9Q_jOZ3IISiZp4OAe7A1cMBjqLdDCBgjlPdZPFfc0IzwLdp4jUWSq4yR129tJZn0eyufRqY76he_hzm_g0PUwhxB_Ok2G4v9ixcQitZcw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173739 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173739';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:37:39.627368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:39.627968 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:38:05.339231 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m10:38:05.342585 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:38:05.349712 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:38:05.350415 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:38:05.512390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:38:05.519705 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:38:05.520559 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:38:05.636065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:38:05.652239 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:38:05.653142 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:38:05.653803 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:38:05.766285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:38:05.777806 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:38:05.778736 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:38:05.907776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:38:05.926242 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:37:37.273660 => 10:38:05.926043
[0m10:38:05.926811 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:38:06.058178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0585e9e-d05b-4813-99ad-a61b55850c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109109310>]}
[0m10:38:06.059658 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 28.81s]
[0m10:38:06.060540 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:38:06.062961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:06.063698 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m10:38:07.978950 [debug] [MainThread]: On master: COMMIT
[0m10:38:07.980600 [debug] [MainThread]: Using oracle connection "master"
[0m10:38:07.981278 [debug] [MainThread]: On master: COMMIT
[0m10:38:08.097117 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:38:08.099017 [debug] [MainThread]: On master: Close
[0m10:38:08.221252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:08.222200 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:38:08.222782 [info ] [MainThread]: 
[0m10:38:08.223267 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 38.71 seconds (38.71s).
[0m10:38:08.224145 [debug] [MainThread]: Command end result
[0m10:38:08.236556 [info ] [MainThread]: 
[0m10:38:08.237276 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:38:08.237660 [info ] [MainThread]: 
[0m10:38:08.238056 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:38:08.238753 [debug] [MainThread]: Command `dbt run` succeeded at 10:38:08.238653 after 39.14 seconds
[0m10:38:08.239226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051968d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051964d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f8e10>]}
[0m10:38:08.239659 [debug] [MainThread]: Flushing usage events
[0m10:38:31.975231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107517550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f7010>]}


============================== 10:38:31.978377 | fa432796-ea01-40b8-ac61-fbe9af53686a ==============================
[0m10:38:31.978377 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:38:31.978756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:38:32.081472 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:38:32.108074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa432796-ea01-40b8-ac61-fbe9af53686a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752b7d0>]}
[0m10:38:32.114569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa432796-ea01-40b8-ac61-fbe9af53686a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcd750>]}
[0m10:38:32.157132 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:38:32.162590 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m10:38:32.162868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa432796-ea01-40b8-ac61-fbe9af53686a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107548b90>]}
[0m10:38:32.541648 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m10:38:32.547896 [debug] [MainThread]: 1603: static parser failed on combined_categorized_events.sql
[0m10:38:32.552492 [debug] [MainThread]: 1602: parser fallback to jinja rendering on combined_categorized_events.sql
[0m10:38:32.553695 [debug] [MainThread]: 1699: static parser successfully parsed event_counts_by_platform.sql
[0m10:38:32.555572 [debug] [MainThread]: 1699: static parser successfully parsed average_duration_by_platform_country.sql
[0m10:38:32.557512 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m10:38:32.559872 [debug] [MainThread]: 1699: static parser successfully parsed most_frequent_browser.sql
[0m10:38:32.562091 [debug] [MainThread]: 1699: static parser successfully parsed most_active_mobile_users.sql
[0m10:38:32.563949 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
[0m10:38:32.565681 [debug] [MainThread]: 1603: static parser failed on staging/stg_web_events.sql
[0m10:38:32.568384 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_web_events.sql
[0m10:38:32.569444 [debug] [MainThread]: 1603: static parser failed on staging/stg_mobile_events.sql
[0m10:38:32.571881 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_mobile_events.sql
[0m10:38:32.609809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa432796-ea01-40b8-ac61-fbe9af53686a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb3c50>]}
[0m10:38:32.617785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa432796-ea01-40b8-ac61-fbe9af53686a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110888c10>]}
[0m10:38:32.618153 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:38:32.618338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa432796-ea01-40b8-ac61-fbe9af53686a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e93350>]}
[0m10:38:32.619085 [info ] [MainThread]: 
[0m10:38:32.619473 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:38:32.620006 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:38:32.625238 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:38:32.625541 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:38:32.625716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:32.625894 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:38:34.313981 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:38:34.444745 [debug] [ThreadPool]: On list_None: Close
[0m10:38:34.574607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:38:34.582221 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:38:34.582846 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:38:34.583236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:34.583647 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:38:36.097980 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:38:36.108155 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:38:36.108874 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:38:36.234417 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:38:36.471539 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:38:36.661075 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:38:36.819438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa432796-ea01-40b8-ac61-fbe9af53686a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110893950>]}
[0m10:38:36.820138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:36.820434 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:38:38.274017 [debug] [MainThread]: On master: COMMIT
[0m10:38:38.276382 [debug] [MainThread]: Using oracle connection "master"
[0m10:38:38.277123 [debug] [MainThread]: On master: COMMIT
[0m10:38:38.397570 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:38:38.399390 [debug] [MainThread]: On master: Close
[0m10:38:38.530343 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:38:38.531006 [info ] [MainThread]: 
[0m10:38:38.540029 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:38:38.540789 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:38:38.541685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:38:38.542072 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:38:38.559775 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:38:38.561114 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:38:38.542342 => 10:38:38.560843
[0m10:38:38.561560 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:38:38.572420 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:38:38.572758 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:38:38.583377 [info ] [Thread-1 (]: Python model materialization is table
[0m10:38:38.583810 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:38:40.904052 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:38:40.905500 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzI3MTksImlhdCI6MTY4NzM2OTExOX0.mj2lCwIrpogukskG7MfJrqB-gLot0B8pPNFmO5u_SSjuZwYXBe9oY3QtGaDJ3l7BeKF7fbuVC1QcP59CYnmswB0PolDhS7js8fH3MQBbi9NBEjirTCSBbvc6VZSOu-94bd27U1RtvvvSm268EybEjVGrVenNFXcEfbsjTncqgxJILfH5Fy0BLeWqJNOB5OUdUqwme-vNdPUk9hBtGklbEaN9QbsiHgtWvuaBjx23Sc_FoRutHGGhyniRSoHQfvudXYWtWWGKSWn0yaqOvziwTSrt1YyjwvyG5ODOTZ_Mgz-J0TpkF8UweatrAdqlPcgxMX9fW8EN3S0DDki385JiFQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173840 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173840';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:38:40.907213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:40.907835 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:39:07.055443 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m10:39:07.058866 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:39:07.068159 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:39:07.068990 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:39:07.211795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:39:07.219360 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:39:07.220175 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:39:07.377148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:39:07.394943 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:39:07.395758 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:39:07.396125 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:39:07.572018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:39:07.582591 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:39:07.583351 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:39:07.752617 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:39:07.769988 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:38:38.561795 => 10:39:07.769759
[0m10:39:07.770677 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:39:07.900882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa432796-ea01-40b8-ac61-fbe9af53686a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b1e810>]}
[0m10:39:07.902054 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 29.36s]
[0m10:39:07.902672 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:39:07.905120 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:39:07.905759 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:39:09.477745 [debug] [MainThread]: On master: COMMIT
[0m10:39:09.479468 [debug] [MainThread]: Using oracle connection "master"
[0m10:39:09.480056 [debug] [MainThread]: On master: COMMIT
[0m10:39:09.589204 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:39:09.590932 [debug] [MainThread]: On master: Close
[0m10:39:09.711110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:09.711966 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:39:09.712672 [info ] [MainThread]: 
[0m10:39:09.713417 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 37.09 seconds (37.09s).
[0m10:39:09.714181 [debug] [MainThread]: Command end result
[0m10:39:09.767421 [info ] [MainThread]: 
[0m10:39:09.768425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:39:09.768829 [info ] [MainThread]: 
[0m10:39:09.769236 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:39:09.770055 [debug] [MainThread]: Command `dbt run` succeeded at 10:39:09.769927 after 37.83 seconds
[0m10:39:09.770588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e0a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f6ce90>]}
[0m10:39:09.771112 [debug] [MainThread]: Flushing usage events
[0m10:57:42.272652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040b3b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040bf550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040bffd0>]}


============================== 10:57:42.275726 | b6835b43-295e-4447-84ae-74518200ae67 ==============================
[0m10:57:42.275726 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:57:42.276052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:57:42.342023 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:57:42.366152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6835b43-295e-4447-84ae-74518200ae67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040efd90>]}
[0m10:57:42.372350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6835b43-295e-4447-84ae-74518200ae67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d13d0>]}
[0m10:57:42.409689 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:57:42.447212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:42.447667 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:57:42.468205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6835b43-295e-4447-84ae-74518200ae67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f7c10>]}
[0m10:57:42.481455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6835b43-295e-4447-84ae-74518200ae67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104173050>]}
[0m10:57:42.481857 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:57:42.482045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6835b43-295e-4447-84ae-74518200ae67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104801fd0>]}
[0m10:57:42.482801 [info ] [MainThread]: 
[0m10:57:42.483194 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:57:42.483709 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:57:42.488840 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:57:42.489181 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:57:42.489358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:42.489530 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:57:46.796850 [debug] [ThreadPool]: SQL status: OK in 4.0 seconds
[0m10:57:47.112897 [debug] [ThreadPool]: On list_None: Close
[0m10:57:47.390214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:57:47.398432 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:57:47.399085 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:57:47.399436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:47.399774 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:57:50.947070 [debug] [ThreadPool]: SQL status: OK in 4.0 seconds
[0m10:57:50.963148 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:57:50.964614 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:57:51.246705 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:51.577170 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:57:51.805925 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:57:52.037185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6835b43-295e-4447-84ae-74518200ae67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e35910>]}
[0m10:57:52.038800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:52.039444 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:57:56.829464 [debug] [MainThread]: On master: COMMIT
[0m10:57:56.830582 [debug] [MainThread]: Using oracle connection "master"
[0m10:57:56.831218 [debug] [MainThread]: On master: COMMIT
[0m10:57:57.093250 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:57:57.095607 [debug] [MainThread]: On master: Close
[0m10:57:58.382694 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:57:58.384797 [info ] [MainThread]: 
[0m10:57:58.410337 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:57:58.411248 [info ] [Thread-1 (]: 1 of 1 START python incremental model FAWDBTCORE.web_events_python ............. [RUN]
[0m10:57:58.412243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:57:58.412834 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:57:58.431995 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:57:58.433240 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:57:58.413318 => 10:57:58.433091
[0m10:57:58.433528 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:57:58.469485 [info ] [Thread-1 (]: Python model materialization is incremental
[0m10:58:01.453005 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:58:01.455846 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzM4ODAsImlhdCI6MTY4NzM3MDI4MH0.gk8DNILdMl1B4OlSntNHbq0Iqa-c3XrlYJucvFXRRVIAt05fZcLJ36h0it8MvAPCoMbVikUsPMkS3Iu2Sddbj0j5kLod8858B-g5W4e0TF8T2xGQMTymJ09RExWA34r8dXJaGJHyLNc09OYuhJly7clkykraKNOkxIddTLKX3wQFHBsUzXvGCQnEtk2wKj1hAd5nDAGBukcPSu_HKn55Y9nJdcdGdW3imxmnPhaas5QEIdKpGlvARix0gbkHjpBhEyiT7gaW5KDUtp4pGK7ooGzzolV9zXJn7N-5vWXaIyyoD-CCVCso4eNaR3gsSioTOVCFTpIewFhN_RGfJE5rCQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="incremental")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_web_events_python105758458992"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175801 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175801';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:58:01.459722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:01.460905 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:58:29.416851 [debug] [Thread-1 (]: SQL status: OK in 28.0 seconds
[0m10:58:29.418573 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:58:29.431553 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:58:29.432631 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_web_events_python105758458992')
        
      order by ordinal_position

  
[0m10:58:29.810987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:58:30.060849 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:58:30.063171 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('web_events_python')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m10:58:30.406078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:58:30.644334 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:58:30.645480 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('WEB_EVENTS_PYTHON')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m10:58:30.941166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:58:31.248740 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.web_events_python"
[0m10:58:31.268150 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:58:31.268982 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */

      insert  into  FAWDBTCORE.web_events_python (USER_ID, NAME)
    (
       select USER_ID, NAME
       from o$pt_web_events_python105758458992
    )
  
[0m10:58:31.551646 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:58:31.574108 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:58:31.575860 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:58:31.576749 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:58:31.870843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:58:31.886057 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:58:31.888289 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
truncate table o$pt_web_events_python105758458992
[0m10:58:32.203389 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:58:32.222814 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:58:32.223991 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_web_events_python105758458992 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:58:32.473553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:58:32.496947 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:57:58.433773 => 10:58:32.496743
[0m10:58:32.497686 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: ROLLBACK
[0m10:58:32.779957 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:58:33.064198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6835b43-295e-4447-84ae-74518200ae67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a93910>]}
[0m10:58:33.066286 [info ] [Thread-1 (]: 1 of 1 OK created python incremental model FAWDBTCORE.web_events_python ........ [[32mOK[0m in 34.65s]
[0m10:58:33.068031 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:58:33.073385 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:33.074741 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:58:36.543753 [debug] [MainThread]: On master: COMMIT
[0m10:58:36.545979 [debug] [MainThread]: Using oracle connection "master"
[0m10:58:36.546992 [debug] [MainThread]: On master: COMMIT
[0m10:58:36.722183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:58:36.723870 [debug] [MainThread]: On master: Close
[0m10:58:36.907590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:36.909574 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:58:36.910826 [info ] [MainThread]: 
[0m10:58:36.911915 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 54.43 seconds (54.43s).
[0m10:58:36.913540 [debug] [MainThread]: Command end result
[0m10:58:36.930491 [info ] [MainThread]: 
[0m10:58:36.931353 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:58:36.931808 [info ] [MainThread]: 
[0m10:58:36.932277 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:58:36.933104 [debug] [MainThread]: Command `dbt run` succeeded at 10:58:36.932981 after 54.68 seconds
[0m10:58:36.933637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040d3690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009f4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100952a10>]}
[0m10:58:36.934139 [debug] [MainThread]: Flushing usage events
[0m11:11:05.625884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122a08f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122a17550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122a17fd0>]}


============================== 11:11:05.628181 | a668d49e-2235-46d1-b3e0-98ebaef26c8e ==============================
[0m11:11:05.628181 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:11:05.628496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:11:05.669310 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:11:05.691572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a668d49e-2235-46d1-b3e0-98ebaef26c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122a299d0>]}
[0m11:11:05.697742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a668d49e-2235-46d1-b3e0-98ebaef26c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122a08c50>]}
[0m11:11:05.730901 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:11:05.763712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:11:05.764188 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:11:05.784604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a668d49e-2235-46d1-b3e0-98ebaef26c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123145d10>]}
[0m11:11:05.790850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a668d49e-2235-46d1-b3e0-98ebaef26c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123250350>]}
[0m11:11:05.791199 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m11:11:05.791385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a668d49e-2235-46d1-b3e0-98ebaef26c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123142ed0>]}
[0m11:11:05.792125 [info ] [MainThread]: 
[0m11:11:05.792505 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:11:05.793059 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:11:05.798136 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:11:05.798463 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:11:05.798637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:05.798813 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:11:09.972630 [debug] [ThreadPool]: SQL status: OK in 4.0 seconds
[0m11:11:10.271338 [debug] [ThreadPool]: On list_None: Close
[0m11:11:10.579216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:11:10.588265 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:11:10.588918 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:11:10.589317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:10.589739 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:11:13.890829 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:11:13.903847 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:11:13.904397 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:11:14.167632 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:11:14.534170 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:11:14.842122 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:11:15.157633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a668d49e-2235-46d1-b3e0-98ebaef26c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122a7e1d0>]}
[0m11:11:15.158800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:15.159295 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:11:18.331325 [debug] [MainThread]: On master: COMMIT
[0m11:11:18.333704 [debug] [MainThread]: Using oracle connection "master"
[0m11:11:18.334708 [debug] [MainThread]: On master: COMMIT
[0m11:11:18.616122 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:11:18.618495 [debug] [MainThread]: On master: Close
[0m11:11:18.875286 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:11:18.876333 [info ] [MainThread]: 
[0m11:11:18.883683 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:11:18.884488 [info ] [Thread-1 (]: 1 of 1 START python incremental model FAWDBTCORE.web_events_python ............. [RUN]
[0m11:11:18.885416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:11:18.885877 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:11:18.906556 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:11:18.907858 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:11:18.886191 => 11:11:18.907658
[0m11:11:18.908217 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:11:18.934474 [info ] [Thread-1 (]: Python model materialization is incremental
[0m11:11:22.198521 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:11:22.199858 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzQ2ODEsImlhdCI6MTY4NzM3MTA4MX0.m9aNKYHWLtsEd7yUFn1lcFOM8dghDqhxY62uQIsBSd71bX4QSaDMiu2LrJeqNjemvxKq_kDNwVSlGBn8g1G6fu1wZXjCga3o15lfr8E4NaGI5-uYh8sB_sohE-I3wwQLzX19dhGMjHNkJAqwn4EHfdSE2AajoDPohYmznNHO6_Rq815cFL-hJ7WL_EyUfI8jWJRpvi06JCHZs1ZBsm7PJfcVqvRFuDmP1LG2NrQvsFYCs4aURw_teAtBZd4yYaQJQGeBlwOX_I3iH-p69Aq2qDxIM1-W2yqtAqqBNYDyJG0iwpk1C2EsOmCwDhO9yWB8AyPpHpmsyQJfrY0nYAPfmQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="incremental")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        median = s_df["user_id"].median()
        return median





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_web_events_python111118925201"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181122 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181122';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:11:22.201292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:22.201869 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:11:50.170753 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 72, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 87
[0m11:11:50.172023 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:11:50.358436 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:11:18.908422 => 11:11:50.357232
[0m11:11:50.371380 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 72, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 87
[0m11:11:50.374564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a668d49e-2235-46d1-b3e0-98ebaef26c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12338b090>]}
[0m11:11:50.375357 [error] [Thread-1 (]: 1 of 1 ERROR creating python incremental model FAWDBTCORE.web_events_python .... [[31mERROR[0m in 31.49s]
[0m11:11:50.375918 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:11:50.377987 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:50.378479 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:11:52.555173 [debug] [MainThread]: On master: COMMIT
[0m11:11:52.557365 [debug] [MainThread]: Using oracle connection "master"
[0m11:11:52.558471 [debug] [MainThread]: On master: COMMIT
[0m11:11:52.731142 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:11:52.733028 [debug] [MainThread]: On master: Close
[0m11:11:52.881333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:52.882243 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:11:52.882721 [info ] [MainThread]: 
[0m11:11:52.883141 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 47.09 seconds (47.09s).
[0m11:11:52.883836 [debug] [MainThread]: Command end result
[0m11:11:52.892507 [info ] [MainThread]: 
[0m11:11:52.893021 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:11:52.893322 [info ] [MainThread]: 
[0m11:11:52.893605 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m11:11:52.893935 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 72, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
[0m11:11:52.894246 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m11:11:52.894506 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m11:11:52.894754 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m11:11:52.895009 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m11:11:52.895260 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m11:11:52.895511 [error] [MainThread]:   ORA-06512: at line 87
[0m11:11:52.895754 [info ] [MainThread]: 
[0m11:11:52.896018 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:11:52.896539 [debug] [MainThread]: Command `dbt run` failed at 11:11:52.896464 after 47.29 seconds
[0m11:11:52.896912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105068e90>]}
[0m11:11:52.897256 [debug] [MainThread]: Flushing usage events
[0m11:15:06.079879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b17b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b17f90>]}


============================== 11:15:06.082636 | 28f039dc-35f7-4e48-abfd-da73a8c6c202 ==============================
[0m11:15:06.082636 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:15:06.082994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:15:06.126237 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:15:06.148129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28f039dc-35f7-4e48-abfd-da73a8c6c202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e60d0>]}
[0m11:15:06.154544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28f039dc-35f7-4e48-abfd-da73a8c6c202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072cd390>]}
[0m11:15:06.187132 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:15:06.218809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:15:06.219269 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:15:06.241996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28f039dc-35f7-4e48-abfd-da73a8c6c202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b1f10>]}
[0m11:15:06.257573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28f039dc-35f7-4e48-abfd-da73a8c6c202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cf750>]}
[0m11:15:06.257971 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m11:15:06.258156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28f039dc-35f7-4e48-abfd-da73a8c6c202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072eaed0>]}
[0m11:15:06.258904 [info ] [MainThread]: 
[0m11:15:06.259298 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:15:06.259810 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:15:06.264843 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:15:06.265152 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:15:06.265330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:06.265508 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:15:09.084063 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:15:09.279210 [debug] [ThreadPool]: On list_None: Close
[0m11:15:09.519826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:15:09.528169 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:15:09.528821 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:15:09.529261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:09.529680 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:15:12.209308 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:15:12.222862 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:15:12.223461 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:15:12.517105 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:15:12.842960 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:15:13.077795 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:15:13.315408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28f039dc-35f7-4e48-abfd-da73a8c6c202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b86010>]}
[0m11:15:13.316615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:13.317191 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:15:18.560301 [debug] [MainThread]: On master: COMMIT
[0m11:15:18.562608 [debug] [MainThread]: Using oracle connection "master"
[0m11:15:18.563782 [debug] [MainThread]: On master: COMMIT
[0m11:15:18.793988 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:15:18.796317 [debug] [MainThread]: On master: Close
[0m11:15:19.034309 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:15:19.035980 [info ] [MainThread]: 
[0m11:15:19.043884 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:15:19.044395 [info ] [Thread-1 (]: 1 of 1 START python incremental model FAWDBTCORE.web_events_python ............. [RUN]
[0m11:15:19.045137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:15:19.045740 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:15:19.064601 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:15:19.065573 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:15:19.046045 => 11:15:19.065473
[0m11:15:19.065880 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:15:19.093462 [info ] [Thread-1 (]: Python model materialization is incremental
[0m11:15:22.175484 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:15:22.176349 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzQ5MjEsImlhdCI6MTY4NzM3MTMyMX0.r3MVyHJIggi3WkEeMkNCRkvN4Clls_qD1JiN28o9k2EER3ZD7tSRC22VC9UKfLgZ9cApZB3GNK7K-zhu7euOkfmcPHgVXQ42WXHnd43s6epFz_FUAF47-2c9an8qb-kKj4uR3lyvIAYP4bwzBFGQZYzMKhV406YD-kABZSiAyVfExgF20REoKD28NQpQO5CmYfQK7ksyepdZ1_0Ue-Sn5Hld1oflMMS1ZywEJkXDaRj4dUVsadg4NXqd4XZc8-qomG7jdUiyGLCQGv65REFrNuHO9GJxTzzgP47cHRtvQKSabATKk0iPHTd_FQktuMHb2ZfL8U9GjrOu2JSFBv88IQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="incremental")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        median = s_df["user_id"].median()
    
        diff = s_df["CUST_CREDIT_LIMIT"] - median
    
        # Add a new column "CUST_CREDIT_ANOMALY_SCORE"
        s_df = s_df.concat({"diff_col": diff})
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_web_events_python111519083949"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181522 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181522';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:15:22.177159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:22.177523 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:15:52.996208 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 93
[0m11:15:52.999052 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:15:53.163030 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:15:19.066073 => 11:15:53.161621
[0m11:15:53.175623 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 93
[0m11:15:53.178686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f039dc-35f7-4e48-abfd-da73a8c6c202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ed1d0>]}
[0m11:15:53.179440 [error] [Thread-1 (]: 1 of 1 ERROR creating python incremental model FAWDBTCORE.web_events_python .... [[31mERROR[0m in 34.13s]
[0m11:15:53.179945 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:15:53.181791 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:53.182306 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:15:55.407234 [debug] [MainThread]: On master: COMMIT
[0m11:15:55.409298 [debug] [MainThread]: Using oracle connection "master"
[0m11:15:55.410200 [debug] [MainThread]: On master: COMMIT
[0m11:15:55.589748 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:15:55.592339 [debug] [MainThread]: On master: Close
[0m11:15:55.807235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:55.809092 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:15:55.810087 [info ] [MainThread]: 
[0m11:15:55.810647 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 49.55 seconds (49.55s).
[0m11:15:55.811500 [debug] [MainThread]: Command end result
[0m11:15:55.822363 [info ] [MainThread]: 
[0m11:15:55.823125 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:15:55.823432 [info ] [MainThread]: 
[0m11:15:55.823727 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m11:15:55.824056 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
[0m11:15:55.824376 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m11:15:55.824568 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m11:15:55.824694 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m11:15:55.824819 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m11:15:55.824946 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m11:15:55.825074 [error] [MainThread]:   ORA-06512: at line 93
[0m11:15:55.825209 [info ] [MainThread]: 
[0m11:15:55.825387 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:15:55.825826 [debug] [MainThread]: Command `dbt run` failed at 11:15:55.825761 after 49.77 seconds
[0m11:15:55.826533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b299d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103060e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103060e90>]}
[0m11:15:55.827066 [debug] [MainThread]: Flushing usage events
[0m11:16:26.413694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d17ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d17f90>]}


============================== 11:16:26.415899 | 0f4dde74-5c66-43c6-8ef4-d30a6977832c ==============================
[0m11:16:26.415899 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:16:26.416227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:16:26.455418 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:16:26.477702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f4dde74-5c66-43c6-8ef4-d30a6977832c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd5bd0>]}
[0m11:16:26.483914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f4dde74-5c66-43c6-8ef4-d30a6977832c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066db1d0>]}
[0m11:16:26.514784 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:16:26.557496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:16:26.557878 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:16:26.577698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f4dde74-5c66-43c6-8ef4-d30a6977832c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ce990>]}
[0m11:16:26.582979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f4dde74-5c66-43c6-8ef4-d30a6977832c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704bf50>]}
[0m11:16:26.583182 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m11:16:26.583358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f4dde74-5c66-43c6-8ef4-d30a6977832c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ea450>]}
[0m11:16:26.584022 [info ] [MainThread]: 
[0m11:16:26.584407 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:16:26.584885 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:16:26.589789 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:16:26.590066 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:16:26.590193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:26.590330 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:16:32.278892 [debug] [ThreadPool]: SQL status: OK in 6.0 seconds
[0m11:16:32.460801 [debug] [ThreadPool]: On list_None: Close
[0m11:16:32.653898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:16:32.660681 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:16:32.661046 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:16:32.661312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:32.661592 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:16:34.706897 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:16:34.721489 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:16:34.722133 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:16:34.912705 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:16:35.259265 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:16:35.560114 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:16:35.755065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f4dde74-5c66-43c6-8ef4-d30a6977832c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787add0>]}
[0m11:16:35.756116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:16:35.756559 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:16:38.428423 [debug] [MainThread]: On master: COMMIT
[0m11:16:38.430471 [debug] [MainThread]: Using oracle connection "master"
[0m11:16:38.431227 [debug] [MainThread]: On master: COMMIT
[0m11:16:38.654802 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:16:38.656678 [debug] [MainThread]: On master: Close
[0m11:16:38.947310 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:16:38.948418 [info ] [MainThread]: 
[0m11:16:38.955174 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:16:38.955906 [info ] [Thread-1 (]: 1 of 1 START python incremental model FAWDBTCORE.web_events_python ............. [RUN]
[0m11:16:38.956858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:16:38.957451 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:16:38.977769 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:16:38.978982 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:16:38.957996 => 11:16:38.978805
[0m11:16:38.979237 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:16:39.008519 [info ] [Thread-1 (]: Python model materialization is incremental
[0m11:16:41.812450 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:16:41.813723 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzUwMDAsImlhdCI6MTY4NzM3MTQwMH0.QVVAQBECARowylxt6o-wAtrTTK8RIchpQaltcmIq0qsc3RhWH7Xkd1UKkfP-SOVIvbJieT2IzNUSBacq1c4k6jiq7vzjLKhHPdgXbtnLfotCyivy698G4VNjNEOA0v1_twdXolX3WUOgO1IGQg7yC5STeZWDY-Q2stDgsADlr1XJhorEnWJK22ve7Do1Ldnac9hSx6Zn26-dEhIn2cyEVyQ7bi40_TCXzUnkRhxOsz_SnHt3WCWB7LkbObVAn0lwWK884UTMVAYsedW-Gh84a2bm8HEuvUBGUQKWx9kbbH3a6SI6AWcjC3yq6sh1SvaIwJSjzpgHI5h-p37BdZacrw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="incremental")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        median = s_df["user_id"].median()
    
        diff = (s_df["CUST_CREDIT_LIMIT"] - median)
    
        # Add a new column "CUST_CREDIT_ANOMALY_SCORE"
        s_df = s_df.concat({"diff_col": diff})
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_web_events_python111638999369"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181641 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181641';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:16:41.814551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:41.815017 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:17:10.485555 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 93
[0m11:17:10.488873 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:17:10.686996 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:16:38.979355 => 11:17:10.682205
[0m11:17:10.698916 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 93
[0m11:17:10.702206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4dde74-5c66-43c6-8ef4-d30a6977832c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078724d0>]}
[0m11:17:10.702993 [error] [Thread-1 (]: 1 of 1 ERROR creating python incremental model FAWDBTCORE.web_events_python .... [[31mERROR[0m in 31.75s]
[0m11:17:10.703658 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:17:10.705657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:17:10.706028 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:17:13.177195 [debug] [MainThread]: On master: COMMIT
[0m11:17:13.179122 [debug] [MainThread]: Using oracle connection "master"
[0m11:17:13.179875 [debug] [MainThread]: On master: COMMIT
[0m11:17:13.386767 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:17:13.388483 [debug] [MainThread]: On master: Close
[0m11:17:13.622042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:13.622364 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:17:13.622519 [info ] [MainThread]: 
[0m11:17:13.622697 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 47.04 seconds (47.04s).
[0m11:17:13.622992 [debug] [MainThread]: Command end result
[0m11:17:13.632015 [info ] [MainThread]: 
[0m11:17:13.632523 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:17:13.632865 [info ] [MainThread]: 
[0m11:17:13.633190 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m11:17:13.633553 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
[0m11:17:13.633917 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m11:17:13.634214 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m11:17:13.634503 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m11:17:13.634794 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m11:17:13.635067 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m11:17:13.635314 [error] [MainThread]:   ORA-06512: at line 93
[0m11:17:13.635565 [info ] [MainThread]: 
[0m11:17:13.635848 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:17:13.636387 [debug] [MainThread]: Command `dbt run` failed at 11:17:13.636300 after 47.24 seconds
[0m11:17:13.636733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b1eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b1cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106793c10>]}
[0m11:17:13.637053 [debug] [MainThread]: Flushing usage events
[0m11:17:42.954146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10421bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104227bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104227f90>]}


============================== 11:17:42.956784 | f077fee5-f72e-49dd-ae02-b88bb80e88d6 ==============================
[0m11:17:42.956784 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:17:42.957137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:17:42.998295 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:17:43.020885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f077fee5-f72e-49dd-ae02-b88bb80e88d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104251490>]}
[0m11:17:43.026961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f077fee5-f72e-49dd-ae02-b88bb80e88d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104939850>]}
[0m11:17:43.058401 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:17:43.085872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:17:43.086173 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:17:43.104878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f077fee5-f72e-49dd-ae02-b88bb80e88d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494a150>]}
[0m11:17:43.110319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f077fee5-f72e-49dd-ae02-b88bb80e88d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a3590>]}
[0m11:17:43.110514 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m11:17:43.110688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f077fee5-f72e-49dd-ae02-b88bb80e88d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428e510>]}
[0m11:17:43.111323 [info ] [MainThread]: 
[0m11:17:43.111698 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:17:43.112166 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:17:43.117172 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:17:43.117418 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:17:43.117546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:43.117672 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:17:45.431761 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:17:45.615284 [debug] [ThreadPool]: On list_None: Close
[0m11:17:45.794015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:17:45.801400 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:17:45.801758 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:17:45.802017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:45.802288 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:17:48.364228 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:17:48.375402 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:17:48.375979 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:17:48.671377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:17:48.989561 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:17:49.229431 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:17:49.439463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f077fee5-f72e-49dd-ae02-b88bb80e88d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8ae10>]}
[0m11:17:49.440407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:17:49.440768 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:17:51.807679 [debug] [MainThread]: On master: COMMIT
[0m11:17:51.809726 [debug] [MainThread]: Using oracle connection "master"
[0m11:17:51.810621 [debug] [MainThread]: On master: COMMIT
[0m11:17:52.005191 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:17:52.006774 [debug] [MainThread]: On master: Close
[0m11:17:52.221995 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:17:52.223663 [info ] [MainThread]: 
[0m11:17:52.230711 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:17:52.231420 [info ] [Thread-1 (]: 1 of 1 START python incremental model FAWDBTCORE.web_events_python ............. [RUN]
[0m11:17:52.232243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:17:52.232583 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:17:52.252970 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:17:52.254076 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:17:52.232793 => 11:17:52.253980
[0m11:17:52.254248 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:17:52.282453 [info ] [Thread-1 (]: Python model materialization is incremental
[0m11:17:55.436520 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:17:55.437946 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzUwNzQsImlhdCI6MTY4NzM3MTQ3NH0.Xr8ZpR0oJ9cItsNDoNoxxjX999qyKKgagEjfpBcegfu_ftk-kxgJvjrWfKKAqmsKLiIKp9YhAis1gIvaBc3sc1zhebwFDBr_88H_UvxRu7Q7y2zDXKWYekE5_Nzbv8Hg0p35HAaPJ7IOngZQYEfLCdEu4EEtQTwFl__8znDKUJjLY210jVCDxLGoi-hYtQbUKK2jT1lUtd4ddkgMsbMxSGHKcs25WnerfQ1Kty4ss17RdjTLKRpmoHiMsTC5DZS6lLDbjjPX39VVtdyUvY0i-TJFgRKwHGXWWX0uX-WNNiC3NvrwJkQ8p0R5YXRBOWWiA81AUxcGjLw72_PQvagOiw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="incremental")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        med = s_df["user_id"].median()
    
        diff = (s_df["CUST_CREDIT_LIMIT"] - med)
    
        # Add a new column "CUST_CREDIT_ANOMALY_SCORE"
        s_df = s_df.concat({"diff_col": diff})
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_web_events_python111752273655"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181755 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181755';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:17:55.438802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:55.439281 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:18:25.251627 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 93
[0m11:18:25.254374 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:18:25.470974 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:17:52.254431 => 11:18:25.469612
[0m11:18:25.485054 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 93
[0m11:18:25.488013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f077fee5-f72e-49dd-ae02-b88bb80e88d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c14850>]}
[0m11:18:25.488722 [error] [Thread-1 (]: 1 of 1 ERROR creating python incremental model FAWDBTCORE.web_events_python .... [[31mERROR[0m in 33.26s]
[0m11:18:25.489297 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:18:25.491185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:18:25.491526 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:18:27.995769 [debug] [MainThread]: On master: COMMIT
[0m11:18:27.997723 [debug] [MainThread]: Using oracle connection "master"
[0m11:18:27.998439 [debug] [MainThread]: On master: COMMIT
[0m11:18:28.182518 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:18:28.184051 [debug] [MainThread]: On master: Close
[0m11:18:28.370131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:28.370977 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:18:28.371376 [info ] [MainThread]: 
[0m11:18:28.371819 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 45.26 seconds (45.26s).
[0m11:18:28.372485 [debug] [MainThread]: Command end result
[0m11:18:28.382240 [info ] [MainThread]: 
[0m11:18:28.382802 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:18:28.383062 [info ] [MainThread]: 
[0m11:18:28.383317 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m11:18:28.383600 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
[0m11:18:28.383877 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m11:18:28.384097 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m11:18:28.384312 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m11:18:28.384528 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m11:18:28.384740 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m11:18:28.384953 [error] [MainThread]:   ORA-06512: at line 93
[0m11:18:28.385175 [info ] [MainThread]: 
[0m11:18:28.385446 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:18:28.386052 [debug] [MainThread]: Command `dbt run` failed at 11:18:28.385958 after 45.45 seconds
[0m11:18:28.386443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104238290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b5eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b5cd10>]}
[0m11:18:28.386752 [debug] [MainThread]: Flushing usage events
[0m11:19:55.779373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105debb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df7f90>]}


============================== 11:19:55.782016 | f84b87bd-81d1-4d2b-b339-0594413f457b ==============================
[0m11:19:55.782016 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:19:55.782380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:19:55.823777 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:19:55.845960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f84b87bd-81d1-4d2b-b339-0594413f457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de8b10>]}
[0m11:19:55.852044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f84b87bd-81d1-4d2b-b339-0594413f457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106509a90>]}
[0m11:19:55.884268 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:19:55.914378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:19:55.914694 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:19:55.933667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f84b87bd-81d1-4d2b-b339-0594413f457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c0510>]}
[0m11:19:55.939017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f84b87bd-81d1-4d2b-b339-0594413f457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106573690>]}
[0m11:19:55.939216 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m11:19:55.939393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f84b87bd-81d1-4d2b-b339-0594413f457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d6fd0>]}
[0m11:19:55.940042 [info ] [MainThread]: 
[0m11:19:55.940427 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:19:55.940931 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:19:55.945845 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:19:55.946095 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:19:55.946225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:55.946358 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:19:59.523469 [debug] [ThreadPool]: SQL status: OK in 4.0 seconds
[0m11:19:59.661398 [debug] [ThreadPool]: On list_None: Close
[0m11:19:59.804064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:19:59.814081 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:19:59.814574 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:19:59.814878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:19:59.815194 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:20:01.767212 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:20:01.777052 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:20:01.777641 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:20:01.947289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:20:02.144579 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:20:02.316399 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:20:02.498660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f84b87bd-81d1-4d2b-b339-0594413f457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065204d0>]}
[0m11:20:02.499644 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:20:02.500073 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:20:04.428772 [debug] [MainThread]: On master: COMMIT
[0m11:20:04.430727 [debug] [MainThread]: Using oracle connection "master"
[0m11:20:04.431475 [debug] [MainThread]: On master: COMMIT
[0m11:20:04.575813 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:20:04.578040 [debug] [MainThread]: On master: Close
[0m11:20:04.742023 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:20:04.742971 [info ] [MainThread]: 
[0m11:20:04.752249 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:20:04.753027 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:20:04.753893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:20:04.754210 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:20:04.773667 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:20:04.774915 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:20:04.754414 => 11:20:04.774696
[0m11:20:04.775247 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:20:04.785322 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:20:04.785577 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:20:04.796026 [info ] [Thread-1 (]: Python model materialization is table
[0m11:20:04.796410 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:20:07.645917 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:20:07.647177 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczNzUyMDYsImlhdCI6MTY4NzM3MTYwNn0.EDxacEMz-LS8L-d3BklWGEndU5T9jTeHEQMmYjrf1uJIyuq1JCchPqOgV22FOMfYHOoQhC10Nla9VybjFOgC9FIKzjF038j4tXPFTVQ0TVnHgisC3b_nPw0YhD-aIo4rcikEpgsUZaSpGWtgHTM7u3fzvLyWzSweRk3phswhZkCbLusBkDdZlxF3uRcaiGi0A_QouUNaMUfq9ZNneS-2GfIJTGBeQMyjXNSmGQn2EhLm3-bYRi5eNCThNcAS8FoLxOy151asUpmEr8Vo9wXtjxMy2jEpW7wXUauYIRdsWiS4I6zuJcXPh2Sjk6_R98rMgLf68Z54P3J9cTixlSR0zA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        med = s_df["user_id"].median()
    
        diff = (s_df["CUST_CREDIT_LIMIT"] - med)
    
        s_df = s_df.concat({"diff_col": diff})
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_182007 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_182007';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:20:07.647909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:07.648301 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:20:34.408176 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 77, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 89
[0m11:20:34.410424 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:20:34.568548 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:20:04.775410 => 11:20:34.568240
[0m11:20:34.578818 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 77, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 89
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:20:34.579994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f84b87bd-81d1-4d2b-b339-0594413f457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e0bd0>]}
[0m11:20:34.580336 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 29.83s]
[0m11:20:34.580624 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:20:34.581799 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:20:34.582002 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:20:36.956357 [debug] [MainThread]: On master: COMMIT
[0m11:20:36.958131 [debug] [MainThread]: Using oracle connection "master"
[0m11:20:36.958553 [debug] [MainThread]: On master: COMMIT
[0m11:20:37.167048 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:20:37.168408 [debug] [MainThread]: On master: Close
[0m11:20:37.353649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:37.353912 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:20:37.354061 [info ] [MainThread]: 
[0m11:20:37.354236 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 41.41 seconds (41.41s).
[0m11:20:37.354516 [debug] [MainThread]: Command end result
[0m11:20:37.361575 [info ] [MainThread]: 
[0m11:20:37.361858 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:20:37.362004 [info ] [MainThread]: 
[0m11:20:37.362149 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m11:20:37.362313 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"\"'user_id'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 77, in main\n   File \"<string>\", line 58, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
[0m11:20:37.362470 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m11:20:37.362601 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m11:20:37.362726 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m11:20:37.362850 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m11:20:37.362972 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m11:20:37.363153 [error] [MainThread]:   ORA-06512: at line 89
[0m11:20:37.363334 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:20:37.363488 [info ] [MainThread]: 
[0m11:20:37.363650 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:20:37.363965 [debug] [MainThread]: Command `dbt run` failed at 11:20:37.363916 after 41.61 seconds
[0m11:20:37.364160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10272cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10272f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f3090>]}
[0m11:20:37.364324 [debug] [MainThread]: Flushing usage events
[0m13:57:16.459034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d03b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bbe390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0ff90>]}


============================== 13:57:16.461609 | 6c8329fa-0474-4eea-acd3-58d78f4dda29 ==============================
[0m13:57:16.461609 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:57:16.462033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:57:16.513864 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:57:16.536110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c8329fa-0474-4eea-acd3-58d78f4dda29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d235d0>]}
[0m13:57:16.542154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c8329fa-0474-4eea-acd3-58d78f4dda29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108421bd0>]}
[0m13:57:16.573160 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:57:16.603134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:57:16.603521 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m13:57:16.623426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c8329fa-0474-4eea-acd3-58d78f4dda29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da9c10>]}
[0m13:57:16.628861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c8329fa-0474-4eea-acd3-58d78f4dda29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108545110>]}
[0m13:57:16.629067 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m13:57:16.629252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c8329fa-0474-4eea-acd3-58d78f4dda29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108452750>]}
[0m13:57:16.630214 [info ] [MainThread]: 
[0m13:57:16.630603 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:57:16.631331 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:57:16.636188 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:57:16.636443 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:57:16.636579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:16.636715 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:57:17.702417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:17.703250 [debug] [MainThread]: Connection 'list_None' was properly closed.
[0m13:57:17.703669 [info ] [MainThread]: 
[0m13:57:17.704188 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m13:57:17.704772 [error] [MainThread]: Encountered an error:

[0m13:57:17.778064 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 538, in create_schemas
    for ls_future in as_completed(list_futures):
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 622, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/main.py", line 565, in run
    results = task.run()
              ^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 441, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 403, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/run.py", line 446, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 529, in create_schemas
    with dbt.utils.executor(self.config) as tpe:
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/_base.py", line 647, in __exit__
    self.shutdown(wait=True)
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 235, in shutdown
    t.join()
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1112, in join
    self._wait_for_tstate_lock()
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1132, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:57:17.779509 [debug] [MainThread]: Command `dbt run` failed at 13:57:17.779413 after 1.34 seconds
[0m13:57:17.779850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d21ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e685d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104644d50>]}
[0m13:57:17.780144 [debug] [MainThread]: Flushing usage events
[0m13:57:35.968773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a3990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065af890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065afe50>]}


============================== 13:57:35.971656 | 662a931a-92c3-42a9-8f9f-911ec6c719f5 ==============================
[0m13:57:35.971656 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:57:35.971998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:57:36.017009 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:57:36.039147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '662a931a-92c3-42a9-8f9f-911ec6c719f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a06d0>]}
[0m13:57:36.045150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '662a931a-92c3-42a9-8f9f-911ec6c719f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076299d0>]}
[0m13:57:36.075352 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:57:36.103893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:36.104086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:36.107189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '662a931a-92c3-42a9-8f9f-911ec6c719f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107888c90>]}
[0m13:57:36.111123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '662a931a-92c3-42a9-8f9f-911ec6c719f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780db50>]}
[0m13:57:36.111317 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m13:57:36.111487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '662a931a-92c3-42a9-8f9f-911ec6c719f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794be10>]}
[0m13:57:36.112149 [info ] [MainThread]: 
[0m13:57:36.112512 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:57:36.112987 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:57:36.118259 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:57:36.118505 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:57:36.118637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:36.118765 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:57:39.928403 [debug] [ThreadPool]: SQL status: OK in 4.0 seconds
[0m13:57:40.226137 [debug] [ThreadPool]: On list_None: Close
[0m13:57:40.522876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:57:40.529013 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:57:40.529586 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:57:40.529939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:40.530170 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:57:46.624858 [debug] [ThreadPool]: SQL status: OK in 6.0 seconds
[0m13:57:46.637363 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:57:46.637894 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:57:46.852947 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:57:47.840696 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:57:48.758888 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:57:48.975145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '662a931a-92c3-42a9-8f9f-911ec6c719f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b9910>]}
[0m13:57:48.976032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:48.976390 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:57:50.934976 [debug] [MainThread]: On master: COMMIT
[0m13:57:50.936945 [debug] [MainThread]: Using oracle connection "master"
[0m13:57:50.937689 [debug] [MainThread]: On master: COMMIT
[0m13:57:51.111095 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:57:51.112803 [debug] [MainThread]: On master: Close
[0m13:57:51.270918 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:51.272299 [info ] [MainThread]: 
[0m13:57:51.279495 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m13:57:51.280520 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:57:51.281677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m13:57:51.282030 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:57:51.304392 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:57:51.305563 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:57:51.282242 => 13:57:51.305434
[0m13:57:51.305778 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:57:51.314649 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m13:57:51.314948 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m13:57:51.325587 [info ] [Thread-1 (]: Python model materialization is table
[0m13:57:51.326003 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:57:53.826079 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:57:53.827563 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczODQ2NzIsImlhdCI6MTY4NzM4MTA3Mn0.BkxDesWNmIUPESh1gbgfzPLiE6XoV3oeHk7PEX80jFBfuu3onhpsx8KflXQr4PvehOa0MmCRD2-t4JmFp-oSpqsTg6OAO9aeDhCfiUMUBItaqt8ATGkASoegKD_AnH599tHEvUTYWMrzSjV-XbypGcl3YG54bh4wh-c8YIKUbssSfnTxf99fAubWwZZIrmOMypSOSzGlRPkHWAgisfki_dWxg6Pewyo9gRTKFMgWSa3w7t8ESmI3HsiRey3WSYUqj9oRxgBL9X6OMrMsMSMO-yqw4B4N2nXhkrBJHqZ4yU1PYsJX-7tFuRgE5WQHIysqFObicj5IiU-8VuLY4IqBzw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        s_df = s_df.pull()
        med = s_df["user_id"].median()
    
        diff = (s_df["CUST_CREDIT_LIMIT"] - med)
    
        s_df = s_df.concat({"diff_col": diff})
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_205753 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_205753';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:57:53.828423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:53.828926 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:58:21.384487 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"'user_id' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 59, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/frame.py\", line 3458, in __getitem__\n    indexer = self.columns.get_loc(key)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/base.py\", line 3363, in get_loc\n    raise KeyError(key) from err\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 90
[0m13:58:21.387052 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m13:58:21.691241 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:57:51.305903 => 13:58:21.689945
[0m13:58:21.703341 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"'user_id' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 59, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/frame.py\", line 3458, in __getitem__\n    indexer = self.columns.get_loc(key)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/base.py\", line 3363, in get_loc\n    raise KeyError(key) from err\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 90
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m13:58:21.705959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '662a931a-92c3-42a9-8f9f-911ec6c719f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076086d0>]}
[0m13:58:21.706657 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 30.42s]
[0m13:58:21.707245 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:58:21.709315 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:21.709702 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:58:24.533383 [debug] [MainThread]: On master: COMMIT
[0m13:58:24.535340 [debug] [MainThread]: Using oracle connection "master"
[0m13:58:24.536084 [debug] [MainThread]: On master: COMMIT
[0m13:58:24.863737 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:58:24.865483 [debug] [MainThread]: On master: Close
[0m13:58:25.178167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:25.179049 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:58:25.179524 [info ] [MainThread]: 
[0m13:58:25.180078 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 49.07 seconds (49.07s).
[0m13:58:25.180928 [debug] [MainThread]: Command end result
[0m13:58:25.191638 [info ] [MainThread]: 
[0m13:58:25.192267 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:58:25.192574 [info ] [MainThread]: 
[0m13:58:25.192871 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m13:58:25.193206 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"'user_id' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 59, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/frame.py\", line 3458, in __getitem__\n    indexer = self.columns.get_loc(key)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/base.py\", line 3363, in get_loc\n    raise KeyError(key) from err\n"}
[0m13:58:25.193537 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m13:58:25.193797 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m13:58:25.194049 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:58:25.194301 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:58:25.194544 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:58:25.194797 [error] [MainThread]:   ORA-06512: at line 90
[0m13:58:25.195044 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m13:58:25.195299 [info ] [MainThread]: 
[0m13:58:25.195598 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:58:25.196232 [debug] [MainThread]: Command `dbt run` failed at 13:58:25.196136 after 49.25 seconds
[0m13:58:25.196621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107835d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ee4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d37f50>]}
[0m13:58:25.196962 [debug] [MainThread]: Flushing usage events
[0m13:59:25.279854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11200bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a41e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112017fd0>]}


============================== 13:59:25.282662 | 36c63620-abd4-4081-a339-938a164a3c2a ==============================
[0m13:59:25.282662 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:59:25.282999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:59:25.327079 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:59:25.349765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36c63620-abd4-4081-a339-938a164a3c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112028a90>]}
[0m13:59:25.356050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36c63620-abd4-4081-a339-938a164a3c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112028b10>]}
[0m13:59:25.387627 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:59:25.426602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:59:25.427008 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m13:59:25.446089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36c63620-abd4-4081-a339-938a164a3c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a15e10>]}
[0m13:59:25.451508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36c63620-abd4-4081-a339-938a164a3c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b7f3d0>]}
[0m13:59:25.451722 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m13:59:25.451897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36c63620-abd4-4081-a339-938a164a3c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112859710>]}
[0m13:59:25.452558 [info ] [MainThread]: 
[0m13:59:25.452934 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:59:25.453447 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:59:25.458492 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:59:25.458713 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:59:25.458838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:25.458967 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:59:28.863718 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m13:59:29.138649 [debug] [ThreadPool]: On list_None: Close
[0m13:59:29.483480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:59:29.491756 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:59:29.492285 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:59:29.492598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:29.492921 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:59:33.141487 [debug] [ThreadPool]: SQL status: OK in 4.0 seconds
[0m13:59:33.154163 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:59:33.154721 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:59:33.424921 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:59:33.799602 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:59:34.085730 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:59:34.399447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36c63620-abd4-4081-a339-938a164a3c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112085cd0>]}
[0m13:59:34.400323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:34.400616 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:59:37.341166 [debug] [MainThread]: On master: COMMIT
[0m13:59:37.343360 [debug] [MainThread]: Using oracle connection "master"
[0m13:59:37.343959 [debug] [MainThread]: On master: COMMIT
[0m13:59:37.599872 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:59:37.601576 [debug] [MainThread]: On master: Close
[0m13:59:37.863586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:37.864885 [info ] [MainThread]: 
[0m13:59:37.879271 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m13:59:37.879974 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:59:37.880659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m13:59:37.880912 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:59:37.895810 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:59:37.896752 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:59:37.881068 => 13:59:37.896640
[0m13:59:37.896935 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:59:37.905128 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m13:59:37.905388 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m13:59:37.915125 [info ] [Thread-1 (]: Python model materialization is table
[0m13:59:37.915433 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:59:40.692015 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:59:40.693364 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczODQ3NzksImlhdCI6MTY4NzM4MTE3OX0.AJZt_H3UG1HZ3jas-FjgNDjNWtpgQjMKBLAFB4jLcCXucdJEx0HHi2CVIAv4I0r3mjbg_DjS7bN8A2iEafsHFio4ilfik2Q__q2WqBFYSYqDDR5xuWIaFWgsFncuc3PhiOdlRlpFQlafwdWJRMshflhb75z3L5QXbMQeiOiH4IM83Ncmue6DOOunR6dsoLbqnU_9iPo6VEwinI9GCxvCk_nakscKDy21scMd_sWU15zd1cx9z-V6J4exBNdZwuWueHefvaJqWSviDjARF3IGTeieMkYphnRASFyf7zTG3a95Cmo1gu5jigidB6gSzgW4LNDbsktpZQtOyR9FnShutg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        s_df = s_df.pull()
        # med = s_df["user_id"].median()
    
        # diff = (s_df["CUST_CREDIT_LIMIT"] - med)
    
        # s_df = s_df.concat({"diff_col": diff})
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_205940 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_205940';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:59:40.694209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:40.694709 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:00:08.082095 [debug] [Thread-1 (]: SQL status: OK in 27.0 seconds
[0m14:00:08.084534 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:00:08.106543 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:00:08.106902 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m14:00:08.389155 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:00:08.396593 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:00:08.397382 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m14:00:08.669410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:00:08.690504 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m14:00:08.691527 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:00:08.692255 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m14:00:09.004600 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:00:09.020078 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:00:09.020849 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:00:09.413215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:00:09.436323 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:59:37.897069 => 14:00:09.436145
[0m14:00:09.436789 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m14:00:09.724923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36c63620-abd4-4081-a339-938a164a3c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a9aa10>]}
[0m14:00:09.727011 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 31.84s]
[0m14:00:09.728065 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:00:09.732012 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:09.732842 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:00:13.266408 [debug] [MainThread]: On master: COMMIT
[0m14:00:13.268325 [debug] [MainThread]: Using oracle connection "master"
[0m14:00:13.269060 [debug] [MainThread]: On master: COMMIT
[0m14:00:13.560657 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:00:13.562620 [debug] [MainThread]: On master: Close
[0m14:00:13.866567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:13.868150 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:00:13.868862 [info ] [MainThread]: 
[0m14:00:13.871822 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 48.42 seconds (48.42s).
[0m14:00:13.875105 [debug] [MainThread]: Command end result
[0m14:00:13.889019 [info ] [MainThread]: 
[0m14:00:13.889431 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:13.889675 [info ] [MainThread]: 
[0m14:00:13.889922 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:00:13.890371 [debug] [MainThread]: Command `dbt run` succeeded at 14:00:13.890302 after 48.63 seconds
[0m14:00:13.890618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112017410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da6450>]}
[0m14:00:13.890860 [debug] [MainThread]: Flushing usage events
[0m14:09:39.083166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080bb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080bbfd0>]}


============================== 14:09:39.085377 | 39fa5a75-f874-41d2-b9ee-d27d5c6e3949 ==============================
[0m14:09:39.085377 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:09:39.085696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:09:39.127311 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:09:39.149498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39fa5a75-f874-41d2-b9ee-d27d5c6e3949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f0b10>]}
[0m14:09:39.155762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39fa5a75-f874-41d2-b9ee-d27d5c6e3949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087cd410>]}
[0m14:09:39.188221 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:09:39.215937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:09:39.216246 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m14:09:39.235326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39fa5a75-f874-41d2-b9ee-d27d5c6e3949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b2010>]}
[0m14:09:39.240738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39fa5a75-f874-41d2-b9ee-d27d5c6e3949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108835590>]}
[0m14:09:39.240943 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:09:39.241125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39fa5a75-f874-41d2-b9ee-d27d5c6e3949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087fc650>]}
[0m14:09:39.241807 [info ] [MainThread]: 
[0m14:09:39.242186 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:09:39.242742 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:09:39.247777 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:09:39.248055 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:09:39.248188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:39.248324 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:09:40.907910 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:09:41.009599 [debug] [ThreadPool]: On list_None: Close
[0m14:09:41.124594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:09:41.130530 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:09:41.131013 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:09:41.131200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:41.131338 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:09:42.490618 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:09:42.508739 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:09:42.509487 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:09:42.630502 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:42.827287 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:09:42.925085 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:09:43.033246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39fa5a75-f874-41d2-b9ee-d27d5c6e3949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f03d0>]}
[0m14:09:43.034255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:43.034981 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:09:44.373161 [debug] [MainThread]: On master: COMMIT
[0m14:09:44.374487 [debug] [MainThread]: Using oracle connection "master"
[0m14:09:44.375198 [debug] [MainThread]: On master: COMMIT
[0m14:09:44.476316 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:44.477599 [debug] [MainThread]: On master: Close
[0m14:09:44.590353 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:09:44.593399 [info ] [MainThread]: 
[0m14:09:44.613548 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m14:09:44.614142 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:09:44.614804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m14:09:44.615255 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:09:44.629790 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:09:44.630950 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:09:44.615543 => 14:09:44.630749
[0m14:09:44.631262 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:09:44.642322 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m14:09:44.642689 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m14:09:44.655427 [info ] [Thread-1 (]: Python model materialization is table
[0m14:09:44.655968 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:09:47.152985 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:09:47.155683 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczODUzODYsImlhdCI6MTY4NzM4MTc4Nn0.jfPRKspwK0UKzL-b_4hGRK5zeW5-1_69GcRJMx-rZhv_SgvpPaLbs2f8skYwjKfZb6QEOpxXRJce_LrJD0dx-Mr94ec5bev16rpyZxJ06y98fZl_V5tIB3qoLowANqfTzU7cKuPdTeWGRJzmm0L3_dlI8rwUE_56ZJURTVhionc6ssD5jIhf42SoohJRhwagk7yVk1zv6P4RBi_7p5Y8IqV9If7SDA02-N81cE9xf6nd909UKHqcquhsKro0e-_fMEZ85MoWCvyDOVLda5XcjOJ05wpyJWmWX_iPLku9-TlKQVZW2XJm-DJKqQqs1cGdbqaV5jqXYA6xmSFnYMWtqw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        s_df = s_df.pull()
        med = s_df["USER_ID"].median()
    
        # diff = (s_df["CUST_CREDIT_LIMIT"] - med)
    
        # s_df = s_df.concat({"diff_col": diff})
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_210947 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_210947';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:09:47.156961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:47.157713 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:10:13.033664 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m14:10:13.037858 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:10:13.050710 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:10:13.051157 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m14:10:13.244235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:13.251111 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:10:13.251690 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m14:10:13.432735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:13.446804 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m14:10:13.447376 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:10:13.447741 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m14:10:13.599515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:13.603516 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:10:13.603794 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:10:13.797470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:13.815064 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:09:44.631406 => 14:10:13.814864
[0m14:10:13.815583 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m14:10:13.992152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39fa5a75-f874-41d2-b9ee-d27d5c6e3949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a34710>]}
[0m14:10:13.993416 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 29.38s]
[0m14:10:13.994307 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:10:13.996444 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:13.996900 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:10:16.055682 [debug] [MainThread]: On master: COMMIT
[0m14:10:16.057795 [debug] [MainThread]: Using oracle connection "master"
[0m14:10:16.058690 [debug] [MainThread]: On master: COMMIT
[0m14:10:16.192179 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:16.193057 [debug] [MainThread]: On master: Close
[0m14:10:16.338654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:16.339717 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:10:16.340266 [info ] [MainThread]: 
[0m14:10:16.340929 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 37.10 seconds (37.10s).
[0m14:10:16.341855 [debug] [MainThread]: Command end result
[0m14:10:16.357143 [info ] [MainThread]: 
[0m14:10:16.357767 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:16.358145 [info ] [MainThread]: 
[0m14:10:16.358533 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:10:16.359257 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:16.359148 after 37.32 seconds
[0m14:10:16.359655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2b090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494e8d0>]}
[0m14:10:16.360032 [debug] [MainThread]: Flushing usage events
[0m14:10:32.971907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ff950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440bfd0>]}


============================== 14:10:32.974473 | 16243d7d-0c32-4413-a43c-9d55aa1964ee ==============================
[0m14:10:32.974473 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:10:32.974804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:10:33.014487 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:10:33.036848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16243d7d-0c32-4413-a43c-9d55aa1964ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440bad0>]}
[0m14:10:33.043117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16243d7d-0c32-4413-a43c-9d55aa1964ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1d850>]}
[0m14:10:33.074731 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:10:33.102290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:10:33.102579 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m14:10:33.121182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16243d7d-0c32-4413-a43c-9d55aa1964ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b4c850>]}
[0m14:10:33.126536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16243d7d-0c32-4413-a43c-9d55aa1964ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9be90>]}
[0m14:10:33.126727 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:10:33.126900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16243d7d-0c32-4413-a43c-9d55aa1964ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3af90>]}
[0m14:10:33.127533 [info ] [MainThread]: 
[0m14:10:33.127904 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:10:33.128351 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:10:33.133262 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:10:33.133504 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:10:33.133631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:33.133762 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:10:34.671409 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:10:34.789876 [debug] [ThreadPool]: On list_None: Close
[0m14:10:34.905382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:10:34.912897 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:10:34.913312 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:10:34.913606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:34.913905 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:10:36.409686 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:10:36.424678 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:10:36.425230 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:10:36.559941 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:36.780827 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:10:36.887790 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:10:37.011310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16243d7d-0c32-4413-a43c-9d55aa1964ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b85390>]}
[0m14:10:37.011995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:37.012331 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:10:40.403935 [debug] [MainThread]: On master: COMMIT
[0m14:10:40.405940 [debug] [MainThread]: Using oracle connection "master"
[0m14:10:40.406694 [debug] [MainThread]: On master: COMMIT
[0m14:10:40.549444 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:40.551207 [debug] [MainThread]: On master: Close
[0m14:10:40.692240 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:10:40.694146 [info ] [MainThread]: 
[0m14:10:40.701191 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m14:10:40.701972 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:10:40.702910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m14:10:40.703299 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:10:40.724126 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:10:40.725848 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:10:40.703537 => 14:10:40.725619
[0m14:10:40.726208 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:10:40.736621 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m14:10:40.736948 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m14:10:40.745318 [info ] [Thread-1 (]: Python model materialization is table
[0m14:10:40.745627 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:10:42.878163 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:10:42.878847 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczODU0NDEsImlhdCI6MTY4NzM4MTg0MX0.A4477GkzAYPVwFDV7iSkLtNC4A_E6tzQu20r1oKngdPJqiuUN1fwfbX2xEZXzgW56l4FVIWRmWiBiqYCuModn5tvlBG3oP2sf9aJdu0k-StFYua9kUe3MycOnzSa7nWgR-h3IE4KLKtQ4ju4y_WTsvhfujtcTFF6ylo9L4m4p_wv86R4pBUOl_371Rd2nVDCrHj-77OlNKpHp8NhYdSR9ZQh0j6TUY2aDzHwGkTFvSjqX7Sqo9DYp5FOmsnar9aFTNIfQWZHRVXOOgM5Qo66GyYj--iBZXT9TGC9WOoOrp6lznNM1__3K0z2dEjDthLg705e72ANDY5wX8HmdrbRVg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        s_df = s_df.pull()
        med = s_df["USER_ID"].median()
    
        diff = (s_df["CUST_CREDIT_LIMIT"] - med)
    
        s_df = s_df.concat({"diff_col": diff})
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211042 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211042';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:10:42.879306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:42.879546 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:10:45.997986 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m14:10:45.999683 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m14:10:46.154532 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:10:40.726380 => 14:10:46.153135
[0m14:10:46.167423 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m14:10:46.169935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16243d7d-0c32-4413-a43c-9d55aa1964ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f0350>]}
[0m14:10:46.170703 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 5.47s]
[0m14:10:46.171304 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:10:46.173579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:46.174157 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:10:47.732317 [debug] [MainThread]: On master: COMMIT
[0m14:10:47.732970 [debug] [MainThread]: Using oracle connection "master"
[0m14:10:47.733277 [debug] [MainThread]: On master: COMMIT
[0m14:10:47.853052 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:47.853459 [debug] [MainThread]: On master: Close
[0m14:10:47.976665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:47.977052 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:10:47.977450 [info ] [MainThread]: 
[0m14:10:47.977972 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.85 seconds (14.85s).
[0m14:10:47.978583 [debug] [MainThread]: Command end result
[0m14:10:47.993872 [info ] [MainThread]: 
[0m14:10:47.994363 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:10:47.994526 [info ] [MainThread]: 
[0m14:10:47.994689 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m14:10:47.994851 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m14:10:47.995101 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m14:10:47.995282 [info ] [MainThread]: 
[0m14:10:47.995486 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:10:47.995934 [debug] [MainThread]: Command `dbt run` failed at 14:10:47.995863 after 15.04 seconds
[0m14:10:47.996246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d2a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d40cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d42b10>]}
[0m14:10:47.996428 [debug] [MainThread]: Flushing usage events
[0m14:11:20.796876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8bdd0>]}


============================== 14:11:20.799088 | 6e95f50b-0227-4c09-8360-2a29a8d161bb ==============================
[0m14:11:20.799088 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:11:20.799405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:11:20.840175 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:11:20.862364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e95f50b-0227-4c09-8360-2a29a8d161bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd01d0>]}
[0m14:11:20.868647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e95f50b-0227-4c09-8360-2a29a8d161bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669d550>]}
[0m14:11:20.900622 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:11:20.928324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:20.928626 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m14:11:20.947259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e95f50b-0227-4c09-8360-2a29a8d161bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651c310>]}
[0m14:11:20.960842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e95f50b-0227-4c09-8360-2a29a8d161bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106850250>]}
[0m14:11:20.961058 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:11:20.961233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e95f50b-0227-4c09-8360-2a29a8d161bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb93d0>]}
[0m14:11:20.961887 [info ] [MainThread]: 
[0m14:11:20.962264 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:11:20.962762 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:11:20.967716 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:11:20.967955 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:11:20.968086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:20.968217 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:11:23.017659 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:11:23.153549 [debug] [ThreadPool]: On list_None: Close
[0m14:11:23.310024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:11:23.317119 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:11:23.317459 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:11:23.317716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:23.317989 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:11:25.106645 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:11:25.117930 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:11:25.118488 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:11:25.284247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:25.518580 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:11:25.644738 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:11:25.798256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e95f50b-0227-4c09-8360-2a29a8d161bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fad90>]}
[0m14:11:25.798836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:25.799175 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:11:30.120814 [debug] [MainThread]: On master: COMMIT
[0m14:11:30.122913 [debug] [MainThread]: Using oracle connection "master"
[0m14:11:30.123792 [debug] [MainThread]: On master: COMMIT
[0m14:11:30.253450 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:30.255112 [debug] [MainThread]: On master: Close
[0m14:11:30.389550 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:30.391143 [info ] [MainThread]: 
[0m14:11:30.398119 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m14:11:30.398809 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:11:30.399795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m14:11:30.400174 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:11:30.416801 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:11:30.417673 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:11:30.400441 => 14:11:30.417547
[0m14:11:30.417874 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:11:30.428432 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m14:11:30.428648 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m14:11:30.436619 [info ] [Thread-1 (]: Python model materialization is table
[0m14:11:30.436953 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:11:33.009506 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:11:33.011350 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczODU0OTEsImlhdCI6MTY4NzM4MTg5MX0.VE2HAQKhdRf_7A2kh4K6lqRk9l1kq3tot_jqwXR_mnwu1_2CBed6CVD5tt2TLBvinpAlj5QU4Xn-FIFVpPxqMyhca63Bd3-_LGBbTp_aSS8S5Ap8XD7edshd-q2O_Uh2GOTy53o9b506iMDTYKqoNLIiRR-5YJDN9nsN3VRI_VFHv-h7hOGrAYp72GWx0Z3nKkKVArnowb7abdYb-GUNR2KOc9Mwf471YrHyIXk4DVe9U-LMwf9U37N-V57q61u14XXSEwgZabKSnvM9dHJx228tXTfeTIBzmPO3vePYqSN-PEhfzks_IIF7OSO5MMiKIBfU1ctdldjLOv4pJKDu5g!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        s_df = s_df.pull()
        med = s_df["USER_ID"].median()
    
        diff = (s_df["USER_ID"] - med)
    
        s_df = s_df.concat({"diff_col": diff})
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211133 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211133';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:11:33.012681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:33.013292 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:11:58.304483 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"'DataFrame' object has no attribute 'concat' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 63, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/generic.py\", line 5487, in __getattr__\n    return object.__getattribute__(self, name)\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 90
[0m14:11:58.307837 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m14:11:58.432698 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:11:30.417973 => 14:11:58.431267
[0m14:11:58.444808 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"'DataFrame' object has no attribute 'concat' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 63, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/generic.py\", line 5487, in __getattr__\n    return object.__getattribute__(self, name)\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 90
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m14:11:58.447200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e95f50b-0227-4c09-8360-2a29a8d161bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069859d0>]}
[0m14:11:58.447886 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 28.05s]
[0m14:11:58.448467 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:11:58.450388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:58.450749 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:12:00.579657 [debug] [MainThread]: On master: COMMIT
[0m14:12:00.581663 [debug] [MainThread]: Using oracle connection "master"
[0m14:12:00.582409 [debug] [MainThread]: On master: COMMIT
[0m14:12:00.693264 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:00.694850 [debug] [MainThread]: On master: Close
[0m14:12:00.815254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:00.816510 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:12:00.817106 [info ] [MainThread]: 
[0m14:12:00.817667 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 39.85 seconds (39.85s).
[0m14:12:00.818523 [debug] [MainThread]: Command end result
[0m14:12:00.834812 [info ] [MainThread]: 
[0m14:12:00.835355 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:12:00.835621 [info ] [MainThread]: 
[0m14:12:00.835874 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m14:12:00.836157 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"'DataFrame' object has no attribute 'concat' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 63, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/generic.py\", line 5487, in __getattr__\n    return object.__getattribute__(self, name)\n"}
[0m14:12:00.836431 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m14:12:00.836656 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m14:12:00.836873 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:12:00.837089 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:12:00.837305 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:12:00.837520 [error] [MainThread]:   ORA-06512: at line 90
[0m14:12:00.837735 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m14:12:00.837961 [info ] [MainThread]: 
[0m14:12:00.838228 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:12:00.838838 [debug] [MainThread]: Command `dbt run` failed at 14:12:00.838743 after 40.06 seconds
[0m14:12:00.839223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bfb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f45fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10680c150>]}
[0m14:12:00.839536 [debug] [MainThread]: Flushing usage events
[0m14:13:22.813190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105517f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105517fd0>]}


============================== 14:13:22.815696 | eaf7aaa5-294b-45a0-951d-e4a7b76417b9 ==============================
[0m14:13:22.815696 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:13:22.816049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:13:22.856999 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:13:22.879475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaf7aaa5-294b-45a0-951d-e4a7b76417b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105508fd0>]}
[0m14:13:22.885579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eaf7aaa5-294b-45a0-951d-e4a7b76417b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106326bd0>]}
[0m14:13:22.916318 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:13:22.951699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:13:22.952009 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m14:13:22.970878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eaf7aaa5-294b-45a0-951d-e4a7b76417b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064dbb90>]}
[0m14:13:22.976380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eaf7aaa5-294b-45a0-951d-e4a7b76417b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d1110>]}
[0m14:13:22.976576 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:13:22.976754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaf7aaa5-294b-45a0-951d-e4a7b76417b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d3690>]}
[0m14:13:22.977399 [info ] [MainThread]: 
[0m14:13:22.977772 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:13:22.978288 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:13:22.983193 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:13:22.983459 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:13:22.983596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:22.983736 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:13:24.536314 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:13:24.648537 [debug] [ThreadPool]: On list_None: Close
[0m14:13:24.758179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:13:24.765985 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:13:24.766379 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:13:24.766680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:24.766993 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:13:26.143642 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:13:26.155136 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:13:26.155736 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:13:26.281504 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:26.491748 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:13:26.599143 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:13:26.708780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaf7aaa5-294b-45a0-951d-e4a7b76417b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105560950>]}
[0m14:13:26.709310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:26.709636 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:13:27.990323 [debug] [MainThread]: On master: COMMIT
[0m14:13:27.992364 [debug] [MainThread]: Using oracle connection "master"
[0m14:13:27.992880 [debug] [MainThread]: On master: COMMIT
[0m14:13:28.094354 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:28.096348 [debug] [MainThread]: On master: Close
[0m14:13:28.206260 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:13:28.207719 [info ] [MainThread]: 
[0m14:13:28.214905 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m14:13:28.215646 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:13:28.216578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m14:13:28.217327 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:13:28.236806 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:13:28.237711 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:13:28.217658 => 14:13:28.237608
[0m14:13:28.237897 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:13:28.248524 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m14:13:28.248794 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m14:13:28.257988 [info ] [Thread-1 (]: Python model materialization is table
[0m14:13:28.258320 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:13:30.763326 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:13:30.764273 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczODU2MDksImlhdCI6MTY4NzM4MjAwOX0.pkTkjW3TtMPQlt-rNcnI8C3NKQAozIRGRX7arlEjZ3YFRQCwC7LyLR4AhltUbJL1-g880CV_Z0EI1edb7fbtuyt3iEZNGbzbY3qnPxBaRZMhRCqJtrtW8uneF3AolYf2Z53ZEvidQOi7d8Eb5nT7cbGB_-NbD8p4gsdggSUgoq7epVym2NWe8PQGpRjTzFGRAUaGAio_lTULHnGAbn4xJOQRqhW6GoAhY-4oRMpmySzo3mOYvV2cX7cyB68064x8lE8d8l_TKpFbjsIKtxZ_URLqgz1Q8GSei-Tl6Rs3ChRA08wB79ny22kl5N27BNvW09ZfuZV12iiaoU4JXa4Fmg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        #s_df = s_df.pull()
        med = s_df["USER_ID"].median()
    
        diff = (s_df["USER_ID"] - med)
    
        s_df = s_df.concat({"diff_col": diff})
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211330 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211330';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:13:30.765061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:30.765623 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:13:55.794127 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m14:13:55.798090 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:13:55.812736 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:13:55.813298 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m14:13:55.925240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:55.932566 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:13:55.933302 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m14:13:56.044789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:56.060618 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m14:13:56.060915 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:13:56.061123 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m14:13:56.163933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:56.170331 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:13:56.170750 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:13:56.352111 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:56.370863 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:13:28.238013 => 14:13:56.370642
[0m14:13:56.371422 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m14:13:56.485539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaf7aaa5-294b-45a0-951d-e4a7b76417b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632e750>]}
[0m14:13:56.486701 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 28.27s]
[0m14:13:56.487413 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:13:56.489615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:56.490134 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:13:57.839505 [debug] [MainThread]: On master: COMMIT
[0m14:13:57.840945 [debug] [MainThread]: Using oracle connection "master"
[0m14:13:57.841481 [debug] [MainThread]: On master: COMMIT
[0m14:13:57.946314 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:57.948063 [debug] [MainThread]: On master: Close
[0m14:13:58.058114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:58.059175 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:13:58.059775 [info ] [MainThread]: 
[0m14:13:58.060651 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 35.08 seconds (35.08s).
[0m14:13:58.061700 [debug] [MainThread]: Command end result
[0m14:13:58.071961 [info ] [MainThread]: 
[0m14:13:58.072543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:13:58.072864 [info ] [MainThread]: 
[0m14:13:58.073198 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:13:58.073888 [debug] [MainThread]: Command `dbt run` succeeded at 14:13:58.073787 after 35.28 seconds
[0m14:13:58.074270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1011ce850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1011ce450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101332b10>]}
[0m14:13:58.074622 [debug] [MainThread]: Flushing usage events
[0m14:14:50.446041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106173f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10617fdd0>]}


============================== 14:14:50.448399 | 18a0afff-e41d-4382-91dd-563d671ca275 ==============================
[0m14:14:50.448399 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:14:50.448725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:14:50.489350 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:14:50.511585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106190910>]}
[0m14:14:50.517638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106891a50>]}
[0m14:14:50.556634 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:14:51.097777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:14:51.098498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:14:51.107185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10695b850>]}
[0m14:14:51.118591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b3510>]}
[0m14:14:51.118970 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:14:51.119313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0ff90>]}
[0m14:14:51.121096 [info ] [MainThread]: 
[0m14:14:51.121834 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:14:51.123456 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:14:51.131661 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:14:51.132003 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:14:51.132218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:51.132672 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:14:53.281696 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:14:53.446293 [debug] [ThreadPool]: On list_None: Close
[0m14:14:53.611116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:14:53.618028 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:14:53.618422 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:14:53.618721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:53.619029 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:14:55.562603 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:14:55.574321 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:14:55.574817 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:14:55.768906 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:14:56.040971 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:14:56.210899 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:14:56.386474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105181e90>]}
[0m14:14:56.387401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:56.387828 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:14:58.190714 [debug] [MainThread]: On master: COMMIT
[0m14:14:58.192533 [debug] [MainThread]: Using oracle connection "master"
[0m14:14:58.192990 [debug] [MainThread]: On master: COMMIT
[0m14:14:58.342793 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:14:58.343211 [debug] [MainThread]: On master: Close
[0m14:14:58.511461 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:14:58.512195 [info ] [MainThread]: 
[0m14:14:58.519279 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:14:58.519925 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:14:58.520501 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:14:58.521145 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_python
[0m14:14:58.521772 [info ] [Thread-1 (]: 1 of 11 START sql incremental model FAWDBTCORE.stg_mobile_events ............... [RUN]
[0m14:14:58.522353 [info ] [Thread-2 (]: 2 of 11 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:14:58.522995 [info ] [Thread-3 (]: 3 of 11 START sql incremental model FAWDBTCORE.stg_web_events .................. [RUN]
[0m14:14:58.523804 [info ] [Thread-4 (]: 4 of 11 START python table model FAWDBTCORE.web_events_python .................. [RUN]
[0m14:14:58.524406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:14:58.524819 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:14:58.525191 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:14:58.525621 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:14:58.525871 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:14:58.526228 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:14:58.526559 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:14:58.526866 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:14:58.539947 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:14:58.542543 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:14:58.545814 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:14:58.559920 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:14:58.561213 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:14:58.546107 => 14:14:58.561019
[0m14:14:58.561503 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:14:58.571604 [debug] [Thread-4 (]: Preexisting intermediate relation=None
[0m14:14:58.572048 [debug] [Thread-4 (]: Preexisting backup relation=None
[0m14:14:58.572306 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:14:58.542859 => 14:14:58.572201
[0m14:14:58.572509 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:14:58.540328 => 14:14:58.572407
[0m14:14:58.572685 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:14:58.527099 => 14:14:58.572608
[0m14:14:58.582377 [info ] [Thread-4 (]: Python model materialization is table
[0m14:14:58.582754 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:14:58.583017 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:14:58.583232 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:14:58.583451 [debug] [Thread-4 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:14:58.597603 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:14:58.604898 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:14:58.607035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:58.607382 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:14:58.607633 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:14:58.617570 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:14:58.617801 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:15:00.388184 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:15:00.390481 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

        
  
    
      create global temporary table o$pt_stg_web_events141458597200
      on commit preserve rows
      
      as
        


with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  created_at
    FROM FAWDBTCORE.web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned



  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.stg_web_events)


  
      
[0m14:15:00.414498 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:15:00.415185 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

        
  
    
      create global temporary table o$pt_stg_mobile_events141458606597
      on commit preserve rows
      
      as
        


with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  created_at
FROM FAWDBTCORE.mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned





  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.stg_mobile_events)


  
      
[0m14:15:00.422306 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m14:15:00.422835 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users
)

select * from users_cleaned


[0m14:15:00.592388 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:15:00.603175 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m14:15:00.604120 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m14:15:00.604537 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m14:15:00.750493 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:15:00.769490 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m14:15:00.770500 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:15:00.915334 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:15:00.946416 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:14:58.597779 => 14:15:00.946264
[0m14:15:00.946830 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:15:01.105027 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:15:01.106398 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczODU2OTksImlhdCI6MTY4NzM4MjA5OX0.hT6h-xrDC8z3T5pGK9wNKvPy8yW1qqrkMAV6OE2ZeEqGOvGZzrtnJ8yKutSHYYExiVy_O3-PGCUNXECOyES9GCgVIVdW4Gp82F7fQvNJIyhA4b5PX3sgdOzew8CXo1IiqlDlnL1qHP8KTmJ6rMHViEq4ByiUxss6LEEpTde1NDv9Up6HSaEFAvUYfiBJiEcskECWLyDPfyEWRktgpcVU9p76wkY3U5E5V2CEVISAZOgw1srl_CAute-J5JoEF-g5yU-r4xhrom23LmlzrT86PGRtYDdMKKi0XBNBeJ6Nf9tgqTCB0xmCDDMRS_q8coTPn6LnS6oV5zFviEUbz6aeOA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        #s_df = s_df.pull()
        med = s_df["USER_ID"].median()
    
        diff = (s_df["USER_ID"] - med)
    
        s_df = s_df.concat({"diff_col": diff})
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211501 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211501';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:15:01.107449 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:15:01.110858 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fa610>]}
[0m14:15:01.111565 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:15:01.112527 [info ] [Thread-2 (]: 2 of 11 OK created sql view model FAWDBTCORE.stg_users ......................... [[32mOK[0m in 2.59s]
[0m14:15:01.115338 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:15:01.314704 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:15:01.334373 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:15:01.335086 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_mobile_events141458606597')
        
      order by ordinal_position

  
[0m14:15:01.656227 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:01.824406 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:15:01.826625 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_mobile_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:15:02.088795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:02.286560 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:15:02.287380 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_MOBILE_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:15:02.562870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:02.781231 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:15:02.783143 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:15:02.783457 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      merge  into FAWDBTCORE.stg_mobile_events DBT_INTERNAL_DEST
          using o$pt_stg_mobile_events141458606597 DBT_INTERNAL_SOURCE
          on (
            DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
        )
        when matched then
          update set
          DBT_INTERNAL_DEST.EVENT_TYPE = DBT_INTERNAL_SOURCE.EVENT_TYPE, 
          DBT_INTERNAL_DEST.EVENT_TIMESTAMP = DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
          DBT_INTERNAL_DEST.USER_ID = DBT_INTERNAL_SOURCE.USER_ID, 
          DBT_INTERNAL_DEST.APP_NAME = DBT_INTERNAL_SOURCE.APP_NAME, 
          DBT_INTERNAL_DEST.OPERATING_SYSTEM = DBT_INTERNAL_SOURCE.OPERATING_SYSTEM, 
          DBT_INTERNAL_DEST.COUNTRY = DBT_INTERNAL_SOURCE.COUNTRY, 
          DBT_INTERNAL_DEST.DURATION_SECONDS = DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
          DBT_INTERNAL_DEST.CONVERSION_STATUS = DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
          DBT_INTERNAL_DEST.CREATED_AT = DBT_INTERNAL_SOURCE.CREATED_AT
          when not matched then
          insert(EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, APP_NAME, OPERATING_SYSTEM, COUNTRY, DURATION_SECONDS, CONVERSION_STATUS, CREATED_AT)
          values(
            DBT_INTERNAL_SOURCE.EVENT_ID, 
            DBT_INTERNAL_SOURCE.EVENT_TYPE, 
            DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
            DBT_INTERNAL_SOURCE.USER_ID, 
            DBT_INTERNAL_SOURCE.APP_NAME, 
            DBT_INTERNAL_SOURCE.OPERATING_SYSTEM, 
            DBT_INTERNAL_SOURCE.COUNTRY, 
            DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
            DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
            DBT_INTERNAL_SOURCE.CREATED_AT
            )
  
[0m14:15:02.920227 [debug] [Thread-3 (]: SQL status: OK in 3.0 seconds
[0m14:15:02.925577 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:15:02.926755 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_events141458597200')
        
      order by ordinal_position

  
[0m14:15:03.289546 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:15:03.480141 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:15:03.481842 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:15:03.781998 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:15:04.013882 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:15:04.016871 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:15:04.316688 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:15:04.511848 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:15:04.515229 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:15:04.516003 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      merge  into FAWDBTCORE.stg_web_events DBT_INTERNAL_DEST
          using o$pt_stg_web_events141458597200 DBT_INTERNAL_SOURCE
          on (
            DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
        )
        when matched then
          update set
          DBT_INTERNAL_DEST.EVENT_TYPE = DBT_INTERNAL_SOURCE.EVENT_TYPE, 
          DBT_INTERNAL_DEST.EVENT_TIMESTAMP = DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
          DBT_INTERNAL_DEST.USER_ID = DBT_INTERNAL_SOURCE.USER_ID, 
          DBT_INTERNAL_DEST.PAGE_URL = DBT_INTERNAL_SOURCE.PAGE_URL, 
          DBT_INTERNAL_DEST.BROWSER = DBT_INTERNAL_SOURCE.BROWSER, 
          DBT_INTERNAL_DEST.DEVICE_TYPE = DBT_INTERNAL_SOURCE.DEVICE_TYPE, 
          DBT_INTERNAL_DEST.COUNTRY = DBT_INTERNAL_SOURCE.COUNTRY, 
          DBT_INTERNAL_DEST.DURATION_SECONDS = DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
          DBT_INTERNAL_DEST.CONVERSION_STATUS = DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
          DBT_INTERNAL_DEST.CREATED_AT = DBT_INTERNAL_SOURCE.CREATED_AT
          when not matched then
          insert(EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, PAGE_URL, BROWSER, DEVICE_TYPE, COUNTRY, DURATION_SECONDS, CONVERSION_STATUS, CREATED_AT)
          values(
            DBT_INTERNAL_SOURCE.EVENT_ID, 
            DBT_INTERNAL_SOURCE.EVENT_TYPE, 
            DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
            DBT_INTERNAL_SOURCE.USER_ID, 
            DBT_INTERNAL_SOURCE.PAGE_URL, 
            DBT_INTERNAL_SOURCE.BROWSER, 
            DBT_INTERNAL_SOURCE.DEVICE_TYPE, 
            DBT_INTERNAL_SOURCE.COUNTRY, 
            DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
            DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
            DBT_INTERNAL_SOURCE.CREATED_AT
            )
  
[0m14:15:04.644547 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m14:15:04.646151 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m14:15:04.646425 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:15:04.646623 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m14:15:04.830917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:04.841527 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:15:04.842133 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
truncate table o$pt_stg_mobile_events141458606597
[0m14:15:05.021129 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:05.031728 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:15:05.032833 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_mobile_events141458606597 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:15:05.233709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:05.240432 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:14:58.605140 => 14:15:05.239972
[0m14:15:05.241569 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:15:05.426689 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:15:05.777384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b17750>]}
[0m14:15:05.779950 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model FAWDBTCORE.stg_mobile_events .......... [[32mOK[0m in 7.25s]
[0m14:15:05.782487 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:15:23.653026 [debug] [Thread-4 (]: SQL status: OK in 23.0 seconds
[0m14:15:23.656162 [info ] [Thread-4 (]: oracle adapter: OK
[0m14:15:23.666300 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:15:23.666927 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m14:15:23.917580 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:15:23.924140 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:15:23.924666 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m14:15:24.219989 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:15:24.231049 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m14:15:24.231633 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:15:24.231978 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m14:15:24.527236 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:15:24.533981 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:15:24.534496 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:15:24.834487 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:15:24.836729 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:14:58.561683 => 14:15:24.836572
[0m14:15:24.837047 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_python: Close
[0m14:15:25.087926 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a2390>]}
[0m14:15:25.088894 [info ] [Thread-4 (]: 4 of 11 OK created python table model FAWDBTCORE.web_events_python ............. [[32mOK[0m in 26.56s]
[0m14:15:25.089490 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:15:33.073738 [debug] [Thread-3 (]: SQL status: OK in 29.0 seconds
[0m14:15:33.079229 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m14:15:33.079806 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:15:33.080126 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m14:15:33.325056 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:15:33.331778 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:15:33.332357 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
truncate table o$pt_stg_web_events141458597200
[0m14:15:33.538472 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:15:33.546911 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:15:33.547506 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_events141458597200 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:15:33.762730 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:15:33.769038 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:14:58.583569 => 14:15:33.768764
[0m14:15:33.769682 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:15:33.970915 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:15:34.193500 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e56590>]}
[0m14:15:34.195356 [info ] [Thread-3 (]: 3 of 11 OK created sql incremental model FAWDBTCORE.stg_web_events ............. [[32mOK[0m in 35.67s]
[0m14:15:34.196235 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:15:34.197480 [debug] [Thread-2 (]: Began running node model.oracle_dbt.combined_categorized_events
[0m14:15:34.198072 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:15:34.198490 [debug] [Thread-4 (]: Began running node model.oracle_dbt.most_active_mobile_users
[0m14:15:34.198900 [debug] [Thread-3 (]: Began running node model.oracle_dbt.most_frequent_browser
[0m14:15:34.199345 [info ] [Thread-2 (]: 5 of 11 START sql incremental model FAWDBTCORE.combined_categorized_events ..... [RUN]
[0m14:15:34.199909 [info ] [Thread-1 (]: 6 of 11 START sql view model FAWDBTCORE.mobile_event_durations ................. [RUN]
[0m14:15:34.200401 [info ] [Thread-4 (]: 7 of 11 START sql view model FAWDBTCORE.most_active_mobile_users ............... [RUN]
[0m14:15:34.201063 [info ] [Thread-3 (]: 8 of 11 START sql view model FAWDBTCORE.most_frequent_browser .................. [RUN]
[0m14:15:34.202111 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.combined_categorized_events)
[0m14:15:34.202891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m14:15:34.203501 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.web_events_python, now model.oracle_dbt.most_active_mobile_users)
[0m14:15:34.204106 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.most_frequent_browser)
[0m14:15:34.204476 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.combined_categorized_events
[0m14:15:34.204811 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m14:15:34.205117 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.most_active_mobile_users
[0m14:15:34.205414 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.most_frequent_browser
[0m14:15:34.210308 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.combined_categorized_events"
[0m14:15:34.212971 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m14:15:34.215546 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.most_active_mobile_users"
[0m14:15:34.218065 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.most_frequent_browser"
[0m14:15:34.231936 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.most_active_mobile_users (compile): 14:15:34.213196 => 14:15:34.231548
[0m14:15:34.232363 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 14:15:34.210667 => 14:15:34.232205
[0m14:15:34.232680 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.combined_categorized_events (compile): 14:15:34.205632 => 14:15:34.232555
[0m14:15:34.233089 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.most_frequent_browser (compile): 14:15:34.215792 => 14:15:34.232895
[0m14:15:34.233471 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.most_active_mobile_users
[0m14:15:34.233750 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m14:15:34.233998 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.combined_categorized_events
[0m14:15:34.234404 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.most_frequent_browser
[0m14:15:34.237166 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.most_active_mobile_users"
[0m14:15:34.239236 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m14:15:34.241825 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:15:34.243726 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.most_frequent_browser"
[0m14:15:34.244169 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:15:34.262942 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:15:34.263212 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:15:34.263662 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:15:34.263905 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:15:34.264257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:34.264481 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:15:36.607113 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.most_frequent_browser"
[0m14:15:36.608231 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.mobile_event_durations"
[0m14:15:36.621454 [debug] [Thread-3 (]: On model.oracle_dbt.most_frequent_browser: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_frequent_browser"} */

  
  create or replace view FAWDBTCORE.most_frequent_browser as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
),

web_users_names as (
      SELECT u.name, w.most_frequent_browser
FROM start_users_cleaned u
JOIN (
  SELECT w.user_id, w.browser AS most_frequent_browser
  FROM (
    SELECT user_id, browser, ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY COUNT(*) DESC) AS rn
    FROM start_web_events_cleaned
    GROUP BY user_id, browser
  ) w
  WHERE rn = 1
) w ON u.user_id = w.user_id
)

select * from web_users_names


[0m14:15:36.622749 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m14:15:36.798983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:36.800100 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:15:36.804963 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m14:15:36.805934 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.most_active_mobile_users"
[0m14:15:36.812272 [debug] [Thread-4 (]: On model.oracle_dbt.most_active_mobile_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_active_mobile_users"} */

  
  create or replace view FAWDBTCORE.most_active_mobile_users as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
),

mobile_users_names as (
    select start_users_cleaned.name, count(start_mobile_events_cleaned.event_id) as num_mobile_events
    from start_users_cleaned
    join start_mobile_events_cleaned on start_mobile_events_cleaned.user_id = start_users_cleaned.user_id
    group by start_users_cleaned.name
    ORDER BY num_mobile_events DESC
)

select * from mobile_users_names


[0m14:15:36.810299 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.mobile_event_durations"
[0m14:15:36.808573 [debug] [Thread-3 (]: On model.oracle_dbt.most_frequent_browser: COMMIT
[0m14:15:36.815038 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m14:15:36.815660 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.most_frequent_browser"
[0m14:15:36.816248 [debug] [Thread-3 (]: On model.oracle_dbt.most_frequent_browser: COMMIT
[0m14:15:36.972882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:36.979173 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.mobile_event_durations"
[0m14:15:36.981203 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:15:36.980427 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:15:36.979844 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:15:36.984866 [debug] [Thread-4 (]: On model.oracle_dbt.most_active_mobile_users: COMMIT
[0m14:15:36.992595 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.most_active_mobile_users"
[0m14:15:36.993322 [debug] [Thread-4 (]: On model.oracle_dbt.most_active_mobile_users: COMMIT
[0m14:15:36.994133 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.most_frequent_browser"
[0m14:15:36.994570 [debug] [Thread-3 (]: On model.oracle_dbt.most_frequent_browser: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_frequent_browser"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.most_frequent_browser__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:15:37.141474 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:15:37.153056 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.most_active_mobile_users"
[0m14:15:37.153903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:37.154536 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:15:37.155447 [debug] [Thread-4 (]: On model.oracle_dbt.most_active_mobile_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_active_mobile_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.most_active_mobile_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:15:37.161328 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 14:15:34.237378 => 14:15:37.160919
[0m14:15:37.164598 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.most_frequent_browser (execute): 14:15:34.241997 => 14:15:37.164319
[0m14:15:37.165870 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m14:15:37.166606 [debug] [Thread-3 (]: On model.oracle_dbt.most_frequent_browser: Close
[0m14:15:37.304661 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:15:37.314254 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.most_active_mobile_users (execute): 14:15:34.234612 => 14:15:37.313602
[0m14:15:37.323514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e20050>]}
[0m14:15:37.324405 [debug] [Thread-4 (]: On model.oracle_dbt.most_active_mobile_users: Close
[0m14:15:37.331825 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e6410>]}
[0m14:15:37.333008 [info ] [Thread-1 (]: 6 of 11 OK created sql view model FAWDBTCORE.mobile_event_durations ............ [[32mOK[0m in 3.12s]
[0m14:15:37.334758 [info ] [Thread-3 (]: 8 of 11 OK created sql view model FAWDBTCORE.most_frequent_browser ............. [[32mOK[0m in 3.13s]
[0m14:15:37.335874 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:15:37.336619 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.most_frequent_browser
[0m14:15:37.337224 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:15:37.338236 [info ] [Thread-1 (]: 9 of 11 START sql view model FAWDBTCORE.web_events_counts ...................... [RUN]
[0m14:15:37.339358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.mobile_event_durations, now model.oracle_dbt.web_events_counts)
[0m14:15:37.339868 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m14:15:37.344017 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m14:15:37.354386 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 14:15:37.340172 => 14:15:37.354029
[0m14:15:37.354907 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_counts
[0m14:15:37.359206 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m14:15:37.369303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:37.369697 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:15:37.427821 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:15:37.429578 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

        
  
    
      create global temporary table o$pt_combined_categorized_events141534241345
      on commit preserve rows
      
      as
        

with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM start_web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM start_mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
)


select * from combined_categorized_events



  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.combined_categorized_events)


  
      
[0m14:15:37.494616 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e22f10>]}
[0m14:15:37.496593 [info ] [Thread-4 (]: 7 of 11 OK created sql view model FAWDBTCORE.most_active_mobile_users .......... [[32mOK[0m in 3.29s]
[0m14:15:37.498778 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.most_active_mobile_users
[0m14:15:39.007401 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_counts"
[0m14:15:39.009246 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_counts: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_events_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_events_counts


[0m14:15:39.148107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:39.153426 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m14:15:39.154344 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_counts"
[0m14:15:39.154973 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m14:15:39.293217 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:39.312947 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_counts"
[0m14:15:39.314809 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_counts: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:15:39.453531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:39.458993 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 14:15:37.355139 => 14:15:39.458718
[0m14:15:39.459612 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_counts: Close
[0m14:15:39.610261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7ffd0>]}
[0m14:15:39.612410 [info ] [Thread-1 (]: 9 of 11 OK created sql view model FAWDBTCORE.web_events_counts ................. [[32mOK[0m in 2.27s]
[0m14:15:39.614332 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:16:04.568244 [debug] [Thread-2 (]: SQL status: OK in 27.0 seconds
[0m14:16:04.576035 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:16:04.577560 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_combined_categorized_events141534241345')
        
      order by ordinal_position

  
[0m14:16:05.060145 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:16:05.258021 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:16:05.259910 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('combined_categorized_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:16:05.551946 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:16:05.734909 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:16:05.737059 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('COMBINED_CATEGORIZED_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:16:05.975225 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:16:06.128902 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.combined_categorized_events"
[0m14:16:06.135547 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:16:06.135792 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      insert  into  FAWDBTCORE.combined_categorized_events (EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, PAGE_URL, BROWSER, DEVICE_TYPE, COUNTRY, DURATION_SECONDS, CREATED_AT, CONVERSION_STATUS, APP_NAME, PLATFORM, WEB_DURATION_SECONDS, MOBILE_DURATION_SECONDS)
    (
       select EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, PAGE_URL, BROWSER, DEVICE_TYPE, COUNTRY, DURATION_SECONDS, CREATED_AT, CONVERSION_STATUS, APP_NAME, PLATFORM, WEB_DURATION_SECONDS, MOBILE_DURATION_SECONDS
       from o$pt_combined_categorized_events141534241345
    )
  
[0m14:16:25.846872 [debug] [Thread-2 (]: SQL status: OK in 20.0 seconds
[0m14:16:25.852296 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: COMMIT
[0m14:16:25.852908 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:16:25.853273 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: COMMIT
[0m14:16:25.991129 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:16:25.998465 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:16:25.999445 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */
truncate table o$pt_combined_categorized_events141534241345
[0m14:16:26.131613 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:16:26.139003 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:16:26.139734 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_combined_categorized_events141534241345 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:16:26.317861 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:16:26.322809 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.combined_categorized_events (execute): 14:15:34.239416 => 14:16:26.322540
[0m14:16:26.323415 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: ROLLBACK
[0m14:16:26.450315 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: Close
[0m14:16:26.688580 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a23710>]}
[0m14:16:26.691159 [info ] [Thread-2 (]: 5 of 11 OK created sql incremental model FAWDBTCORE.combined_categorized_events  [[32mOK[0m in 52.49s]
[0m14:16:26.692280 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.combined_categorized_events
[0m14:16:26.693424 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:16:26.693982 [debug] [Thread-4 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:16:26.694530 [info ] [Thread-3 (]: 10 of 11 START sql view model FAWDBTCORE.average_duration_by_platform_country .. [RUN]
[0m14:16:26.695083 [info ] [Thread-4 (]: 11 of 11 START sql view model FAWDBTCORE.event_counts_by_platform .............. [RUN]
[0m14:16:26.695988 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.most_frequent_browser, now model.oracle_dbt.average_duration_by_platform_country)
[0m14:16:26.696677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.most_active_mobile_users, now model.oracle_dbt.event_counts_by_platform)
[0m14:16:26.697157 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m14:16:26.697541 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m14:16:26.701242 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m14:16:26.704469 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m14:16:26.725933 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 14:16:26.701691 => 14:16:26.725553
[0m14:16:26.726281 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 14:16:26.697800 => 14:16:26.726138
[0m14:16:26.726557 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m14:16:26.726789 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m14:16:26.728959 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m14:16:26.730413 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m14:16:26.736136 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:16:26.736305 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:16:26.742895 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:16:26.743068 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:16:28.862025 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country"
[0m14:16:28.863935 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.event_counts_by_platform"
[0m14:16:28.865222 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.combined_categorized_events
), 

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  ROUND(AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END), 2) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
ORDER BY platform
)

select * from average_duration_by_platform_country


[0m14:16:28.865741 [debug] [Thread-4 (]: On model.oracle_dbt.event_counts_by_platform: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with events as (

    select * from FAWDBTCORE.combined_categorized_events
),


event_counts_by_platform as (

    SELECT
  platform,
  COUNT(*) AS event_count
FROM events
GROUP BY platform
)

select * from event_counts_by_platform


[0m14:16:28.995152 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:16:29.000049 [debug] [Thread-4 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m14:16:29.001039 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:16:29.001507 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.event_counts_by_platform"
[0m14:16:29.002320 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m14:16:29.002503 [debug] [Thread-4 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m14:16:29.002651 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country"
[0m14:16:29.002958 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m14:16:29.125520 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:16:29.126815 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:16:29.133468 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.event_counts_by_platform"
[0m14:16:29.136721 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country"
[0m14:16:29.137159 [debug] [Thread-4 (]: On model.oracle_dbt.event_counts_by_platform: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:16:29.137601 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:16:29.260756 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:16:29.266835 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 14:16:26.726947 => 14:16:29.266588
[0m14:16:29.267249 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:16:29.267710 [debug] [Thread-4 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m14:16:29.269816 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 14:16:26.729100 => 14:16:29.269682
[0m14:16:29.270178 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m14:16:29.417994 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b43810>]}
[0m14:16:29.421161 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a0afff-e41d-4382-91dd-563d671ca275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e759d0>]}
[0m14:16:29.421860 [info ] [Thread-4 (]: 11 of 11 OK created sql view model FAWDBTCORE.event_counts_by_platform ......... [[32mOK[0m in 2.72s]
[0m14:16:29.422533 [info ] [Thread-3 (]: 10 of 11 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 2.73s]
[0m14:16:29.423548 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:16:29.424277 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:16:29.426706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:29.427191 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:16:30.915949 [debug] [MainThread]: On master: COMMIT
[0m14:16:30.917923 [debug] [MainThread]: Using oracle connection "master"
[0m14:16:30.918398 [debug] [MainThread]: On master: COMMIT
[0m14:16:31.058192 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:16:31.060308 [debug] [MainThread]: On master: Close
[0m14:16:31.204526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:31.205340 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m14:16:31.205688 [debug] [MainThread]: Connection 'model.oracle_dbt.combined_categorized_events' was properly closed.
[0m14:16:31.205993 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m14:16:31.206279 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m14:16:31.206764 [info ] [MainThread]: 
[0m14:16:31.207255 [info ] [MainThread]: Finished running 7 view models, 3 incremental models, 1 table model in 0 hours 1 minutes and 40.09 seconds (100.09s).
[0m14:16:31.209516 [debug] [MainThread]: Command end result
[0m14:16:31.221853 [info ] [MainThread]: 
[0m14:16:31.222371 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:31.222689 [info ] [MainThread]: 
[0m14:16:31.223006 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m14:16:31.223717 [debug] [MainThread]: Command `dbt run` succeeded at 14:16:31.223610 after 100.80 seconds
[0m14:16:31.224108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102952390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ab77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ab6b10>]}
[0m14:16:31.224446 [debug] [MainThread]: Flushing usage events
[0m16:04:47.390136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd3fd0>]}


============================== 16:04:47.392428 | b1c6dd86-a067-4f75-b1bd-ce1a655295d5 ==============================
[0m16:04:47.392428 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:04:47.392745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:04:47.435783 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m16:04:47.457973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1c6dd86-a067-4f75-b1bd-ce1a655295d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd3c50>]}
[0m16:04:47.464377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1c6dd86-a067-4f75-b1bd-ce1a655295d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ffc990>]}
[0m16:04:47.495833 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:04:47.523571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m16:04:47.524147 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/sources.yml
[0m16:04:47.524317 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m16:04:47.524445 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_web_events.sql
[0m16:04:47.533339 [debug] [MainThread]: 1699: static parser successfully parsed average_duration_by_platform_country.sql
[0m16:04:47.539438 [debug] [MainThread]: 1699: static parser successfully parsed event_counts_by_platform.sql
[0m16:04:47.541233 [debug] [MainThread]: 1603: static parser failed on combined_categorized_events.sql
[0m16:04:47.545222 [debug] [MainThread]: 1602: parser fallback to jinja rendering on combined_categorized_events.sql
[0m16:04:47.546280 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m16:04:47.548376 [debug] [MainThread]: 1699: static parser successfully parsed most_active_mobile_users.sql
[0m16:04:47.550344 [debug] [MainThread]: 1699: static parser successfully parsed most_frequent_browser.sql
[0m16:04:47.552284 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m16:04:47.554055 [debug] [MainThread]: 1603: static parser failed on staging/stg_web_events.sql
[0m16:04:47.556454 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_web_events.sql
[0m16:04:47.557404 [debug] [MainThread]: 1603: static parser failed on staging/stg_mobile_events.sql
[0m16:04:47.559684 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_mobile_events.sql
[0m16:04:47.575185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1c6dd86-a067-4f75-b1bd-ce1a655295d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104708ed0>]}
[0m16:04:47.581286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1c6dd86-a067-4f75-b1bd-ce1a655295d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c0410>]}
[0m16:04:47.581487 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m16:04:47.581656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c6dd86-a067-4f75-b1bd-ce1a655295d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c1850>]}
[0m16:04:47.582313 [info ] [MainThread]: 
[0m16:04:47.582701 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m16:04:47.583165 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m16:04:47.588191 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m16:04:47.588484 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m16:04:47.588618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:47.588750 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:04:49.080841 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m16:04:49.188198 [debug] [ThreadPool]: On list_None: Close
[0m16:04:49.293993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m16:04:49.301107 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m16:04:49.301602 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m16:04:49.301847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:49.302067 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:04:50.666259 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m16:04:50.678006 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m16:04:50.678537 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m16:04:50.804349 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:04:50.925260 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m16:04:51.027074 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m16:04:51.136627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c6dd86-a067-4f75-b1bd-ce1a655295d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fd7910>]}
[0m16:04:51.137288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:04:51.137542 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:04:52.376949 [debug] [MainThread]: On master: COMMIT
[0m16:04:52.378886 [debug] [MainThread]: Using oracle connection "master"
[0m16:04:52.379904 [debug] [MainThread]: On master: COMMIT
[0m16:04:52.481380 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:04:52.482716 [debug] [MainThread]: On master: Close
[0m16:04:52.594045 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:04:52.596102 [info ] [MainThread]: 
[0m16:04:52.605605 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m16:04:52.606315 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m16:04:52.607234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m16:04:52.607677 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m16:04:52.625947 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m16:04:52.627376 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 16:04:52.608030 => 16:04:52.627126
[0m16:04:52.627742 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m16:04:52.639437 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m16:04:52.639808 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m16:04:52.651174 [info ] [Thread-1 (]: Python model materialization is table
[0m16:04:52.651640 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m16:04:55.733998 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m16:04:55.735419 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczOTIyOTQsImlhdCI6MTY4NzM4ODY5NH0.qaNZw9bBn6ah5CMXguP8O-RsYHrVucOYKYAB1aTrVqTRyoCHNJF-tU75fUYXTqX8VGmHRiznh5bs_kmRTgRRfeMNG3SoRSwKBxHfY23wjNT__3dQPPeC2HWgN4QwR1idvOVHeWS0KvWexGTmmyN5JPY8YZAXUwbOw-mXU2AXS8XKV7BMXlKtuXwNE7fHP2VBDqw9rxIe6oCwyI03lwLr_9pbgdfn5HWJ8SfXXK-uTU3cSolegcCrwbvm-arFmY5KjFAHUFRgK-QMTftBzn_aWGNzzaGIZvV7YEh3-fLXn3JonYKYUD5CxI0QMFLOlsD5-wAnrykeK8tyNtTH0bK3aA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        # from sklearn.model_selection import train_test_split
        # from sklearn.preprocessing import LabelEncoder
        # from sklearn.tree import DecisionTreeClassifier
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
        X = df[['price']]  # Independent variable
        y = df['shipping_city']  # Dependent variable
    
        # Encode the categorical variable 'shipping_city'
        # label_encoder = LabelEncoder()
        # y_encoded = label_encoder.fit_transform(y)
    
        # # Split the data into training and testing sets
        # X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_230455 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_230455';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m16:04:55.736322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:55.736783 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:04:57.003776 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m16:04:57.007958 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m16:04:57.110597 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 16:04:52.627933 => 16:04:57.110158
[0m16:04:57.129717 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m16:04:57.132313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c6dd86-a067-4f75-b1bd-ce1a655295d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fbc10>]}
[0m16:04:57.133027 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 4.53s]
[0m16:04:57.133543 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m16:04:57.135588 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:04:57.136164 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:04:58.383507 [debug] [MainThread]: On master: COMMIT
[0m16:04:58.383858 [debug] [MainThread]: Using oracle connection "master"
[0m16:04:58.384017 [debug] [MainThread]: On master: COMMIT
[0m16:04:58.484884 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:04:58.485251 [debug] [MainThread]: On master: Close
[0m16:04:58.599206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:58.600233 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m16:04:58.600645 [info ] [MainThread]: 
[0m16:04:58.601035 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.02 seconds (11.02s).
[0m16:04:58.601615 [debug] [MainThread]: Command end result
[0m16:04:58.609779 [info ] [MainThread]: 
[0m16:04:58.610216 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:04:58.610501 [info ] [MainThread]: 
[0m16:04:58.610768 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m16:04:58.611022 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m16:04:58.611234 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m16:04:58.611447 [info ] [MainThread]: 
[0m16:04:58.611681 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:04:58.612121 [debug] [MainThread]: Command `dbt run` failed at 16:04:58.612052 after 11.24 seconds
[0m16:04:58.612395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100908cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100908d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104819f90>]}
[0m16:04:58.612650 [debug] [MainThread]: Flushing usage events
[0m16:05:46.419872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063dc690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063eff90>]}


============================== 16:05:46.422976 | d169cef8-0788-400f-afaa-d611b2471afd ==============================
[0m16:05:46.422976 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:05:46.423305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:05:46.473774 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m16:05:46.495703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd169cef8-0788-400f-afaa-d611b2471afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063cbf90>]}
[0m16:05:46.501585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd169cef8-0788-400f-afaa-d611b2471afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106459ad0>]}
[0m16:05:46.536188 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:05:46.594814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:05:46.595227 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m16:05:46.614759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd169cef8-0788-400f-afaa-d611b2471afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc5150>]}
[0m16:05:46.625136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd169cef8-0788-400f-afaa-d611b2471afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c19f90>]}
[0m16:05:46.625387 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m16:05:46.625572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd169cef8-0788-400f-afaa-d611b2471afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2cc90>]}
[0m16:05:46.626254 [info ] [MainThread]: 
[0m16:05:46.626645 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m16:05:46.627144 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m16:05:46.632173 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m16:05:46.632425 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m16:05:46.632562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:46.632686 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:05:48.170201 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m16:05:48.278167 [debug] [ThreadPool]: On list_None: Close
[0m16:05:48.395482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m16:05:48.402320 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m16:05:48.402737 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m16:05:48.403053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:48.403386 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:05:49.738850 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m16:05:49.751291 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m16:05:49.751859 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m16:05:49.887608 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:05:50.228112 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m16:05:50.331215 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m16:05:50.441583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd169cef8-0788-400f-afaa-d611b2471afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649eb50>]}
[0m16:05:50.442433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:50.442852 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:05:51.691597 [debug] [MainThread]: On master: COMMIT
[0m16:05:51.693608 [debug] [MainThread]: Using oracle connection "master"
[0m16:05:51.694557 [debug] [MainThread]: On master: COMMIT
[0m16:05:51.798354 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:05:51.799724 [debug] [MainThread]: On master: Close
[0m16:05:51.922453 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:05:51.923843 [info ] [MainThread]: 
[0m16:05:51.931709 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m16:05:51.932479 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m16:05:51.933430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m16:05:51.933798 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m16:05:51.953103 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m16:05:51.954089 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 16:05:51.934038 => 16:05:51.953976
[0m16:05:51.954286 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m16:05:51.962517 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m16:05:51.962774 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m16:05:51.973920 [info ] [Thread-1 (]: Python model materialization is table
[0m16:05:51.974381 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m16:05:56.653022 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m16:05:56.654817 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczOTIzNTUsImlhdCI6MTY4NzM4ODc1NX0.aQc9j-DPZhUgvpMJKn_8fgPw_X1aiHGheWqrM9UpyHjK_Mgo7nqH1lV6uhvn-BgiMIVh7pR4hcSLXDy5jeOOs3s_st6EwZwTl8dlAFHIrRCMaRTXhB8Um_fiqi4USvxPetztvkHaQjAvrp6tX94BAdt-u4q_pR9nI5dO0mXMt9OOcsTGUq5WXIs40SfXluY9W4pASzqwLw7eVgn0WxARAhvCi4FHmZXh_ygL5MPQagkaoNtCscldxPOEjS7Z02k00y2cJP5MHdIMKjNXqPbF0PtuNDIcSYuVVROig92g0ACG2D5OEObxweDNNz2jr7qu6COPX-rWsjx3TFISIgk8Kw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        # from sklearn.model_selection import train_test_split
        # from sklearn.preprocessing import LabelEncoder
        # from sklearn.tree import DecisionTreeClassifier
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
        #X = df[['price']]  # Independent variable
        #y = df['shipping_city']  # Dependent variable
    
        # Encode the categorical variable 'shipping_city'
        # label_encoder = LabelEncoder()
        # y_encoded = label_encoder.fit_transform(y)
    
        # # Split the data into training and testing sets
        # X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_230556 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_230556';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m16:05:56.656150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:56.656683 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:05:57.910372 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m16:05:57.912825 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m16:05:58.016321 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 16:05:51.954401 => 16:05:58.015807
[0m16:05:58.027640 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m16:05:58.029925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd169cef8-0788-400f-afaa-d611b2471afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de4610>]}
[0m16:05:58.030689 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 6.10s]
[0m16:05:58.031232 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m16:05:58.033304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:58.033766 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:05:59.277499 [debug] [MainThread]: On master: COMMIT
[0m16:05:59.279770 [debug] [MainThread]: Using oracle connection "master"
[0m16:05:59.280262 [debug] [MainThread]: On master: COMMIT
[0m16:05:59.390864 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:05:59.392517 [debug] [MainThread]: On master: Close
[0m16:05:59.509595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:59.510739 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m16:05:59.511388 [info ] [MainThread]: 
[0m16:05:59.511921 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.88 seconds (12.88s).
[0m16:05:59.512664 [debug] [MainThread]: Command end result
[0m16:05:59.528836 [info ] [MainThread]: 
[0m16:05:59.529401 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:05:59.529698 [info ] [MainThread]: 
[0m16:05:59.529969 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m16:05:59.530228 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m16:05:59.530469 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m16:05:59.530719 [info ] [MainThread]: 
[0m16:05:59.531001 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:05:59.531580 [debug] [MainThread]: Command `dbt run` failed at 16:05:59.531486 after 13.14 seconds
[0m16:05:59.531920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d22b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d20cd0>]}
[0m16:05:59.532212 [debug] [MainThread]: Flushing usage events
[0m16:06:44.455982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061dbd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e7f90>]}


============================== 16:06:44.458768 | ca7feafd-9518-4988-84ea-4d0ddc230eae ==============================
[0m16:06:44.458768 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:06:44.459120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:06:44.507125 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m16:06:44.530132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca7feafd-9518-4988-84ea-4d0ddc230eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f8950>]}
[0m16:06:44.536323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca7feafd-9518-4988-84ea-4d0ddc230eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad1b10>]}
[0m16:06:44.569779 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:06:44.604314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:06:44.604737 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m16:06:44.624838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca7feafd-9518-4988-84ea-4d0ddc230eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7ff10>]}
[0m16:06:44.631227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca7feafd-9518-4988-84ea-4d0ddc230eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e94310>]}
[0m16:06:44.631483 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m16:06:44.631682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca7feafd-9518-4988-84ea-4d0ddc230eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d16390>]}
[0m16:06:44.632384 [info ] [MainThread]: 
[0m16:06:44.632797 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m16:06:44.633290 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m16:06:44.638097 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m16:06:44.638307 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m16:06:44.638443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:44.638579 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:06:46.109963 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m16:06:46.213869 [debug] [ThreadPool]: On list_None: Close
[0m16:06:46.319292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m16:06:46.327189 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m16:06:46.327734 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m16:06:46.328082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:46.328408 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:06:47.811882 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m16:06:47.819315 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m16:06:47.819795 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m16:06:47.945796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:48.144163 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m16:06:48.245516 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m16:06:48.349655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca7feafd-9518-4988-84ea-4d0ddc230eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629add0>]}
[0m16:06:48.350036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:48.350209 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:06:49.629245 [debug] [MainThread]: On master: COMMIT
[0m16:06:49.630934 [debug] [MainThread]: Using oracle connection "master"
[0m16:06:49.631710 [debug] [MainThread]: On master: COMMIT
[0m16:06:49.735816 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:06:49.737216 [debug] [MainThread]: On master: Close
[0m16:06:49.856156 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:06:49.858680 [info ] [MainThread]: 
[0m16:06:49.888440 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m16:06:49.889161 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m16:06:49.890009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m16:06:49.890322 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m16:06:49.910325 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m16:06:49.911569 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 16:06:49.890522 => 16:06:49.911367
[0m16:06:49.911916 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m16:06:49.922974 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m16:06:49.923385 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m16:06:49.934989 [info ] [Thread-1 (]: Python model materialization is table
[0m16:06:49.935445 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m16:06:52.385422 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m16:06:52.387695 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczOTI0MTEsImlhdCI6MTY4NzM4ODgxMX0.huPIukwceXCKb6PlpGmj0inBIkxSysRaTG6CLx1-QnhVa7O2Yk6zZOiU84ucZhFiySYGPy0yJbaAQSDQSpE7TjAfZWd0OUTa81ypuQfSpfh0mdCPMyzVRzcBk52rtWL-cjqBV88buU--L1-OqU45P5WAdbPFqzmH15k2bFbOzl9uxt-pSCYhBK5RHgWsVOSnmDpIj6iDsFZnEVwOZJyN-j3i6lN2iO_TbGgtdJuj9f5V-2X21eGfSP1rTc5S7vI7FpZGhh5enOZ2Ybz78rv3Q4WfyjVUtbGG2wsKm3mk-yHgP-Jc5iw5MpUt5amUbBPa6Mqd4nOwsZvyVDPXteLYug!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    import oml
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        # from sklearn.model_selection import train_test_split
        # from sklearn.preprocessing import LabelEncoder
        # from sklearn.tree import DecisionTreeClassifier
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
        #X = df[['price']]  # Independent variable
        #y = df['shipping_city']  # Dependent variable
    
        # Encode the categorical variable 'shipping_city'
        # label_encoder = LabelEncoder()
        # y_encoded = label_encoder.fit_transform(y)
    
        # # Split the data into training and testing sets
        # X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_230652 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_230652';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m16:06:52.389404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:52.390169 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:06:53.671347 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m16:06:53.672440 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m16:06:53.777582 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 16:06:49.912097 => 16:06:53.775529
[0m16:06:53.793644 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m16:06:53.798379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca7feafd-9518-4988-84ea-4d0ddc230eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110982b90>]}
[0m16:06:53.800068 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.91s]
[0m16:06:53.803968 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m16:06:53.811137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:53.812125 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:06:55.073576 [debug] [MainThread]: On master: COMMIT
[0m16:06:55.075523 [debug] [MainThread]: Using oracle connection "master"
[0m16:06:55.076279 [debug] [MainThread]: On master: COMMIT
[0m16:06:55.178538 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:06:55.180544 [debug] [MainThread]: On master: Close
[0m16:06:55.291166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:55.292666 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m16:06:55.293281 [info ] [MainThread]: 
[0m16:06:55.293965 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.66 seconds (10.66s).
[0m16:06:55.294851 [debug] [MainThread]: Command end result
[0m16:06:55.562873 [info ] [MainThread]: 
[0m16:06:55.564439 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:06:55.564902 [info ] [MainThread]: 
[0m16:06:55.565346 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m16:06:55.565783 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m16:06:55.566188 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m16:06:55.566607 [info ] [MainThread]: 
[0m16:06:55.567097 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:06:55.568696 [debug] [MainThread]: Command `dbt run` failed at 16:06:55.568302 after 11.13 seconds
[0m16:06:55.569735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b1cd90>]}
[0m16:06:55.570644 [debug] [MainThread]: Flushing usage events
[0m16:07:26.889130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082fda50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d7a90>]}


============================== 16:07:26.891416 | 3c856c32-686c-43ba-8be6-27ecdc00a69e ==============================
[0m16:07:26.891416 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:07:26.891732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:07:26.935516 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m16:07:26.958949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c856c32-686c-43ba-8be6-27ecdc00a69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10882cd90>]}
[0m16:07:26.965214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c856c32-686c-43ba-8be6-27ecdc00a69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108820990>]}
[0m16:07:26.997268 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:07:27.025039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:07:27.025224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:07:27.028285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c856c32-686c-43ba-8be6-27ecdc00a69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e8b90>]}
[0m16:07:27.033179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c856c32-686c-43ba-8be6-27ecdc00a69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f457d0>]}
[0m16:07:27.033364 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m16:07:27.033539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c856c32-686c-43ba-8be6-27ecdc00a69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f02b50>]}
[0m16:07:27.034164 [info ] [MainThread]: 
[0m16:07:27.034541 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m16:07:27.034990 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m16:07:27.039830 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m16:07:27.040119 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m16:07:27.040274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:27.040411 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:07:28.511677 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m16:07:28.618880 [debug] [ThreadPool]: On list_None: Close
[0m16:07:28.730000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m16:07:28.738088 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m16:07:28.738479 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m16:07:28.738782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:28.739093 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:07:30.090803 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m16:07:30.102667 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m16:07:30.103314 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m16:07:30.231338 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:07:30.437413 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m16:07:30.538683 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m16:07:30.650988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c856c32-686c-43ba-8be6-27ecdc00a69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee9010>]}
[0m16:07:30.651862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:30.652278 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:07:31.903262 [debug] [MainThread]: On master: COMMIT
[0m16:07:31.905440 [debug] [MainThread]: Using oracle connection "master"
[0m16:07:31.906114 [debug] [MainThread]: On master: COMMIT
[0m16:07:32.039501 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:07:32.041474 [debug] [MainThread]: On master: Close
[0m16:07:32.151035 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:07:32.152242 [info ] [MainThread]: 
[0m16:07:32.158847 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m16:07:32.159245 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m16:07:32.159934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m16:07:32.160198 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m16:07:32.184705 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m16:07:32.185942 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 16:07:32.160332 => 16:07:32.185721
[0m16:07:32.186291 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m16:07:32.195357 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m16:07:32.195772 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m16:07:32.205805 [info ] [Thread-1 (]: Python model materialization is table
[0m16:07:32.206191 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m16:07:39.541094 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m16:07:39.542511 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczOTI0NTgsImlhdCI6MTY4NzM4ODg1OH0.AHiCNWnn7jxhQE6g4wKN2KKC-0zwaXY0xgFnjyK0akAj3gyYS_MDxYYpVmeKyO8zqHIuRFiZgFNoMqWLpqnn0jXXziZ5liS4ovh-EJ3lz2CKBMCNEIhRAW_RmVsYUCP-NkL5NN84g9r2NfQ3kY7ZMPaxAQBJ_NPSxh6vtyUtpOD235Z8nKvjGeaSBtAtJClvhYaap79hS5czBmo3P_t8IvnkwCx-1eK7XjQAGTM_z9t0OrhOjYlZJCa1oxjyt0kC-ldOuNX2KnxrFK3FgayWDBwy3zNsEEL-9qRz8r1viyOzmP4wd2J-5uPCEo9o0CRlsXFVwNANvIN-2i9uqNwUJQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    import oml
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        # from sklearn.model_selection import train_test_split
        # from sklearn.preprocessing import LabelEncoder
        # from sklearn.tree import DecisionTreeClassifier
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
        #X = df[['price']]  # Independent variable
        #y = df['shipping_city']  # Dependent variable
    
        # Encode the categorical variable 'shipping_city'
        # label_encoder = LabelEncoder()
        # y_encoded = label_encoder.fit_transform(y)
    
        # # Split the data into training and testing sets
        # X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_230739 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_230739';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m16:07:39.543431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:39.543926 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:07:40.780059 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m16:07:40.780542 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m16:07:40.882928 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 16:07:32.186500 => 16:07:40.882738
[0m16:07:40.889244 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m16:07:40.890515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c856c32-686c-43ba-8be6-27ecdc00a69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa9190>]}
[0m16:07:40.890890 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 8.73s]
[0m16:07:40.891165 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m16:07:40.892161 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:07:40.892383 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:07:42.123233 [debug] [MainThread]: On master: COMMIT
[0m16:07:42.123553 [debug] [MainThread]: Using oracle connection "master"
[0m16:07:42.123707 [debug] [MainThread]: On master: COMMIT
[0m16:07:42.223891 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:07:42.224223 [debug] [MainThread]: On master: Close
[0m16:07:42.326263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:42.326536 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m16:07:42.326700 [info ] [MainThread]: 
[0m16:07:42.326893 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.29 seconds (15.29s).
[0m16:07:42.327175 [debug] [MainThread]: Command end result
[0m16:07:42.332714 [info ] [MainThread]: 
[0m16:07:42.333039 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:07:42.333213 [info ] [MainThread]: 
[0m16:07:42.333373 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m16:07:42.333526 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m16:07:42.333673 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m16:07:42.333816 [info ] [MainThread]: 
[0m16:07:42.333975 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:07:42.334308 [debug] [MainThread]: Command `dbt run` failed at 16:07:42.334256 after 15.46 seconds
[0m16:07:42.334503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fca450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512f7d0>]}
[0m16:07:42.334673 [debug] [MainThread]: Flushing usage events
[0m16:10:45.964095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11080bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110817a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110817f90>]}


============================== 16:10:45.966755 | b66dadcb-1228-4a3b-8efc-89973a1da120 ==============================
[0m16:10:45.966755 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:10:45.967080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:10:46.013557 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m16:10:46.036675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b66dadcb-1228-4a3b-8efc-89973a1da120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110842010>]}
[0m16:10:46.043237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b66dadcb-1228-4a3b-8efc-89973a1da120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106782c90>]}
[0m16:10:46.077283 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:10:46.108663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:46.108953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:46.112507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b66dadcb-1228-4a3b-8efc-89973a1da120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110885f50>]}
[0m16:10:46.117559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b66dadcb-1228-4a3b-8efc-89973a1da120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122ebdd0>]}
[0m16:10:46.117876 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m16:10:46.118057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b66dadcb-1228-4a3b-8efc-89973a1da120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122b7190>]}
[0m16:10:46.118774 [info ] [MainThread]: 
[0m16:10:46.119141 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m16:10:46.119651 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m16:10:46.124894 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m16:10:46.125202 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m16:10:46.125380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:46.125557 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:10:47.691531 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m16:10:47.800789 [debug] [ThreadPool]: On list_None: Close
[0m16:10:47.908504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m16:10:47.913244 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m16:10:47.913569 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m16:10:47.913751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:47.913926 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:10:49.293562 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m16:10:49.305988 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m16:10:49.306623 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m16:10:49.432709 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:10:49.644895 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m16:10:49.748225 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m16:10:49.853980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b66dadcb-1228-4a3b-8efc-89973a1da120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108432d0>]}
[0m16:10:49.854527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:49.854844 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:10:51.141574 [debug] [MainThread]: On master: COMMIT
[0m16:10:51.142239 [debug] [MainThread]: Using oracle connection "master"
[0m16:10:51.142484 [debug] [MainThread]: On master: COMMIT
[0m16:10:51.244130 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:10:51.246488 [debug] [MainThread]: On master: Close
[0m16:10:51.356711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:10:51.358334 [info ] [MainThread]: 
[0m16:10:51.365404 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m16:10:51.366143 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m16:10:51.366625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m16:10:51.366819 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m16:10:51.386554 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m16:10:51.388119 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 16:10:51.366959 => 16:10:51.387959
[0m16:10:51.388452 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m16:10:51.397985 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m16:10:51.398352 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m16:10:51.409269 [info ] [Thread-1 (]: Python model materialization is table
[0m16:10:51.409879 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m16:10:55.255166 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m16:10:55.256735 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczOTI2NTQsImlhdCI6MTY4NzM4OTA1NH0.ZHoIWUBPjK7bEtIAgYjcezoGUGwkYTPrSwiCd5JsGS8lDAZWvlKF7ntyaKGqs7oUdYPel50zda-Rxo9q_1Bkg7ThNlRDFPxj6QEugkTXNrSb36MiWfrdC9NxU3ZlQQYtQsrGEzFZtFpZLNnj17dbjpW0xdQDqvVFUhq_Cyl_HHMBOlgv_VG8H_7k2Jq2SiHpulFt-zs22dBCkkTkGsmeDBgi0SB7TRoT0zosbqzVyvSCS6lW9XDyWufOcuAmDTwgcpNSPiFehvt4Ye_yKH37xFIDEYyuFkCS53dCrZmIAIOYkmoViS_coa528DqYotchPM2L1uQTgpOz2QtaKrJSNg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    import oml
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        # from sklearn.model_selection import train_test_split
        # from sklearn.preprocessing import LabelEncoder
        # from sklearn.tree import DecisionTreeClassifier
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
        #X = df[['price']]  # Independent variable
        #y = df['shipping_city']  # Dependent variable
    
        # Encode the categorical variable 'shipping_city'
        # label_encoder = LabelEncoder()
        # y_encoded = label_encoder.fit_transform(y)
    
        # # Split the data into training and testing sets
        # X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_231055 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_231055';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m16:10:55.258394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:55.259060 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:10:56.823718 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m16:10:56.826012 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m16:10:56.936343 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 16:10:51.388668 => 16:10:56.934896
[0m16:10:56.949538 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m16:10:56.951481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b66dadcb-1228-4a3b-8efc-89973a1da120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11231b390>]}
[0m16:10:56.951987 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 5.59s]
[0m16:10:56.952284 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m16:10:56.954042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:56.954585 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:10:58.431726 [debug] [MainThread]: On master: COMMIT
[0m16:10:58.433248 [debug] [MainThread]: Using oracle connection "master"
[0m16:10:58.433751 [debug] [MainThread]: On master: COMMIT
[0m16:10:58.540082 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:10:58.542503 [debug] [MainThread]: On master: Close
[0m16:10:58.655041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:58.655984 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m16:10:58.656550 [info ] [MainThread]: 
[0m16:10:58.657076 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.54 seconds (12.54s).
[0m16:10:58.657826 [debug] [MainThread]: Command end result
[0m16:10:58.666561 [info ] [MainThread]: 
[0m16:10:58.666962 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:10:58.667184 [info ] [MainThread]: 
[0m16:10:58.667367 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m16:10:58.667524 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m16:10:58.667666 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m16:10:58.667807 [info ] [MainThread]: 
[0m16:10:58.667964 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:10:58.668278 [debug] [MainThread]: Command `dbt run` failed at 16:10:58.668228 after 12.72 seconds
[0m16:10:58.668499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110829a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f18e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112382d90>]}
[0m16:10:58.668705 [debug] [MainThread]: Flushing usage events
[0m16:11:45.282996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107317e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107317fd0>]}


============================== 16:11:45.285515 | 71fbfacb-a192-4ad5-a213-bf14a85931a8 ==============================
[0m16:11:45.285515 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:11:45.285838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:11:45.327528 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m16:11:45.349628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71fbfacb-a192-4ad5-a213-bf14a85931a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e6290>]}
[0m16:11:45.356128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71fbfacb-a192-4ad5-a213-bf14a85931a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be6110>]}
[0m16:11:45.388004 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:11:45.433738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:11:45.434200 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m16:11:45.455119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71fbfacb-a192-4ad5-a213-bf14a85931a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703a250>]}
[0m16:11:45.460873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71fbfacb-a192-4ad5-a213-bf14a85931a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df0090>]}
[0m16:11:45.461211 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m16:11:45.461402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71fbfacb-a192-4ad5-a213-bf14a85931a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfe010>]}
[0m16:11:45.462212 [info ] [MainThread]: 
[0m16:11:45.462605 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m16:11:45.463125 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m16:11:45.468003 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m16:11:45.468255 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m16:11:45.468425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:45.468600 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:11:46.935228 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m16:11:47.038181 [debug] [ThreadPool]: On list_None: Close
[0m16:11:47.140626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m16:11:47.146681 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m16:11:47.147168 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m16:11:47.147502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:47.147836 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:11:48.503771 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m16:11:48.515253 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m16:11:48.516116 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m16:11:48.640890 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:11:48.853605 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m16:11:48.957858 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m16:11:49.074042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71fbfacb-a192-4ad5-a213-bf14a85931a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111033990>]}
[0m16:11:49.075172 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:49.075761 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:11:50.342379 [debug] [MainThread]: On master: COMMIT
[0m16:11:50.344392 [debug] [MainThread]: Using oracle connection "master"
[0m16:11:50.345011 [debug] [MainThread]: On master: COMMIT
[0m16:11:50.452539 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:11:50.455399 [debug] [MainThread]: On master: Close
[0m16:11:50.594247 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:50.595202 [info ] [MainThread]: 
[0m16:11:50.600379 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m16:11:50.600921 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m16:11:50.601474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m16:11:50.601738 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m16:11:50.617459 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m16:11:50.618590 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 16:11:50.601934 => 16:11:50.618394
[0m16:11:50.618943 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m16:11:50.629126 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m16:11:50.629587 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m16:11:50.641457 [info ] [Thread-1 (]: Python model materialization is table
[0m16:11:50.641969 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m16:11:53.127668 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m16:11:53.129714 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODczOTI3MTIsImlhdCI6MTY4NzM4OTExMn0.KLrw51mjJQrKuzNfUVUkceWoyHNJT4xHUh6HZB43UhrYbZyDtiDY9cNEZp5iCv5gOiv6fwkcS5GnzDzhD3FTZPbjD3P3mPaO8G9B4ERKNS1S1qrZZnwLXqIedXbbOC9jSqZF9-OW5d5rH7EyVY5b-Q3MuGOHXf7qSKAfXITgwjm0S5LHyGbEnW_ge61jmfE_0Kyxd65Dx-LQQ1H4l3T5_oLo4LVh1RSLvWBNkHQqV9qqLtvyslOkLUNCNDw5BMrqAjAq-cfVHZjcuL7BaQlL498eih5iuALj-076rtAGeWsf9dfC8lgAh9FY7tV1FdpHETVqJ50NsNwiXHAJ_RVO-A!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    import oml
    import pandas as pd
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        # from sklearn.model_selection import train_test_split
        # from sklearn.preprocessing import LabelEncoder
        # from sklearn.tree import DecisionTreeClassifier
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
        #X = df[['price']]  # Independent variable
        #y = df['shipping_city']  # Dependent variable
    
        # Encode the categorical variable 'shipping_city'
        # label_encoder = LabelEncoder()
        # y_encoded = label_encoder.fit_transform(y)
    
        # # Split the data into training and testing sets
        # X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_231153 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_231153';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m16:11:53.131438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:53.132089 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:11:54.381078 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m16:11:54.382684 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m16:11:54.487897 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 16:11:50.619120 => 16:11:54.486537
[0m16:11:54.499783 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m16:11:54.501216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71fbfacb-a192-4ad5-a213-bf14a85931a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7d210>]}
[0m16:11:54.501684 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.90s]
[0m16:11:54.501975 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m16:11:54.503111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:54.503326 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:11:55.749850 [debug] [MainThread]: On master: COMMIT
[0m16:11:55.754584 [debug] [MainThread]: Using oracle connection "master"
[0m16:11:55.755539 [debug] [MainThread]: On master: COMMIT
[0m16:11:55.863707 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:11:55.866246 [debug] [MainThread]: On master: Close
[0m16:11:55.974766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:55.975319 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m16:11:55.975617 [info ] [MainThread]: 
[0m16:11:55.975885 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.51 seconds (10.51s).
[0m16:11:55.976216 [debug] [MainThread]: Command end result
[0m16:11:55.987075 [info ] [MainThread]: 
[0m16:11:55.987383 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:11:55.987542 [info ] [MainThread]: 
[0m16:11:55.987689 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m16:11:55.987835 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m16:11:55.987966 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m16:11:55.988100 [info ] [MainThread]: 
[0m16:11:55.988247 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:11:55.988540 [debug] [MainThread]: Command `dbt run` failed at 16:11:55.988493 after 10.73 seconds
[0m16:11:55.988792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107328390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073284d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bcce10>]}
[0m16:11:55.989053 [debug] [MainThread]: Flushing usage events
[0m09:37:36.512933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111317dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111317d90>]}


============================== 09:37:36.534380 | 68c4a1ed-b8d8-45f3-ae7e-ebf6bf9e2d6c ==============================
[0m09:37:36.534380 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:37:36.535149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:37:37.302110 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m09:37:37.362141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68c4a1ed-b8d8-45f3-ae7e-ebf6bf9e2d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11135c390>]}
[0m09:37:37.368919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68c4a1ed-b8d8-45f3-ae7e-ebf6bf9e2d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a420d0>]}
[0m09:37:37.431073 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:37:39.592653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:37:39.593928 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m09:37:39.629219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68c4a1ed-b8d8-45f3-ae7e-ebf6bf9e2d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111385890>]}
[0m09:37:39.826052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68c4a1ed-b8d8-45f3-ae7e-ebf6bf9e2d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a68fd0>]}
[0m09:37:39.828345 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m09:37:39.829034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68c4a1ed-b8d8-45f3-ae7e-ebf6bf9e2d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a4e750>]}
[0m09:37:39.831699 [info ] [MainThread]: 
[0m09:37:39.833064 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m09:37:39.834873 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m09:37:39.846353 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m09:37:39.846926 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m09:37:39.847198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:39.847464 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:37:42.299881 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m09:37:42.437867 [debug] [ThreadPool]: On list_None: Close
[0m09:37:42.565363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m09:37:42.572855 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m09:37:42.573364 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m09:37:42.573715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:42.574064 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:37:44.666668 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m09:37:44.679499 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m09:37:44.680260 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m09:37:45.312852 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m09:37:45.563556 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m09:37:45.789370 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m09:37:46.042881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68c4a1ed-b8d8-45f3-ae7e-ebf6bf9e2d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c8fbd0>]}
[0m09:37:46.043970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:37:46.044431 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:37:49.069314 [debug] [MainThread]: On master: COMMIT
[0m09:37:49.071679 [debug] [MainThread]: Using oracle connection "master"
[0m09:37:49.072858 [debug] [MainThread]: On master: COMMIT
[0m09:37:49.336374 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:37:49.339473 [debug] [MainThread]: On master: Close
[0m09:37:49.583312 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:37:49.584948 [info ] [MainThread]: 
[0m09:37:49.614766 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m09:37:49.615797 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m09:37:49.616775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m09:37:49.617227 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m09:37:49.638394 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m09:37:49.644936 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 09:37:49.617541 => 09:37:49.644703
[0m09:37:49.645343 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m09:37:49.656072 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m09:37:49.656507 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m09:37:49.667322 [info ] [Thread-1 (]: Python model materialization is table
[0m09:37:49.667736 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m09:37:53.517539 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m09:37:53.518821 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTU0NzIsImlhdCI6MTY4NzQ1MTg3Mn0.QP0XQIMB3wTFsTOKwkRH9JIXUcDKWu5Guxh-Tr50_ZvIYKWFr44dfhwFrZUtx5qChJCX6k2alN1Xo2xQ0wmcYD6xwwNP7A6rDxgipaOntQXV2GfJwd9WECRZFBYQkPKquxXtdEadcZNUgUqlHhqGsXnhnNxz8WCodSG1njfjoELXsc62cXh0-3ZHuKD5rGB9fOhcpwUFb6WPnQNeTTBBFuQl3YDp_jGokGN3nDDfdQ0pstmLvbLb3_SD5kW5sK6aYWnSMMShpv6-b3E24owfO851VRgjCXnYalQQmiV2G-R8Z-rPxhtMHX5WOO71A-aMuUNN-BmwS9U6QaOwiJpAXQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        # from sklearn.model_selection import train_test_split
        # from sklearn.preprocessing import LabelEncoder
        # from sklearn.tree import DecisionTreeClassifier
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        s_df = s_df.pull()
        #X = df[['price']]  # Independent variable
        #y = df['shipping_city']  # Dependent variable
    
        # Encode the categorical variable 'shipping_city'
        # label_encoder = LabelEncoder()
        # y_encoded = label_encoder.fit_transform(y)
    
        # # Split the data into training and testing sets
        # X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_163753 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_163753';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m09:37:53.520166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:53.520651 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:37:56.197079 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m09:37:56.197564 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m09:37:56.443147 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 09:37:49.645551 => 09:37:56.441988
[0m09:37:56.631365 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m09:37:56.634999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68c4a1ed-b8d8-45f3-ae7e-ebf6bf9e2d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a58ed0>]}
[0m09:37:56.636232 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 7.02s]
[0m09:37:56.636919 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m09:37:56.639260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:37:56.640070 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:37:59.760093 [debug] [MainThread]: On master: COMMIT
[0m09:37:59.762388 [debug] [MainThread]: Using oracle connection "master"
[0m09:37:59.763372 [debug] [MainThread]: On master: COMMIT
[0m09:38:00.059700 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:38:00.062273 [debug] [MainThread]: On master: Close
[0m09:38:00.347465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:00.348229 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m09:38:00.348655 [info ] [MainThread]: 
[0m09:38:00.349019 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.52 seconds (20.52s).
[0m09:38:00.349585 [debug] [MainThread]: Command end result
[0m09:38:00.445654 [info ] [MainThread]: 
[0m09:38:00.446373 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:38:00.446761 [info ] [MainThread]: 
[0m09:38:00.447115 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m09:38:00.447453 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m09:38:00.447757 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m09:38:00.448074 [info ] [MainThread]: 
[0m09:38:00.448427 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:38:00.449096 [debug] [MainThread]: Command `dbt run` failed at 09:38:00.448991 after 24.15 seconds
[0m09:38:00.449595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043dce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043dced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11135c6d0>]}
[0m09:38:00.450076 [debug] [MainThread]: Flushing usage events
[0m09:45:53.393338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b67510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b73450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b73a90>]}


============================== 09:45:53.396293 | 362f9931-b0d3-4bcf-8c64-61a1c0bdc1a2 ==============================
[0m09:45:53.396293 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:45:53.396630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:45:53.396905 [info ] [MainThread]: dbt version: 1.5.1
[0m09:45:53.397090 [info ] [MainThread]: python version: 3.11.3
[0m09:45:53.397257 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m09:45:53.397400 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m09:45:53.397542 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/Desktop/oracle-dbt/profiles.yml
[0m09:45:53.397698 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m09:45:53.397830 [info ] [MainThread]: Configuration:
[0m09:45:53.441566 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m09:45:53.457749 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:45:53.466863 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:45:53.467225 [info ] [MainThread]: Required dependencies:
[0m09:45:53.467461 [debug] [MainThread]: Executing "git --help"
[0m09:45:53.475745 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:45:53.476366 [debug] [MainThread]: STDERR: "b''"
[0m09:45:53.476544 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:45:53.476730 [info ] [MainThread]: Connection:
[0m09:45:53.476982 [info ] [MainThread]:   user: fawdbtcore
[0m09:45:53.477195 [info ] [MainThread]:   database: None
[0m09:45:53.477358 [info ] [MainThread]:   schema: FAWDBTCORE
[0m09:45:53.477505 [info ] [MainThread]:   protocol: None
[0m09:45:53.477652 [info ] [MainThread]:   host: None
[0m09:45:53.477789 [info ] [MainThread]:   port: None
[0m09:45:53.477919 [info ] [MainThread]:   tns_name: cfg57adw_low
[0m09:45:53.478228 [info ] [MainThread]:   service: None
[0m09:45:53.478420 [info ] [MainThread]:   connection_string: None
[0m09:45:53.478566 [info ] [MainThread]:   shardingkey: []
[0m09:45:53.478694 [info ] [MainThread]:   supershardingkey: []
[0m09:45:53.478821 [info ] [MainThread]:   cclass: None
[0m09:45:53.478948 [info ] [MainThread]:   purity: None
[0m09:45:53.479071 [info ] [MainThread]:   retry_count: 1
[0m09:45:53.479193 [info ] [MainThread]:   retry_delay: 3
[0m09:45:53.479321 [info ] [MainThread]:   oml_auth_token_uri: https://tv1lg8pdut4n8vc-cfg57adw.adb.us-ashburn-1.oraclecloudapps.com/omlusers/api/oauth2/v1/token
[0m09:45:53.483704 [debug] [MainThread]: Acquiring new oracle connection 'debug'
[0m09:45:53.484821 [debug] [MainThread]: Using oracle connection "debug"
[0m09:45:53.485074 [debug] [MainThread]: On debug: select 1 as id from dual
[0m09:45:53.485377 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:45:53.485594 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:45:55.236839 [debug] [MainThread]: SQL status: OK in 2.0 seconds
[0m09:45:55.239332 [debug] [MainThread]: On debug: Close
[0m09:45:55.345174 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:45:55.347187 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:45:55.348896 [debug] [MainThread]: Command `dbt debug` succeeded at 09:45:55.348586 after 1.98 seconds
[0m09:45:55.349614 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:45:55.350155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b647d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b64710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023ffd10>]}
[0m09:45:55.350812 [debug] [MainThread]: Flushing usage events
[0m09:48:04.950993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d17650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d17c90>]}


============================== 09:48:04.953897 | ae55d43c-a6a6-413d-aec2-28d0f703086b ==============================
[0m09:48:04.953897 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:48:04.954241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:48:04.954532 [info ] [MainThread]: dbt version: 1.5.1
[0m09:48:04.954710 [info ] [MainThread]: python version: 3.11.3
[0m09:48:04.954874 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m09:48:04.955025 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m09:48:04.955168 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/Desktop/oracle-dbt/profiles.yml
[0m09:48:04.955324 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m09:48:04.955463 [info ] [MainThread]: Configuration:
[0m09:48:05.001460 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m09:48:05.018208 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:48:05.026903 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:48:05.027180 [info ] [MainThread]: Required dependencies:
[0m09:48:05.027405 [debug] [MainThread]: Executing "git --help"
[0m09:48:05.035195 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:48:05.035638 [debug] [MainThread]: STDERR: "b''"
[0m09:48:05.035780 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:48:05.035935 [info ] [MainThread]: Connection:
[0m09:48:05.036118 [info ] [MainThread]:   user: fawdbtcore
[0m09:48:05.036256 [info ] [MainThread]:   database: None
[0m09:48:05.036386 [info ] [MainThread]:   schema: FAWDBTCORE
[0m09:48:05.036513 [info ] [MainThread]:   protocol: None
[0m09:48:05.036643 [info ] [MainThread]:   host: None
[0m09:48:05.036767 [info ] [MainThread]:   port: None
[0m09:48:05.036891 [info ] [MainThread]:   tns_name: cfg57adw_low
[0m09:48:05.037013 [info ] [MainThread]:   service: None
[0m09:48:05.037134 [info ] [MainThread]:   connection_string: None
[0m09:48:05.037252 [info ] [MainThread]:   shardingkey: []
[0m09:48:05.037374 [info ] [MainThread]:   supershardingkey: []
[0m09:48:05.037491 [info ] [MainThread]:   cclass: None
[0m09:48:05.037612 [info ] [MainThread]:   purity: None
[0m09:48:05.037731 [info ] [MainThread]:   retry_count: 1
[0m09:48:05.037848 [info ] [MainThread]:   retry_delay: 3
[0m09:48:05.037972 [info ] [MainThread]:   oml_auth_token_uri: https://tv1lg8pdut4n8vc-cfg57adw.adb.us-ashburn-1.oraclecloudapps.com/omlusers/api/oauth2/v1/token
[0m09:48:05.042009 [debug] [MainThread]: Acquiring new oracle connection 'debug'
[0m09:48:05.042648 [debug] [MainThread]: Using oracle connection "debug"
[0m09:48:05.042823 [debug] [MainThread]: On debug: select 1 as id from dual
[0m09:48:05.042964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:48:05.043151 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:48:07.549085 [debug] [MainThread]: SQL status: OK in 3.0 seconds
[0m09:48:07.553212 [debug] [MainThread]: On debug: Close
[0m09:48:07.651977 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:48:07.653814 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:48:07.656017 [debug] [MainThread]: Command `dbt debug` succeeded at 09:48:07.655782 after 2.73 seconds
[0m09:48:07.656778 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:48:07.657518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dcad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ac2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b7bb90>]}
[0m09:48:07.658152 [debug] [MainThread]: Flushing usage events
[0m09:48:12.000903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c17d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c17f90>]}


============================== 09:48:12.003266 | a34778ca-915d-4326-9666-4aca7f5b8713 ==============================
[0m09:48:12.003266 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:48:12.003578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:48:12.053112 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m09:48:12.075440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a34778ca-915d-4326-9666-4aca7f5b8713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c5c390>]}
[0m09:48:12.081534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a34778ca-915d-4326-9666-4aca7f5b8713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062de010>]}
[0m09:48:12.115755 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:48:12.162077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:48:12.162517 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m09:48:12.182845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a34778ca-915d-4326-9666-4aca7f5b8713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639a810>]}
[0m09:48:12.192857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a34778ca-915d-4326-9666-4aca7f5b8713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106334750>]}
[0m09:48:12.193173 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m09:48:12.193358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a34778ca-915d-4326-9666-4aca7f5b8713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ee2d0>]}
[0m09:48:12.194132 [info ] [MainThread]: 
[0m09:48:12.194581 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m09:48:12.195168 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m09:48:12.200192 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m09:48:12.200426 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m09:48:12.200602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:48:12.200780 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:48:13.521337 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m09:48:13.621978 [debug] [ThreadPool]: On list_None: Close
[0m09:48:13.725522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m09:48:13.733011 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m09:48:13.733649 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m09:48:13.734060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:48:13.734404 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:48:15.032690 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m09:48:15.039938 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m09:48:15.040414 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m09:48:15.411975 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:48:15.665391 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m09:48:15.769785 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m09:48:15.887759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a34778ca-915d-4326-9666-4aca7f5b8713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c97510>]}
[0m09:48:15.888884 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:48:15.889377 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:48:17.779584 [debug] [MainThread]: On master: COMMIT
[0m09:48:17.781960 [debug] [MainThread]: Using oracle connection "master"
[0m09:48:17.783099 [debug] [MainThread]: On master: COMMIT
[0m09:48:18.085923 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:48:18.088146 [debug] [MainThread]: On master: Close
[0m09:48:18.398291 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:48:18.399167 [info ] [MainThread]: 
[0m09:48:18.405196 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m09:48:18.405910 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m09:48:18.406606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m09:48:18.406952 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m09:48:18.423050 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m09:48:18.424221 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 09:48:18.407214 => 09:48:18.424054
[0m09:48:18.424552 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m09:48:18.433952 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m09:48:18.434349 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m09:48:18.443816 [info ] [Thread-1 (]: Python model materialization is table
[0m09:48:18.444374 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m09:48:21.634638 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m09:48:21.637624 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTYxMDAsImlhdCI6MTY4NzQ1MjUwMH0.jU41GE-mOp2SweC6lLqH5zWysBSqEqP5dSIFzJ6lganmE4tyjWuNcDF9pgVxrDfCyuTeHv4cOWMoemNYEI_IjIie9wFRxgYPeby7y2HFmOvKSE60C8GqXIkaJOBd7WlIgpT0hKob-SCZlMGle6zVZcxqBzh4NGuo9XqjUGe5Z1QnfCoVu94rd5ISvE0vVi6_Xf3qoiIFbiATXPaBXqOEvsZ8SlfskDc63Y1O9OnChWEPh0BWeJB0wAxpL4GzXlE5qX17E1Y1GRt3xQRWwuh1_TGA35WSGMnVtfa3792kZ_nF6uksDf-io6650JgOdAGtYS92RhnYzM4IUITbOpufrQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        # from sklearn.model_selection import train_test_split
        # from sklearn.preprocessing import LabelEncoder
        # from sklearn.tree import DecisionTreeClassifier
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        #df = s_df.pull()
        
        X = s_df[['price']]  # Independent variable
        y = s_df['shipping_city']  # Dependent variable
    
        # Encode the categorical variable 'shipping_city'
        # label_encoder = LabelEncoder()
        # y_encoded = label_encoder.fit_transform(y)
    
        # # Split the data into training and testing sets
        # X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_164821 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_164821';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m09:48:21.638852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:21.639281 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:48:23.180165 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m09:48:23.182656 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m09:48:23.296307 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 09:48:18.424764 => 09:48:23.294899
[0m09:48:23.307869 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m09:48:23.309522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34778ca-915d-4326-9666-4aca7f5b8713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106590f10>]}
[0m09:48:23.310041 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 4.90s]
[0m09:48:23.310325 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m09:48:23.311465 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:48:23.311740 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:48:25.107312 [debug] [MainThread]: On master: COMMIT
[0m09:48:25.109486 [debug] [MainThread]: Using oracle connection "master"
[0m09:48:25.110026 [debug] [MainThread]: On master: COMMIT
[0m09:48:25.315413 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:48:25.318606 [debug] [MainThread]: On master: Close
[0m09:48:25.548905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:48:25.550734 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m09:48:25.551479 [info ] [MainThread]: 
[0m09:48:25.552009 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.36 seconds (13.36s).
[0m09:48:25.552690 [debug] [MainThread]: Command end result
[0m09:48:25.568697 [info ] [MainThread]: 
[0m09:48:25.569116 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:48:25.569280 [info ] [MainThread]: 
[0m09:48:25.569433 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m09:48:25.569583 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m09:48:25.569944 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m09:48:25.570300 [info ] [MainThread]: 
[0m09:48:25.570597 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:48:25.571104 [debug] [MainThread]: Command `dbt run` failed at 09:48:25.571022 after 13.59 seconds
[0m09:48:25.571476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c41290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c17310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100984ed0>]}
[0m09:48:25.571814 [debug] [MainThread]: Flushing usage events
[0m09:48:46.472320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108137d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108120c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108143fd0>]}


============================== 09:48:46.481243 | d2984f54-fc66-4fe9-a35c-c96c35c1518d ==============================
[0m09:48:46.481243 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:48:46.481563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:48:46.531370 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m09:48:46.554764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2984f54-fc66-4fe9-a35c-c96c35c1518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108154810>]}
[0m09:48:46.560890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2984f54-fc66-4fe9-a35c-c96c35c1518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088557d0>]}
[0m09:48:46.593716 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:48:46.627856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:48:46.628286 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m09:48:46.648926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2984f54-fc66-4fe9-a35c-c96c35c1518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108135050>]}
[0m09:48:46.655715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2984f54-fc66-4fe9-a35c-c96c35c1518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108879cd0>]}
[0m09:48:46.656064 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m09:48:46.656253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2984f54-fc66-4fe9-a35c-c96c35c1518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086bbc10>]}
[0m09:48:46.657042 [info ] [MainThread]: 
[0m09:48:46.657463 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m09:48:46.658071 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m09:48:46.663083 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m09:48:46.663319 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m09:48:46.663495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:48:46.663677 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:48:47.984507 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m09:48:48.081999 [debug] [ThreadPool]: On list_None: Close
[0m09:48:48.180333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m09:48:48.188967 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m09:48:48.189405 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m09:48:48.189585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:48:48.189783 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:48:49.376208 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m09:48:49.391140 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m09:48:49.391902 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m09:48:49.507874 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:48:49.698785 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m09:48:49.792617 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m09:48:49.893163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2984f54-fc66-4fe9-a35c-c96c35c1518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abbbd0>]}
[0m09:48:49.894193 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:48:49.894659 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:48:51.014195 [debug] [MainThread]: On master: COMMIT
[0m09:48:51.015154 [debug] [MainThread]: Using oracle connection "master"
[0m09:48:51.015652 [debug] [MainThread]: On master: COMMIT
[0m09:48:51.104642 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:48:51.104977 [debug] [MainThread]: On master: Close
[0m09:48:51.202888 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:48:51.203535 [info ] [MainThread]: 
[0m09:48:51.207925 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m09:48:51.208347 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m09:48:51.208753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m09:48:51.208954 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m09:48:51.221329 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m09:48:51.222475 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 09:48:51.209092 => 09:48:51.222278
[0m09:48:51.222863 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m09:48:51.233329 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m09:48:51.233669 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m09:48:51.244528 [info ] [Thread-1 (]: Python model materialization is table
[0m09:48:51.244928 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m09:48:53.565586 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m09:48:53.567114 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTYxMzIsImlhdCI6MTY4NzQ1MjUzMn0.Iparg9_b5rKodqZ-HDUJCTYwOFz3nclTNYV_DkS-cPk_y_j8BeqlSj2n46TeDZvZ-fGdeC8t4d4Ol8FNU9EpEJXHIFr6RfBf4XpfSY-dnjyeRwRU6Q61qLw_T9gnhqN3fIxJyWr09ZCwgXWx-dCHCAFkT6Fr9_ZFUTlQvAa-dMFm-WKeC6BNDePgESejdExsgJJtYyuIpaWY-eVLHTlRuVwVJOoP1QCCQ2uo7LrKO76DKOYeHl5n9CboCOp6SFbMJtdP3U-2BtdbTwTPei2sMs4eGqQAOWjy7MQ-ilC3WBLDoWH9s3fBrkwNETWLSnSsMKJYZgkGatZDT7ZQR78Jbg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    # from sklearn.model_selection import train_test_split
    # from sklearn.preprocessing import LabelEncoder
    # from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        # from sklearn.model_selection import train_test_split
        # from sklearn.preprocessing import LabelEncoder
        # from sklearn.tree import DecisionTreeClassifier
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        #df = s_df.pull()
        
        # X = s_df[['price']]  # Independent variable
        # y = s_df['shipping_city']  # Dependent variable
    
        # Encode the categorical variable 'shipping_city'
        # label_encoder = LabelEncoder()
        # y_encoded = label_encoder.fit_transform(y)
    
        # # Split the data into training and testing sets
        # X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_164853 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_164853';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m09:48:53.569551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:53.570172 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:48:54.726627 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m09:48:54.728031 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m09:48:54.820352 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 09:48:51.223084 => 09:48:54.819080
[0m09:48:54.829902 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m09:48:54.832101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2984f54-fc66-4fe9-a35c-c96c35c1518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894a450>]}
[0m09:48:54.832513 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.62s]
[0m09:48:54.832780 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m09:48:54.833788 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:48:54.834061 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:48:55.988340 [debug] [MainThread]: On master: COMMIT
[0m09:48:55.990044 [debug] [MainThread]: Using oracle connection "master"
[0m09:48:55.990632 [debug] [MainThread]: On master: COMMIT
[0m09:48:56.080585 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:48:56.080938 [debug] [MainThread]: On master: Close
[0m09:48:56.172337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:48:56.172668 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m09:48:56.172872 [info ] [MainThread]: 
[0m09:48:56.173056 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.52 seconds (9.52s).
[0m09:48:56.173330 [debug] [MainThread]: Command end result
[0m09:48:56.181599 [info ] [MainThread]: 
[0m09:48:56.181909 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:48:56.182079 [info ] [MainThread]: 
[0m09:48:56.182233 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m09:48:56.182382 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m09:48:56.182527 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m09:48:56.182669 [info ] [MainThread]: 
[0m09:48:56.182826 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:48:56.183137 [debug] [MainThread]: Command `dbt run` failed at 09:48:56.183089 after 9.73 seconds
[0m09:48:56.183373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a78e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a78ed0>]}
[0m09:48:56.183594 [debug] [MainThread]: Flushing usage events
[0m09:49:59.471157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a0ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a17ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a17f90>]}


============================== 09:49:59.474152 | faf0246b-44df-4bbf-b36e-d1ce74e1a4f8 ==============================
[0m09:49:59.474152 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:49:59.474517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:49:59.538365 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m09:49:59.561890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'faf0246b-44df-4bbf-b36e-d1ce74e1a4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a4ce10>]}
[0m09:49:59.568443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'faf0246b-44df-4bbf-b36e-d1ce74e1a4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105129210>]}
[0m09:49:59.603652 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:49:59.642763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:49:59.643208 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m09:49:59.660214 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.oracle_dbt.web_events_python' (models/staging/web_events_python.py) depends on a source named 'FAWDBTCORE.WEB_ORDER_INFO' which was not found
[0m09:49:59.660696 [debug] [MainThread]: Command `dbt run` failed at 09:49:59.660640 after 0.21 seconds
[0m09:49:59.660942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a29990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051418d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1011cce10>]}
[0m09:49:59.661174 [debug] [MainThread]: Flushing usage events
[0m09:50:33.357834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f17ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f17f90>]}


============================== 09:50:33.360464 | d44363d3-02de-4be1-aed5-8bfc9c78a9e6 ==============================
[0m09:50:33.360464 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:50:33.360804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:50:33.404830 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m09:50:33.427560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd44363d3-02de-4be1-aed5-8bfc9c78a9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd6290>]}
[0m09:50:33.434118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd44363d3-02de-4be1-aed5-8bfc9c78a9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe9890>]}
[0m09:50:33.466956 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:50:33.500373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:50:33.501135 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/sources.yml
[0m09:50:33.501351 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m09:50:33.510911 [debug] [MainThread]: 1699: static parser successfully parsed average_duration_by_platform_country.sql
[0m09:50:33.517619 [debug] [MainThread]: 1699: static parser successfully parsed event_counts_by_platform.sql
[0m09:50:33.519688 [debug] [MainThread]: 1603: static parser failed on combined_categorized_events.sql
[0m09:50:33.524323 [debug] [MainThread]: 1602: parser fallback to jinja rendering on combined_categorized_events.sql
[0m09:50:33.525700 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m09:50:33.527672 [debug] [MainThread]: 1699: static parser successfully parsed most_active_mobile_users.sql
[0m09:50:33.529570 [debug] [MainThread]: 1699: static parser successfully parsed most_frequent_browser.sql
[0m09:50:33.531922 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m09:50:33.533764 [debug] [MainThread]: 1603: static parser failed on staging/stg_web_events.sql
[0m09:50:33.536309 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_web_events.sql
[0m09:50:33.537254 [debug] [MainThread]: 1603: static parser failed on staging/stg_mobile_events.sql
[0m09:50:33.539539 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_mobile_events.sql
[0m09:50:33.555573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd44363d3-02de-4be1-aed5-8bfc9c78a9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11100c650>]}
[0m09:50:33.564087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd44363d3-02de-4be1-aed5-8bfc9c78a9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11114bed0>]}
[0m09:50:33.564439 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m09:50:33.564621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd44363d3-02de-4be1-aed5-8bfc9c78a9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f42e10>]}
[0m09:50:33.565362 [info ] [MainThread]: 
[0m09:50:33.565774 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m09:50:33.566335 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m09:50:33.571129 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m09:50:33.571346 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m09:50:33.571520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:33.571692 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:50:35.140659 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m09:50:35.257956 [debug] [ThreadPool]: On list_None: Close
[0m09:50:35.371643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m09:50:35.375022 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m09:50:35.375318 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m09:50:35.375498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:35.375674 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:50:36.601608 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m09:50:36.614082 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m09:50:36.615119 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m09:50:36.733499 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:50:36.934859 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m09:50:37.027991 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m09:50:37.120987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd44363d3-02de-4be1-aed5-8bfc9c78a9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111a2e10>]}
[0m09:50:37.121825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:50:37.122160 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:50:38.301815 [debug] [MainThread]: On master: COMMIT
[0m09:50:38.303440 [debug] [MainThread]: Using oracle connection "master"
[0m09:50:38.303958 [debug] [MainThread]: On master: COMMIT
[0m09:50:38.421546 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:50:38.423231 [debug] [MainThread]: On master: Close
[0m09:50:38.523021 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:50:38.523793 [info ] [MainThread]: 
[0m09:50:38.528690 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m09:50:38.529100 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m09:50:38.529496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m09:50:38.529685 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m09:50:38.538731 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m09:50:38.539749 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 09:50:38.529821 => 09:50:38.539645
[0m09:50:38.539970 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m09:50:38.547815 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m09:50:38.548119 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m09:50:38.558485 [info ] [Thread-1 (]: Python model materialization is table
[0m09:50:38.558915 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m09:50:40.533667 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m09:50:40.534819 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTYyMzksImlhdCI6MTY4NzQ1MjYzOX0.YCDafedZ2loBPuQ88985jrL5o-t3TlJRiTHVxb0b0-BfW0TB0y1kUxcKIsmyf3_ZR2E_sqH8lndyBobDvEiZGrf2Vhv-BqfoucokzrjH2U4XimoaI4YfQQnpS2Jp5jmEzA5y6UE-BvBu2Ow47Q62wRSYxk2tkDUdMl_qutMOvl31ff8sQXlCo8CusYYOm-DBK5Q9zHsSu2hzlOr8kDKzHgRmI-_kh3lYlLM63qQ3G7eMOO4iLLSzcKGvjE0k0Oa4ps34WyUrNiF_p9jFCcfItMOqPAbX68B490KokJr978AtE5cmMJfmhkJ5O6p2SkWNzw343NrtgTa4PLWQ3f1c1A!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.WEB_ORDER_INFO": "FAWDBTCORE.WEB_ORDER_INFO"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    # from sklearn.model_selection import train_test_split
    # from sklearn.preprocessing import LabelEncoder
    # from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        # from sklearn.model_selection import train_test_split
        # from sklearn.preprocessing import LabelEncoder
        # from sklearn.tree import DecisionTreeClassifier
    
        s_df = dbt.source("FAWDBTCORE", "WEB_ORDER_INFO")
        #df = s_df.pull()
        
        # X = s_df[['price']]  # Independent variable
        # y = s_df['shipping_city']  # Dependent variable
    
        # Encode the categorical variable 'shipping_city'
        # label_encoder = LabelEncoder()
        # y_encoded = label_encoder.fit_transform(y)
    
        # # Split the data into training and testing sets
        # X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_165040 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_165040';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m09:50:40.535895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:40.536277 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:50:41.708710 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m09:50:41.710652 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m09:50:41.805823 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 09:50:38.540112 => 09:50:41.804545
[0m09:50:41.823936 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m09:50:41.825447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44363d3-02de-4be1-aed5-8bfc9c78a9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114c2210>]}
[0m09:50:41.825896 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.30s]
[0m09:50:41.826136 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m09:50:41.827063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:50:41.827304 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:50:42.947191 [debug] [MainThread]: On master: COMMIT
[0m09:50:42.949556 [debug] [MainThread]: Using oracle connection "master"
[0m09:50:42.950589 [debug] [MainThread]: On master: COMMIT
[0m09:50:43.041588 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:50:43.042141 [debug] [MainThread]: On master: Close
[0m09:50:43.140609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:43.141171 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m09:50:43.141544 [info ] [MainThread]: 
[0m09:50:43.141867 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.58 seconds (9.58s).
[0m09:50:43.142349 [debug] [MainThread]: Command end result
[0m09:50:43.149443 [info ] [MainThread]: 
[0m09:50:43.149934 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:50:43.150389 [info ] [MainThread]: 
[0m09:50:43.150644 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m09:50:43.150860 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m09:50:43.151053 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m09:50:43.151246 [info ] [MainThread]: 
[0m09:50:43.151419 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:50:43.151766 [debug] [MainThread]: Command `dbt run` failed at 09:50:43.151710 after 9.81 seconds
[0m09:50:43.152006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051afd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026c6c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026c4e10>]}
[0m09:50:43.152229 [debug] [MainThread]: Flushing usage events
[0m09:54:05.100688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104487650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104493510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104493b90>]}


============================== 09:54:05.103286 | 1a43dddc-a796-4013-af4c-019267bca416 ==============================
[0m09:54:05.103286 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:54:05.103608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:54:05.103900 [info ] [MainThread]: dbt version: 1.5.1
[0m09:54:05.104082 [info ] [MainThread]: python version: 3.11.3
[0m09:54:05.104248 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m09:54:05.104395 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m09:54:05.104542 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/Desktop/oracle-dbt/profiles.yml
[0m09:54:05.104697 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m09:54:05.104837 [info ] [MainThread]: Configuration:
[0m09:54:05.154129 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m09:54:05.196633 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:54:05.206343 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:54:05.206690 [info ] [MainThread]: Required dependencies:
[0m09:54:05.206935 [debug] [MainThread]: Executing "git --help"
[0m09:54:05.216080 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:54:05.216706 [debug] [MainThread]: STDERR: "b''"
[0m09:54:05.216905 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:54:05.217094 [info ] [MainThread]: Connection:
[0m09:54:05.217408 [info ] [MainThread]:   user: fawdbtcore
[0m09:54:05.217700 [info ] [MainThread]:   database: None
[0m09:54:05.217963 [info ] [MainThread]:   schema: FAWDBTCORE
[0m09:54:05.218107 [info ] [MainThread]:   protocol: None
[0m09:54:05.218243 [info ] [MainThread]:   host: None
[0m09:54:05.218370 [info ] [MainThread]:   port: None
[0m09:54:05.218490 [info ] [MainThread]:   tns_name: cfg57adw_low
[0m09:54:05.218618 [info ] [MainThread]:   service: None
[0m09:54:05.218740 [info ] [MainThread]:   connection_string: None
[0m09:54:05.218859 [info ] [MainThread]:   shardingkey: []
[0m09:54:05.218978 [info ] [MainThread]:   supershardingkey: []
[0m09:54:05.219095 [info ] [MainThread]:   cclass: None
[0m09:54:05.219219 [info ] [MainThread]:   purity: None
[0m09:54:05.219335 [info ] [MainThread]:   retry_count: 1
[0m09:54:05.219455 [info ] [MainThread]:   retry_delay: 3
[0m09:54:05.219577 [info ] [MainThread]:   oml_auth_token_uri: https://tv1lg8pdut4n8vc-cfg57adw.adb.us-ashburn-1.oraclecloudapps.com/omlusers/api/oauth2/v1/token
[0m09:54:05.223466 [debug] [MainThread]: Acquiring new oracle connection 'debug'
[0m09:54:05.224029 [debug] [MainThread]: Using oracle connection "debug"
[0m09:54:05.224153 [debug] [MainThread]: On debug: select 1 as id from dual
[0m09:54:05.224273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:54:05.224437 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m09:56:35.819009 [info ] [MainThread]: oracle adapter: Got an error when attempting to open an Oracle connection: 'DPY-6005: cannot connect to database.
timed out'
[0m09:56:35.821071 [info ] [MainThread]: oracle adapter: Rolling back transaction.
[0m09:56:35.822020 [debug] [MainThread]: On debug: No close available on handle
[0m09:56:35.823061 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m09:56:35.823603 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:56:35.824049 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  DPY-6005: cannot connect to database.
  timed out

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m09:56:35.825436 [debug] [MainThread]: Command `dbt debug` failed at 09:56:35.825242 after 150.74 seconds
[0m09:56:35.826048 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:56:35.826507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100dc8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100dc8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104493790>]}
[0m09:56:35.827097 [debug] [MainThread]: Flushing usage events
[0m09:56:45.959193 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m10:08:10.843844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d7990>]}


============================== 10:08:10.845984 | 01dd7cfd-3f32-4a96-af43-e49a4a291a4d ==============================
[0m10:08:10.845984 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:08:10.846296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:08:10.846584 [info ] [MainThread]: dbt version: 1.5.1
[0m10:08:10.846760 [info ] [MainThread]: python version: 3.11.3
[0m10:08:10.846935 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m10:08:10.847088 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m10:08:10.847234 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/Desktop/oracle-dbt/profiles.yml
[0m10:08:10.847391 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m10:08:10.847530 [info ] [MainThread]: Configuration:
[0m10:08:10.896436 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:08:10.912607 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:08:10.921107 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:08:10.921408 [info ] [MainThread]: Required dependencies:
[0m10:08:10.921655 [debug] [MainThread]: Executing "git --help"
[0m10:08:10.929542 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:08:10.930078 [debug] [MainThread]: STDERR: "b''"
[0m10:08:10.930219 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:08:10.930379 [info ] [MainThread]: Connection:
[0m10:08:10.930567 [info ] [MainThread]:   user: fawdbtcore
[0m10:08:10.930703 [info ] [MainThread]:   database: None
[0m10:08:10.930834 [info ] [MainThread]:   schema: FAWDBTCORE
[0m10:08:10.930962 [info ] [MainThread]:   protocol: None
[0m10:08:10.931093 [info ] [MainThread]:   host: None
[0m10:08:10.931219 [info ] [MainThread]:   port: None
[0m10:08:10.931343 [info ] [MainThread]:   tns_name: cfg57adw_low
[0m10:08:10.931469 [info ] [MainThread]:   service: None
[0m10:08:10.931597 [info ] [MainThread]:   connection_string: None
[0m10:08:10.931719 [info ] [MainThread]:   shardingkey: []
[0m10:08:10.931843 [info ] [MainThread]:   supershardingkey: []
[0m10:08:10.931963 [info ] [MainThread]:   cclass: None
[0m10:08:10.932085 [info ] [MainThread]:   purity: None
[0m10:08:10.932207 [info ] [MainThread]:   retry_count: 1
[0m10:08:10.932333 [info ] [MainThread]:   retry_delay: 3
[0m10:08:10.932458 [info ] [MainThread]:   oml_auth_token_uri: https://tv1lg8pdut4n8vc-cfg57adw.adb.us-ashburn-1.oraclecloudapps.com/omlusers/api/oauth2/v1/token
[0m10:08:10.938390 [debug] [MainThread]: Acquiring new oracle connection 'debug'
[0m10:08:10.939057 [debug] [MainThread]: Using oracle connection "debug"
[0m10:08:10.939215 [debug] [MainThread]: On debug: select 1 as id from dual
[0m10:08:10.939362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:08:10.939541 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:08:14.697278 [debug] [MainThread]: SQL status: OK in 4.0 seconds
[0m10:08:14.699158 [debug] [MainThread]: On debug: Close
[0m10:08:14.925088 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:08:14.926523 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:08:14.928139 [debug] [MainThread]: Command `dbt debug` succeeded at 10:08:14.927887 after 4.10 seconds
[0m10:08:14.928739 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:08:14.929224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103108d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10310b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef7f10>]}
[0m10:08:14.929782 [debug] [MainThread]: Flushing usage events
[0m10:08:26.611740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b7fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8bf90>]}


============================== 10:08:26.620088 | 92ed8c4e-954e-4c93-87b0-c0449e7ce060 ==============================
[0m10:08:26.620088 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:08:26.620427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:08:26.679748 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:08:26.724369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92ed8c4e-954e-4c93-87b0-c0449e7ce060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b7d110>]}
[0m10:08:26.730936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92ed8c4e-954e-4c93-87b0-c0449e7ce060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529d410>]}
[0m10:08:26.769000 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:08:26.809425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:08:26.809765 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:08:26.813529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92ed8c4e-954e-4c93-87b0-c0449e7ce060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105358750>]}
[0m10:08:26.823739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92ed8c4e-954e-4c93-87b0-c0449e7ce060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbc790>]}
[0m10:08:26.824100 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:08:26.824280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ed8c4e-954e-4c93-87b0-c0449e7ce060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbeb90>]}
[0m10:08:26.825041 [info ] [MainThread]: 
[0m10:08:26.825444 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:08:26.826003 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:08:26.831904 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:08:26.832245 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:08:26.832430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:26.832620 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:08:28.415806 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:08:28.513339 [debug] [ThreadPool]: On list_None: Close
[0m10:08:28.614751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:08:28.618223 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:08:28.618555 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:08:28.618735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:28.618917 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:08:30.049555 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:08:30.053118 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:08:30.053443 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:08:30.200647 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:08:30.415654 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:08:30.525045 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:08:30.641176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ed8c4e-954e-4c93-87b0-c0449e7ce060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8be50>]}
[0m10:08:30.641624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:08:30.641831 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:08:31.848161 [debug] [MainThread]: On master: COMMIT
[0m10:08:31.848964 [debug] [MainThread]: Using oracle connection "master"
[0m10:08:31.849486 [debug] [MainThread]: On master: COMMIT
[0m10:08:31.949599 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:08:31.950444 [debug] [MainThread]: On master: Close
[0m10:08:32.055150 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:08:32.055865 [info ] [MainThread]: 
[0m10:08:32.058957 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:08:32.059400 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:08:32.059850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:08:32.060073 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:08:32.074328 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:08:32.075299 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:08:32.060217 => 10:08:32.075182
[0m10:08:32.075544 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:08:32.083591 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:08:32.083958 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:08:32.093507 [info ] [Thread-1 (]: Python model materialization is table
[0m10:08:32.093925 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:08:34.367176 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:08:34.368546 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTczMTMsImlhdCI6MTY4NzQ1MzcxM30.OXQ6jn6TpqutP2-x6OXicyssw4iX8qpJCmw_Xxe8P-cn8FSdKLhb6NGa7BwtJl9RqYUVmvpxHVaBM9AoDKrHCSkRqNU5wEgZ0oT68DNDM-pPh1eneYiJD7MR8FhodcuTPQtN1qYDcD2z2FALkDHcbl6OcU18RYk6zQGtRyxmyayZJCFTlm0oQEpBcQBn2kNLsuQ08AJj3vsKbixQExKlXEgPJfZtKmHkDIdzqHO3NVUl19DEW3gEZpJ-pABJnVh-aP_D6TR9vY0iVTwZsl442_sS_OiYvHQL6gM0y5cIS6FS3duU1FMeYxUkvC_XnK4PyzgPRk3TJrdmYbj62j17OA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.WEB_ORDER_INFO": "FAWDBTCORE.WEB_ORDER_INFO"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    # from sklearn.model_selection import train_test_split
    # from sklearn.preprocessing import LabelEncoder
    # from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        # from sklearn.model_selection import train_test_split
        # from sklearn.preprocessing import LabelEncoder
        # from sklearn.tree import DecisionTreeClassifier
    
        s_df = dbt.source("FAWDBTCORE", "WEB_ORDER_INFO")
        #df = s_df.pull()
        
        # X = s_df[['price']]  # Independent variable
        # y = s_df['shipping_city']  # Dependent variable
    
        # Encode the categorical variable 'shipping_city'
        # label_encoder = LabelEncoder()
        # y_encoded = label_encoder.fit_transform(y)
    
        # # Split the data into training and testing sets
        # X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_170834 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_170834';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:08:34.370261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:34.370937 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:08:35.905474 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:08:35.906691 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:08:36.008339 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:08:32.075686 => 10:08:36.007636
[0m10:08:36.016598 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:08:36.017815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed8c4e-954e-4c93-87b0-c0449e7ce060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c4b90>]}
[0m10:08:36.018174 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.96s]
[0m10:08:36.018418 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:08:36.019325 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:08:36.019608 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:08:37.230120 [debug] [MainThread]: On master: COMMIT
[0m10:08:37.230877 [debug] [MainThread]: Using oracle connection "master"
[0m10:08:37.231356 [debug] [MainThread]: On master: COMMIT
[0m10:08:37.326396 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:08:37.327166 [debug] [MainThread]: On master: Close
[0m10:08:37.426070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:37.426775 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:08:37.427282 [info ] [MainThread]: 
[0m10:08:37.427770 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.60 seconds (10.60s).
[0m10:08:37.428605 [debug] [MainThread]: Command end result
[0m10:08:37.436207 [info ] [MainThread]: 
[0m10:08:37.436675 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:08:37.436853 [info ] [MainThread]: 
[0m10:08:37.437007 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:08:37.437156 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:08:37.437294 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:08:37.437428 [info ] [MainThread]: 
[0m10:08:37.437581 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:08:37.437887 [debug] [MainThread]: Command `dbt run` failed at 10:08:37.437841 after 10.86 seconds
[0m10:08:37.438115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e46c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e44e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b8c90>]}
[0m10:08:37.438330 [debug] [MainThread]: Flushing usage events
[0m10:08:46.883689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104247d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104247f90>]}


============================== 10:08:46.886568 | 3406ad1b-118d-4f6f-8f4d-7f5ceb7d7ab6 ==============================
[0m10:08:46.886568 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:08:46.886883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:08:46.935557 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:08:46.957385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3406ad1b-118d-4f6f-8f4d-7f5ceb7d7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104976450>]}
[0m10:08:46.963780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3406ad1b-118d-4f6f-8f4d-7f5ceb7d7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104959650>]}
[0m10:08:46.996481 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:08:47.059500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:08:47.059833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:08:47.063484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3406ad1b-118d-4f6f-8f4d-7f5ceb7d7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c74d0>]}
[0m10:08:47.068374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3406ad1b-118d-4f6f-8f4d-7f5ceb7d7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10427b050>]}
[0m10:08:47.068716 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:08:47.068952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3406ad1b-118d-4f6f-8f4d-7f5ceb7d7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d2d390>]}
[0m10:08:47.069754 [info ] [MainThread]: 
[0m10:08:47.070172 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:08:47.070804 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:08:47.075892 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:08:47.076109 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:08:47.076278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:47.076450 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:08:48.612643 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:08:48.709192 [debug] [ThreadPool]: On list_None: Close
[0m10:08:48.812866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:08:48.817686 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:08:48.818105 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:08:48.818366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:48.818623 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:08:50.275683 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:08:50.288085 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:08:50.288784 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:08:50.507787 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:08:50.727923 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:08:50.879307 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:08:51.019543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3406ad1b-118d-4f6f-8f4d-7f5ceb7d7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104976e90>]}
[0m10:08:51.020797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:08:51.021398 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:08:52.435116 [debug] [MainThread]: On master: COMMIT
[0m10:08:52.437440 [debug] [MainThread]: Using oracle connection "master"
[0m10:08:52.438646 [debug] [MainThread]: On master: COMMIT
[0m10:08:52.549138 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:08:52.551523 [debug] [MainThread]: On master: Close
[0m10:08:52.657355 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:08:52.658392 [info ] [MainThread]: 
[0m10:08:52.665248 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:08:52.666080 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:08:52.666816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:08:52.667138 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:08:52.689983 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:08:52.692779 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:08:52.667360 => 10:08:52.692588
[0m10:08:52.693154 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:08:52.703609 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:08:52.704039 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:08:52.714286 [info ] [Thread-1 (]: Python model materialization is table
[0m10:08:52.714707 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:08:55.049533 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:08:55.050147 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTczMzQsImlhdCI6MTY4NzQ1MzczNH0.kn9WQ-xUK1LraaoS_9CUDeUiiQyn0mExKp_m70XFg8dfAvSOt3EYTbii79ttvZPixmidAzDJCby0HMvzivw-Vv1V7sjutnKfCU4RJx_GhHFQT66yCwzhf-1q97LatYIOTJ55WqxSHbFj7vjvy-afougvhXwQoid8kwg2d2aaYpPBgoD0hQlvZJKzEpRPnVick8Wd36ItZ8zzUgF7-ustMR6gX9MX-daNbuO-3wwj6q5qwxJrzhJQeQbv4-N6GBQ2XjHiUR6xL5eDhdeN_Rhzt8NDWqwhJ90dX3CW7JzaXsHGRiKWaifSVxSnmnkfCgQKAb0eWuhCcXf4FYBfehhZUg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.WEB_ORDER_INFO": "FAWDBTCORE.WEB_ORDER_INFO"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    # from sklearn.model_selection import train_test_split
    # from sklearn.preprocessing import LabelEncoder
    # from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        # from sklearn.model_selection import train_test_split
        # from sklearn.preprocessing import LabelEncoder
        # from sklearn.tree import DecisionTreeClassifier
    
        s_df = dbt.source("FAWDBTCORE", "WEB_ORDER_INFO")
        #df = s_df.pull()
        
        # X = s_df[['price']]  # Independent variable
        # y = s_df['shipping_city']  # Dependent variable
    
        # Encode the categorical variable 'shipping_city'
        # label_encoder = LabelEncoder()
        # y_encoded = label_encoder.fit_transform(y)
    
        # # Split the data into training and testing sets
        # X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_170855 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_170855';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:08:55.050844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:55.051137 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:08:56.269260 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:08:56.271080 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:08:56.382349 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:08:52.693358 => 10:08:56.381861
[0m10:08:56.392199 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:08:56.393354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3406ad1b-118d-4f6f-8f4d-7f5ceb7d7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd4ad0>]}
[0m10:08:56.393757 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.73s]
[0m10:08:56.394008 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:08:56.394963 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:08:56.395169 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:08:57.788829 [debug] [MainThread]: On master: COMMIT
[0m10:08:57.789671 [debug] [MainThread]: Using oracle connection "master"
[0m10:08:57.790135 [debug] [MainThread]: On master: COMMIT
[0m10:08:57.909161 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:08:57.910115 [debug] [MainThread]: On master: Close
[0m10:08:58.035579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:58.036533 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:08:58.037094 [info ] [MainThread]: 
[0m10:08:58.037596 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.97 seconds (10.97s).
[0m10:08:58.038348 [debug] [MainThread]: Command end result
[0m10:08:58.056412 [info ] [MainThread]: 
[0m10:08:58.057106 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:08:58.057422 [info ] [MainThread]: 
[0m10:08:58.057714 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:08:58.058010 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:08:58.058278 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:08:58.058548 [info ] [MainThread]: 
[0m10:08:58.058869 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:08:58.059534 [debug] [MainThread]: Command `dbt run` failed at 10:08:58.059432 after 11.21 seconds
[0m10:08:58.060008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b7ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b7ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104affed0>]}
[0m10:08:58.060447 [debug] [MainThread]: Flushing usage events
[0m10:09:59.657059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa17550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa17fd0>]}


============================== 10:09:59.659872 | a8dc7e44-715b-46bb-88fd-0ac9fa96e059 ==============================
[0m10:09:59.659872 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:09:59.660193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:09:59.718913 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:09:59.740981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8dc7e44-715b-46bb-88fd-0ac9fa96e059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa5c410>]}
[0m10:09:59.747256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8dc7e44-715b-46bb-88fd-0ac9fa96e059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2cda10>]}
[0m10:09:59.782564 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:09:59.822938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:09:59.823238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:09:59.826791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8dc7e44-715b-46bb-88fd-0ac9fa96e059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa975d0>]}
[0m10:09:59.831221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8dc7e44-715b-46bb-88fd-0ac9fa96e059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aacb110>]}
[0m10:09:59.831470 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:09:59.831643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8dc7e44-715b-46bb-88fd-0ac9fa96e059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2c6c10>]}
[0m10:09:59.832332 [info ] [MainThread]: 
[0m10:09:59.832690 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:09:59.833203 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:09:59.838174 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:09:59.838459 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:09:59.838630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:59.838803 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:10:01.446156 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:10:01.548668 [debug] [ThreadPool]: On list_None: Close
[0m10:10:01.652379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:10:01.661289 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:10:01.662010 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:10:01.662417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:10:01.662849 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:10:03.039942 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:10:03.050923 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:10:03.051651 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:10:03.179711 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:10:03.398228 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:10:03.500634 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:10:03.604829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8dc7e44-715b-46bb-88fd-0ac9fa96e059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4f2310>]}
[0m10:10:03.605345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:10:03.605659 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:10:04.864510 [debug] [MainThread]: On master: COMMIT
[0m10:10:04.866079 [debug] [MainThread]: Using oracle connection "master"
[0m10:10:04.866595 [debug] [MainThread]: On master: COMMIT
[0m10:10:04.964180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:10:04.965903 [debug] [MainThread]: On master: Close
[0m10:10:05.106383 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:10:05.107845 [info ] [MainThread]: 
[0m10:10:05.207701 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:10:05.208657 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:10:05.209703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:10:05.210360 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:10:05.235490 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:10:05.237546 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:10:05.210749 => 10:10:05.237315
[0m10:10:05.237975 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:10:05.249637 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:10:05.250075 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:10:05.261678 [info ] [Thread-1 (]: Python model materialization is table
[0m10:10:05.262136 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:10:07.662873 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:10:07.664488 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTc0MDYsImlhdCI6MTY4NzQ1MzgwNn0.Q4XBpHjKxTd2XFn4eDPFT4-s6Rcf8zyaT6NpL3fptC7CyI-lpAY2eyH7NiBqy3x_YokqU9P-Kv0Tn21oTylYpe3e_7nCyBuCefma357GvQ1Ndcq7SJQWuRGBaQyQs6s4m2aB7O6sSbxqO5xXF1PAjcuI9GxUzmp4A9txvDpZXtdMXw7LrVSi1fyO3qCfh7-EIhnqGHhpsUVyQn7P4ezgP1ao3Gc9PBsKAz-8B6gElB5UhDyG6vgxgj5qBTflJQ61ZL7ALovgD9hQSKdascMwc_q20guJ0onktRfb6ixyaLqoSd_lkdM3AxVglXy4--fEVB_uIe6tIsop_EWkg3WHLw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.WEB_ORDER_INFO": "FAWDBTCORE.WEB_ORDER_INFO"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    # from sklearn.model_selection import train_test_split
    # from sklearn.preprocessing import LabelEncoder
    # from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        # from sklearn.model_selection import train_test_split
        # from sklearn.preprocessing import LabelEncoder
        # from sklearn.tree import DecisionTreeClassifier
    
        s_df = dbt.source("FAWDBTCORE", "WEB_ORDER_INFO")
        #df = s_df.pull()
        
        # X = s_df[['price']]  # Independent variable
        # y = s_df['shipping_city']  # Dependent variable
    
        # Encode the categorical variable 'shipping_city'
        # label_encoder = LabelEncoder()
        # y_encoded = label_encoder.fit_transform(y)
    
        # # Split the data into training and testing sets
        # X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171007 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171007';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:10:07.666166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:07.666832 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:10:09.002786 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m10:10:09.005236 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:10:09.103262 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:10:05.238215 => 10:10:09.103057
[0m10:10:09.109653 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:10:09.111255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dc7e44-715b-46bb-88fd-0ac9fa96e059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b351a10>]}
[0m10:10:09.111735 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.90s]
[0m10:10:09.112019 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:10:09.113064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:10:09.113394 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:10:10.406592 [debug] [MainThread]: On master: COMMIT
[0m10:10:10.408958 [debug] [MainThread]: Using oracle connection "master"
[0m10:10:10.409837 [debug] [MainThread]: On master: COMMIT
[0m10:10:10.517180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:10:10.519647 [debug] [MainThread]: On master: Close
[0m10:10:10.625637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:10.626436 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:10:10.626846 [info ] [MainThread]: 
[0m10:10:10.627198 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.79 seconds (10.79s).
[0m10:10:10.627737 [debug] [MainThread]: Command end result
[0m10:10:10.639616 [info ] [MainThread]: 
[0m10:10:10.640254 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:10:10.640497 [info ] [MainThread]: 
[0m10:10:10.640739 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:10:10.640970 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m10:10:10.641174 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:10:10.641381 [info ] [MainThread]: 
[0m10:10:10.641615 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:10:10.642175 [debug] [MainThread]: Command `dbt run` failed at 10:10:10.642089 after 11.02 seconds
[0m10:10:10.642567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a328810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109701350>]}
[0m10:10:10.642929 [debug] [MainThread]: Flushing usage events
[0m10:11:05.991411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104717bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104717f90>]}


============================== 10:11:05.994621 | e5a7ed1b-0f0b-48a8-bcb8-3542b0a1ef53 ==============================
[0m10:11:05.994621 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:11:05.994965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:11:06.041649 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:11:06.063412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5a7ed1b-0f0b-48a8-bcb8-3542b0a1ef53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104728290>]}
[0m10:11:06.069767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5a7ed1b-0f0b-48a8-bcb8-3542b0a1ef53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e29650>]}
[0m10:11:06.102616 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:11:06.139505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:11:06.139962 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:11:06.161126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5a7ed1b-0f0b-48a8-bcb8-3542b0a1ef53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cda850>]}
[0m10:11:06.167000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5a7ed1b-0f0b-48a8-bcb8-3542b0a1ef53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105830b90>]}
[0m10:11:06.167388 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:11:06.167575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5a7ed1b-0f0b-48a8-bcb8-3542b0a1ef53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e59190>]}
[0m10:11:06.168344 [info ] [MainThread]: 
[0m10:11:06.168725 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:11:06.169241 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:11:06.174076 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:11:06.174315 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:11:06.174484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:06.174660 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:11:07.603608 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:11:07.704044 [debug] [ThreadPool]: On list_None: Close
[0m10:11:07.804606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:11:07.813077 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:11:07.813641 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:11:07.813929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:07.814230 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:11:09.069051 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:11:09.080579 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:11:09.081242 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:11:09.198304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:11:09.410947 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:11:09.506978 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:11:09.670834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5a7ed1b-0f0b-48a8-bcb8-3542b0a1ef53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d99490>]}
[0m10:11:09.671551 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:11:09.671897 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:11:10.827445 [debug] [MainThread]: On master: COMMIT
[0m10:11:10.829490 [debug] [MainThread]: Using oracle connection "master"
[0m10:11:10.830148 [debug] [MainThread]: On master: COMMIT
[0m10:11:10.925309 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:11:10.927335 [debug] [MainThread]: On master: Close
[0m10:11:11.028532 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:11:11.029205 [info ] [MainThread]: 
[0m10:11:11.035373 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:11:11.036227 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:11:11.037198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:11:11.037648 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:11:11.054671 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:11:11.055848 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:11:11.037968 => 10:11:11.055709
[0m10:11:11.056147 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:11:11.067393 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:11:11.067919 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:11:11.079150 [info ] [Thread-1 (]: Python model materialization is table
[0m10:11:11.079609 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:11:13.037999 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:11:13.039519 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTc0NzIsImlhdCI6MTY4NzQ1Mzg3Mn0.lfv3cnWw2dc5KOpAwK_DMwMPupOrUgTlFPd8-BNGjrPvBYPMCtOMWqecckyrEML1xa1lgdK5oYKV1q-dDY-kA2RAJhrXbkpwEJoCvGFSg-5c3O15RfU4cE0003Fkzfkdrr2GGD07p_Sy2z-bRLlEK9I1x1fdqbtANvH5CyNSDzPC_vm027DklDB7nUh3jmp2zeXS2SDiZAmy269qAd-3HiiGS9mg1VPgfEaE7gov9-DxbY3BxlDGpfJRsvp4hx552adZqwM3VKyV4J2tca7BBQOu2OhEsOERGUmr12j1x9uJvoA_Yt_8QHcR6q_GMYGYcbQPoK0hAsp0r1whmhRz7Q!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.raw_users": "FAWDBTCORE.raw_users"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "raw_users")
        #s_df = s_df.pull()
        med = s_df["USER_ID"].median()
    
        diff = (s_df["USER_ID"] - med)
    
        s_df = s_df.concat({"diff_col": diff})
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171113 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171113';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:11:13.041213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:13.041841 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:11:38.138076 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m10:11:38.143072 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:11:38.159692 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:11:38.160472 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:11:38.276388 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:11:38.282846 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:11:38.283481 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:11:38.387101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:11:38.406178 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:11:38.407233 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:11:38.407687 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:11:38.501296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:11:38.511154 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:11:38.511931 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:11:38.633944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:11:38.651658 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:11:11.056335 => 10:11:38.651478
[0m10:11:38.652220 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:11:38.754885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5a7ed1b-0f0b-48a8-bcb8-3542b0a1ef53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a27290>]}
[0m10:11:38.756204 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 27.72s]
[0m10:11:38.756980 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:11:38.759218 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:11:38.759871 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:11:40.031774 [debug] [MainThread]: On master: COMMIT
[0m10:11:40.034322 [debug] [MainThread]: Using oracle connection "master"
[0m10:11:40.035184 [debug] [MainThread]: On master: COMMIT
[0m10:11:40.130327 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:11:40.132694 [debug] [MainThread]: On master: Close
[0m10:11:40.233777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:40.234636 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:11:40.235023 [info ] [MainThread]: 
[0m10:11:40.235329 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 34.07 seconds (34.07s).
[0m10:11:40.235897 [debug] [MainThread]: Command end result
[0m10:11:40.246225 [info ] [MainThread]: 
[0m10:11:40.246836 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:11:40.247104 [info ] [MainThread]: 
[0m10:11:40.247390 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:11:40.248025 [debug] [MainThread]: Command `dbt run` succeeded at 10:11:40.247921 after 34.28 seconds
[0m10:11:40.248465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d7a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d7a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100edec50>]}
[0m10:11:40.248849 [debug] [MainThread]: Flushing usage events
[0m10:12:08.406906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a17d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a17f90>]}


============================== 10:12:08.409392 | 9806e671-c188-4c02-bcf2-b0041bfd38be ==============================
[0m10:12:08.409392 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:12:08.409723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:12:08.461581 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:12:08.482668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9806e671-c188-4c02-bcf2-b0041bfd38be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10376ce50>]}
[0m10:12:08.488977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9806e671-c188-4c02-bcf2-b0041bfd38be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a96810>]}
[0m10:12:08.524385 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:12:08.563728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:12:08.564453 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/sources.yml
[0m10:12:08.564668 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:12:08.574096 [debug] [MainThread]: 1699: static parser successfully parsed average_duration_by_platform_country.sql
[0m10:12:08.580796 [debug] [MainThread]: 1699: static parser successfully parsed event_counts_by_platform.sql
[0m10:12:08.582842 [debug] [MainThread]: 1603: static parser failed on combined_categorized_events.sql
[0m10:12:08.587104 [debug] [MainThread]: 1602: parser fallback to jinja rendering on combined_categorized_events.sql
[0m10:12:08.588383 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m10:12:08.590462 [debug] [MainThread]: 1699: static parser successfully parsed most_active_mobile_users.sql
[0m10:12:08.592686 [debug] [MainThread]: 1699: static parser successfully parsed most_frequent_browser.sql
[0m10:12:08.594688 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m10:12:08.596747 [debug] [MainThread]: 1603: static parser failed on staging/stg_web_events.sql
[0m10:12:08.599637 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_web_events.sql
[0m10:12:08.600656 [debug] [MainThread]: 1603: static parser failed on staging/stg_mobile_events.sql
[0m10:12:08.603053 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_mobile_events.sql
[0m10:12:08.619153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9806e671-c188-4c02-bcf2-b0041bfd38be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7db10>]}
[0m10:12:08.639211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9806e671-c188-4c02-bcf2-b0041bfd38be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a6d90>]}
[0m10:12:08.639591 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:12:08.639772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9806e671-c188-4c02-bcf2-b0041bfd38be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f0c10>]}
[0m10:12:08.640567 [info ] [MainThread]: 
[0m10:12:08.640986 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:12:08.641520 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:12:08.646738 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:12:08.647056 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:12:08.647227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:08.647393 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:12:11.443854 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:12:11.554192 [debug] [ThreadPool]: On list_None: Close
[0m10:12:11.655879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:12:11.661340 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:12:11.661834 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:12:11.662089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:11.662336 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:12:12.927031 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:12:12.941476 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:12:12.942160 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:12:13.064059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:12:13.261229 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:12:13.354697 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:12:13.456263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9806e671-c188-4c02-bcf2-b0041bfd38be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106129690>]}
[0m10:12:13.457081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:12:13.457406 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:12:14.645829 [debug] [MainThread]: On master: COMMIT
[0m10:12:14.647670 [debug] [MainThread]: Using oracle connection "master"
[0m10:12:14.648187 [debug] [MainThread]: On master: COMMIT
[0m10:12:14.743761 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:12:14.745917 [debug] [MainThread]: On master: Close
[0m10:12:14.849476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:12:14.851245 [info ] [MainThread]: 
[0m10:12:14.904108 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:12:14.904893 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:12:14.905626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:12:14.905981 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:12:14.923317 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:12:14.924496 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:12:14.906227 => 10:12:14.924299
[0m10:12:14.924900 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:12:14.936355 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:12:14.936765 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:12:14.947527 [info ] [Thread-1 (]: Python model materialization is table
[0m10:12:14.947953 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:12:17.341872 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:12:17.343332 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTc1MzYsImlhdCI6MTY4NzQ1MzkzNn0.VKrqaD10roZw1y_4n8zC37HCRwf8UJBzEpMD-92Y9MjeVLVy29RC6iO153F28s7iR_vkjaY8gkW4uQaEzSdSbNGBqxYlBy2Os89jC6A4QW4WQN4kuKtjVm1iF0agT6u4vU7x9SMloYkiMJzq24lHcEtWhKAohNDThuZC_cyeUfPXhAV-IEnegMqpys-NAGscC6PLAzLislWsCmG9NFzWH9OcquaAIcKSKMkZlWVGPuQ_qKz6s-PNbrOIyvrZYN9khgaDyKlQh9jkaXiZnN0R_ljERjrJ37stxCH5zdlsF0mZ5f6EaGcwMDCIwuKeBjFO8x-W66jG99kV6Sbu7AQYRA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        #s_df = s_df.pull()
        med = s_df["USER_ID"].median()
    
        diff = (s_df["USER_ID"] - med)
    
        s_df = s_df.concat({"diff_col": diff})
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171217 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171217';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:12:17.344541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:12:17.345113 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:12:37.196613 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"\"'USER_ID'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 59, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 90
[0m10:12:37.199568 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:12:37.300693 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:12:14.925146 => 10:12:37.299177
[0m10:12:37.328691 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"\"'USER_ID'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 59, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 90
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:12:37.331419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9806e671-c188-4c02-bcf2-b0041bfd38be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643d150>]}
[0m10:12:37.332503 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 22.43s]
[0m10:12:37.332996 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:12:37.334690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:12:37.335376 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:12:38.617159 [debug] [MainThread]: On master: COMMIT
[0m10:12:38.618515 [debug] [MainThread]: Using oracle connection "master"
[0m10:12:38.619579 [debug] [MainThread]: On master: COMMIT
[0m10:12:38.714019 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:12:38.716343 [debug] [MainThread]: On master: Close
[0m10:12:38.812238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:38.812624 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:12:38.812882 [info ] [MainThread]: 
[0m10:12:38.813129 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 30.17 seconds (30.17s).
[0m10:12:38.813519 [debug] [MainThread]: Command end result
[0m10:12:38.819247 [info ] [MainThread]: 
[0m10:12:38.819758 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:12:38.820068 [info ] [MainThread]: 
[0m10:12:38.820284 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:12:38.820512 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"\"'USER_ID'\" : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 78, in main\n   File \"<string>\", line 59, in model\n   File \"oml/core/frame.py\", line 291, in oml.core.frame.DataFrame.__getitem__\n   File \"oml/core/frame.py\", line 224, in oml.core.frame.DataFrame.__lookup_idx\n"}
[0m10:12:38.820730 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m10:12:38.820920 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m10:12:38.821099 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m10:12:38.821273 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m10:12:38.821446 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m10:12:38.821622 [error] [MainThread]:   ORA-06512: at line 90
[0m10:12:38.821810 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:12:38.822039 [info ] [MainThread]: 
[0m10:12:38.822243 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:12:38.822644 [debug] [MainThread]: Command `dbt run` failed at 10:12:38.822583 after 30.43 seconds
[0m10:12:38.822943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100926c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100924e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a17d90>]}
[0m10:12:38.823212 [debug] [MainThread]: Flushing usage events
[0m10:13:02.450054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10670bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106717dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106717d90>]}


============================== 10:13:02.452679 | a1a916cd-685f-4237-b36c-38148789f840 ==============================
[0m10:13:02.452679 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:13:02.452995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:13:02.494498 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:13:02.516923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1a916cd-685f-4237-b36c-38148789f840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043cce50>]}
[0m10:13:02.523167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1a916cd-685f-4237-b36c-38148789f840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107515390>]}
[0m10:13:02.555688 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:13:02.588646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:13:02.589098 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:13:02.609769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1a916cd-685f-4237-b36c-38148789f840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11040fc10>]}
[0m10:13:02.620501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1a916cd-685f-4237-b36c-38148789f840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11040c410>]}
[0m10:13:02.620875 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:13:02.621062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a916cd-685f-4237-b36c-38148789f840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737a050>]}
[0m10:13:02.621908 [info ] [MainThread]: 
[0m10:13:02.622339 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:13:02.622871 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:13:02.627781 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:13:02.628009 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:13:02.628185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:02.628358 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:13:04.042111 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:13:04.166532 [debug] [ThreadPool]: On list_None: Close
[0m10:13:04.273699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:13:04.280846 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:13:04.281421 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:13:04.281711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:04.282010 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:13:05.706733 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:13:05.717149 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:13:05.717755 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:13:05.843690 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:06.053878 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:13:06.151165 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:13:06.266017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a916cd-685f-4237-b36c-38148789f840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110622e10>]}
[0m10:13:06.266855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:13:06.267154 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:13:07.423280 [debug] [MainThread]: On master: COMMIT
[0m10:13:07.425524 [debug] [MainThread]: Using oracle connection "master"
[0m10:13:07.426522 [debug] [MainThread]: On master: COMMIT
[0m10:13:07.522688 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:13:07.525096 [debug] [MainThread]: On master: Close
[0m10:13:07.624259 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:13:07.625036 [info ] [MainThread]: 
[0m10:13:07.630262 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:13:07.631051 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:13:07.631829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:13:07.632217 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:13:07.652377 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:13:07.653624 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:13:07.632489 => 10:13:07.653403
[0m10:13:07.654010 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:13:07.664830 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:13:07.665261 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:13:07.675792 [info ] [Thread-1 (]: Python model materialization is table
[0m10:13:07.676226 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:13:09.890813 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:13:09.891901 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTc1ODgsImlhdCI6MTY4NzQ1Mzk4OH0.nE6ddqq_UvrBCKgOAoVgSpR8C4Tpq1N8JMLreAsb5Sl2GNx8dqPag6x1kMgdgQGnpmZ4OuRBnBPBnoXQvMgeZmf2GuVY3WVJpORqFLi43NIn9aCneGPNBwbasE2m4lcoaoNHqOVOjTQCXDFDGoj1tj6pWNmPal2EJskIJgezhBirqe3sYvXRDlSwEY_TsOXd28-uCiiQhOwq3v_2cd3IJs10afNKmtjCt87hfRmOWe0NsopAEty42HOtA6K7FC6hD3pxJTlUKc8ltCGJ2IV8v8CvRzDKiKCWYDHzC0eVwwx_izWXIfZnv1xCG-Dn5YXTNsQPMt5yj-bZlFKUcoVZlg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        #s_df = s_df.pull()
    
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171309 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171309';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:13:09.893110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:13:09.893670 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:13:37.221208 [debug] [Thread-1 (]: SQL status: OK in 27.0 seconds
[0m10:13:37.224667 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:13:37.251033 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:13:37.251566 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:13:37.503661 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:13:37.516394 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:13:37.517886 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:13:37.748709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:13:37.775760 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:13:37.776787 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:13:37.777569 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:13:37.874720 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:13:37.899832 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:13:37.900573 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:13:38.249878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:13:38.262722 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:13:07.654220 => 10:13:38.262555
[0m10:13:38.263213 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:13:38.361994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a916cd-685f-4237-b36c-38148789f840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11049a810>]}
[0m10:13:38.362637 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 30.73s]
[0m10:13:38.363040 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:13:38.364163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:13:38.364446 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:13:39.692637 [debug] [MainThread]: On master: COMMIT
[0m10:13:39.693408 [debug] [MainThread]: Using oracle connection "master"
[0m10:13:39.694009 [debug] [MainThread]: On master: COMMIT
[0m10:13:39.788575 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:13:39.790273 [debug] [MainThread]: On master: Close
[0m10:13:39.891762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:13:39.892666 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:13:39.893239 [info ] [MainThread]: 
[0m10:13:39.893706 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 37.27 seconds (37.27s).
[0m10:13:39.894423 [debug] [MainThread]: Command end result
[0m10:13:39.907878 [info ] [MainThread]: 
[0m10:13:39.908664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:13:39.909214 [info ] [MainThread]: 
[0m10:13:39.909722 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:13:39.910361 [debug] [MainThread]: Command `dbt run` succeeded at 10:13:39.910261 after 37.48 seconds
[0m10:13:39.910825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022da510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10243f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10243ce10>]}
[0m10:13:39.911275 [debug] [MainThread]: Flushing usage events
[0m10:15:42.394604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f77c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f83c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f83f90>]}


============================== 10:15:42.396978 | dac45de8-e24c-4686-be0d-feb11c8ab8d1 ==============================
[0m10:15:42.396978 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:15:42.397303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:15:42.440636 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:15:42.462873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dac45de8-e24c-4686-be0d-feb11c8ab8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc0e50>]}
[0m10:15:42.468970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dac45de8-e24c-4686-be0d-feb11c8ab8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108695a50>]}
[0m10:15:42.500428 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:15:42.537358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:15:42.537814 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:15:42.557976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dac45de8-e24c-4686-be0d-feb11c8ab8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086fbe10>]}
[0m10:15:42.565705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dac45de8-e24c-4686-be0d-feb11c8ab8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c8f10>]}
[0m10:15:42.566053 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:15:42.566238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac45de8-e24c-4686-be0d-feb11c8ab8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108036fd0>]}
[0m10:15:42.567000 [info ] [MainThread]: 
[0m10:15:42.567414 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:15:42.567969 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:15:42.572994 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:15:42.573257 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:15:42.573431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:42.573611 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:15:44.036276 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:15:44.140491 [debug] [ThreadPool]: On list_None: Close
[0m10:15:44.244601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:15:44.251323 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:15:44.251716 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:15:44.251961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:44.252211 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:15:45.548984 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:15:45.559894 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:15:45.560812 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:15:45.679552 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:15:45.882071 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:15:45.979689 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:15:46.086499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac45de8-e24c-4686-be0d-feb11c8ab8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107faca10>]}
[0m10:15:46.087484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:15:46.087875 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:15:47.296953 [debug] [MainThread]: On master: COMMIT
[0m10:15:47.297736 [debug] [MainThread]: Using oracle connection "master"
[0m10:15:47.298080 [debug] [MainThread]: On master: COMMIT
[0m10:15:47.392620 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:15:47.394525 [debug] [MainThread]: On master: Close
[0m10:15:47.497324 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:15:47.498357 [info ] [MainThread]: 
[0m10:15:47.504550 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:15:47.505453 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:15:47.506447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:15:47.506862 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:15:47.527379 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:15:47.528616 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:15:47.507144 => 10:15:47.528478
[0m10:15:47.528918 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:15:47.539636 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:15:47.540160 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:15:47.550798 [info ] [Thread-1 (]: Python model materialization is table
[0m10:15:47.551243 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:15:49.951429 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:15:49.952655 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTc3NDksImlhdCI6MTY4NzQ1NDE0OX0.Vl6NNGNW4sXynS0hwygKeVYljq1VUCBuH_wWTUAAtZuPsjuU0QqF3O7VwkBqjlyYrpiujhC9z7RTFzdiTKfL1Lhn1DQBahKs9FuD2wIPhU0H4rYFhgQYlL9pIQAoS75684pkbPozwasUrJDsYaEXqPJW40zTnZ0SjuHN8rbQxOwxWhSS-_kB389-LjyDktsNUvAYeAxIuDV5f7pPRnTo9zU7osGNW_DSmgw7hcG_K_7TIyNJ289OkncsMPJSDUd7yGayYV9RIpgG0vhL5_8Nhw06Nq7cJnXiw5-Uqhq8iDpd4H7y_Jc_AFRwaRBofdVBZUxlql8hbTfposIxzXt0SA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        #s_df = s_df.pull()
    
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171549 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171549';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:15:49.953879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:49.954384 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:16:15.073040 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m10:16:15.077886 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:16:15.093954 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:16:15.094768 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:16:15.211844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:16:15.219630 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:16:15.220370 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:16:15.324781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:16:15.340726 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:16:15.341354 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:16:15.341728 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:16:15.438338 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:16:15.450042 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:16:15.450529 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:16:15.570675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:16:15.587062 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:15:47.529110 => 10:16:15.586875
[0m10:16:15.587634 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:16:15.693900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac45de8-e24c-4686-be0d-feb11c8ab8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a6a10>]}
[0m10:16:15.695016 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 28.19s]
[0m10:16:15.695635 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:16:15.697625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:15.698134 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:16:17.276934 [debug] [MainThread]: On master: COMMIT
[0m10:16:17.279270 [debug] [MainThread]: Using oracle connection "master"
[0m10:16:17.280012 [debug] [MainThread]: On master: COMMIT
[0m10:16:17.376070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:16:17.378560 [debug] [MainThread]: On master: Close
[0m10:16:17.481746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:17.482802 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:16:17.483393 [info ] [MainThread]: 
[0m10:16:17.483762 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 34.92 seconds (34.92s).
[0m10:16:17.484171 [debug] [MainThread]: Command end result
[0m10:16:17.493805 [info ] [MainThread]: 
[0m10:16:17.494250 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:17.494432 [info ] [MainThread]: 
[0m10:16:17.494619 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:17.495320 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:17.495223 after 35.12 seconds
[0m10:16:17.495657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104756910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104756510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bac50>]}
[0m10:16:17.495983 [debug] [MainThread]: Flushing usage events
[0m10:16:57.229042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f14090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f175d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f17e90>]}


============================== 10:16:57.231447 | 95b92b2b-3447-4962-bb90-709abb4e54af ==============================
[0m10:16:57.231447 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:16:57.231745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:16:57.273606 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:16:57.296664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95b92b2b-3447-4962-bb90-709abb4e54af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f28550>]}
[0m10:16:57.302740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95b92b2b-3447-4962-bb90-709abb4e54af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090cdc50>]}
[0m10:16:57.336580 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:16:57.369330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:16:57.369772 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:16:57.391242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95b92b2b-3447-4962-bb90-709abb4e54af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109290550>]}
[0m10:16:57.399676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95b92b2b-3447-4962-bb90-709abb4e54af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109200e50>]}
[0m10:16:57.400026 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:16:57.400204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95b92b2b-3447-4962-bb90-709abb4e54af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffc510>]}
[0m10:16:57.400950 [info ] [MainThread]: 
[0m10:16:57.401327 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:16:57.401834 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:16:57.406882 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:16:57.407182 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:16:57.407360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:57.407539 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:16:58.987494 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:16:59.098061 [debug] [ThreadPool]: On list_None: Close
[0m10:16:59.202045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:16:59.210565 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:16:59.211151 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:16:59.211483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:59.211811 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:17:00.542471 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:17:00.553956 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:17:00.554839 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:17:00.688072 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:17:00.885019 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:17:00.982041 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:17:01.085297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95b92b2b-3447-4962-bb90-709abb4e54af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d6910>]}
[0m10:17:01.086241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:01.086567 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:17:02.254542 [debug] [MainThread]: On master: COMMIT
[0m10:17:02.256893 [debug] [MainThread]: Using oracle connection "master"
[0m10:17:02.258003 [debug] [MainThread]: On master: COMMIT
[0m10:17:02.354913 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:17:02.357207 [debug] [MainThread]: On master: Close
[0m10:17:02.460522 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:17:02.461449 [info ] [MainThread]: 
[0m10:17:02.468105 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:17:02.469013 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:17:02.469919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:17:02.470401 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:17:02.491639 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:17:02.493067 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:17:02.470727 => 10:17:02.492839
[0m10:17:02.493488 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:17:02.504132 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:17:02.504620 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:17:02.515209 [info ] [Thread-1 (]: Python model materialization is table
[0m10:17:02.515624 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:17:04.649980 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:17:04.651586 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTc4MjMsImlhdCI6MTY4NzQ1NDIyM30.LI9xfTB4zFd58m4Kb3oRoi6rLysD92LhLG1d1vlOUzIpbBcmZ2jw9CD7T_NJWaEIxsrsTWmhwIBAx1PLOI_uza3xZue9NpA6L93DWPpDbLjnxyXMuyd0K4vWtY21CcnRDTD_XGZxkPsA6dgsTdC-tmGe_wlQF5yNbS1MlZgShAqoOTZjQhMFV7xSJzbShHDQAY0mlnU2CqahI8POOPGpWCm_seoXAkHdsl1xiW-5iIhWFr-0xo83nY5CHDySwj298EKpTyHmPHMvNQf40JGGeAk3l4QcAVZ0ptpbVN8PQCh3Uhu1-YX9FixscbZihyAwpwQrdbB6dESc3Ed39WA51Q!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        s_df = s_df.pull()
    
    
        return s_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171704 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171704';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:17:04.653052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:04.653736 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:17:30.189020 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m10:17:30.192742 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:17:30.207762 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:17:30.208686 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:17:30.325907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:17:30.334271 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:17:30.335076 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:17:30.451050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:17:30.466890 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:17:30.467635 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:17:30.468017 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:17:30.565820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:17:30.576545 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:17:30.577411 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:17:30.702752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:17:30.716636 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:17:02.493708 => 10:17:30.716505
[0m10:17:30.717016 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:17:30.818954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95b92b2b-3447-4962-bb90-709abb4e54af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b6110>]}
[0m10:17:30.820153 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 28.35s]
[0m10:17:30.820855 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:17:30.823112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:30.823807 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:17:32.144904 [debug] [MainThread]: On master: COMMIT
[0m10:17:32.147051 [debug] [MainThread]: Using oracle connection "master"
[0m10:17:32.148042 [debug] [MainThread]: On master: COMMIT
[0m10:17:32.249840 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:17:32.251936 [debug] [MainThread]: On master: Close
[0m10:17:32.362711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:32.363590 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:17:32.364032 [info ] [MainThread]: 
[0m10:17:32.364378 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 34.96 seconds (34.96s).
[0m10:17:32.364995 [debug] [MainThread]: Command end result
[0m10:17:32.374806 [info ] [MainThread]: 
[0m10:17:32.375344 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:32.375639 [info ] [MainThread]: 
[0m10:17:32.375952 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:17:32.376541 [debug] [MainThread]: Command `dbt run` succeeded at 10:17:32.376448 after 35.16 seconds
[0m10:17:32.376953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d86510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eeb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ee8e10>]}
[0m10:17:32.377388 [debug] [MainThread]: Flushing usage events
[0m10:17:47.805505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105517d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105517f90>]}


============================== 10:17:47.808172 | 193db4fb-940b-405e-be2a-b9e8253609f7 ==============================
[0m10:17:47.808172 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:17:47.808509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:17:47.852028 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:17:47.879779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '193db4fb-940b-405e-be2a-b9e8253609f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10299ce50>]}
[0m10:17:47.885967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '193db4fb-940b-405e-be2a-b9e8253609f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dcda50>]}
[0m10:17:47.920809 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:17:47.961781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:17:47.962238 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:17:47.982904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '193db4fb-940b-405e-be2a-b9e8253609f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106872890>]}
[0m10:17:47.992270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '193db4fb-940b-405e-be2a-b9e8253609f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e769d0>]}
[0m10:17:47.992651 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:17:47.992836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '193db4fb-940b-405e-be2a-b9e8253609f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de6e10>]}
[0m10:17:47.993599 [info ] [MainThread]: 
[0m10:17:47.993993 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:17:47.994524 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:17:47.999647 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:17:47.999956 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:17:48.000128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:48.000304 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:17:49.296896 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:17:49.398065 [debug] [ThreadPool]: On list_None: Close
[0m10:17:49.497410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:17:49.502510 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:17:49.502914 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:17:49.503147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:49.503391 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:17:50.821392 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:17:50.826386 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:17:50.826803 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:17:50.980911 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:17:51.194364 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:17:51.303695 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:17:51.421111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '193db4fb-940b-405e-be2a-b9e8253609f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c8f90>]}
[0m10:17:51.422141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:51.422599 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:17:52.769855 [debug] [MainThread]: On master: COMMIT
[0m10:17:52.770556 [debug] [MainThread]: Using oracle connection "master"
[0m10:17:52.770954 [debug] [MainThread]: On master: COMMIT
[0m10:17:52.918712 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:17:52.919579 [debug] [MainThread]: On master: Close
[0m10:17:53.056466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:17:53.057384 [info ] [MainThread]: 
[0m10:17:53.063535 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:17:53.064051 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:17:53.064650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:17:53.064956 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:17:53.081595 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:17:53.082793 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:17:53.065179 => 10:17:53.082598
[0m10:17:53.083142 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:17:53.092768 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:17:53.093137 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:17:53.102847 [info ] [Thread-1 (]: Python model materialization is table
[0m10:17:53.103244 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:17:56.808472 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:17:56.809997 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTc4NzUsImlhdCI6MTY4NzQ1NDI3NX0.cVrp8UPztuy7y4-I8fsWTBni6tKQ8oTAn_z6FBkVAPKv9gXPIkU8suYfoMycC3bSwrv9YRNqUowTuCq3f3FoDUCjRqiyR2ak0F-ktVzCKVVRG6_KFkt2yJnZC9EM6hcg8D94mQMOr_DS8Ql3I41jiB_igq-KqMnSW92UFLIcv3knn_VvAuSS2QrgSO6f4HN5lthBABay2Mw7u9ssiDD5zL_RG37KgGxy5GVhD4YORmjaw8iT4NV7il2pbu3CdMNjnjyws-c9CZVDT2dsGd0SWXRMdl-hRCmchDShUSSBhdKKW1mYZpk1jWGJQ3GM-L7qEEO5v0CZBtLJnr--8brzHQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        X = df[['price']]  # Independent variable
        y = df['shipping_city']  # Dependent variable
    
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171756 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171756';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:17:56.811767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:56.812432 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:17:58.068863 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m10:17:58.070618 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:17:58.177491 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:17:53.083326 => 10:17:58.175879
[0m10:17:58.187872 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:17:58.190405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '193db4fb-940b-405e-be2a-b9e8253609f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d4b90>]}
[0m10:17:58.191585 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 5.13s]
[0m10:17:58.192162 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:17:58.194072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:58.194553 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:17:59.515995 [debug] [MainThread]: On master: COMMIT
[0m10:17:59.518524 [debug] [MainThread]: Using oracle connection "master"
[0m10:17:59.519286 [debug] [MainThread]: On master: COMMIT
[0m10:17:59.618602 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:17:59.619628 [debug] [MainThread]: On master: Close
[0m10:17:59.733507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:59.734303 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:17:59.734729 [info ] [MainThread]: 
[0m10:17:59.735081 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.74 seconds (11.74s).
[0m10:17:59.735624 [debug] [MainThread]: Command end result
[0m10:17:59.750450 [info ] [MainThread]: 
[0m10:17:59.750971 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:17:59.751271 [info ] [MainThread]: 
[0m10:17:59.751553 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:17:59.751799 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m10:17:59.752027 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:17:59.752272 [info ] [MainThread]: 
[0m10:17:59.752536 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:17:59.753092 [debug] [MainThread]: Command `dbt run` failed at 10:17:59.753008 after 11.97 seconds
[0m10:17:59.753498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a0ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a0ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f4690>]}
[0m10:17:59.753874 [debug] [MainThread]: Flushing usage events
[0m10:18:20.906395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105117c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105117f90>]}


============================== 10:18:20.908786 | 07ea7851-956c-49c9-a4a8-5166f3888ed7 ==============================
[0m10:18:20.908786 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:18:20.909108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:18:20.953171 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:18:20.975286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07ea7851-956c-49c9-a4a8-5166f3888ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105128710>]}
[0m10:18:20.981627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07ea7851-956c-49c9-a4a8-5166f3888ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105829d10>]}
[0m10:18:21.013844 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:18:21.052744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:18:21.053197 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:18:21.073683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07ea7851-956c-49c9-a4a8-5166f3888ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ebe90>]}
[0m10:18:21.098147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07ea7851-956c-49c9-a4a8-5166f3888ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585a810>]}
[0m10:18:21.098581 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:18:21.098785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07ea7851-956c-49c9-a4a8-5166f3888ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ef650>]}
[0m10:18:21.099627 [info ] [MainThread]: 
[0m10:18:21.100044 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:18:21.100616 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:18:21.105731 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:18:21.106048 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:18:21.106227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:21.106399 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:18:22.549674 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:18:22.649570 [debug] [ThreadPool]: On list_None: Close
[0m10:18:22.762158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:18:22.771481 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:18:22.772172 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:18:22.772519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:22.772884 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:18:24.281049 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:18:24.291575 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:18:24.292268 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:18:24.461899 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:18:24.697927 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:18:24.825421 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:18:24.971689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07ea7851-956c-49c9-a4a8-5166f3888ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f7d10>]}
[0m10:18:24.972787 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:24.973244 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:18:26.428451 [debug] [MainThread]: On master: COMMIT
[0m10:18:26.430506 [debug] [MainThread]: Using oracle connection "master"
[0m10:18:26.431130 [debug] [MainThread]: On master: COMMIT
[0m10:18:26.538997 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:18:26.541146 [debug] [MainThread]: On master: Close
[0m10:18:26.714611 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:18:26.716464 [info ] [MainThread]: 
[0m10:18:26.723083 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:18:26.723909 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:18:26.724823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:18:26.725335 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:18:26.745796 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:18:26.747126 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:18:26.725620 => 10:18:26.746875
[0m10:18:26.747529 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:18:26.758283 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:18:26.758712 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:18:26.769106 [info ] [Thread-1 (]: Python model materialization is table
[0m10:18:26.769495 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:18:29.180862 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:18:29.182413 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTc5MDgsImlhdCI6MTY4NzQ1NDMwOH0.fmTPgLM3MbFlLB597tl5JwoKaAUdvhy3iBiO92tM2km2lLHtmlbdvMJ0nrwrA2c_3FTnrU1qHtfxQ4fNNWYFoxcAPQmseFMJPPVWAO5SjsBomyUDZUciZRqf7IcDcwkKRsrqZcfn6RIO707KIrz-zwYyC6_kqNSWhBKK7lOHYTPXKAIZyp1TJIsrZn_DjQzX9rLPoP-9ImGjDiKg_NdUf-7xuOPfERT5-dC2yYLpnu-NVn7NUAbigaL1H8eGUlfPDUEXcw0VsFB-2mGBmeAxqLf1GsJG17xY22XWDrUClqUuKFFweBpeY9HSOPaswUHwQfqfCfthW5kpyILTFQus3g!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        # X = df[['price']]  # Independent variable
        # y = df['shipping_city']  # Dependent variable
    
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171829 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171829';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:18:29.183896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:29.184584 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:18:31.225449 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06550: line 67, column 20:
PLS-00103: Encountered the symbol "PRICE" when expecting one of the following:

   ) , * & = - + < / > at in is mod remainder not rem =>
   <an exponent (**)> <> or != or ~= >= <= <> and or like like2
   like4 likec between || multiset member submultiset
[0m10:18:31.227972 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:18:31.335005 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:18:26.747735 => 10:18:31.333672
[0m10:18:31.354816 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-06550: line 67, column 20:
  PLS-00103: Encountered the symbol "PRICE" when expecting one of the following:
  
     ) , * & = - + < / > at in is mod remainder not rem =>
     <an exponent (**)> <> or != or ~= >= <= <> and or like like2
     like4 likec between || multiset member submultiset
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:18:31.356988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07ea7851-956c-49c9-a4a8-5166f3888ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105108750>]}
[0m10:18:31.357665 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 4.63s]
[0m10:18:31.358026 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:18:31.359637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:18:31.360086 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:18:32.694870 [debug] [MainThread]: On master: COMMIT
[0m10:18:32.697043 [debug] [MainThread]: Using oracle connection "master"
[0m10:18:32.697713 [debug] [MainThread]: On master: COMMIT
[0m10:18:32.815837 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:18:32.817939 [debug] [MainThread]: On master: Close
[0m10:18:32.917997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:32.918824 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:18:32.919423 [info ] [MainThread]: 
[0m10:18:32.920386 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.82 seconds (11.82s).
[0m10:18:32.921055 [debug] [MainThread]: Command end result
[0m10:18:32.929536 [info ] [MainThread]: 
[0m10:18:32.930110 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:18:32.930493 [info ] [MainThread]: 
[0m10:18:32.930845 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:18:32.931370 [error] [MainThread]:   ORA-06550: line 67, column 20:
[0m10:18:32.931596 [error] [MainThread]:   PLS-00103: Encountered the symbol "PRICE" when expecting one of the following:
[0m10:18:32.931764 [error] [MainThread]:   
[0m10:18:32.931920 [error] [MainThread]:      ) , * & = - + < / > at in is mod remainder not rem =>
[0m10:18:32.932075 [error] [MainThread]:      <an exponent (**)> <> or != or ~= >= <= <> and or like like2
[0m10:18:32.932222 [error] [MainThread]:      like4 likec between || multiset member submultiset
[0m10:18:32.932371 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:18:32.932530 [info ] [MainThread]: 
[0m10:18:32.932712 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:18:32.933061 [debug] [MainThread]: Command `dbt run` failed at 10:18:32.933007 after 12.04 seconds
[0m10:18:32.933310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1005a6c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1005a4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f72d0>]}
[0m10:18:32.933543 [debug] [MainThread]: Flushing usage events
[0m10:19:38.734470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409bf90>]}


============================== 10:19:38.736762 | 144cfe5d-2dfd-4c4a-aea0-b017b8c0f8a7 ==============================
[0m10:19:38.736762 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:19:38.737084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:19:38.779707 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:19:38.802504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '144cfe5d-2dfd-4c4a-aea0-b017b8c0f8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104102290>]}
[0m10:19:38.808778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '144cfe5d-2dfd-4c4a-aea0-b017b8c0f8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ad5d0>]}
[0m10:19:38.842988 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:19:38.877398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:19:38.877859 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:19:38.898819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '144cfe5d-2dfd-4c4a-aea0-b017b8c0f8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104891e90>]}
[0m10:19:38.905294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '144cfe5d-2dfd-4c4a-aea0-b017b8c0f8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d0910>]}
[0m10:19:38.905651 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:19:38.905835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '144cfe5d-2dfd-4c4a-aea0-b017b8c0f8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104158d50>]}
[0m10:19:38.906583 [info ] [MainThread]: 
[0m10:19:38.906962 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:19:38.907493 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:19:38.912531 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:19:38.912814 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:19:38.912981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:38.913150 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:19:40.448304 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:19:40.573778 [debug] [ThreadPool]: On list_None: Close
[0m10:19:40.721598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:19:40.728685 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:19:40.729279 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:19:40.729616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:40.729950 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:19:42.147100 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:19:42.158833 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:19:42.159439 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:19:42.286202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:19:42.500287 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:19:42.603876 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:19:42.720300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '144cfe5d-2dfd-4c4a-aea0-b017b8c0f8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478ce50>]}
[0m10:19:42.721425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:42.721921 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:19:43.988693 [debug] [MainThread]: On master: COMMIT
[0m10:19:43.991270 [debug] [MainThread]: Using oracle connection "master"
[0m10:19:43.992049 [debug] [MainThread]: On master: COMMIT
[0m10:19:44.098603 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:19:44.101101 [debug] [MainThread]: On master: Close
[0m10:19:44.215258 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:19:44.216034 [info ] [MainThread]: 
[0m10:19:44.222313 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:19:44.223059 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:19:44.223800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:19:44.224157 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:19:44.244096 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:19:44.245227 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:19:44.224403 => 10:19:44.245066
[0m10:19:44.245555 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:19:44.256320 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:19:44.256837 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:19:44.267423 [info ] [Thread-1 (]: Python model materialization is table
[0m10:19:44.267868 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:19:46.340218 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:19:46.341722 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTc5ODUsImlhdCI6MTY4NzQ1NDM4NX0.P7ZAmOEXTZvsWNI7gTtQ7n84QWMz5vT2xc8blE0uSpzhv0cIztOoGfQypCKvfQBzRxdiR26_olRFeI5XUKH4u3QjyrI0YUeLSEUprYs1Ym6z5jNewxOAPhX8vWJwcCLvOA6myzxIEqsUbZ0oy6cxul4OFntXwpRd05FMMaQR03OLjR3qGhrc1PNbJXr4xyiM4BlLUEAIB_Lez4Sf8deuShKEZTW_EFJTa7XQjBKgkO4sTTwYHGFvBh_sKW6A50Ugoda3CQqI3cuDFJStJGWtp-MgmOC_Wzb4dkPxFkbMUG91lybavKijKdX5Bu7urfiDjqZc27k9egu_gc3Chp-1uA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        X = df[['PRICE']]  # Independent variable
        y = df['SHIPPING_CITY']  # Dependent variable
    
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171946 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_171946';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:19:46.343452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:46.344112 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:19:47.929203 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06550: line 67, column 18:
PLS-00103: Encountered the symbol "PRICE" when expecting one of the following:

   ) , * & = - + < / > at in is mod remainder not rem =>
   <an exponent (**)> <> or != or ~= >= <= <> and or like like2
   like4 likec between || multiset member submultiset
[0m10:19:47.932307 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:19:48.051988 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:19:44.245751 => 10:19:48.050807
[0m10:19:48.063475 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-06550: line 67, column 18:
  PLS-00103: Encountered the symbol "PRICE" when expecting one of the following:
  
     ) , * & = - + < / > at in is mod remainder not rem =>
     <an exponent (**)> <> or != or ~= >= <= <> and or like like2
     like4 likec between || multiset member submultiset
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:19:48.065936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '144cfe5d-2dfd-4c4a-aea0-b017b8c0f8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fe4d0>]}
[0m10:19:48.066824 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.84s]
[0m10:19:48.067551 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:19:48.069349 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:48.069923 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:19:49.564676 [debug] [MainThread]: On master: COMMIT
[0m10:19:49.566628 [debug] [MainThread]: Using oracle connection "master"
[0m10:19:49.567258 [debug] [MainThread]: On master: COMMIT
[0m10:19:49.670720 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:19:49.671675 [debug] [MainThread]: On master: Close
[0m10:19:49.785181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:49.786071 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:19:49.786539 [info ] [MainThread]: 
[0m10:19:49.786936 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.88 seconds (10.88s).
[0m10:19:49.787550 [debug] [MainThread]: Command end result
[0m10:19:49.868691 [info ] [MainThread]: 
[0m10:19:49.870571 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:19:49.871093 [info ] [MainThread]: 
[0m10:19:49.871559 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:19:49.871994 [error] [MainThread]:   ORA-06550: line 67, column 18:
[0m10:19:49.872426 [error] [MainThread]:   PLS-00103: Encountered the symbol "PRICE" when expecting one of the following:
[0m10:19:49.872821 [error] [MainThread]:   
[0m10:19:49.873215 [error] [MainThread]:      ) , * & = - + < / > at in is mod remainder not rem =>
[0m10:19:49.873577 [error] [MainThread]:      <an exponent (**)> <> or != or ~= >= <= <> and or like like2
[0m10:19:49.873948 [error] [MainThread]:      like4 likec between || multiset member submultiset
[0m10:19:49.874329 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:19:49.874715 [info ] [MainThread]: 
[0m10:19:49.875163 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:19:49.876060 [debug] [MainThread]: Command `dbt run` failed at 10:19:49.875925 after 11.16 seconds
[0m10:19:49.876570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040af510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009d2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009d0e10>]}
[0m10:19:49.877255 [debug] [MainThread]: Flushing usage events
[0m10:37:05.259919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103debcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df7f90>]}


============================== 10:37:05.262931 | a6ec1890-bdb2-45a1-b71e-6c165460261e ==============================
[0m10:37:05.262931 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:37:05.263248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:37:05.311135 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:37:05.333979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6ec1890-bdb2-45a1-b71e-6c165460261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5e290>]}
[0m10:37:05.340104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6ec1890-bdb2-45a1-b71e-6c165460261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045096d0>]}
[0m10:37:05.404217 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:37:05.445557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:37:05.445997 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:37:05.466639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6ec1890-bdb2-45a1-b71e-6c165460261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ede90>]}
[0m10:37:05.472432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6ec1890-bdb2-45a1-b71e-6c165460261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452db10>]}
[0m10:37:05.472703 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:37:05.472878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6ec1890-bdb2-45a1-b71e-6c165460261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ba7250>]}
[0m10:37:05.473568 [info ] [MainThread]: 
[0m10:37:05.473924 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:37:05.474453 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:37:05.479625 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:37:05.479953 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:37:05.480132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:05.480311 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:37:07.276030 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:37:07.398876 [debug] [ThreadPool]: On list_None: Close
[0m10:37:07.506018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:37:07.511607 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:37:07.512187 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:37:07.512455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:07.512717 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:37:08.941986 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:37:08.955699 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:37:08.956660 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:37:09.143175 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:37:09.400480 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:37:09.548076 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:37:09.709563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6ec1890-bdb2-45a1-b71e-6c165460261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044db690>]}
[0m10:37:09.710426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:37:09.710781 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:37:11.295979 [debug] [MainThread]: On master: COMMIT
[0m10:37:11.298342 [debug] [MainThread]: Using oracle connection "master"
[0m10:37:11.299391 [debug] [MainThread]: On master: COMMIT
[0m10:37:11.417523 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:37:11.419801 [debug] [MainThread]: On master: Close
[0m10:37:11.546463 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:37:11.547491 [info ] [MainThread]: 
[0m10:37:11.553874 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:37:11.554683 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:37:11.555453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:37:11.555830 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:37:11.575094 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:37:11.577117 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:37:11.556098 => 10:37:11.576923
[0m10:37:11.577517 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:37:11.588070 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:37:11.588473 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:37:11.599212 [info ] [Thread-1 (]: Python model materialization is table
[0m10:37:11.599644 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:37:13.846018 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:37:13.846924 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTkwMzMsImlhdCI6MTY4NzQ1NTQzM30.cBnb1FLGOWwVPATUGn724mbbXSmV76RvF9XmOP8jrEQue96H8YPNC6HsuSsNLL1bWrl9INaOre5wIq4UjMBQcJ5Ec3cwHOu2Je-9yuGVNkv25C_cVlMxoEjr-ecexm9hpuMNIh6SL3gzvzoVlztGla98NXZt-JhKykN6OfdrYLF_3XEpCarz6T0EA0MbZKPkEzH8r_HR2-xox_fyz3QJfAnqym56mDJj3iBhbyc3NaFa2AR1mQ9oXYhteZi33ClTDiS9fV0ZXFoA99nxbylfkIKs4y_lHREdMMktjGW1TTnEPBvEGlJuCj_V-RD6WU1uKsItchKjE8YSFwlMC8BRsg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        X = df[["PRICE"]]  # Independent variable
        y = df['SHIPPING_CITY']  # Dependent variable
    
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173713 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173713';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:37:13.847612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:13.847916 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:37:15.542444 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06550: line 68, column 17:
PLS-00103: Encountered the symbol "SHIPPING_CITY" when expecting one of the following:

   ) , * & = - + < / > at in is mod remainder not rem =>
   <an exponent (**)> <> or != or ~= >= <= <> and or like like2
   like4 likec between || multiset member submultiset
[0m10:37:15.544794 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:37:15.668523 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:37:11.577795 => 10:37:15.667409
[0m10:37:15.680923 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-06550: line 68, column 17:
  PLS-00103: Encountered the symbol "SHIPPING_CITY" when expecting one of the following:
  
     ) , * & = - + < / > at in is mod remainder not rem =>
     <an exponent (**)> <> or != or ~= >= <= <> and or like like2
     like4 likec between || multiset member submultiset
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:37:15.682583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ec1890-bdb2-45a1-b71e-6c165460261e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046eed10>]}
[0m10:37:15.682988 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 4.13s]
[0m10:37:15.683252 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:37:15.684416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:37:15.684683 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:37:17.284974 [debug] [MainThread]: On master: COMMIT
[0m10:37:17.287345 [debug] [MainThread]: Using oracle connection "master"
[0m10:37:17.288528 [debug] [MainThread]: On master: COMMIT
[0m10:37:17.429801 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:37:17.431710 [debug] [MainThread]: On master: Close
[0m10:37:17.569455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:17.570388 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:37:17.570931 [info ] [MainThread]: 
[0m10:37:17.571435 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.10 seconds (12.10s).
[0m10:37:17.572171 [debug] [MainThread]: Command end result
[0m10:37:17.584186 [info ] [MainThread]: 
[0m10:37:17.584516 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:37:17.584728 [info ] [MainThread]: 
[0m10:37:17.584932 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:37:17.585127 [error] [MainThread]:   ORA-06550: line 68, column 17:
[0m10:37:17.585314 [error] [MainThread]:   PLS-00103: Encountered the symbol "SHIPPING_CITY" when expecting one of the following:
[0m10:37:17.585494 [error] [MainThread]:   
[0m10:37:17.585664 [error] [MainThread]:      ) , * & = - + < / > at in is mod remainder not rem =>
[0m10:37:17.585837 [error] [MainThread]:      <an exponent (**)> <> or != or ~= >= <= <> and or like like2
[0m10:37:17.586005 [error] [MainThread]:      like4 likec between || multiset member submultiset
[0m10:37:17.586179 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:37:17.586356 [info ] [MainThread]: 
[0m10:37:17.586595 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:37:17.587066 [debug] [MainThread]: Command `dbt run` failed at 10:37:17.586990 after 12.35 seconds
[0m10:37:17.587415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10072ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10072ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd84d0>]}
[0m10:37:17.587735 [debug] [MainThread]: Flushing usage events
[0m10:37:32.921572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108108dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108108f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108117fd0>]}


============================== 10:37:32.924305 | 8ddb2901-c45d-4d4b-a232-37dcb5963fa8 ==============================
[0m10:37:32.924305 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:37:32.924626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:37:32.969285 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:37:32.991861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ddb2901-c45d-4d4b-a232-37dcb5963fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a231fd0>]}
[0m10:37:32.998128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ddb2901-c45d-4d4b-a232-37dcb5963fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e5810>]}
[0m10:37:33.030723 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:37:33.063665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:37:33.064106 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:37:33.084735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ddb2901-c45d-4d4b-a232-37dcb5963fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a59a650>]}
[0m10:37:33.094543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ddb2901-c45d-4d4b-a232-37dcb5963fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5f03d0>]}
[0m10:37:33.094900 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:37:33.095083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ddb2901-c45d-4d4b-a232-37dcb5963fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a2c050>]}
[0m10:37:33.095887 [info ] [MainThread]: 
[0m10:37:33.096378 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:37:33.096989 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:37:33.101966 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:37:33.102220 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:37:33.102383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:33.102547 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:37:34.606915 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:37:34.717441 [debug] [ThreadPool]: On list_None: Close
[0m10:37:34.835033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:37:34.839728 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:37:34.840025 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:37:34.840253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:34.840500 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:37:36.181549 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:37:36.187934 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:37:36.188439 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:37:36.308690 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:37:36.506593 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:37:36.601343 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:37:36.722684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ddb2901-c45d-4d4b-a232-37dcb5963fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ea910>]}
[0m10:37:36.723690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:37:36.724022 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:37:38.109135 [debug] [MainThread]: On master: COMMIT
[0m10:37:38.109942 [debug] [MainThread]: Using oracle connection "master"
[0m10:37:38.110344 [debug] [MainThread]: On master: COMMIT
[0m10:37:38.254961 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:37:38.257259 [debug] [MainThread]: On master: Close
[0m10:37:38.390488 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:37:38.392246 [info ] [MainThread]: 
[0m10:37:38.398978 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:37:38.399814 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:37:38.400734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:37:38.401204 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:37:38.420880 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:37:38.422039 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:37:38.401484 => 10:37:38.421885
[0m10:37:38.422373 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:37:38.433276 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:37:38.433738 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:37:38.444680 [info ] [Thread-1 (]: Python model materialization is table
[0m10:37:38.445130 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:37:41.281939 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:37:41.282512 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTkwNjAsImlhdCI6MTY4NzQ1NTQ2MH0.aGBvZyiHPxyxTgqhZHx4ig124ttjRxb__w3-6OMsip66RIT9KCIX1ZSrm_AeWRL9R-dnn1lavDNvc7ThaPdV2sPH1VmXrHn7ERBC6LKMLtprelIBFUjFJhvdQlPirIPWsODeBn5bsQ_2NNDrir5SFVX7a-kyvwBikJm168zkckIH7iUggAimMFvi1fr65NrHhgc1-33FmZD8eqIcAlHgATOhvcVxlXFYhs-NKu6F5GgE4uaTtogo6D-LCZffXzKphGqxC7kkQL4-0t01QckJXV8eMrVa6JuGZXyGCDSuG-mfrSTg1EHK27oj01toB2yzkDY7HEj00zcntjmQLjo1Rg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        X = df[["PRICE"]]  # Independent variable
        y = df["SHIPPING_CITY"]  # Dependent variable
    
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173741 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173741';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:37:41.283146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:41.283442 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:38:06.472223 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m10:38:06.476927 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:38:06.494450 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:38:06.495311 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:38:06.867724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:38:06.878125 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:38:06.879054 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:38:07.264736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:38:07.282890 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:38:07.283748 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:38:07.284130 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:38:07.583803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:38:07.587607 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:38:07.587941 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:38:08.101260 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m10:38:08.123175 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:37:38.422581 => 10:38:08.122952
[0m10:38:08.123949 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:38:08.629202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ddb2901-c45d-4d4b-a232-37dcb5963fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a64bd10>]}
[0m10:38:08.631433 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 30.23s]
[0m10:38:08.632467 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:38:08.635282 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:08.635918 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:38:12.308736 [debug] [MainThread]: On master: COMMIT
[0m10:38:12.310905 [debug] [MainThread]: Using oracle connection "master"
[0m10:38:12.312101 [debug] [MainThread]: On master: COMMIT
[0m10:38:12.565564 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:38:12.565933 [debug] [MainThread]: On master: Close
[0m10:38:12.821339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:12.823071 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:38:12.823808 [info ] [MainThread]: 
[0m10:38:12.824157 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 39.73 seconds (39.73s).
[0m10:38:12.824713 [debug] [MainThread]: Command end result
[0m10:38:12.834112 [info ] [MainThread]: 
[0m10:38:12.834701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:38:12.834864 [info ] [MainThread]: 
[0m10:38:12.835037 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:38:12.835428 [debug] [MainThread]: Command `dbt run` succeeded at 10:38:12.835374 after 39.93 seconds
[0m10:38:12.835674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10268e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10268e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027f2c50>]}
[0m10:38:12.835909 [debug] [MainThread]: Flushing usage events
[0m10:38:40.701891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10710be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107117e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107117fd0>]}


============================== 10:38:40.704680 | 172eaef1-8114-42f8-a5f6-993af405ae6b ==============================
[0m10:38:40.704680 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:38:40.705012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:38:40.748744 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:38:40.770932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '172eaef1-8114-42f8-a5f6-993af405ae6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107128ad0>]}
[0m10:38:40.776871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '172eaef1-8114-42f8-a5f6-993af405ae6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081cd490>]}
[0m10:38:40.809387 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:38:40.845284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:38:40.845718 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:38:40.866751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '172eaef1-8114-42f8-a5f6-993af405ae6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fc250>]}
[0m10:38:40.873836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '172eaef1-8114-42f8-a5f6-993af405ae6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820c550>]}
[0m10:38:40.874212 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:38:40.874413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '172eaef1-8114-42f8-a5f6-993af405ae6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ce490>]}
[0m10:38:40.875157 [info ] [MainThread]: 
[0m10:38:40.875550 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:38:40.876096 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:38:40.881105 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:38:40.881388 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:38:40.881559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:40.881731 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:38:42.331825 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:38:42.438789 [debug] [ThreadPool]: On list_None: Close
[0m10:38:42.550554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:38:42.560289 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:38:42.560987 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:38:42.561278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:42.561478 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:38:44.074641 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:38:44.086820 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:38:44.087707 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:38:44.206777 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:38:44.419668 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:38:44.518893 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:38:44.627878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '172eaef1-8114-42f8-a5f6-993af405ae6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108393190>]}
[0m10:38:44.628660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:44.628902 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:38:45.893354 [debug] [MainThread]: On master: COMMIT
[0m10:38:45.895820 [debug] [MainThread]: Using oracle connection "master"
[0m10:38:45.896587 [debug] [MainThread]: On master: COMMIT
[0m10:38:46.002711 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:38:46.005292 [debug] [MainThread]: On master: Close
[0m10:38:46.125239 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:38:46.126224 [info ] [MainThread]: 
[0m10:38:46.132956 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:38:46.133726 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:38:46.134206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:38:46.134420 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:38:46.150289 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:38:46.151609 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:38:46.134559 => 10:38:46.151389
[0m10:38:46.152030 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:38:46.162707 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:38:46.163039 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:38:46.172311 [info ] [Thread-1 (]: Python model materialization is table
[0m10:38:46.172741 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:38:48.624847 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:38:48.626406 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTkxMjcsImlhdCI6MTY4NzQ1NTUyN30.LGUNMvcR3XWgIs2a7UrB6CaY4WKvP_PVX0FoGflUpYGi6xUkPL716M6F__AeEIBzmBlPRWl2U5IzlaD4RyQOy7UPaHvAHr2a3BSYgw56plcYUjPLUAZvSe3sq3h4bIscTV-bdNy4Te3KNa4JAICUTsTYYayvz1agRrXv25MTyjP0oY-zhKkuj_I6rzaU2dxzNTHB4V2GI6CQo14cPml-rRQNbsS86y9w7XOfcUr-6MxP5DAgsHxOG4-6UEbwVvGv4ipoFTTdowZvjupjF4IMij3gyl8sYF5-iVHKWIemocGl5YlOwSfZsD2JiUm5MD-HyWQkxIiH85LDurOtUSaV-w!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  # Independent variable
        y = df["SHIPPING_CITY"]  # Dependent variable
    
        label_encoder = LabelEncoder()
    
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173848 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173848';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:38:48.627875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:48.628562 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:39:15.093708 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m10:39:15.097559 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:39:15.109831 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:39:15.110418 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:39:15.218513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:39:15.225763 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:39:15.226425 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:39:15.331054 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:39:15.339358 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:39:15.339772 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:39:15.340010 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:39:15.435004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:39:15.438523 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:39:15.438879 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:39:15.559568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:39:15.567720 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:38:46.152232 => 10:39:15.567601
[0m10:39:15.568064 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:39:15.668145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '172eaef1-8114-42f8-a5f6-993af405ae6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b0450>]}
[0m10:39:15.668738 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 29.53s]
[0m10:39:15.669076 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:39:15.670084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:39:15.670343 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:39:16.961252 [debug] [MainThread]: On master: COMMIT
[0m10:39:16.963106 [debug] [MainThread]: Using oracle connection "master"
[0m10:39:16.963751 [debug] [MainThread]: On master: COMMIT
[0m10:39:17.060977 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:39:17.061800 [debug] [MainThread]: On master: Close
[0m10:39:17.161058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:17.161411 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:39:17.161624 [info ] [MainThread]: 
[0m10:39:17.161796 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 36.29 seconds (36.29s).
[0m10:39:17.162100 [debug] [MainThread]: Command end result
[0m10:39:17.170904 [info ] [MainThread]: 
[0m10:39:17.171255 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:39:17.171437 [info ] [MainThread]: 
[0m10:39:17.171714 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:39:17.172249 [debug] [MainThread]: Command `dbt run` succeeded at 10:39:17.172186 after 36.49 seconds
[0m10:39:17.172500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026da910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026da510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10283ec50>]}
[0m10:39:17.172738 [debug] [MainThread]: Flushing usage events
[0m10:39:32.771091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a53e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a5fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a5ffd0>]}


============================== 10:39:32.773558 | 148022f1-50f4-4b08-8add-6605287c1328 ==============================
[0m10:39:32.773558 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:39:32.773873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:39:32.820999 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:39:32.842216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '148022f1-50f4-4b08-8add-6605287c1328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102324e50>]}
[0m10:39:32.848572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '148022f1-50f4-4b08-8add-6605287c1328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104171390>]}
[0m10:39:32.883914 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:39:32.921393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:39:32.921847 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:39:32.942547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '148022f1-50f4-4b08-8add-6605287c1328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10416b4d0>]}
[0m10:39:32.948248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '148022f1-50f4-4b08-8add-6605287c1328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104322510>]}
[0m10:39:32.948597 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:39:32.948779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '148022f1-50f4-4b08-8add-6605287c1328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a1cd0>]}
[0m10:39:32.949511 [info ] [MainThread]: 
[0m10:39:32.949874 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:39:32.950406 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:39:32.955433 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:39:32.955713 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:39:32.955882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:32.956058 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:39:34.502514 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:39:34.623499 [debug] [ThreadPool]: On list_None: Close
[0m10:39:34.746126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:39:34.753358 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:39:34.753847 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:39:34.754123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:34.754426 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:39:36.497801 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:39:36.519153 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:39:36.520552 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:39:36.685162 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:39:36.907942 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:39:37.031196 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:39:37.183369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '148022f1-50f4-4b08-8add-6605287c1328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b20190>]}
[0m10:39:37.185444 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:39:37.186235 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:39:38.814679 [debug] [MainThread]: On master: COMMIT
[0m10:39:38.815993 [debug] [MainThread]: Using oracle connection "master"
[0m10:39:38.816960 [debug] [MainThread]: On master: COMMIT
[0m10:39:38.952409 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:39:38.953718 [debug] [MainThread]: On master: Close
[0m10:39:39.084843 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:39:39.085888 [info ] [MainThread]: 
[0m10:39:39.103699 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:39:39.105010 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:39:39.105481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:39:39.105703 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:39:39.116974 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:39:39.117909 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:39:39.106001 => 10:39:39.117805
[0m10:39:39.118132 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:39:39.125999 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:39:39.126341 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:39:39.135096 [info ] [Thread-1 (]: Python model materialization is table
[0m10:39:39.135471 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:39:41.404069 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:39:41.406547 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTkxODAsImlhdCI6MTY4NzQ1NTU4MH0.NsN8FIAFJZN-PcnGy70Mj2Lxz65g-a-3h42rKdeMuEzG9DoeR_NoNSbmqPdpf8nDrrrtUxmTwtioiDZy8xlPpygcCj7V6-4e6pfJYVRS4QWzZala_mtTPl86SBqwisfUto9qimUJ-GgqcbC9KXIqVT82n7bmQvqdoGZlM9vFrByiuNzfy5EpYuH6J-OZJjyCRSyXQVRT-J4ZVnVYKxuSO_-1PL2btQ7qE0a4Er2KmPgL8Poj7I7H7zJP4dtTA09vxX9VI0ony5TLaee3lSeSbFqfp5rne-NDHIJ8-NB53cR0Og5t13sqkMLL7owA2L3bo1bDnCm5cVFat0IYSDqPmA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  # Independent variable
        y = df["SHIPPING_CITY"]  # Dependent variable
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173941 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_173941';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:39:41.412888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:41.413848 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:40:06.178405 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m10:40:06.183033 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:40:06.199490 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:40:06.200334 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:40:06.389737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:40:06.395288 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:40:06.395809 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:40:06.543920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:40:06.552132 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:40:06.552598 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:40:06.552896 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:40:06.688588 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:40:06.699985 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:40:06.700835 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:40:06.886943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:40:06.904282 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:39:39.118274 => 10:40:06.904110
[0m10:40:06.904777 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:40:07.050563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '148022f1-50f4-4b08-8add-6605287c1328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043d3f90>]}
[0m10:40:07.051331 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 27.95s]
[0m10:40:07.051729 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:40:07.053343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:40:07.053680 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:40:08.794625 [debug] [MainThread]: On master: COMMIT
[0m10:40:08.797011 [debug] [MainThread]: Using oracle connection "master"
[0m10:40:08.797842 [debug] [MainThread]: On master: COMMIT
[0m10:40:08.913245 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:40:08.916151 [debug] [MainThread]: On master: Close
[0m10:40:09.038922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:09.039642 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:40:09.039910 [info ] [MainThread]: 
[0m10:40:09.040110 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 36.09 seconds (36.09s).
[0m10:40:09.040478 [debug] [MainThread]: Command end result
[0m10:40:09.045145 [info ] [MainThread]: 
[0m10:40:09.045435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:40:09.045611 [info ] [MainThread]: 
[0m10:40:09.045786 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:40:09.046599 [debug] [MainThread]: Command `dbt run` succeeded at 10:40:09.046447 after 36.29 seconds
[0m10:40:09.047107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100232910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100232510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100396c50>]}
[0m10:40:09.047563 [debug] [MainThread]: Flushing usage events
[0m10:40:23.113730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106093c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10609fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10609ff90>]}


============================== 10:40:23.116559 | fae4b65e-cb65-403c-aaae-fc4055732539 ==============================
[0m10:40:23.116559 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:40:23.116877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:40:23.159856 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:40:23.182008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fae4b65e-cb65-403c-aaae-fc4055732539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b0850>]}
[0m10:40:23.188445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fae4b65e-cb65-403c-aaae-fc4055732539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b17d0>]}
[0m10:40:23.221203 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:40:23.255215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:40:23.255635 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:40:23.276056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fae4b65e-cb65-403c-aaae-fc4055732539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106091c50>]}
[0m10:40:23.282304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fae4b65e-cb65-403c-aaae-fc4055732539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d65d0>]}
[0m10:40:23.282653 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:40:23.282835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae4b65e-cb65-403c-aaae-fc4055732539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fb350>]}
[0m10:40:23.283562 [info ] [MainThread]: 
[0m10:40:23.283937 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:40:23.284475 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:40:23.289567 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:40:23.289901 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:40:23.290078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:23.290253 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:40:24.796120 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:40:24.896281 [debug] [ThreadPool]: On list_None: Close
[0m10:40:25.002658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:40:25.009092 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:40:25.009633 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:40:25.009956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:25.010287 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:40:26.537577 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:40:26.551916 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:40:26.552638 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:40:26.672213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:40:26.790489 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:40:26.900639 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:40:27.011314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae4b65e-cb65-403c-aaae-fc4055732539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687fc90>]}
[0m10:40:27.012329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:40:27.012799 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:40:28.481305 [debug] [MainThread]: On master: COMMIT
[0m10:40:28.483573 [debug] [MainThread]: Using oracle connection "master"
[0m10:40:28.484219 [debug] [MainThread]: On master: COMMIT
[0m10:40:28.629217 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:40:28.630108 [debug] [MainThread]: On master: Close
[0m10:40:28.759516 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:40:28.760579 [info ] [MainThread]: 
[0m10:40:28.765471 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:40:28.765848 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:40:28.766266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:40:28.766463 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:40:28.778363 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:40:28.779686 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:40:28.766604 => 10:40:28.779541
[0m10:40:28.779970 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:40:28.788300 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:40:28.788792 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:40:28.800706 [info ] [Thread-1 (]: Python model materialization is table
[0m10:40:28.801226 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:40:30.867892 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:40:30.869980 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTkyMzAsImlhdCI6MTY4NzQ1NTYzMH0.d5HKBwzdXcQe7b91qn-8b6eGQMP7U1-z3pRC4hmz9rynJndMIc72Skjclwr-EQ50ac8DQT5l_-V0n-6b6jLv8Nh_VeCJJlJSURMd_zRSbhjc8pQ8ZaLW44tzZwiAQYUxutiIfER51erhyGbLNT7jXeK_ULVQNhBcWWSPz7bVpWrkUk27_ot2PVDcsK1g-6vB04HNPBSJwl2OJa_ycx-kNPgqXk4c1MI3rWbgN8trDNjZdv0RFhZYFiEWyLYklvA-ItJCVmoRiV4qteX-33lxdlMVaWVhl9dr5mBN6P8aTSi8y1Z-ITVaO7n3AuD8irEDRRWqF6BBTcwXQ_v3oNGJNg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  # Independent variable
        y = df["SHIPPING_CITY"]  # Dependent variable
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
    
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174030 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174030';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:40:30.874061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:30.874774 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:40:32.217357 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:40:32.219634 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:40:32.326294 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:40:28.780163 => 10:40:32.325424
[0m10:40:32.337162 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:40:32.339295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4b65e-cb65-403c-aaae-fc4055732539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a56a90>]}
[0m10:40:32.340034 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.57s]
[0m10:40:32.340574 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:40:32.342182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:40:32.342662 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:40:33.960436 [debug] [MainThread]: On master: COMMIT
[0m10:40:33.962680 [debug] [MainThread]: Using oracle connection "master"
[0m10:40:33.963428 [debug] [MainThread]: On master: COMMIT
[0m10:40:34.084662 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:40:34.087437 [debug] [MainThread]: On master: Close
[0m10:40:34.212474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:34.214048 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:40:34.214551 [info ] [MainThread]: 
[0m10:40:34.214843 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.93 seconds (10.93s).
[0m10:40:34.215288 [debug] [MainThread]: Command end result
[0m10:40:34.227159 [info ] [MainThread]: 
[0m10:40:34.227785 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:40:34.228149 [info ] [MainThread]: 
[0m10:40:34.228326 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:40:34.228474 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:40:34.228617 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:40:34.228752 [info ] [MainThread]: 
[0m10:40:34.228901 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:40:34.229199 [debug] [MainThread]: Command `dbt run` failed at 10:40:34.229152 after 11.13 seconds
[0m10:40:34.229411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029d4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029d4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c9210>]}
[0m10:40:34.229741 [debug] [MainThread]: Flushing usage events
[0m10:40:56.319470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104807c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104813c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104813f90>]}


============================== 10:40:56.322255 | 09be2453-b7cd-4c64-8c04-95a5bdd559d6 ==============================
[0m10:40:56.322255 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:40:56.322580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:40:56.367926 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:40:56.390317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09be2453-b7cd-4c64-8c04-95a5bdd559d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100fd4e90>]}
[0m10:40:56.396732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09be2453-b7cd-4c64-8c04-95a5bdd559d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f254d0>]}
[0m10:40:56.429813 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:40:56.460256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:40:56.460664 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:40:56.481118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09be2453-b7cd-4c64-8c04-95a5bdd559d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e8810>]}
[0m10:40:56.487355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09be2453-b7cd-4c64-8c04-95a5bdd559d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f55550>]}
[0m10:40:56.487677 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:40:56.487858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09be2453-b7cd-4c64-8c04-95a5bdd559d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f48f90>]}
[0m10:40:56.488580 [info ] [MainThread]: 
[0m10:40:56.488952 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:40:56.489475 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:40:56.494561 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:40:56.494885 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:40:56.495065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:56.495242 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:40:58.259977 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:40:58.404285 [debug] [ThreadPool]: On list_None: Close
[0m10:40:58.536150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:40:58.544639 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:40:58.545285 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:40:58.545681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:58.546082 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:40:59.931434 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m10:40:59.945626 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:40:59.946280 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:41:00.070071 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:00.269597 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:41:00.368967 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:41:00.475991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09be2453-b7cd-4c64-8c04-95a5bdd559d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10518bbd0>]}
[0m10:41:00.477129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:41:00.477691 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:41:01.810097 [debug] [MainThread]: On master: COMMIT
[0m10:41:01.812431 [debug] [MainThread]: Using oracle connection "master"
[0m10:41:01.813475 [debug] [MainThread]: On master: COMMIT
[0m10:41:01.911491 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:41:01.913832 [debug] [MainThread]: On master: Close
[0m10:41:02.027794 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:41:02.028772 [info ] [MainThread]: 
[0m10:41:02.035238 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:41:02.036046 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:41:02.036668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:41:02.037051 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:41:02.054668 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:41:02.055748 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:41:02.037318 => 10:41:02.055609
[0m10:41:02.055999 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:41:02.063971 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:41:02.064326 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:41:02.073737 [info ] [Thread-1 (]: Python model materialization is table
[0m10:41:02.074212 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:41:04.230761 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:41:04.232359 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTkyNjMsImlhdCI6MTY4NzQ1NTY2M30.pu60hgRc_sFqeT7cU0bJfZ29dZuddLf4cZLSO6ZGvGpvFOid8CeQrmxZb9fRNeJ5_gHGUKTTFRBlneH9pQ414yMoqUgHNltvy0c1zxWyauG7aMiMsuw4ySrwbWhELJrv5-OX6mMH2sxAOBvqvUN4IFWKoUc-oyfl7k2NApz0lnWRVwymypZAmDMjvY1UTd-W2af8RW7LmYD8ZozXfWXlhhIIkcMDV5f2NYYYbwl847sViyBSPxraUefkeQKmvthFaWtqhEB8B8yySniPNIzFDB-Rt2aDCHDEvs8xDMsbcxS7YBY-r2ByaAakQDNwVZ6txmWZbADD9zk0TvlctzKKTw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  # Independent variable
        y = df["SHIPPING_CITY"]  # Dependent variable
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        #X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
    
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174104 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174104';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:41:04.234156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:04.234763 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:41:05.851767 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:41:05.852802 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:41:05.983389 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:41:02.056142 => 10:41:05.982099
[0m10:41:05.997128 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:41:05.999598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09be2453-b7cd-4c64-8c04-95a5bdd559d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105209250>]}
[0m10:41:06.000316 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.96s]
[0m10:41:06.000766 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:41:06.002367 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:41:06.002670 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:41:07.233760 [debug] [MainThread]: On master: COMMIT
[0m10:41:07.236037 [debug] [MainThread]: Using oracle connection "master"
[0m10:41:07.236998 [debug] [MainThread]: On master: COMMIT
[0m10:41:07.345607 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:41:07.347413 [debug] [MainThread]: On master: Close
[0m10:41:07.458222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:07.459543 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:41:07.460138 [info ] [MainThread]: 
[0m10:41:07.460659 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.97 seconds (10.97s).
[0m10:41:07.461445 [debug] [MainThread]: Command end result
[0m10:41:07.476599 [info ] [MainThread]: 
[0m10:41:07.477214 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:41:07.477382 [info ] [MainThread]: 
[0m10:41:07.477542 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:41:07.477701 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:41:07.477840 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:41:07.477978 [info ] [MainThread]: 
[0m10:41:07.478132 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:41:07.478469 [debug] [MainThread]: Command `dbt run` failed at 10:41:07.478417 after 11.18 seconds
[0m10:41:07.478712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10114ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101148e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b4790>]}
[0m10:41:07.478926 [debug] [MainThread]: Flushing usage events
[0m10:42:34.993875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a0bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a17ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a17f90>]}


============================== 10:42:34.996278 | 1743cb3f-b551-4b8a-b812-3a0aa238a62a ==============================
[0m10:42:34.996278 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:42:34.996596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:42:35.043507 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:42:35.065321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1743cb3f-b551-4b8a-b812-3a0aa238a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a49150>]}
[0m10:42:35.071841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1743cb3f-b551-4b8a-b812-3a0aa238a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123cd890>]}
[0m10:42:35.104548 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:42:35.134192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:35.134497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:35.138136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1743cb3f-b551-4b8a-b812-3a0aa238a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a50e10>]}
[0m10:42:35.142507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1743cb3f-b551-4b8a-b812-3a0aa238a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123e85d0>]}
[0m10:42:35.142774 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:42:35.142948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1743cb3f-b551-4b8a-b812-3a0aa238a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123ce4d0>]}
[0m10:42:35.143704 [info ] [MainThread]: 
[0m10:42:35.144096 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:42:35.144645 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:42:35.149663 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:42:35.149944 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:42:35.150109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:35.150273 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:42:37.204975 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:42:37.366177 [debug] [ThreadPool]: On list_None: Close
[0m10:42:37.540343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:42:37.547278 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:42:37.547742 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:42:37.547957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:37.548262 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:42:39.560926 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:42:39.572079 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:42:39.572708 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:42:39.731572 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:42:39.879595 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:42:40.071236 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:42:40.232048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1743cb3f-b551-4b8a-b812-3a0aa238a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112397e90>]}
[0m10:42:40.233172 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:40.233728 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:42:42.128788 [debug] [MainThread]: On master: COMMIT
[0m10:42:42.130892 [debug] [MainThread]: Using oracle connection "master"
[0m10:42:42.131892 [debug] [MainThread]: On master: COMMIT
[0m10:42:42.282350 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:42:42.284453 [debug] [MainThread]: On master: Close
[0m10:42:42.446524 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:42:42.448096 [info ] [MainThread]: 
[0m10:42:42.455887 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:42:42.456653 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:42:42.457591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:42:42.458046 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:42:42.480431 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:42:42.481517 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:42:42.458368 => 10:42:42.481361
[0m10:42:42.481817 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:42:42.490725 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:42:42.491053 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:42:42.502123 [info ] [Thread-1 (]: Python model materialization is table
[0m10:42:42.502541 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:42:44.801561 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:42:44.803191 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTkzNjMsImlhdCI6MTY4NzQ1NTc2M30.SGsgmBLxQQxtb0nSqfpyFjoQbd8CmbGdQm81KhbxZn1ZCIvvnjw7m20FuNmI5QucmOxa8cMudnkVmN24Xq6JUi5GuTaxXuKL8VmCcIz0W3SlM6SsGq-sGXqxCCtO1BWrDd9P78A2mxQdujbPAH-xPTT-NTDu8vF4uL-2eJSYakIcdC0mBCw2AgXSvs1KY2yIz32MpUaP3RoVB3mV9rYik5WaZ8IgLbM-Qpt2jgOS7RofMOVJEFfuAqNFIPx9-mKQI9fy2z069Uu6L5qxHPQkhMF4Xvl_KFtgeAaR3BULNdKAb1vR2VyGYv8k_3qm4gNm8mb9GiF4s4nYfXpoYrK1Dg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  # Independent variable
        y = df["SHIPPING_CITY"]  # Dependent variable
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        #X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
    
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174244 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174244';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:42:44.805131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:44.805852 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:42:46.028915 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:42:46.031286 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:42:46.134602 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:42:42.481966 => 10:42:46.133375
[0m10:42:46.146916 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:42:46.148927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1743cb3f-b551-4b8a-b812-3a0aa238a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112514b90>]}
[0m10:42:46.149325 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.69s]
[0m10:42:46.149614 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:42:46.150969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:46.151209 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:42:47.425518 [debug] [MainThread]: On master: COMMIT
[0m10:42:47.428002 [debug] [MainThread]: Using oracle connection "master"
[0m10:42:47.428893 [debug] [MainThread]: On master: COMMIT
[0m10:42:47.525722 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:42:47.527271 [debug] [MainThread]: On master: Close
[0m10:42:47.635129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:47.635693 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:42:47.635953 [info ] [MainThread]: 
[0m10:42:47.636147 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.49 seconds (12.49s).
[0m10:42:47.636985 [debug] [MainThread]: Command end result
[0m10:42:47.644358 [info ] [MainThread]: 
[0m10:42:47.644658 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:42:47.644816 [info ] [MainThread]: 
[0m10:42:47.644967 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:42:47.645116 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:42:47.645253 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:42:47.645388 [info ] [MainThread]: 
[0m10:42:47.645583 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:42:47.646030 [debug] [MainThread]: Command `dbt run` failed at 10:42:47.645978 after 12.67 seconds
[0m10:42:47.646270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a2b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10493ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10493ced0>]}
[0m10:42:47.646478 [debug] [MainThread]: Flushing usage events
[0m10:43:37.660306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606f090>]}


============================== 10:43:37.663076 | c3a0d5be-fabb-40ff-9e0d-3f527aaabff6 ==============================
[0m10:43:37.663076 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:43:37.663405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:43:37.709956 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:43:37.732457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3a0d5be-fabb-40ff-9e0d-3f527aaabff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a13d0>]}
[0m10:43:37.738755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3a0d5be-fabb-40ff-9e0d-3f527aaabff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106781290>]}
[0m10:43:37.772438 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:43:37.806456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:37.806767 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:37.810478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3a0d5be-fabb-40ff-9e0d-3f527aaabff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ef510>]}
[0m10:43:37.815117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3a0d5be-fabb-40ff-9e0d-3f527aaabff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c1ad0>]}
[0m10:43:37.815483 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:43:37.815668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3a0d5be-fabb-40ff-9e0d-3f527aaabff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677a650>]}
[0m10:43:37.816406 [info ] [MainThread]: 
[0m10:43:37.816767 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:43:37.817404 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:43:37.822737 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:43:37.823027 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:43:37.823206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:37.823387 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:43:40.191913 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:43:40.329174 [debug] [ThreadPool]: On list_None: Close
[0m10:43:40.470354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:43:40.478524 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:43:40.479163 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:43:40.479552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:40.479955 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:43:42.173536 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:43:42.185898 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:43:42.186705 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:43:42.332063 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:42.559708 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:43:43.419031 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:43:43.547112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3a0d5be-fabb-40ff-9e0d-3f527aaabff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069afbd0>]}
[0m10:43:43.548189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:43.548653 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:43:45.324871 [debug] [MainThread]: On master: COMMIT
[0m10:43:45.327187 [debug] [MainThread]: Using oracle connection "master"
[0m10:43:45.328210 [debug] [MainThread]: On master: COMMIT
[0m10:43:45.489240 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:43:45.491463 [debug] [MainThread]: On master: Close
[0m10:43:45.662166 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:43:45.663842 [info ] [MainThread]: 
[0m10:43:45.671342 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:43:45.672130 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:43:45.673084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:43:45.673540 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:43:45.695837 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:43:45.696985 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:43:45.673862 => 10:43:45.696807
[0m10:43:45.697356 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:43:45.706783 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:43:45.707143 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:43:45.717240 [info ] [Thread-1 (]: Python model materialization is table
[0m10:43:45.717790 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:43:48.903794 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:43:48.905828 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTk0MjgsImlhdCI6MTY4NzQ1NTgyOH0.nFiJUYD8cCyHnaBoAmIgdxjjUkBmgzaGq88iZCk1CCsfdGWyx7n8b4o77grlvtRq3BfukTuWq9Gg9lAttR_poAD_SA9pGcf47X1-BY2DAoumbB1bc1K8br3zWKOP6-zB3gRM9t6IepIlp70cDJO3erbctrgQZFnBaldEbkgXzSjAx5JGOJpD0Bm8Mp3LP69tvu7h9iehYeNXx1L37mUZp3HS7H0BTrNDtCcsYds857Qc9y-gUKcsaqtfSS-MgdXgMuJ5X3Fjc-hgkt6f8kP-XUL_WTcNKO2L6XHwdjEvhdhDZO24looCQ-aG7s02goU-tJ4TQqFVcnWuM8jKo-KTog!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  # Independent variable
        y = df["SHIPPING_CITY"]  # Dependent variable
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        #X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
    
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174348 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174348';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:43:48.907588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:48.908128 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:43:50.566605 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:43:50.568960 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:43:51.387499 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:43:45.697563 => 10:43:51.386204
[0m10:43:51.402070 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:43:51.404970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3a0d5be-fabb-40ff-9e0d-3f527aaabff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069fe510>]}
[0m10:43:51.405796 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 5.73s]
[0m10:43:51.406318 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:43:51.408233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:51.408722 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:43:53.507755 [debug] [MainThread]: On master: COMMIT
[0m10:43:53.509254 [debug] [MainThread]: Using oracle connection "master"
[0m10:43:53.509737 [debug] [MainThread]: On master: COMMIT
[0m10:43:53.650236 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:43:53.652364 [debug] [MainThread]: On master: Close
[0m10:43:53.790243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:53.791250 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:43:53.791814 [info ] [MainThread]: 
[0m10:43:53.792300 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.98 seconds (15.98s).
[0m10:43:53.793047 [debug] [MainThread]: Command end result
[0m10:43:53.806710 [info ] [MainThread]: 
[0m10:43:53.807074 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:43:53.807226 [info ] [MainThread]: 
[0m10:43:53.807374 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:43:53.807520 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:43:53.807659 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:43:53.807800 [info ] [MainThread]: 
[0m10:43:53.807965 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:43:53.808358 [debug] [MainThread]: Command `dbt run` failed at 10:43:53.808299 after 16.17 seconds
[0m10:43:53.808637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029a4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029a4ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689ae50>]}
[0m10:43:53.808905 [debug] [MainThread]: Flushing usage events
[0m10:44:17.874969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105817a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105817f90>]}


============================== 10:44:17.877694 | f1b66364-748e-4312-85c2-76502b842be1 ==============================
[0m10:44:17.877694 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:44:17.878025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:44:17.922817 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:44:17.945511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1b66364-748e-4312-85c2-76502b842be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105808e50>]}
[0m10:44:17.951863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1b66364-748e-4312-85c2-76502b842be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066cd010>]}
[0m10:44:17.986865 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:44:18.038400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:18.038697 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:18.042177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1b66364-748e-4312-85c2-76502b842be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b2010>]}
[0m10:44:18.049194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1b66364-748e-4312-85c2-76502b842be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ebf50>]}
[0m10:44:18.049527 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:44:18.049702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1b66364-748e-4312-85c2-76502b842be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c5550>]}
[0m10:44:18.050469 [info ] [MainThread]: 
[0m10:44:18.050894 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:44:18.051593 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:44:18.056437 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:44:18.056733 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:44:18.056906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:18.057075 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:44:19.799711 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:44:19.917146 [debug] [ThreadPool]: On list_None: Close
[0m10:44:20.058577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:44:20.064729 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:44:20.065283 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:44:20.065553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:20.065839 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:44:21.796174 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:44:21.800309 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:44:21.800684 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:44:22.004795 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:44:22.235414 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:44:22.355730 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:44:22.477298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1b66364-748e-4312-85c2-76502b842be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066cd810>]}
[0m10:44:22.477801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:22.478046 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:44:23.805838 [debug] [MainThread]: On master: COMMIT
[0m10:44:23.806767 [debug] [MainThread]: Using oracle connection "master"
[0m10:44:23.807140 [debug] [MainThread]: On master: COMMIT
[0m10:44:23.946159 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:44:23.947078 [debug] [MainThread]: On master: Close
[0m10:44:24.084842 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:24.085593 [info ] [MainThread]: 
[0m10:44:24.090903 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:44:24.091508 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:44:24.092292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:44:24.092654 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:44:24.112564 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:44:24.113997 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:44:24.092896 => 10:44:24.113867
[0m10:44:24.114282 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:44:24.123940 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:44:24.124329 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:44:24.134328 [info ] [Thread-1 (]: Python model materialization is table
[0m10:44:24.134774 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:44:26.374871 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:44:26.375663 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTk0NjUsImlhdCI6MTY4NzQ1NTg2NX0.PjZ7h5FldT_TFuud_M-CYRC8Hq-OMrUTGm_co_r-McZWMkhX0PDxvH49aFMyODd1bYhVMj4tuSP4E-ROOpioSMTR6QBgmQzf4JksCNouocgY1w3dPX28Ni9ykRn0FJqcWdhwjvrbJZf9irqeR9v5cK17-imFztL1p5Msp7IdrmIz1dYEcxqpyqxmyJzSUdMnXyI85UR7Z4F9dd90TL7yED4E14cNwbI7eqZIMxKiXVlnTr_IwgJWPRzHIWg1W90pTHEp7VuoeCOo6Lzh6AkA9vATHjFEdAQ5wer2seVsAMHd7hLU2NDwlQ3S_TpQ6iLolvoqEDqxjD1JFZspSNT42w!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
        # Must be either table or incremental (view is not currently supported)
        dbt.config(materialized="table")
        # dbt.config(conda_env_name="dbt_py_env")
        # oml.core.DataFrame representing a datasource
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  # Independent variable
        y = df["SHIPPING_CITY"]  # Dependent variable
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        #X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
    
        # # Train a decision tree classifier
        # classifier = DecisionTreeClassifier()
        # classifier.fit(X_train, y_train)
    
        # # Predict the shipping city based on the price for the test set
        # y_pred = classifier.predict(X_test)
    
        # # Decode the predicted shipping city
        # y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        # # Evaluate the classifier's accuracy
        # accuracy = classifier.score(X_test, y_test)
    
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174426 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174426';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:44:26.376713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:26.377012 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:44:27.569566 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:44:27.571968 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:44:27.990069 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:44:24.114454 => 10:44:27.988459
[0m10:44:28.000579 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:44:28.002724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1b66364-748e-4312-85c2-76502b842be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe0b90>]}
[0m10:44:28.003379 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.91s]
[0m10:44:28.003791 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:44:28.005086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:28.005422 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:44:29.542816 [debug] [MainThread]: On master: COMMIT
[0m10:44:29.545032 [debug] [MainThread]: Using oracle connection "master"
[0m10:44:29.545649 [debug] [MainThread]: On master: COMMIT
[0m10:44:29.688227 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:44:29.690509 [debug] [MainThread]: On master: Close
[0m10:44:29.828658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:29.829687 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:44:29.830278 [info ] [MainThread]: 
[0m10:44:29.830777 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.78 seconds (11.78s).
[0m10:44:29.831453 [debug] [MainThread]: Command end result
[0m10:44:29.841418 [info ] [MainThread]: 
[0m10:44:29.842026 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:44:29.842350 [info ] [MainThread]: 
[0m10:44:29.842659 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:44:29.842948 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:44:29.843181 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:44:29.843418 [info ] [MainThread]: 
[0m10:44:29.843694 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:44:29.844339 [debug] [MainThread]: Command `dbt run` failed at 10:44:29.844233 after 11.99 seconds
[0m10:44:29.844786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105829a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c3a1d0>]}
[0m10:44:29.845181 [debug] [MainThread]: Flushing usage events
[0m10:44:33.961935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d14150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d17ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d17fd0>]}


============================== 10:44:33.964457 | d5a68402-7ca7-4ef3-9873-9bbb2b946649 ==============================
[0m10:44:33.964457 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:44:33.964795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:44:34.008496 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:44:34.031265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5a68402-7ca7-4ef3-9873-9bbb2b946649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc9410>]}
[0m10:44:34.037579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5a68402-7ca7-4ef3-9873-9bbb2b946649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d17050>]}
[0m10:44:34.071178 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:44:34.105291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:44:34.105753 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:44:34.126716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5a68402-7ca7-4ef3-9873-9bbb2b946649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108753690>]}
[0m10:44:34.133729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5a68402-7ca7-4ef3-9873-9bbb2b946649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e5790>]}
[0m10:44:34.134096 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:44:34.134277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5a68402-7ca7-4ef3-9873-9bbb2b946649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10869b290>]}
[0m10:44:34.135032 [info ] [MainThread]: 
[0m10:44:34.135439 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:44:34.135976 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:44:34.141438 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:44:34.141765 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:44:34.141940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:34.142115 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:44:36.306021 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:44:36.515633 [debug] [ThreadPool]: On list_None: Close
[0m10:44:36.644573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:44:36.651426 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:44:36.651906 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:44:36.652213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:36.652529 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:44:38.594148 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:44:38.607053 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:44:38.607931 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:44:38.816459 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:44:39.063049 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:44:39.212550 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:44:39.376409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5a68402-7ca7-4ef3-9873-9bbb2b946649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0a190>]}
[0m10:44:39.377343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:39.377791 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:44:41.181893 [debug] [MainThread]: On master: COMMIT
[0m10:44:41.184180 [debug] [MainThread]: Using oracle connection "master"
[0m10:44:41.185173 [debug] [MainThread]: On master: COMMIT
[0m10:44:41.334631 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:44:41.336924 [debug] [MainThread]: On master: Close
[0m10:44:41.479878 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:41.480941 [info ] [MainThread]: 
[0m10:44:41.487241 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:44:41.487986 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:44:41.488748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:44:41.489130 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:44:41.509052 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:44:41.510136 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:44:41.489391 => 10:44:41.509993
[0m10:44:41.510432 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:44:41.519501 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:44:41.519947 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:44:41.530975 [info ] [Thread-1 (]: Python model materialization is table
[0m10:44:41.531461 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:44:43.685253 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:44:43.687204 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTk0ODIsImlhdCI6MTY4NzQ1NTg4Mn0.aOJ_dSxrvvnEOphRugJE68rfPSKfPt5dg1vM-HJJD8tPtVDrh9JIgT9ouTJ1-8KZzsjVqe_Q8uC9VsNO9zjttKQZz2AuveWt9D5tlLbC34RggEJK2E3xaXn6UZbocpHAbqb19t_Y5p4I5c9EgRZ1gpNGSRsuSvf5u5JWDZh1CzsUHpUBMZzldOYb0W2Vid6k9fxAMZDrGYuIILb1y8uZ4y5JaR-mfIW8iIYh-8EOxiAEBRa1uQljJPLv9aduzKj6zfF6IPB7Lvvj4quJZYhY5EMGfH1KH4zB8vmnU5Tf-qCPt1ZOrMG2eWSi3CR1an3ogPFsip12sgJ7hRnt2nAZCQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  # Independent variable
        y = df["SHIPPING_CITY"]  # Dependent variable
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        #X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174443 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174443';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:44:43.688767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:43.689338 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:45:14.796812 [debug] [Thread-1 (]: SQL status: OK in 31.0 seconds
[0m10:45:14.801505 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:45:14.816532 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:45:14.817170 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:45:15.110245 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:45:15.117848 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:45:15.118712 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:45:15.385943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:45:15.405975 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:45:15.406803 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:45:15.407195 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:45:15.698761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:45:15.712292 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:45:15.713251 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:45:16.035975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:45:16.051880 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:44:41.510620 => 10:45:16.051730
[0m10:45:16.052372 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:45:16.349124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5a68402-7ca7-4ef3-9873-9bbb2b946649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878bc50>]}
[0m10:45:16.351295 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 34.86s]
[0m10:45:16.352264 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:45:16.355031 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:45:16.355650 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:45:19.619276 [debug] [MainThread]: On master: COMMIT
[0m10:45:19.619672 [debug] [MainThread]: Using oracle connection "master"
[0m10:45:19.619872 [debug] [MainThread]: On master: COMMIT
[0m10:45:19.929305 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:45:19.931300 [debug] [MainThread]: On master: Close
[0m10:45:20.234813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:45:20.235213 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:45:20.235444 [info ] [MainThread]: 
[0m10:45:20.235637 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 46.10 seconds (46.10s).
[0m10:45:20.235980 [debug] [MainThread]: Command end result
[0m10:45:20.240258 [info ] [MainThread]: 
[0m10:45:20.240484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:45:20.240642 [info ] [MainThread]: 
[0m10:45:20.240803 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:45:20.241112 [debug] [MainThread]: Command `dbt run` succeeded at 10:45:20.241065 after 46.30 seconds
[0m10:45:20.241339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c06910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c06510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d6ac50>]}
[0m10:45:20.241551 [debug] [MainThread]: Flushing usage events
[0m10:45:33.260162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac6850>]}


============================== 10:45:33.262647 | ae74d3f3-8280-487b-9328-71b677dce6d2 ==============================
[0m10:45:33.262647 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:45:33.262979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:45:33.311915 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:45:33.334439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae74d3f3-8280-487b-9328-71b677dce6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c28850>]}
[0m10:45:33.340737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae74d3f3-8280-487b-9328-71b677dce6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ccb390>]}
[0m10:45:33.374327 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:45:33.409935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:45:33.410371 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:45:33.430784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae74d3f3-8280-487b-9328-71b677dce6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c45450>]}
[0m10:45:33.438424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae74d3f3-8280-487b-9328-71b677dce6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618e390>]}
[0m10:45:33.438778 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:45:33.438980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae74d3f3-8280-487b-9328-71b677dce6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106503b10>]}
[0m10:45:33.439761 [info ] [MainThread]: 
[0m10:45:33.440174 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:45:33.440752 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:45:33.445458 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:45:33.445681 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:45:33.445848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:33.446019 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:45:36.619139 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:45:36.927385 [debug] [ThreadPool]: On list_None: Close
[0m10:45:37.164852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:45:37.168759 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:45:37.169049 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:45:37.169221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:45:37.169393 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:45:40.304816 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:45:40.319434 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:45:40.320108 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:45:40.597040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:45:40.936063 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:45:41.226350 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:45:41.542130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae74d3f3-8280-487b-9328-71b677dce6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b3bd0>]}
[0m10:45:41.543277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:45:41.543816 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:45:43.869305 [debug] [MainThread]: On master: COMMIT
[0m10:45:43.873673 [debug] [MainThread]: Using oracle connection "master"
[0m10:45:43.875027 [debug] [MainThread]: On master: COMMIT
[0m10:45:44.064392 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:45:44.066901 [debug] [MainThread]: On master: Close
[0m10:45:44.264830 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:45:44.265856 [info ] [MainThread]: 
[0m10:45:44.272167 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:45:44.273090 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:45:44.274041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:45:44.274477 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:45:44.291993 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:45:44.293363 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:45:44.274759 => 10:45:44.293131
[0m10:45:44.293800 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:45:44.302984 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:45:44.303322 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:45:44.312899 [info ] [Thread-1 (]: Python model materialization is table
[0m10:45:44.313377 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:45:46.967505 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:45:46.969016 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTk1NDUsImlhdCI6MTY4NzQ1NTk0NX0.U3pQ-fNKeyNhllK-Y3WNnik7GqLAoWCRyTyyg0VVtcGQ9PfJcb8mXi0jbS2MffgRopOKCc7HlKhaX2beU2lkJJMgm3raLEJoyTWSqfZ6SUSP9ChkMYNq96j1ZD8cc--FKjXgZBWwexV0t1564n0qUjioIRvxEUsW1K9Qx6NviLv6zzrHruz0SbiSP2iL74cv_COyE6Iw1N04DtSKvk6gRfRjrY_VeHYVgoumz61_phu_0-c9smd9AhmieQFQmir5Gmxkv5zakwG8tIHWJS9-Mo-CaBHI23MBRCk2r69opXATWN5xPX42u-koNeYtVAGQrRQx27HIDQcRIUW-uPRjGA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  # Independent variable
        y = df["SHIPPING_CITY"]  # Dependent variable
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174546 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174546';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:45:46.970494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:46.971141 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:45:49.153342 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m10:45:49.155445 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:45:49.326103 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:45:44.294002 => 10:45:49.324999
[0m10:45:49.335632 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:45:49.337621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae74d3f3-8280-487b-9328-71b677dce6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679a390>]}
[0m10:45:49.338301 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 5.06s]
[0m10:45:49.338720 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:45:49.340770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:45:49.341231 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:45:51.654532 [debug] [MainThread]: On master: COMMIT
[0m10:45:51.656934 [debug] [MainThread]: Using oracle connection "master"
[0m10:45:51.658052 [debug] [MainThread]: On master: COMMIT
[0m10:45:51.978526 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:45:51.981041 [debug] [MainThread]: On master: Close
[0m10:45:52.227102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:45:52.228715 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:45:52.229226 [info ] [MainThread]: 
[0m10:45:52.229565 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 18.79 seconds (18.79s).
[0m10:45:52.230046 [debug] [MainThread]: Command end result
[0m10:45:52.396808 [info ] [MainThread]: 
[0m10:45:52.398441 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:45:52.398905 [info ] [MainThread]: 
[0m10:45:52.399354 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:45:52.399808 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m10:45:52.400207 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:45:52.400956 [info ] [MainThread]: 
[0m10:45:52.401394 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:45:52.402088 [debug] [MainThread]: Command `dbt run` failed at 10:45:52.401981 after 19.16 seconds
[0m10:45:52.402615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100412c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100410e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c28310>]}
[0m10:45:52.403243 [debug] [MainThread]: Flushing usage events
[0m10:46:01.841793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063efe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063effd0>]}


============================== 10:46:01.844478 | ff170918-eb43-4cc0-8e04-894e82bda403 ==============================
[0m10:46:01.844478 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:46:01.844800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:46:01.887834 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:46:01.909861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff170918-eb43-4cc0-8e04-894e82bda403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641d610>]}
[0m10:46:01.916146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff170918-eb43-4cc0-8e04-894e82bda403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b017d0>]}
[0m10:46:01.949665 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:46:01.983617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:46:01.983915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:46:01.987530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff170918-eb43-4cc0-8e04-894e82bda403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1a710>]}
[0m10:46:01.992295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff170918-eb43-4cc0-8e04-894e82bda403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e1350>]}
[0m10:46:01.992606 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:46:01.992782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff170918-eb43-4cc0-8e04-894e82bda403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ef750>]}
[0m10:46:01.993520 [info ] [MainThread]: 
[0m10:46:01.993906 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:46:01.994493 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:46:01.999572 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:46:01.999826 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:46:01.999991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:02.000159 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:46:03.934725 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:46:04.067209 [debug] [ThreadPool]: On list_None: Close
[0m10:46:04.200988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:46:04.209799 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:46:04.210548 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:46:04.210736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:46:04.210931 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:46:05.822837 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:46:05.835001 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:46:05.835766 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:46:05.983928 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:06.226177 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:46:06.359516 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:46:06.519872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff170918-eb43-4cc0-8e04-894e82bda403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afbf50>]}
[0m10:46:06.521076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:46:06.521679 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:46:08.953085 [debug] [MainThread]: On master: COMMIT
[0m10:46:08.955011 [debug] [MainThread]: Using oracle connection "master"
[0m10:46:08.955797 [debug] [MainThread]: On master: COMMIT
[0m10:46:09.061632 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:46:09.063123 [debug] [MainThread]: On master: Close
[0m10:46:09.202693 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:46:09.203470 [info ] [MainThread]: 
[0m10:46:09.208977 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:46:09.209740 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:46:09.210666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:46:09.211465 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:46:09.235982 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:46:09.237456 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:46:09.211891 => 10:46:09.237241
[0m10:46:09.237930 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:46:09.248788 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:46:09.249235 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:46:09.259832 [info ] [Thread-1 (]: Python model materialization is table
[0m10:46:09.260282 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:46:11.850660 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:46:11.851939 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTk1NzAsImlhdCI6MTY4NzQ1NTk3MH0.mfQRgmINPfWFN1eRf2aChmUU1sMplj8yTCxE5aXYS-e63SNu3Tsx4mdWXRI8CzYF0pPFXNJwfYF0B_NoVko5m2yG4g-Cte1SIZgb2NDtb4L-q14ulCjyfQK4SiHUKXM6WbIS0MBCklXXSn0bGryI_ugtmBBx-tcz2lCT7YvpKztA_kSMWA6nxhc5J9z5i-ZuKMQMUvWg6-4xCE45qg5B4Nc7hI7uCaQvyFXjGSooy7ux8Gj8s3p-5IWheoxX1dBld30DRgUqDsakr_ClTDb-uTFwgmvHyf3-Smr5hgUdSkHLJR69v6u9egICr9PM9DxhdKrWs65_fwJ86slx7iIhXQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  # Independent variable
        y = df["SHIPPING_CITY"]  # Dependent variable
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174611 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174611';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:46:11.853182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:46:11.853761 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:46:37.829288 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m10:46:37.830225 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:46:37.835010 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:46:37.835436 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:46:37.959990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:46:37.962613 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:46:37.962929 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:46:38.091422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:46:38.107004 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:46:38.107951 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:46:38.108405 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:46:38.222528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:46:38.243589 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:46:38.244675 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:46:38.408663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:46:38.433274 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:46:09.238148 => 10:46:38.433127
[0m10:46:38.433707 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:46:38.549175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff170918-eb43-4cc0-8e04-894e82bda403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a0dd0>]}
[0m10:46:38.550304 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 29.34s]
[0m10:46:38.552325 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:46:38.561097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:46:38.563423 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:46:39.947200 [debug] [MainThread]: On master: COMMIT
[0m10:46:39.948352 [debug] [MainThread]: Using oracle connection "master"
[0m10:46:39.949368 [debug] [MainThread]: On master: COMMIT
[0m10:46:40.049136 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:46:40.051143 [debug] [MainThread]: On master: Close
[0m10:46:40.244358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:40.245323 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:46:40.245904 [info ] [MainThread]: 
[0m10:46:40.246389 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 38.25 seconds (38.25s).
[0m10:46:40.247239 [debug] [MainThread]: Command end result
[0m10:46:40.274873 [info ] [MainThread]: 
[0m10:46:40.275595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:46:40.275936 [info ] [MainThread]: 
[0m10:46:40.276282 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:46:40.277482 [debug] [MainThread]: Command `dbt run` succeeded at 10:46:40.277270 after 38.46 seconds
[0m10:46:40.278023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d27910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d24e10>]}
[0m10:46:40.278492 [debug] [MainThread]: Flushing usage events
[0m10:47:10.949707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f8c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ebfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044eb090>]}


============================== 10:47:10.952351 | 72ecd4be-3e92-451f-b636-f3ce833fe1c1 ==============================
[0m10:47:10.952351 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:47:10.952684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:47:11.002130 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:47:11.024543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72ecd4be-3e92-451f-b636-f3ce833fe1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104530390>]}
[0m10:47:11.031076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72ecd4be-3e92-451f-b636-f3ce833fe1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bfd850>]}
[0m10:47:11.065189 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:47:11.101182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:47:11.101631 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:47:11.122422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72ecd4be-3e92-451f-b636-f3ce833fe1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044dcad0>]}
[0m10:47:11.138426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72ecd4be-3e92-451f-b636-f3ce833fe1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104daf4d0>]}
[0m10:47:11.138699 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:47:11.138872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72ecd4be-3e92-451f-b636-f3ce833fe1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104556810>]}
[0m10:47:11.139602 [info ] [MainThread]: 
[0m10:47:11.139995 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:47:11.140557 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:47:11.145631 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:47:11.145852 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:47:11.146014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:11.146189 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:47:13.115414 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:47:13.222621 [debug] [ThreadPool]: On list_None: Close
[0m10:47:13.335439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:47:13.344019 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:47:13.344486 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:47:13.344698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:13.345091 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:47:14.849740 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:47:14.855538 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:47:14.855999 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:47:14.998862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:47:15.220957 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:47:15.347386 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:47:15.502665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72ecd4be-3e92-451f-b636-f3ce833fe1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b0f590>]}
[0m10:47:15.503202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:47:15.503477 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:47:17.171923 [debug] [MainThread]: On master: COMMIT
[0m10:47:17.174103 [debug] [MainThread]: Using oracle connection "master"
[0m10:47:17.175087 [debug] [MainThread]: On master: COMMIT
[0m10:47:17.320776 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:47:17.323141 [debug] [MainThread]: On master: Close
[0m10:47:17.488682 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:47:17.489621 [info ] [MainThread]: 
[0m10:47:17.497470 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:47:17.498995 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:47:17.500145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:47:17.500746 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:47:17.519560 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:47:17.523865 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:47:17.501145 => 10:47:17.523592
[0m10:47:17.524333 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:47:17.536209 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:47:17.536636 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:47:17.548789 [info ] [Thread-1 (]: Python model materialization is table
[0m10:47:17.549246 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:47:21.087440 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:47:21.089133 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTk2NDAsImlhdCI6MTY4NzQ1NjA0MH0.dTINX1k1his_gjpw1zga_x8aK31D4nQVBvhgCRFNSpJJMvbU3bzv42T6Cuy8LFYgN00_l-i3E8taNglHReWc8TESBec1HuaMfQF4Ih0PXpRpO-k6bEwMIqYExsSz4SFRCU-Uafquf8G9L1JFCmexC1Tkx5A8hp-OVHPpdnrUCnZBK47Hlk0Vd6lom4hLRzpQx1VVQf0Sc6UZ5_SC95SMRR9nguYlOsd_fVfCdabdSZhiaHwFxRM2jFW8rYhR1aPg-S4MhljldkjwyhZtQ66a0u9_w-txnEV4L5ELzSaIzKkXOZNB3SShhQTof9w0wpdaoerpqCMesTckQ2RlRjx9zQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  # Independent variable
        y = df["SHIPPING_CITY"]  # Dependent variable
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174721 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174721';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:47:21.090781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:21.091373 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:47:47.251398 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m10:47:47.255795 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:47:47.270655 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:47:47.271452 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:47:47.434170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:47:47.441796 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:47:47.442597 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:47:47.579343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:47:47.593377 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:47:47.593990 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:47:47.594389 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:47:47.723340 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:47:47.733636 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:47:47.734466 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:47:48.053114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:47:48.071050 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:47:17.524580 => 10:47:48.070826
[0m10:47:48.071684 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:47:48.214298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ecd4be-3e92-451f-b636-f3ce833fe1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbbed0>]}
[0m10:47:48.214830 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 30.71s]
[0m10:47:48.215137 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:47:48.216176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:47:48.216407 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:47:49.800390 [debug] [MainThread]: On master: COMMIT
[0m10:47:49.801827 [debug] [MainThread]: Using oracle connection "master"
[0m10:47:49.802335 [debug] [MainThread]: On master: COMMIT
[0m10:47:49.906225 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:47:49.908567 [debug] [MainThread]: On master: Close
[0m10:47:50.011013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:50.011728 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:47:50.011999 [info ] [MainThread]: 
[0m10:47:50.012226 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 38.87 seconds (38.87s).
[0m10:47:50.012602 [debug] [MainThread]: Command end result
[0m10:47:50.018277 [info ] [MainThread]: 
[0m10:47:50.018588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:47:50.018744 [info ] [MainThread]: 
[0m10:47:50.018910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:47:50.019379 [debug] [MainThread]: Command `dbt run` succeeded at 10:47:50.019319 after 39.09 seconds
[0m10:47:50.019596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100cbe910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100cbe510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e22c50>]}
[0m10:47:50.019790 [debug] [MainThread]: Flushing usage events
[0m10:47:53.773270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111409d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111414090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111417fd0>]}


============================== 10:47:53.775991 | 25c4bd64-aa5c-41db-b415-2f45d6c171e4 ==============================
[0m10:47:53.775991 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:47:53.776331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:47:53.824510 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:47:53.847228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25c4bd64-aa5c-41db-b415-2f45d6c171e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114c9410>]}
[0m10:47:53.853634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25c4bd64-aa5c-41db-b415-2f45d6c171e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b29910>]}
[0m10:47:53.889285 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:47:53.926370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:47:53.926909 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:47:53.947675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25c4bd64-aa5c-41db-b415-2f45d6c171e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f7c490>]}
[0m10:47:53.955163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25c4bd64-aa5c-41db-b415-2f45d6c171e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b2b850>]}
[0m10:47:53.955522 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:47:53.955711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25c4bd64-aa5c-41db-b415-2f45d6c171e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af71d0>]}
[0m10:47:53.956472 [info ] [MainThread]: 
[0m10:47:53.956883 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:47:53.957438 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:47:53.962739 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:47:53.963035 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:47:53.963216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:53.963383 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:47:55.760093 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:47:55.876539 [debug] [ThreadPool]: On list_None: Close
[0m10:47:56.002158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:47:56.010934 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:47:56.011709 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:47:56.012059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:56.012417 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:47:57.677581 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:47:57.691067 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:47:57.691819 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:47:57.863028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:47:58.116400 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:47:58.282387 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:47:58.451937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25c4bd64-aa5c-41db-b415-2f45d6c171e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b22e50>]}
[0m10:47:58.452617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:47:58.452957 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:48:00.444442 [debug] [MainThread]: On master: COMMIT
[0m10:48:00.446088 [debug] [MainThread]: Using oracle connection "master"
[0m10:48:00.447085 [debug] [MainThread]: On master: COMMIT
[0m10:48:00.584325 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:48:00.584758 [debug] [MainThread]: On master: Close
[0m10:48:00.736967 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:48:00.737433 [info ] [MainThread]: 
[0m10:48:00.741167 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:48:00.741630 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:48:00.742078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:48:00.742293 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:48:00.757082 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:48:00.760624 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:48:00.742439 => 10:48:00.760445
[0m10:48:00.760934 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:48:00.769759 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:48:00.770118 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:48:00.780064 [info ] [Thread-1 (]: Python model materialization is table
[0m10:48:00.780444 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:48:03.275974 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:48:03.277378 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTk2ODIsImlhdCI6MTY4NzQ1NjA4Mn0.HQm3fkzzaX5AbGCEj0x5BQOyOQ89HJtp5tgnNQzx-Nfm6Egol-romKqK_H4550QcrWzLvRdmXci0Jeo7Rcg7TAEk4BV4HtmnHJrimfUaxKK06D2v2dDj2YxaREZlj_kJul86Zaabz_rRd4S2G6BQKFnFE14C64s5DjA1l3J0lOgbUXHOwhsnRzL7hEng_LWwF2l28DkEPnbVfUl_L24uGJnHusAwiNV_TuXX81ynxtAAzD7R_o2PXwO-i0OzQcda952AxcFRccLEstWBhcumi6syoY27j8c9hYxnFaZyEBHyKvpNtijahUE2h4thQCUNgbDeOpYVHF_Wjm633Ih4bA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  # Independent variable
        y = df["SHIPPING_CITY"]  # Dependent variable
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
        
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174803 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174803';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:48:03.279003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:03.279683 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:48:28.649156 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m10:48:28.655432 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:48:28.680221 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:48:28.680827 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:48:28.837284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:28.846865 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:48:28.849086 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:48:29.032712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:29.054837 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:48:29.055473 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:48:29.055746 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:48:29.217488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:29.233598 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:48:29.235173 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:48:29.443884 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:29.474956 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:48:00.761104 => 10:48:29.474689
[0m10:48:29.475809 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:48:29.655035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25c4bd64-aa5c-41db-b415-2f45d6c171e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fbab10>]}
[0m10:48:29.658591 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 28.91s]
[0m10:48:29.660180 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:48:29.664675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:48:29.666171 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:48:31.918514 [debug] [MainThread]: On master: COMMIT
[0m10:48:31.920779 [debug] [MainThread]: Using oracle connection "master"
[0m10:48:31.922065 [debug] [MainThread]: On master: COMMIT
[0m10:48:32.079986 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:48:32.082257 [debug] [MainThread]: On master: Close
[0m10:48:32.260538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:32.262641 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:48:32.263530 [info ] [MainThread]: 
[0m10:48:32.264273 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 38.31 seconds (38.31s).
[0m10:48:32.265554 [debug] [MainThread]: Command end result
[0m10:48:32.280365 [info ] [MainThread]: 
[0m10:48:32.280772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:48:32.281017 [info ] [MainThread]: 
[0m10:48:32.281259 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:48:32.281696 [debug] [MainThread]: Command `dbt run` succeeded at 10:48:32.281628 after 38.53 seconds
[0m10:48:32.282010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10484ac50>]}
[0m10:48:32.282316 [debug] [MainThread]: Flushing usage events
[0m10:49:41.481321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10640bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064175d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106417e50>]}


============================== 10:49:41.483689 | 895c62a7-a792-4410-927f-9eb4f3afd635 ==============================
[0m10:49:41.483689 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:49:41.484012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:49:41.529157 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:49:41.552363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '895c62a7-a792-4410-927f-9eb4f3afd635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064284d0>]}
[0m10:49:41.558862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '895c62a7-a792-4410-927f-9eb4f3afd635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccd690>]}
[0m10:49:41.592281 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:49:41.631104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:49:41.631586 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:49:41.652825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '895c62a7-a792-4410-927f-9eb4f3afd635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8bc50>]}
[0m10:49:41.659751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '895c62a7-a792-4410-927f-9eb4f3afd635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0c590>]}
[0m10:49:41.660131 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:49:41.660317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '895c62a7-a792-4410-927f-9eb4f3afd635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106485fd0>]}
[0m10:49:41.661092 [info ] [MainThread]: 
[0m10:49:41.661488 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:49:41.662066 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:49:41.667353 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:49:41.667655 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:49:41.667835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:41.668010 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:49:43.863455 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:49:43.996274 [debug] [ThreadPool]: On list_None: Close
[0m10:49:44.138108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:49:44.154431 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:49:44.154986 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:49:44.155224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:44.155518 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:49:45.883712 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:49:45.889050 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:49:45.889517 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:49:46.029144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:49:46.246846 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:49:46.357352 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:49:46.480763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '895c62a7-a792-4410-927f-9eb4f3afd635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cad690>]}
[0m10:49:46.482189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:49:46.483043 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:49:48.336563 [debug] [MainThread]: On master: COMMIT
[0m10:49:48.341112 [debug] [MainThread]: Using oracle connection "master"
[0m10:49:48.341875 [debug] [MainThread]: On master: COMMIT
[0m10:49:48.488853 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:49:48.491265 [debug] [MainThread]: On master: Close
[0m10:49:48.628200 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:49:48.629850 [info ] [MainThread]: 
[0m10:49:48.650110 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:49:48.651170 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:49:48.652264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:49:48.652831 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:49:48.673086 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:49:48.674255 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:49:48.653226 => 10:49:48.674100
[0m10:49:48.674541 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:49:48.685057 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:49:48.685598 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:49:48.697570 [info ] [Thread-1 (]: Python model materialization is table
[0m10:49:48.698025 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:49:50.870033 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:49:50.872846 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTk3OTAsImlhdCI6MTY4NzQ1NjE5MH0.Bly7KZXmFHOmR4rs9wHmKIlWwcb5jvXscNwAFUVs7C_VXAED_3M7F51CBLsYiOkTFFEAq0mtLmE8tbxbDGM1rdukxrJ7Eo4wydfoGeBj4xNGQMfL6hBbDqcjpGsjfA3mhS6fT2GCbjJrdVn8X5KYSilFd5c54UAGKWQodl6uyf-wjhkKnTlVquL393zy0UFng8y0eOqvPGeujngdeNjHocs6dYA5-fhOb9LgdwcGyGNQMznMPw0av9fp6z7-jo98c4QeYQKmen-V5Tz4K0jhKKehgUqDF6Hqtfyn4cL4jjSuopYuizhI_2PWZdqGxrapqGhc3U10_7cZLUPUwio92g!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
    # Decode the predicted shipping city
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
    # Evaluate the classifier's accuracy
        accuracy = classifier.score(X_test, y_test)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174950 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_174950';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:49:50.877944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:50.878822 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:49:52.252964 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:49:52.255630 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:49:52.381090 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:49:48.674691 => 10:49:52.379891
[0m10:49:52.411168 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:49:52.413731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '895c62a7-a792-4410-927f-9eb4f3afd635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d52790>]}
[0m10:49:52.415294 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.76s]
[0m10:49:52.415903 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:49:52.417849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:49:52.418181 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:49:54.093524 [debug] [MainThread]: On master: COMMIT
[0m10:49:54.094654 [debug] [MainThread]: Using oracle connection "master"
[0m10:49:54.095474 [debug] [MainThread]: On master: COMMIT
[0m10:49:54.221207 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:49:54.223904 [debug] [MainThread]: On master: Close
[0m10:49:54.369941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:54.370751 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:49:54.371466 [info ] [MainThread]: 
[0m10:49:54.372078 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.71 seconds (12.71s).
[0m10:49:54.375239 [debug] [MainThread]: Command end result
[0m10:49:54.397703 [info ] [MainThread]: 
[0m10:49:54.398162 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:49:54.398385 [info ] [MainThread]: 
[0m10:49:54.398596 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:49:54.398802 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:49:54.398988 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:49:54.399181 [info ] [MainThread]: 
[0m10:49:54.399393 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:49:54.399843 [debug] [MainThread]: Command `dbt run` failed at 10:49:54.399773 after 12.93 seconds
[0m10:49:54.400173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106428510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c79a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b48e10>]}
[0m10:49:54.400470 [debug] [MainThread]: Flushing usage events
[0m10:49:59.496063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ffad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080fff90>]}


============================== 10:49:59.499120 | 84b53aac-4289-4ae9-b829-ffd05ef2a320 ==============================
[0m10:49:59.499120 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:49:59.499471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:49:59.542710 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:49:59.564478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84b53aac-4289-4ae9-b829-ffd05ef2a320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c4e50>]}
[0m10:49:59.570614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84b53aac-4289-4ae9-b829-ffd05ef2a320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108811450>]}
[0m10:49:59.604203 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:49:59.637896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:49:59.638216 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:49:59.641933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84b53aac-4289-4ae9-b829-ffd05ef2a320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066efb90>]}
[0m10:49:59.647988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84b53aac-4289-4ae9-b829-ffd05ef2a320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10884bcd0>]}
[0m10:49:59.648285 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:49:59.648457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84b53aac-4289-4ae9-b829-ffd05ef2a320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10884b5d0>]}
[0m10:49:59.649260 [info ] [MainThread]: 
[0m10:49:59.649688 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:49:59.650357 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:49:59.655349 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:49:59.655548 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:49:59.655720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:59.655892 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:50:01.477519 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:50:01.632721 [debug] [ThreadPool]: On list_None: Close
[0m10:50:01.760082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:50:01.765392 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:50:01.765921 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:50:01.766437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:01.767029 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:50:03.452901 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:50:03.466321 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:50:03.467079 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:50:03.648010 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:50:03.929201 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:50:04.139096 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:50:04.338600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84b53aac-4289-4ae9-b829-ffd05ef2a320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108997bd0>]}
[0m10:50:04.339625 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:04.340096 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:50:06.437152 [debug] [MainThread]: On master: COMMIT
[0m10:50:06.438213 [debug] [MainThread]: Using oracle connection "master"
[0m10:50:06.438698 [debug] [MainThread]: On master: COMMIT
[0m10:50:06.607715 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:50:06.610155 [debug] [MainThread]: On master: Close
[0m10:50:06.802072 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:50:06.802955 [info ] [MainThread]: 
[0m10:50:06.809605 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:50:06.810388 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:50:06.811194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:50:06.811610 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:50:06.833795 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:50:06.835007 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:50:06.811896 => 10:50:06.834837
[0m10:50:06.835383 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:50:06.844124 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:50:06.844486 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:50:06.853874 [info ] [Thread-1 (]: Python model materialization is table
[0m10:50:06.854221 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:50:11.466549 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:50:11.467581 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTk4MDksImlhdCI6MTY4NzQ1NjIwOX0.BwHE-sy9CuVslEUTv8x1pLUTX-1sNmaIs8O2cjhaGLqoi_etyEYK3n_YjRaVPIOo8ogVlcuP6ruGR-SB0fA87cWlnWQTCu7A0lSG_tv8c7Yp8X9CbpnFRHkLAlHz04pqKw7XI4N9gHSIOUigP0GiVgPy0VEzHLJRIQ62xo4zUn-JKPp3Lz6EOU06iTF4R9L6YMZruzZHpc_QQDyZe12P76fU5crmoRay35ttI3NPopF11rAqXm3tBYiZ5-998iLmmQx43CDDaq56r9cjsc-VHcw3fRmKks69JOZUMPcssE13Dalqpe6O4mY_W_2GupYTEgMHtOKQhE-jOe3WA0lYeg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
    # Decode the predicted shipping city
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
    # Evaluate the classifier's accuracy
        accuracy = classifier.score(X_test, y_test)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175011 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175011';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:50:11.468814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:11.469284 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:50:13.813631 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:50:13.815061 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:50:14.015254 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:50:06.835584 => 10:50:14.013735
[0m10:50:14.027305 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:50:14.029873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84b53aac-4289-4ae9-b829-ffd05ef2a320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a3a150>]}
[0m10:50:14.030684 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 7.22s]
[0m10:50:14.031195 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:50:14.033082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:50:14.033502 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:50:16.825762 [debug] [MainThread]: On master: COMMIT
[0m10:50:16.828154 [debug] [MainThread]: Using oracle connection "master"
[0m10:50:16.829106 [debug] [MainThread]: On master: COMMIT
[0m10:50:17.132728 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:50:17.134987 [debug] [MainThread]: On master: Close
[0m10:50:17.431750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:50:17.432782 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:50:17.433574 [info ] [MainThread]: 
[0m10:50:17.434336 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 17.78 seconds (17.78s).
[0m10:50:17.435020 [debug] [MainThread]: Command end result
[0m10:50:17.445814 [info ] [MainThread]: 
[0m10:50:17.446154 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:50:17.446318 [info ] [MainThread]: 
[0m10:50:17.446478 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:50:17.446630 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IF" was not provided
[0m10:50:17.446779 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:50:17.447001 [info ] [MainThread]: 
[0m10:50:17.447403 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:50:17.447775 [debug] [MainThread]: Command `dbt run` failed at 10:50:17.447719 after 17.97 seconds
[0m10:50:17.448048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a34e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a34ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080dc690>]}
[0m10:50:17.448265 [debug] [MainThread]: Flushing usage events
[0m10:50:23.351487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108153d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815ff90>]}


============================== 10:50:23.354013 | 8fc63e74-d32f-472c-b599-77934ed34003 ==============================
[0m10:50:23.354013 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:50:23.354340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:50:23.397070 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:50:23.419602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fc63e74-d32f-472c-b599-77934ed34003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a24e50>]}
[0m10:50:23.425785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fc63e74-d32f-472c-b599-77934ed34003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088710d0>]}
[0m10:50:23.457904 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:50:23.496205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:50:23.496686 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:50:23.517545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fc63e74-d32f-472c-b599-77934ed34003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10818ea50>]}
[0m10:50:23.523825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fc63e74-d32f-472c-b599-77934ed34003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a25e50>]}
[0m10:50:23.524135 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:50:23.524309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fc63e74-d32f-472c-b599-77934ed34003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a1f10>]}
[0m10:50:23.525044 [info ] [MainThread]: 
[0m10:50:23.525395 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:50:23.525992 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:50:23.531333 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:50:23.531604 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:50:23.531766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:23.531928 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:50:26.657946 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:50:26.969609 [debug] [ThreadPool]: On list_None: Close
[0m10:50:27.167965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:50:27.176774 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:50:27.177496 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:50:27.177896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:27.178313 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:50:29.779416 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:50:29.790888 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:50:29.791761 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:50:30.037397 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:50:30.259382 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:50:30.450551 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:50:30.639377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fc63e74-d32f-472c-b599-77934ed34003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d6d50>]}
[0m10:50:30.639868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:30.640081 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:50:32.710818 [debug] [MainThread]: On master: COMMIT
[0m10:50:32.711301 [debug] [MainThread]: Using oracle connection "master"
[0m10:50:32.711542 [debug] [MainThread]: On master: COMMIT
[0m10:50:32.872497 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:50:32.874904 [debug] [MainThread]: On master: Close
[0m10:50:33.034498 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:50:33.035431 [info ] [MainThread]: 
[0m10:50:33.041609 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:50:33.042293 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:50:33.042989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:50:33.043326 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:50:33.061928 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:50:33.063402 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:50:33.043559 => 10:50:33.063223
[0m10:50:33.063787 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:50:33.075584 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:50:33.075997 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:50:33.087136 [info ] [Thread-1 (]: Python model materialization is table
[0m10:50:33.087523 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:50:35.570083 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:50:35.571540 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTk4MzQsImlhdCI6MTY4NzQ1NjIzNH0.SWh2xXTy6zInbJQqBd8X8VvDo0PSpVxj4npoolSZ_MZkwm0xh5jNVb2A5hkoO_sVyVVJVgjxIvQtXG0fQWX2_qs-VlM7QDRS28RNVyB85ls4Sbf8Dj7SF3lKToNccNLisSiZVkGXFBtiIoZhkJRpcSrHacAEkhotab--aS5xfPnlQj5RBxLU0CeeOM1Qedr3wMnH_5lhoo_nYzlTkF5Og_8ZlY_T_rcPUZS_vho8JFlYu-JdTs3EGuyLZr2EqNL61HjhBrpX8DJyBbk0JGv3r1GtNivUFCa6wH8nYtvtYkPMbn5uCAuXHI1Wce9IXzKKNqawe5zYATBkZTIfQuni_g!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175035 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175035';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:50:35.572976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:35.573555 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:50:37.368867 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m10:50:37.369760 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:50:37.537146 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:50:33.064029 => 10:50:37.532325
[0m10:50:37.555254 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:50:37.558188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fc63e74-d32f-472c-b599-77934ed34003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898c610>]}
[0m10:50:37.559044 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 4.52s]
[0m10:50:37.559548 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:50:37.561344 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:50:37.561742 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:50:39.674418 [debug] [MainThread]: On master: COMMIT
[0m10:50:39.676648 [debug] [MainThread]: Using oracle connection "master"
[0m10:50:39.677412 [debug] [MainThread]: On master: COMMIT
[0m10:50:39.882619 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:50:39.885056 [debug] [MainThread]: On master: Close
[0m10:50:40.072326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:50:40.073046 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:50:40.073383 [info ] [MainThread]: 
[0m10:50:40.073676 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.55 seconds (16.55s).
[0m10:50:40.074134 [debug] [MainThread]: Command end result
[0m10:50:40.087709 [info ] [MainThread]: 
[0m10:50:40.088178 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:50:40.088434 [info ] [MainThread]: 
[0m10:50:40.088667 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:50:40.088895 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m10:50:40.089099 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:50:40.089332 [info ] [MainThread]: 
[0m10:50:40.089564 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:50:40.089993 [debug] [MainThread]: Command `dbt run` failed at 10:50:40.089925 after 16.76 seconds
[0m10:50:40.090322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a96c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a94e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f47d0>]}
[0m10:50:40.090621 [debug] [MainThread]: Flushing usage events
[0m10:50:45.357916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424bf90>]}


============================== 10:50:45.360629 | 057adc3e-8026-4f89-b7cc-e9cb7d0fe8e5 ==============================
[0m10:50:45.360629 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:50:45.360942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:50:45.415344 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:50:45.437117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '057adc3e-8026-4f89-b7cc-e9cb7d0fe8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424b8d0>]}
[0m10:50:45.443692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '057adc3e-8026-4f89-b7cc-e9cb7d0fe8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10495d990>]}
[0m10:50:45.475613 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:50:45.509093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:50:45.509403 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:50:45.512747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '057adc3e-8026-4f89-b7cc-e9cb7d0fe8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042cb590>]}
[0m10:50:45.517363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '057adc3e-8026-4f89-b7cc-e9cb7d0fe8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10427fb90>]}
[0m10:50:45.517661 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:50:45.517845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '057adc3e-8026-4f89-b7cc-e9cb7d0fe8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10422ba50>]}
[0m10:50:45.518688 [info ] [MainThread]: 
[0m10:50:45.519164 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:50:45.519668 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:50:45.524825 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:50:45.525058 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:50:45.525239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:45.525423 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:50:48.787615 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:50:48.997290 [debug] [ThreadPool]: On list_None: Close
[0m10:50:49.227351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:50:49.237346 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:50:49.238024 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:50:49.238323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:49.238634 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:50:52.289605 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:50:52.300177 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:50:52.301121 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:50:52.531988 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:50:52.889962 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:50:53.151944 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:50:53.381540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '057adc3e-8026-4f89-b7cc-e9cb7d0fe8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b55d0>]}
[0m10:50:53.382614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:53.383075 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:50:56.252256 [debug] [MainThread]: On master: COMMIT
[0m10:50:56.254860 [debug] [MainThread]: Using oracle connection "master"
[0m10:50:56.255938 [debug] [MainThread]: On master: COMMIT
[0m10:50:56.502665 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:50:56.505028 [debug] [MainThread]: On master: Close
[0m10:50:56.756850 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:50:56.758867 [info ] [MainThread]: 
[0m10:50:56.766563 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:50:56.767370 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:50:56.768211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:50:56.768615 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:50:56.790803 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:50:56.791818 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:50:56.768908 => 10:50:56.791706
[0m10:50:56.792063 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:50:56.800734 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:50:56.801128 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:50:56.811500 [info ] [Thread-1 (]: Python model materialization is table
[0m10:50:56.812033 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:50:59.534693 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:50:59.536154 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTk4NTgsImlhdCI6MTY4NzQ1NjI1OH0.S4nPvEq7gBldSN5r3oEUxSUxo8XZVczAl7xawWcwnjW16NOKGyU8sPqhnkrzgOeFjlkSyx0w30IPodLpk-F_KvQDfMg9iRyMwaTjb9KiScuW5oWK2fuQuZDXdzH-6aGayBm-CzZl7Xt36gZfrDLOFYW33iblRTCXtj_uSo2MVTUJb1HdIA3akqoA3K9OVfOIdJCiDjdrkQOf2dr_F9JOK0gEgyHoMyHfnApP7jx_iAkhZucivE1XhVEFO_CiG23CLIe2c9MJfDwCo38mZ-OQYpoB9mKzycibjZc7qd8AlszdIvLEly80SE_PTMQrH29d-lQ4lwDfmRaVU_C55YoC3A!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175059 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175059';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:50:59.537650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:59.538226 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:51:25.932160 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m10:51:25.936863 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:51:25.946188 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:51:25.946853 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:51:26.171430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:51:26.177968 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:51:26.178893 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:51:26.395705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:51:26.412935 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:51:26.413635 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:51:26.414029 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:51:26.625070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:51:26.634160 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:51:26.634756 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:51:26.847945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:51:26.868472 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:50:56.792205 => 10:51:26.868239
[0m10:51:26.869245 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:51:27.065010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057adc3e-8026-4f89-b7cc-e9cb7d0fe8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423d110>]}
[0m10:51:27.065662 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 30.30s]
[0m10:51:27.066058 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:51:27.067324 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:27.067701 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:51:29.596169 [debug] [MainThread]: On master: COMMIT
[0m10:51:29.598638 [debug] [MainThread]: Using oracle connection "master"
[0m10:51:29.599903 [debug] [MainThread]: On master: COMMIT
[0m10:51:29.840080 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:51:29.842063 [debug] [MainThread]: On master: Close
[0m10:51:30.084249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:30.085223 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:51:30.085787 [info ] [MainThread]: 
[0m10:51:30.086264 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 44.57 seconds (44.57s).
[0m10:51:30.087117 [debug] [MainThread]: Command end result
[0m10:51:30.096911 [info ] [MainThread]: 
[0m10:51:30.097526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:51:30.097850 [info ] [MainThread]: 
[0m10:51:30.098184 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:51:30.098819 [debug] [MainThread]: Command `dbt run` succeeded at 10:51:30.098730 after 44.76 seconds
[0m10:51:30.099216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a1e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a1e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b80e90>]}
[0m10:51:30.099591 [debug] [MainThread]: Flushing usage events
[0m10:51:39.940413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c2fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aea890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c18c10>]}


============================== 10:51:39.943163 | d96901fc-9bf7-4f4b-a1c1-f522f828e0b9 ==============================
[0m10:51:39.943163 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:51:39.943486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:51:39.987606 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:51:40.009371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd96901fc-9bf7-4f4b-a1c1-f522f828e0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4dbd0>]}
[0m10:51:40.015828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd96901fc-9bf7-4f4b-a1c1-f522f828e0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834d8d0>]}
[0m10:51:40.048113 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:51:40.078661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:51:40.079085 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:51:40.100292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd96901fc-9bf7-4f4b-a1c1-f522f828e0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085149d0>]}
[0m10:51:40.106335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd96901fc-9bf7-4f4b-a1c1-f522f828e0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10850fe50>]}
[0m10:51:40.106673 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:51:40.106854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd96901fc-9bf7-4f4b-a1c1-f522f828e0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cefad0>]}
[0m10:51:40.107598 [info ] [MainThread]: 
[0m10:51:40.107978 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:51:40.108505 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:51:40.113389 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:51:40.113665 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:51:40.113842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:40.114016 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:51:43.388417 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:51:43.622337 [debug] [ThreadPool]: On list_None: Close
[0m10:51:43.871613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:51:43.880279 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:51:43.881029 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:51:43.881436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:43.881838 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:51:46.487222 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:51:46.498310 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:51:46.498954 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:51:46.836434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:51:47.144496 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:51:47.332823 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:51:47.537782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd96901fc-9bf7-4f4b-a1c1-f522f828e0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108380890>]}
[0m10:51:47.538798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:47.539265 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:51:50.113116 [debug] [MainThread]: On master: COMMIT
[0m10:51:50.115352 [debug] [MainThread]: Using oracle connection "master"
[0m10:51:50.116333 [debug] [MainThread]: On master: COMMIT
[0m10:51:50.318122 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:51:50.320499 [debug] [MainThread]: On master: Close
[0m10:51:50.529287 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:51:50.530998 [info ] [MainThread]: 
[0m10:51:50.537943 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:51:50.538850 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:51:50.539809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:51:50.540263 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:51:50.561040 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:51:50.562440 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:51:50.540596 => 10:51:50.562197
[0m10:51:50.562881 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:51:50.573224 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:51:50.573620 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:51:50.582893 [info ] [Thread-1 (]: Python model materialization is table
[0m10:51:50.583426 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:51:53.074202 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:51:53.075770 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NTk5MTIsImlhdCI6MTY4NzQ1NjMxMn0.TbsdMC2XJFEPBG-4MAEl-bk6zgjET12cX25nG7OdzBL7PI20oFP_aNDihm8wht-gLYE7JCNBjcFrcHArKWfgWbtZrcyfFj0RZf8s_0_ozwcCEySxaNgGmpI8gI9nFXk7hcDdIkxsfd2o29zRC9QzhzAhnfq5pn7BZvU5HC8ZBQTFJyRbN8gBZyqLsNE5ynVpq3mKzTlgaNFT4NhJ0GgZGF1qnl2ozfZ0HvAwoZLmTCpct-J6fFDueyXXynoiwBGLCdyzfJLFMn4xZX6wQsSfBjuTOAKbsmbT_NT-_-0_jU2keiclUwjtCy9vM_Qw_iu8iLPkcoODZFDLm-cswpM1Cg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
    
        return y_pred_decoded





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175153 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175153';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:51:53.077345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:53.077928 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:52:22.190929 [debug] [Thread-1 (]: SQL status: OK in 29.0 seconds
[0m10:52:22.194600 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:52:22.206245 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:52:22.206738 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m10:52:22.416702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:52:22.422034 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:52:22.422558 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:52:22.813290 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00942: table or view does not exist
[0m10:52:22.814818 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: ROLLBACK
[0m10:52:23.012335 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:52:23.216706 [info ] [Thread-1 (]: oracle adapter: Rolling back transaction.
[0m10:52:23.217745 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:51:50.563111 => 10:52:23.217515
[0m10:52:23.241357 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-00942: table or view does not exist
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:52:23.243607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd96901fc-9bf7-4f4b-a1c1-f522f828e0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108442bd0>]}
[0m10:52:23.244268 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 32.70s]
[0m10:52:23.244684 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:52:23.246239 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:52:23.246519 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:52:27.034185 [debug] [MainThread]: On master: COMMIT
[0m10:52:27.036572 [debug] [MainThread]: Using oracle connection "master"
[0m10:52:27.039795 [debug] [MainThread]: On master: COMMIT
[0m10:52:27.300048 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:52:27.302208 [debug] [MainThread]: On master: Close
[0m10:52:27.564048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:27.564780 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:52:27.565144 [info ] [MainThread]: 
[0m10:52:27.565421 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 47.46 seconds (47.46s).
[0m10:52:27.565851 [debug] [MainThread]: Command end result
[0m10:52:27.572606 [info ] [MainThread]: 
[0m10:52:27.572999 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:52:27.573252 [info ] [MainThread]: 
[0m10:52:27.573479 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:52:27.573703 [error] [MainThread]:   ORA-00942: table or view does not exist
[0m10:52:27.573918 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:52:27.574132 [info ] [MainThread]: 
[0m10:52:27.574364 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:52:27.574845 [debug] [MainThread]: Command `dbt run` failed at 10:52:27.574767 after 47.65 seconds
[0m10:52:27.575222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104572c50>]}
[0m10:52:27.575569 [debug] [MainThread]: Flushing usage events
[0m10:53:27.034493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a99f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa7fd0>]}


============================== 10:53:27.037422 | fc0c8c51-c954-4eca-adf2-4d253dd36594 ==============================
[0m10:53:27.037422 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:53:27.037766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:53:27.082100 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:53:27.104358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc0c8c51-c954-4eca-adf2-4d253dd36594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab8890>]}
[0m10:53:27.110727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc0c8c51-c954-4eca-adf2-4d253dd36594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d20d0>]}
[0m10:53:27.144936 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:53:27.177927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:53:27.178365 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:53:27.198939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc0c8c51-c954-4eca-adf2-4d253dd36594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055588d0>]}
[0m10:53:27.204760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc0c8c51-c954-4eca-adf2-4d253dd36594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621d050>]}
[0m10:53:27.205096 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:53:27.205340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc0c8c51-c954-4eca-adf2-4d253dd36594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e9090>]}
[0m10:53:27.206089 [info ] [MainThread]: 
[0m10:53:27.206458 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:53:27.207041 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:53:27.212138 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:53:27.212443 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:53:27.212618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:27.212789 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:53:30.216909 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:53:30.468792 [debug] [ThreadPool]: On list_None: Close
[0m10:53:30.679159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:53:30.688265 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:53:30.688885 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:53:30.689290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:53:30.689728 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:53:33.499679 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:53:33.512563 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:53:33.513301 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:53:33.981339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:34.174127 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:53:34.376635 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:53:34.617256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc0c8c51-c954-4eca-adf2-4d253dd36594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a2e10>]}
[0m10:53:34.618153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:53:34.618666 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:53:37.267053 [debug] [MainThread]: On master: COMMIT
[0m10:53:37.269500 [debug] [MainThread]: Using oracle connection "master"
[0m10:53:37.270652 [debug] [MainThread]: On master: COMMIT
[0m10:53:37.451894 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:53:37.454202 [debug] [MainThread]: On master: Close
[0m10:53:37.647422 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:53:37.648541 [info ] [MainThread]: 
[0m10:53:37.654437 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:53:37.655222 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:53:37.656109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:53:37.656571 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:53:37.674797 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:53:37.676544 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:53:37.656894 => 10:53:37.676391
[0m10:53:37.676875 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:53:37.685231 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:53:37.685675 [debug] [Thread-1 (]: Preexisting backup relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_BACKUP
[0m10:53:37.689286 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:53:37.689648 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_BACKUP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:53:37.689875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:37.690090 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:53:39.947019 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m10:53:39.966736 [info ] [Thread-1 (]: Python model materialization is table
[0m10:53:39.967138 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:53:42.547318 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:53:42.549537 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjAwMjEsImlhdCI6MTY4NzQ1NjQyMX0.LLY-AxHFGn0Pr_7pkKykVGYo1MUcUxirRgXOlUlNS5thNmzyWOAYpOveuFHA6hE-pnKrBxeW3nSULRA-s36nOEQkzKbde68MDyzi-IHefXzZQs9-gO2Pu73oJ3II8SClw69rfTj-WHWoRqSGh0srF7h_KfePVSfLEbwwaVyejZI1fFzi1nTmlNLukUB5kmu8rBaAySPjzQjONoxBNqVY9mB0vLeImHwwdUdB3pFtwFJf0CgZFJJqoIqqmgnYQYhQ17zhfutx5bocgc4zJyUzf2wJ3yuXX39UWwMkkYlNTp1cZBmwZQ6mDJozE-lT4jovPYb2sipCb6lCEoYndLSeLQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
    
        print(accuracy)
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175342 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175342';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:54:06.612671 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: Output malformed JSON: 1.0\n[{\"result\":1}]\n. This could be caused by explicitly calling print() in the executed Python script. Remove print() call from the script should solve the issue.
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 105
[0m10:54:06.615412 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:54:06.813445 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:53:37.677083 => 10:54:06.812169
[0m10:54:06.824622 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: Output malformed JSON: 1.0\n[{\"result\":1}]\n. This could be caused by explicitly calling print() in the executed Python script. Remove print() call from the script should solve the issue.
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 105
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:54:06.827104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc0c8c51-c954-4eca-adf2-4d253dd36594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a2710>]}
[0m10:54:06.827853 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 29.17s]
[0m10:54:06.828309 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:54:06.829939 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:54:06.830299 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:54:09.852155 [debug] [MainThread]: On master: COMMIT
[0m10:54:09.854429 [debug] [MainThread]: Using oracle connection "master"
[0m10:54:09.855557 [debug] [MainThread]: On master: COMMIT
[0m10:54:10.068834 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:54:10.071164 [debug] [MainThread]: On master: Close
[0m10:54:10.282730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:10.283732 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:54:10.284311 [info ] [MainThread]: 
[0m10:54:10.284798 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 43.08 seconds (43.08s).
[0m10:54:10.285508 [debug] [MainThread]: Command end result
[0m10:54:10.295554 [info ] [MainThread]: 
[0m10:54:10.296168 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:54:10.296476 [info ] [MainThread]: 
[0m10:54:10.296771 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:54:10.297060 [error] [MainThread]:   ORA-20100: Output malformed JSON: 1.0\n[{\"result\":1}]\n. This could be caused by explicitly calling print() in the executed Python script. Remove print() call from the script should solve the issue.
[0m10:54:10.297332 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m10:54:10.297589 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m10:54:10.297835 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m10:54:10.298077 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m10:54:10.298317 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m10:54:10.298564 [error] [MainThread]:   ORA-06512: at line 105
[0m10:54:10.298808 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:54:10.299057 [info ] [MainThread]: 
[0m10:54:10.299332 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:54:10.299930 [debug] [MainThread]: Command `dbt run` failed at 10:54:10.299843 after 43.29 seconds
[0m10:54:10.300344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023dec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106286ad0>]}
[0m10:54:10.300739 [debug] [MainThread]: Flushing usage events
[0m10:54:42.330832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106767b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106773c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106773f90>]}


============================== 10:54:42.333270 | 4e430f62-20bd-49b8-800a-ffd0b700a7e6 ==============================
[0m10:54:42.333270 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:54:42.333594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:54:42.375116 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:54:42.396811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e430f62-20bd-49b8-800a-ffd0b700a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067673d0>]}
[0m10:54:42.402973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e430f62-20bd-49b8-800a-ffd0b700a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a6d50>]}
[0m10:54:42.435171 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:54:42.469697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:54:42.470171 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:54:42.491480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e430f62-20bd-49b8-800a-ffd0b700a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb8fd0>]}
[0m10:54:42.500163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e430f62-20bd-49b8-800a-ffd0b700a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa9290>]}
[0m10:54:42.500539 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:54:42.500721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e430f62-20bd-49b8-800a-ffd0b700a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679ebd0>]}
[0m10:54:42.501478 [info ] [MainThread]: 
[0m10:54:42.501865 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:54:42.502397 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:54:42.507354 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:54:42.507643 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:54:42.507833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:42.508007 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:54:46.122600 [debug] [ThreadPool]: SQL status: OK in 4.0 seconds
[0m10:54:46.356277 [debug] [ThreadPool]: On list_None: Close
[0m10:54:46.655470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:54:46.664045 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:54:46.664766 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:54:46.665189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:54:46.665599 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:54:49.056810 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m10:54:49.069056 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:54:49.069810 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:54:49.414521 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:54:49.764861 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:54:49.973859 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:54:50.189620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e430f62-20bd-49b8-800a-ffd0b700a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8ec90>]}
[0m10:54:50.190782 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:54:50.191280 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:54:53.297324 [debug] [MainThread]: On master: COMMIT
[0m10:54:53.299531 [debug] [MainThread]: Using oracle connection "master"
[0m10:54:53.300279 [debug] [MainThread]: On master: COMMIT
[0m10:54:53.543112 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:54:53.545670 [debug] [MainThread]: On master: Close
[0m10:54:53.797243 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:54:53.799054 [info ] [MainThread]: 
[0m10:54:53.806052 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:54:53.806850 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:54:53.807793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:54:53.808258 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:54:53.827867 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:54:53.829063 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:54:53.808585 => 10:54:53.828908
[0m10:54:53.829411 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:54:53.837676 [debug] [Thread-1 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m10:54:53.838018 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:54:53.841475 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:54:53.841774 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:54:53.841983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:53.842186 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:54:57.379844 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m10:54:57.408163 [info ] [Thread-1 (]: Python model materialization is table
[0m10:54:57.408832 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:55:00.452039 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:55:00.453521 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjAwOTksImlhdCI6MTY4NzQ1NjQ5OX0.fjhWrz72m2n5Tw0Eax9tfKE5axk8eRXRnPybFWU7PbPspnPwEtxHeIpCLlYNW2ZG8gZMF2OhU8RME3p282huOI4KIAfMQrYOlhMIFnw7z0NsxcHffCCAavgQde9bh_tbmDY8RAu8ZQhA1LwaK1c0g_lDCw-0swZ9Xx-hb8LIKC8mpTyd7uF-zqUFya6LfhgrbOjrlw29YD1miAp3BcropZ1pv6-spfhgndQ5SJjf8jnvK9-ibOKwOZLmywYg2eKXDZtGD7xuEoNBspCyeQu6hZ5HLctbYd0FaS3KrbXP8o_JL4pe9o-z_fegA-nwRnl-KjBNzUHl5FaITKIrbITsxQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
    
        return y_pred





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175500 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175500';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:55:25.357009 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m10:55:25.361657 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:55:25.372110 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:55:25.372913 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:55:25.877306 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00942: table or view does not exist
[0m10:55:25.879808 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: ROLLBACK
[0m10:55:26.185715 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:55:26.386677 [info ] [Thread-1 (]: oracle adapter: Rolling back transaction.
[0m10:55:26.387725 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:54:53.829630 => 10:55:26.387480
[0m10:55:26.398682 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-00942: table or view does not exist
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:55:26.401022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e430f62-20bd-49b8-800a-ffd0b700a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d63b90>]}
[0m10:55:26.401673 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 32.59s]
[0m10:55:26.401963 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:55:26.403171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:55:26.403456 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:55:29.841127 [debug] [MainThread]: On master: COMMIT
[0m10:55:29.842567 [debug] [MainThread]: Using oracle connection "master"
[0m10:55:29.843622 [debug] [MainThread]: On master: COMMIT
[0m10:55:30.169537 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:55:30.171934 [debug] [MainThread]: On master: Close
[0m10:55:30.412816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:30.414765 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:55:30.415397 [info ] [MainThread]: 
[0m10:55:30.415813 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 47.91 seconds (47.91s).
[0m10:55:30.416572 [debug] [MainThread]: Command end result
[0m10:55:30.428947 [info ] [MainThread]: 
[0m10:55:30.429359 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:55:30.429575 [info ] [MainThread]: 
[0m10:55:30.429752 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:55:30.429927 [error] [MainThread]:   ORA-00942: table or view does not exist
[0m10:55:30.430130 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:55:30.430373 [info ] [MainThread]: 
[0m10:55:30.430651 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:55:30.431292 [debug] [MainThread]: Command `dbt run` failed at 10:55:30.431187 after 48.12 seconds
[0m10:55:30.431732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d620d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030aac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106785c10>]}
[0m10:55:30.432137 [debug] [MainThread]: Flushing usage events
[0m10:55:50.378872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e280d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e08c10>]}


============================== 10:55:50.381324 | cbea2caa-661c-4e0a-9536-7dc5e154e131 ==============================
[0m10:55:50.381324 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:55:50.381663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:55:50.425558 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:55:50.447534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbea2caa-661c-4e0a-9536-7dc5e154e131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f0e50>]}
[0m10:55:50.453750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbea2caa-661c-4e0a-9536-7dc5e154e131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c295d0>]}
[0m10:55:50.486626 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:55:50.518579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:55:50.519028 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:55:50.539726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbea2caa-661c-4e0a-9536-7dc5e154e131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109581e90>]}
[0m10:55:50.545919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbea2caa-661c-4e0a-9536-7dc5e154e131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4da10>]}
[0m10:55:50.546239 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:55:50.546416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbea2caa-661c-4e0a-9536-7dc5e154e131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5b910>]}
[0m10:55:50.547141 [info ] [MainThread]: 
[0m10:55:50.547516 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:55:50.548040 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:55:50.553043 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:55:50.553344 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:55:50.553520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:50.553698 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:55:53.380701 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:55:53.593407 [debug] [ThreadPool]: On list_None: Close
[0m10:55:53.832011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:55:53.840719 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:55:53.841395 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:55:53.841800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:55:53.842213 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:55:56.690742 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:55:56.705248 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:55:56.705979 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:55:56.998285 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:55:57.250152 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:55:57.453205 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:55:57.722605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbea2caa-661c-4e0a-9536-7dc5e154e131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c21f10>]}
[0m10:55:57.723633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:55:57.724089 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:56:00.582685 [debug] [MainThread]: On master: COMMIT
[0m10:56:00.585025 [debug] [MainThread]: Using oracle connection "master"
[0m10:56:00.586244 [debug] [MainThread]: On master: COMMIT
[0m10:56:00.889584 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:00.891542 [debug] [MainThread]: On master: Close
[0m10:56:01.202898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:56:01.203871 [info ] [MainThread]: 
[0m10:56:01.212794 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:56:01.213580 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:56:01.214463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:56:01.214909 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:56:01.232072 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:56:01.234891 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:56:01.215223 => 10:56:01.234732
[0m10:56:01.235193 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:56:01.243177 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:56:01.243514 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:56:01.253213 [info ] [Thread-1 (]: Python model materialization is table
[0m10:56:01.253605 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:56:04.275593 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:56:04.277748 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjAxNjMsImlhdCI6MTY4NzQ1NjU2M30.hLhoO39NlK3w3UCInEbokh0NvjexCuigPdaVHcYKqymtfunKVRRO7JjDUToB7KtxLU3DVsHSdttE2QE4Ue8BlI8vWaGXKKFDx7bohDLGdHBCg_GbOugYeJJRm-zBlgFfR-xH6q76Ozq9edpcLoGdyL2gm7sj6lu5pJW2MtW44vK5MwC1Tj5cNwJ-DH4qemIEbR09NlH83zb8aEePcVukT3vKTqkeFhC5X78V78cYWAdRrgiTHOxCsQ4VMPa9FEGio9kISTVoBNSeJapNBBPI4avOlXcva14Id4IM90AAhXZbGd1xudWt3yTK6MdPKHmtVU_gW29ZNW6oI-OXG0gleQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
    
        return accuracy





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175604 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175604';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:56:04.279753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:04.280468 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:56:32.729616 [debug] [Thread-1 (]: SQL status: OK in 28.0 seconds
[0m10:56:32.731472 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:56:32.752689 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:56:32.753131 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:56:33.350484 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00942: table or view does not exist
[0m10:56:33.352803 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: ROLLBACK
[0m10:56:33.600120 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:56:33.968988 [info ] [Thread-1 (]: oracle adapter: Rolling back transaction.
[0m10:56:33.971738 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:56:01.235405 => 10:56:33.970974
[0m10:56:33.990441 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-00942: table or view does not exist
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:56:33.993461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbea2caa-661c-4e0a-9536-7dc5e154e131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf6690>]}
[0m10:56:33.994397 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 32.78s]
[0m10:56:33.995070 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:56:33.997529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:56:33.998189 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:56:36.864612 [debug] [MainThread]: On master: COMMIT
[0m10:56:36.866814 [debug] [MainThread]: Using oracle connection "master"
[0m10:56:36.867800 [debug] [MainThread]: On master: COMMIT
[0m10:56:37.064880 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:37.067272 [debug] [MainThread]: On master: Close
[0m10:56:37.285357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:37.286172 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:56:37.287235 [info ] [MainThread]: 
[0m10:56:37.288235 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 46.74 seconds (46.74s).
[0m10:56:37.288960 [debug] [MainThread]: Command end result
[0m10:56:37.305716 [info ] [MainThread]: 
[0m10:56:37.306099 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:56:37.306270 [info ] [MainThread]: 
[0m10:56:37.306428 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:56:37.306584 [error] [MainThread]:   ORA-00942: table or view does not exist
[0m10:56:37.306726 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:56:37.306911 [info ] [MainThread]: 
[0m10:56:37.307148 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:56:37.307484 [debug] [MainThread]: Command `dbt run` failed at 10:56:37.307432 after 46.95 seconds
[0m10:56:37.307711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078cc810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104760e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac66d0>]}
[0m10:56:37.307921 [debug] [MainThread]: Flushing usage events
[0m10:58:26.041853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11220b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112217950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112217f50>]}


============================== 10:58:26.044830 | f2bcba6c-cd23-45f6-a996-df095c8fa4fd ==============================
[0m10:58:26.044830 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:58:26.045179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:58:26.087893 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:58:26.110054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2bcba6c-cd23-45f6-a996-df095c8fa4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11224cad0>]}
[0m10:58:26.115899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2bcba6c-cd23-45f6-a996-df095c8fa4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112acd8d0>]}
[0m10:58:26.148243 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:58:26.185037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:58:26.185496 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:58:26.206268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2bcba6c-cd23-45f6-a996-df095c8fa4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b16190>]}
[0m10:58:26.212830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2bcba6c-cd23-45f6-a996-df095c8fa4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b36c10>]}
[0m10:58:26.213158 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:58:26.213336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2bcba6c-cd23-45f6-a996-df095c8fa4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c00cd0>]}
[0m10:58:26.214058 [info ] [MainThread]: 
[0m10:58:26.214455 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:58:26.214987 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:58:26.220025 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:58:26.220358 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:58:26.220533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:26.220707 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:58:28.983995 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:58:29.159898 [debug] [ThreadPool]: On list_None: Close
[0m10:58:29.349012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:58:29.356617 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:58:29.357337 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:58:29.357741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:29.358160 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:58:32.579419 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:58:32.592140 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:58:32.592916 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:58:32.850157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:33.181699 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:58:33.464801 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:58:33.780645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2bcba6c-cd23-45f6-a996-df095c8fa4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c97290>]}
[0m10:58:33.781768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:33.782227 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:58:37.014248 [debug] [MainThread]: On master: COMMIT
[0m10:58:37.016658 [debug] [MainThread]: Using oracle connection "master"
[0m10:58:37.017798 [debug] [MainThread]: On master: COMMIT
[0m10:58:37.257019 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:58:37.259308 [debug] [MainThread]: On master: Close
[0m10:58:37.503181 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:58:37.504758 [info ] [MainThread]: 
[0m10:58:37.511215 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:58:37.511884 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:58:37.512599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:58:37.512932 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:58:37.530533 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:58:37.531835 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:58:37.513175 => 10:58:37.531663
[0m10:58:37.532192 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:58:37.540548 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:58:37.540870 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:58:37.551817 [info ] [Thread-1 (]: Python model materialization is table
[0m10:58:37.552198 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:58:40.838715 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:58:40.839285 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjAzMTksImlhdCI6MTY4NzQ1NjcxOX0.qxb7sql4rW3xyeBjL8KnGcG10a3qBm4H6ztCM8Zm20B_usXCuTPnVeidQpFu4h_7YeZNSN5kMvjLTxDvMB2PeP15CSQ7YUSOAPXEY3l4SwV9rfnwgopil-CKGmb_YVGQR3i5bhIK2uqVKxelKfIquVr6ue0gN5WXL_Cj5htng3A23subqeVm3BrfaCB5yVwzCCJ6xpjMvdUy7iD6-CRDSXtghUEmFmyV2w-SiIORmjuphrm5ykCuNnDJ5_ihoNeUxvRt1Q0l_BQdTU9WiGTGmAv0aSvaDz4I4IKCFPtLi0hgrnOD11jhq4EBI_JB6IZX7pkYJPchha3GWQNEVvdg1Q!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
    
        return pd.DataFrame(y_pred, columns=['predictions'])





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175840 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175840';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:58:40.839960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:40.840251 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:58:44.120805 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06550: line 82, column 47:
PLS-00103: Encountered the symbol "PREDICTIONS" when expecting one of the following:

   ) , * & = - + < / > at in is mod remainder not rem =>
   <an exponent (**)> <> or != or ~= >= <= <> and or like like2
   like4 likec between || multiset member submultiset
[0m10:58:44.123043 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:58:44.402313 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:58:37.532413 => 10:58:44.400899
[0m10:58:44.414501 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-06550: line 82, column 47:
  PLS-00103: Encountered the symbol "PREDICTIONS" when expecting one of the following:
  
     ) , * & = - + < / > at in is mod remainder not rem =>
     <an exponent (**)> <> or != or ~= >= <= <> and or like like2
     like4 likec between || multiset member submultiset
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:58:44.416917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2bcba6c-cd23-45f6-a996-df095c8fa4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c8d350>]}
[0m10:58:44.417617 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 6.90s]
[0m10:58:44.417969 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:58:44.419479 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:44.419809 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:58:47.649581 [debug] [MainThread]: On master: COMMIT
[0m10:58:47.652941 [debug] [MainThread]: Using oracle connection "master"
[0m10:58:47.653544 [debug] [MainThread]: On master: COMMIT
[0m10:58:47.905187 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:58:47.907591 [debug] [MainThread]: On master: Close
[0m10:58:48.128923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:48.130600 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:58:48.131508 [info ] [MainThread]: 
[0m10:58:48.132029 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.92 seconds (21.92s).
[0m10:58:48.132780 [debug] [MainThread]: Command end result
[0m10:58:48.150479 [info ] [MainThread]: 
[0m10:58:48.151119 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:58:48.151436 [info ] [MainThread]: 
[0m10:58:48.151735 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m10:58:48.152010 [error] [MainThread]:   ORA-06550: line 82, column 47:
[0m10:58:48.152272 [error] [MainThread]:   PLS-00103: Encountered the symbol "PREDICTIONS" when expecting one of the following:
[0m10:58:48.152516 [error] [MainThread]:   
[0m10:58:48.152644 [error] [MainThread]:      ) , * & = - + < / > at in is mod remainder not rem =>
[0m10:58:48.152770 [error] [MainThread]:      <an exponent (**)> <> or != or ~= >= <= <> and or like like2
[0m10:58:48.152896 [error] [MainThread]:      like4 likec between || multiset member submultiset
[0m10:58:48.153028 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m10:58:48.153157 [info ] [MainThread]: 
[0m10:58:48.153314 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:58:48.153691 [debug] [MainThread]: Command `dbt run` failed at 10:58:48.153632 after 22.13 seconds
[0m10:58:48.154004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105136c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105134e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120c5f10>]}
[0m10:58:48.154285 [debug] [MainThread]: Flushing usage events
[0m10:58:56.998102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106407cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106407f90>]}


============================== 10:58:57.004863 | 49ccd3d8-2e39-4551-9a4b-2b48a259a126 ==============================
[0m10:58:57.004863 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:58:57.005680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:58:57.065941 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m10:58:57.089021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49ccd3d8-2e39-4551-9a4b-2b48a259a126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644c390>]}
[0m10:58:57.095349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49ccd3d8-2e39-4551-9a4b-2b48a259a126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b193d0>]}
[0m10:58:57.131462 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:58:57.166867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:58:57.167324 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m10:58:57.188092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49ccd3d8-2e39-4551-9a4b-2b48a259a126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b31790>]}
[0m10:58:57.210031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49ccd3d8-2e39-4551-9a4b-2b48a259a126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3e790>]}
[0m10:58:57.210408 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m10:58:57.210591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ccd3d8-2e39-4551-9a4b-2b48a259a126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3d2d0>]}
[0m10:58:57.211362 [info ] [MainThread]: 
[0m10:58:57.211762 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m10:58:57.212304 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m10:58:57.217346 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m10:58:57.217573 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m10:58:57.217757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:57.217933 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:59:00.604508 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:59:00.846316 [debug] [ThreadPool]: On list_None: Close
[0m10:59:01.099637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m10:59:01.108168 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:59:01.108831 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m10:59:01.109175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:59:01.109529 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:59:04.315224 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m10:59:04.330172 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m10:59:04.331026 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m10:59:04.607117 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:59:04.978628 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m10:59:05.242614 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m10:59:05.525037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ccd3d8-2e39-4551-9a4b-2b48a259a126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064764d0>]}
[0m10:59:05.526266 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:05.526752 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:59:08.589264 [debug] [MainThread]: On master: COMMIT
[0m10:59:08.591472 [debug] [MainThread]: Using oracle connection "master"
[0m10:59:08.592741 [debug] [MainThread]: On master: COMMIT
[0m10:59:08.894966 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:59:08.897448 [debug] [MainThread]: On master: Close
[0m10:59:09.107748 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:59:09.108785 [info ] [MainThread]: 
[0m10:59:09.115060 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m10:59:09.115879 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m10:59:09.116761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m10:59:09.117216 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m10:59:09.136113 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m10:59:09.137420 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 10:59:09.117553 => 10:59:09.137200
[0m10:59:09.137815 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m10:59:09.148833 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m10:59:09.149227 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m10:59:09.159649 [info ] [Thread-1 (]: Python model materialization is table
[0m10:59:09.160117 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m10:59:11.871427 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:59:11.873676 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjAzNTAsImlhdCI6MTY4NzQ1Njc1MH0.iDguJ9yDMEkHnYv8g8pjVuop67KJaO_3vr6Erp-GwVGy2TZiZCwnOIaNVugqzk6WlgudDd3ScXKdh5zEe0Z_tOt_k23N9_p8040aCUjks3NtscJ8LsZeaZOFcMx6VJZiQ93Wsdzwcf6wazZ-KSxHM96ZDVPB0P3JrMZC3IXaGNtgpkF-bsDgDxXz8Z2PvlVOLob19Zx5AtLulcWAIYXDTLdwuyt7aIZi-9qN6eKg03maaaiRn6mRqCkes9wiX7XXLNKURJEIwKokyTyl4PCrN_ZAerF6GhbCDG7SdsL8MVgradU2UnFZ286jEPHCsabfQvv4TlH6zuXdGoO0w7yrHA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
    
        return pd.DataFrame(y_pred, columns=["predictions"])





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175911 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_175911';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m10:59:11.875610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:11.876320 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:59:39.196294 [debug] [Thread-1 (]: SQL status: OK in 27.0 seconds
[0m10:59:39.200505 [info ] [Thread-1 (]: oracle adapter: OK
[0m10:59:39.216558 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:59:39.217379 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m10:59:39.466390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:59:39.486497 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:59:39.487295 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:59:39.487683 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m10:59:39.744678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:59:39.755326 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m10:59:39.756152 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m10:59:40.004754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:59:40.025513 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 10:59:09.138029 => 10:59:40.025297
[0m10:59:40.026074 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m10:59:40.331856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ccd3d8-2e39-4551-9a4b-2b48a259a126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcd050>]}
[0m10:59:40.332560 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 31.22s]
[0m10:59:40.332999 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m10:59:40.334490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:40.334886 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m10:59:43.555303 [debug] [MainThread]: On master: COMMIT
[0m10:59:43.557703 [debug] [MainThread]: Using oracle connection "master"
[0m10:59:43.558759 [debug] [MainThread]: On master: COMMIT
[0m10:59:43.814047 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:59:43.819927 [debug] [MainThread]: On master: Close
[0m10:59:44.069678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:44.070253 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m10:59:44.070653 [info ] [MainThread]: 
[0m10:59:44.070838 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 46.86 seconds (46.86s).
[0m10:59:44.071150 [debug] [MainThread]: Command end result
[0m10:59:44.076023 [info ] [MainThread]: 
[0m10:59:44.076325 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:59:44.076489 [info ] [MainThread]: 
[0m10:59:44.076656 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:59:44.076979 [debug] [MainThread]: Command `dbt run` succeeded at 10:59:44.076927 after 47.17 seconds
[0m10:59:44.077202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bda910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bda510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d3ec50>]}
[0m10:59:44.077427 [debug] [MainThread]: Flushing usage events
[0m11:01:49.851897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105417c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105417f90>]}


============================== 11:01:49.854283 | a4cf8f77-a677-4c6b-85e1-02fecd3b946d ==============================
[0m11:01:49.854283 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:01:49.854612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:01:49.902318 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:01:49.925073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4cf8f77-a677-4c6b-85e1-02fecd3b946d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036ece50>]}
[0m11:01:49.931240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4cf8f77-a677-4c6b-85e1-02fecd3b946d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ede290>]}
[0m11:01:49.964450 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:01:50.003703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:50.004280 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:01:50.025210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4cf8f77-a677-4c6b-85e1-02fecd3b946d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb20d0>]}
[0m11:01:50.035444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4cf8f77-a677-4c6b-85e1-02fecd3b946d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f36750>]}
[0m11:01:50.035814 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:01:50.035995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4cf8f77-a677-4c6b-85e1-02fecd3b946d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efe4d0>]}
[0m11:01:50.036754 [info ] [MainThread]: 
[0m11:01:50.037140 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:01:50.037672 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:01:50.042796 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:01:50.043080 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:01:50.043253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:50.043431 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:01:53.464731 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:01:53.763898 [debug] [ThreadPool]: On list_None: Close
[0m11:01:54.043336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:01:54.050298 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:01:54.050796 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:01:54.051125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:54.051461 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:01:57.285962 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:01:57.295863 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:01:57.296484 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:01:57.558401 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:01:57.903770 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:01:58.161164 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:01:58.415801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4cf8f77-a677-4c6b-85e1-02fecd3b946d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107222e10>]}
[0m11:01:58.416740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:58.417293 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:02:01.787371 [debug] [MainThread]: On master: COMMIT
[0m11:02:01.789375 [debug] [MainThread]: Using oracle connection "master"
[0m11:02:01.790305 [debug] [MainThread]: On master: COMMIT
[0m11:02:02.052553 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:02:02.054925 [debug] [MainThread]: On master: Close
[0m11:02:02.315501 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:02:02.316330 [info ] [MainThread]: 
[0m11:02:02.320250 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:02:02.320990 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:02:02.321609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:02:02.322059 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:02:02.337918 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:02:02.340053 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:02:02.322270 => 11:02:02.339879
[0m11:02:02.340351 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:02:02.350279 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:02:02.350636 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:02:02.360985 [info ] [Thread-1 (]: Python model materialization is table
[0m11:02:02.361407 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:02:05.130507 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:02:05.132639 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjA1MjQsImlhdCI6MTY4NzQ1NjkyNH0.QzJr6I--8WdocBzgfFsdELr-qCUaeV1fCNMgusgHwLfOEqLouKd_i1uRrhItjsL2TZfgRoYqaeQpyM9ZYoq4KjfyZZHh2Dh-WQi-BXW5Okb7pfpUMXHRPzYU1SOZrC1xoir1HJ0r7zDZ9pBk_3VPmTb78Wk-uBgepW5LFJoYXfyCDgFYVap-b1MieT-bjs8_J6BJDhXuf8agEyJxqd30koi_JxcnoVs-Jz9Nt26c_h4Au8xMeTNuFcQtvClIMnI2Cfpjxin9waGhAgOc5-90sQmLeS8vj_64WtMdYWj3KI3wOvlDrQ7cGXe1UYHqXXLjIf_J7UFjDJwEugBQP0FmAQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
    
        return pd.DataFrame(X_test, y_pred_decoded, columns=["Test_Product_Price", "Shipping_City_Prediction"])





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_180205 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_180205';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:02:05.134252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:05.134851 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:02:08.683517 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m11:02:08.686002 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:02:08.957816 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:02:02.340497 => 11:02:08.957459
[0m11:02:08.966811 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:02:08.968705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4cf8f77-a677-4c6b-85e1-02fecd3b946d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072555d0>]}
[0m11:02:08.969269 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 6.65s]
[0m11:02:08.969680 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:02:08.971046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:08.971438 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:02:11.634236 [debug] [MainThread]: On master: COMMIT
[0m11:02:11.636644 [debug] [MainThread]: Using oracle connection "master"
[0m11:02:11.637910 [debug] [MainThread]: On master: COMMIT
[0m11:02:11.823492 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:02:11.825744 [debug] [MainThread]: On master: Close
[0m11:02:12.054930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:12.055901 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:02:12.056389 [info ] [MainThread]: 
[0m11:02:12.056841 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.02 seconds (22.02s).
[0m11:02:12.057458 [debug] [MainThread]: Command end result
[0m11:02:12.071131 [info ] [MainThread]: 
[0m11:02:12.071599 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:02:12.071870 [info ] [MainThread]: 
[0m11:02:12.072126 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m11:02:12.072374 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m11:02:12.072614 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:02:12.072845 [info ] [MainThread]: 
[0m11:02:12.073116 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:02:12.073926 [debug] [MainThread]: Command `dbt run` failed at 11:02:12.073759 after 22.24 seconds
[0m11:02:12.074433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105428210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb2d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c3ced0>]}
[0m11:02:12.074817 [debug] [MainThread]: Flushing usage events
[0m11:02:16.550065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d13bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1ff90>]}


============================== 11:02:16.552412 | 6f02e65c-43de-497f-abff-82dc054490c3 ==============================
[0m11:02:16.552412 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:02:16.552726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:02:16.597742 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:02:16.619247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f02e65c-43de-497f-abff-82dc054490c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e4e50>]}
[0m11:02:16.625827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f02e65c-43de-497f-abff-82dc054490c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064312d0>]}
[0m11:02:16.659882 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:02:16.694357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:16.694649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:16.698155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f02e65c-43de-497f-abff-82dc054490c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cffd10>]}
[0m11:02:16.703705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f02e65c-43de-497f-abff-82dc054490c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644ff50>]}
[0m11:02:16.703960 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:02:16.704137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f02e65c-43de-497f-abff-82dc054490c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106431790>]}
[0m11:02:16.704832 [info ] [MainThread]: 
[0m11:02:16.705197 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:02:16.705823 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:02:16.711026 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:02:16.711269 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:02:16.711442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:16.711616 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:02:20.075307 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:02:20.387747 [debug] [ThreadPool]: On list_None: Close
[0m11:02:20.660120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:02:20.668399 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:02:20.669061 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:02:20.669507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:20.669874 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:02:23.610040 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:02:23.622133 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:02:23.622878 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:02:23.833318 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:24.148832 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:02:24.380377 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:02:24.592261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f02e65c-43de-497f-abff-82dc054490c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cf2d0>]}
[0m11:02:24.593388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:24.593858 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:02:27.360231 [debug] [MainThread]: On master: COMMIT
[0m11:02:27.361904 [debug] [MainThread]: Using oracle connection "master"
[0m11:02:27.362406 [debug] [MainThread]: On master: COMMIT
[0m11:02:27.585116 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:02:27.587403 [debug] [MainThread]: On master: Close
[0m11:02:27.863191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:02:27.864335 [info ] [MainThread]: 
[0m11:02:27.871581 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:02:27.872367 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:02:27.873284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:02:27.873745 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:02:27.898517 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:02:27.899654 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:02:27.874074 => 11:02:27.899547
[0m11:02:27.899967 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:02:27.908708 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:02:27.909023 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:02:27.918544 [info ] [Thread-1 (]: Python model materialization is table
[0m11:02:27.918993 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:02:31.696094 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:02:31.697241 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjA1NDksImlhdCI6MTY4NzQ1Njk0OX0.JG-ZAAG4L2YprOO3SRea5HSX5so59VPnOEjaLyndKCATAi6nedheD0QTwoYrpz9J7bwhN3-9bGKWmkfFPhoc-0x7JEW8mkW4n6pwtIIokm7b-LlMofSmXKHI01EzsUKA5r9Kw1Bj7HcNGSTaWvefPWXlRF3HW32f-5uEmAR2fjUrvqZPfR0Pb0j3TTbVdIx1EDPrgiZj2PtF5ZuCd-aJQ57sRT1REyLv_jMcOjbpOkSJUr9zJkrfyAd32gLRCPw8kGGFZ1Ae5W8dM1eLQn-h2O1q--Cl0N250epQtDzhQZ8RPABe73pVMnnQSwHeDFjhJbeRcBpvrpO11Hss5LH4Ag!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
    
        return pd.DataFrame(X_test, y_pred_decoded, columns=["Test_Product_Price", "Shipping_City_Prediction"])





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_180231 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_180231';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:02:31.698329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:31.698759 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:02:35.028879 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m11:02:35.031374 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:02:35.334463 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:02:27.900316 => 11:02:35.333263
[0m11:02:35.350756 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:02:35.353517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f02e65c-43de-497f-abff-82dc054490c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647f410>]}
[0m11:02:35.354367 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 7.48s]
[0m11:02:35.354766 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:02:35.356053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:35.356404 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:02:38.304607 [debug] [MainThread]: On master: COMMIT
[0m11:02:38.306991 [debug] [MainThread]: Using oracle connection "master"
[0m11:02:38.307659 [debug] [MainThread]: On master: COMMIT
[0m11:02:38.712096 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:02:38.714534 [debug] [MainThread]: On master: Close
[0m11:02:38.954837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:38.955189 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:02:38.955423 [info ] [MainThread]: 
[0m11:02:38.955622 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.25 seconds (22.25s).
[0m11:02:38.955932 [debug] [MainThread]: Command end result
[0m11:02:38.960892 [info ] [MainThread]: 
[0m11:02:38.961193 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:02:38.961379 [info ] [MainThread]: 
[0m11:02:38.961553 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m11:02:38.961731 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m11:02:38.961899 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:02:38.962062 [info ] [MainThread]: 
[0m11:02:38.962249 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:02:38.962592 [debug] [MainThread]: Command `dbt run` failed at 11:02:38.962538 after 22.43 seconds
[0m11:02:38.962851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102656c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102654e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d00690>]}
[0m11:02:38.963087 [debug] [MainThread]: Flushing usage events
[0m11:02:42.292505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108853cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885fc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885ff90>]}


============================== 11:02:42.299586 | cc0d5653-8d20-412d-98e9-e995f8d8c4ac ==============================
[0m11:02:42.299586 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:02:42.299906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:02:42.343616 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:02:42.365447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc0d5653-8d20-412d-98e9-e995f8d8c4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107124e50>]}
[0m11:02:42.371717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc0d5653-8d20-412d-98e9-e995f8d8c4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f71550>]}
[0m11:02:42.404926 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:02:42.450208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:42.450516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:42.454116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc0d5653-8d20-412d-98e9-e995f8d8c4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d1ed0>]}
[0m11:02:42.459226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc0d5653-8d20-412d-98e9-e995f8d8c4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108892f90>]}
[0m11:02:42.459542 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:02:42.459715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc0d5653-8d20-412d-98e9-e995f8d8c4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f71e50>]}
[0m11:02:42.460453 [info ] [MainThread]: 
[0m11:02:42.460851 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:02:42.461388 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:02:42.466678 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:02:42.466986 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:02:42.467166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:42.467344 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:02:45.274034 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:02:45.488681 [debug] [ThreadPool]: On list_None: Close
[0m11:02:45.781442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:02:45.797267 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:02:45.798407 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:02:45.800133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:45.801264 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:02:49.008506 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:02:49.012088 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:02:49.012372 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:02:49.360396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:49.775835 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:02:50.077807 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:02:50.393560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc0d5653-8d20-412d-98e9-e995f8d8c4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089126d0>]}
[0m11:02:50.394676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:50.395229 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:02:53.150820 [debug] [MainThread]: On master: COMMIT
[0m11:02:53.153077 [debug] [MainThread]: Using oracle connection "master"
[0m11:02:53.154116 [debug] [MainThread]: On master: COMMIT
[0m11:02:53.359720 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:02:53.361973 [debug] [MainThread]: On master: Close
[0m11:02:53.581056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:02:53.582293 [info ] [MainThread]: 
[0m11:02:53.588488 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:02:53.589215 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:02:53.589985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:02:53.590386 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:02:53.611815 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:02:53.612965 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:02:53.590669 => 11:02:53.612794
[0m11:02:53.613294 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:02:53.621594 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:02:53.621956 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:02:53.631792 [info ] [Thread-1 (]: Python model materialization is table
[0m11:02:53.632137 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:02:57.720054 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:02:57.721935 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjA1NzYsImlhdCI6MTY4NzQ1Njk3Nn0.p9oz__c8jPU60_YFCdRdMZtVz1bHHOhqqhwkQ55GL6MBhLlW6GcUPKoaAOFM6hnnlZuJ7L1jxq7Mw2xCYnbWwswmKlUrkgT4Z6j7qrM3gOcBZOl2FIeNUlYIvH8ygLz0-evzXtJJsOEPViXHU_rTjG0b0CkkcF1wLTxnvZ7YDknjZ2DIeD2ojU9WGb7lqNGLPOCsL1H4zKPYJNDZPu7uSvCPT3-DD6qbbts7aIneT9sMZjzEmtBgvmtxA5PVPuR0PCBDVznjthcR9rdGn8aEQNLSgz8ANFHu9nU-koa00PqiazgXAeFsuIvvCZb_Yn4e-9FhZEygbaI0n9k2cvsBdA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
    
        return pd.DataFrame(X_test, y_pred_decoded, columns=["Test_Product_Price", "Shipping_City_Prediction"])





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_180257 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_180257';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:02:57.723073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:57.723502 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:03:24.505904 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"DPI-1043: invalid number : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 97, in main\n   File \"<string>\", line 86, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 814, in oml.core.methods.__create\n   File \"oml/core/methods.py\", line 796, in oml.core.methods.__create\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 103
[0m11:03:24.508682 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:03:24.704736 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:02:53.613456 => 11:03:24.703423
[0m11:03:24.732596 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"DPI-1043: invalid number : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 97, in main\n   File \"<string>\", line 86, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 814, in oml.core.methods.__create\n   File \"oml/core/methods.py\", line 796, in oml.core.methods.__create\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 103
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:03:24.735972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc0d5653-8d20-412d-98e9-e995f8d8c4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f822d0>]}
[0m11:03:24.736964 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 31.15s]
[0m11:03:24.737597 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:03:24.739688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:03:24.740227 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:03:27.335530 [debug] [MainThread]: On master: COMMIT
[0m11:03:27.337709 [debug] [MainThread]: Using oracle connection "master"
[0m11:03:27.338621 [debug] [MainThread]: On master: COMMIT
[0m11:03:27.518289 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:03:27.520575 [debug] [MainThread]: On master: Close
[0m11:03:27.732105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:27.733248 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:03:27.733766 [info ] [MainThread]: 
[0m11:03:27.734179 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 45.27 seconds (45.27s).
[0m11:03:27.734883 [debug] [MainThread]: Command end result
[0m11:03:27.749782 [info ] [MainThread]: 
[0m11:03:27.750298 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:03:27.750559 [info ] [MainThread]: 
[0m11:03:27.750799 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m11:03:27.751052 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"DPI-1043: invalid number : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 97, in main\n   File \"<string>\", line 86, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 814, in oml.core.methods.__create\n   File \"oml/core/methods.py\", line 796, in oml.core.methods.__create\n"}
[0m11:03:27.751298 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m11:03:27.751497 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m11:03:27.751686 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m11:03:27.751875 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m11:03:27.752062 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m11:03:27.752251 [error] [MainThread]:   ORA-06512: at line 103
[0m11:03:27.752444 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:03:27.752640 [info ] [MainThread]: 
[0m11:03:27.752865 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:03:27.753279 [debug] [MainThread]: Command `dbt run` failed at 11:03:27.753214 after 45.48 seconds
[0m11:03:27.753597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105194e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e21850>]}
[0m11:03:27.753888 [debug] [MainThread]: Flushing usage events
[0m11:05:22.014436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f47d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f53c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f53f90>]}


============================== 11:05:22.017297 | b2d31966-9333-4c98-bdb4-3ad078aab1bc ==============================
[0m11:05:22.017297 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:05:22.017630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:05:22.061661 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:05:22.083739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2d31966-9333-4c98-bdb4-3ad078aab1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104818e50>]}
[0m11:05:22.090009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2d31966-9333-4c98-bdb4-3ad078aab1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106665450>]}
[0m11:05:22.123098 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:05:22.158398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:05:22.158747 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:05:22.162424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2d31966-9333-4c98-bdb4-3ad078aab1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5dd90>]}
[0m11:05:22.167558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2d31966-9333-4c98-bdb4-3ad078aab1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f453d0>]}
[0m11:05:22.167952 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:05:22.168141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2d31966-9333-4c98-bdb4-3ad078aab1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106666110>]}
[0m11:05:22.168944 [info ] [MainThread]: 
[0m11:05:22.169339 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:05:22.169849 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:05:22.174681 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:05:22.174935 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:05:22.175109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:22.175515 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:05:25.642720 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:05:25.921838 [debug] [ThreadPool]: On list_None: Close
[0m11:05:26.166550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:05:26.183253 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:05:26.183894 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:05:26.184142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:05:26.184393 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:05:29.502578 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:05:29.523844 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:05:29.525110 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:05:29.912519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:05:30.277230 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:05:30.629047 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:05:30.879673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2d31966-9333-4c98-bdb4-3ad078aab1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665c190>]}
[0m11:05:30.881595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:05:30.885169 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:05:33.645879 [debug] [MainThread]: On master: COMMIT
[0m11:05:33.647105 [debug] [MainThread]: Using oracle connection "master"
[0m11:05:33.647778 [debug] [MainThread]: On master: COMMIT
[0m11:05:33.878361 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:05:33.879974 [debug] [MainThread]: On master: Close
[0m11:05:34.135270 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:05:34.136236 [info ] [MainThread]: 
[0m11:05:34.139217 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:05:34.139631 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:05:34.140071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:05:34.140295 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:05:34.163477 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:05:34.164766 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:05:34.140449 => 11:05:34.164587
[0m11:05:34.165131 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:05:34.176358 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:05:34.176806 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:05:34.187610 [info ] [Thread-1 (]: Python model materialization is table
[0m11:05:34.187992 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:05:37.145947 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:05:37.147427 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjA3MzYsImlhdCI6MTY4NzQ1NzEzNn0.b0v_ETfVgw3wKPPqyXMv9aLvb6LSm-OGEwULaeKWULZPZr70HXQADtuSTgjwi3bMd5kGxE-9twenNNeCK2GKEVzGVszcH5BsUF4MbXbcIkUkvpP2GTeSKrs1Wddj573QmMqZCXpEO2gG5ZzCu95HXjKYL2sDKp-5u6PO4XK9L775xsf9gpgfXZMg-Ltjh5pOMW3Z3HSmvESD_ZYdkIbhkEhd-MXWu1eVMbvqMmh0VjUgA6iU4gtNZ2MqApjnmBi6h6wWQHHgzDSjmyxN8_hJxg6_LARMhJytzV93DJa4aIllu8OCZO54ZL0QAbb4yodes3G-3GkO0rGrTl1PEg2Nzw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
    
        return pd.DataFrame(X_test, y_pred_decoded, columns=["Test_Product_Price", "Shipping_City_Prediction"])





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_180537 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_180537';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:05:37.149097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:37.149769 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:06:05.037404 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"DPI-1043: invalid number : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 97, in main\n   File \"<string>\", line 86, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 814, in oml.core.methods.__create\n   File \"oml/core/methods.py\", line 796, in oml.core.methods.__create\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 103
[0m11:06:05.040201 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:06:05.282401 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:05:34.165353 => 11:06:05.281077
[0m11:06:05.309107 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"DPI-1043: invalid number : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 97, in main\n   File \"<string>\", line 86, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 814, in oml.core.methods.__create\n   File \"oml/core/methods.py\", line 796, in oml.core.methods.__create\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 103
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:06:05.312761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d31966-9333-4c98-bdb4-3ad078aab1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e8b90>]}
[0m11:06:05.313986 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 31.17s]
[0m11:06:05.314709 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:06:05.317245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:06:05.317873 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:06:08.684096 [debug] [MainThread]: On master: COMMIT
[0m11:06:08.686254 [debug] [MainThread]: Using oracle connection "master"
[0m11:06:08.687374 [debug] [MainThread]: On master: COMMIT
[0m11:06:09.028689 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:06:09.031122 [debug] [MainThread]: On master: Close
[0m11:06:09.265303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:09.267353 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:06:09.268293 [info ] [MainThread]: 
[0m11:06:09.269270 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 47.10 seconds (47.10s).
[0m11:06:09.270850 [debug] [MainThread]: Command end result
[0m11:06:09.291016 [info ] [MainThread]: 
[0m11:06:09.291488 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:06:09.291654 [info ] [MainThread]: 
[0m11:06:09.291815 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m11:06:09.291993 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"DPI-1043: invalid number : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 97, in main\n   File \"<string>\", line 86, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 814, in oml.core.methods.__create\n   File \"oml/core/methods.py\", line 796, in oml.core.methods.__create\n"}
[0m11:06:09.292166 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m11:06:09.292302 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m11:06:09.292439 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m11:06:09.292571 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m11:06:09.292702 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m11:06:09.292830 [error] [MainThread]:   ORA-06512: at line 103
[0m11:06:09.292954 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:06:09.293090 [info ] [MainThread]: 
[0m11:06:09.293265 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:06:09.293722 [debug] [MainThread]: Command `dbt run` failed at 11:06:09.293653 after 47.30 seconds
[0m11:06:09.294038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102888e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102888ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106006dd0>]}
[0m11:06:09.294308 [debug] [MainThread]: Flushing usage events
[0m11:07:40.980509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a53d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5ff90>]}


============================== 11:07:40.983358 | 3d206527-8540-46ab-91e0-d6723acb4034 ==============================
[0m11:07:40.983358 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:07:40.983668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:07:41.029151 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:07:41.051183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d206527-8540-46ab-91e0-d6723acb4034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106324e50>]}
[0m11:07:41.057561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d206527-8540-46ab-91e0-d6723acb4034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108171990>]}
[0m11:07:41.089837 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:07:41.124452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:07:41.124918 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:07:41.145721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d206527-8540-46ab-91e0-d6723acb4034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b7e10>]}
[0m11:07:41.151744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d206527-8540-46ab-91e0-d6723acb4034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d5350>]}
[0m11:07:41.152080 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:07:41.152258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d206527-8540-46ab-91e0-d6723acb4034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a5550>]}
[0m11:07:41.152986 [info ] [MainThread]: 
[0m11:07:41.153367 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:07:41.153923 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:07:41.158964 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:07:41.159299 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:07:41.159465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:41.159631 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:07:44.578188 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:07:44.809811 [debug] [ThreadPool]: On list_None: Close
[0m11:07:45.038200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:07:45.045748 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:07:45.046287 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:07:45.046644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:45.046992 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:07:48.225820 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:07:48.239552 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:07:48.240327 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:07:48.529798 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:07:48.874010 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:07:49.127397 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:07:49.374740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d206527-8540-46ab-91e0-d6723acb4034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075008d0>]}
[0m11:07:49.375732 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:49.376188 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:07:52.157885 [debug] [MainThread]: On master: COMMIT
[0m11:07:52.160404 [debug] [MainThread]: Using oracle connection "master"
[0m11:07:52.161715 [debug] [MainThread]: On master: COMMIT
[0m11:07:52.391591 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:07:52.394144 [debug] [MainThread]: On master: Close
[0m11:07:52.635118 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:07:52.636785 [info ] [MainThread]: 
[0m11:07:52.644456 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:07:52.645334 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:07:52.646259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:07:52.646733 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:07:52.664751 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:07:52.665971 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:07:52.647058 => 11:07:52.665810
[0m11:07:52.666327 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:07:52.677173 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:07:52.677600 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:07:52.687917 [info ] [Thread-1 (]: Python model materialization is table
[0m11:07:52.688321 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:07:56.218720 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:07:56.220910 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjA4NzUsImlhdCI6MTY4NzQ1NzI3NX0.GsWGxq0sEIhyTuWxSHKvXAdaxq-2GPOZ5sc-kqGeLtji-L7awRjYF9lpOtt4AqLcTjrhzVqGyv4wIWEedaAMTbb6muwHhEcBMmRS-RUB_dVNZFB66-TygUUGaQUDh2OckIECeLPhNtN01AThOzC5MF-KM0h2RrZKs-stT62YYZjbW6za2L16u4t0xNT_Dqd2LF-8q1j_WMl27gAs4XG2pcqrbXe-_Z_woq6nM_lrt1CYdaFkO7eGWmrfnQC9kxliAAcLr8MpkrZ40Qnt_oL6jOUBP7N34pv_wcrY6hjFF-yHYW7lKh1-pIDOARjf92xJF0H7s2Kr4NUG6WHRBqL4Vg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
    
        return pd.DataFrame(y_pred_decoded, X_test, columns=[ "Shipping_City_Prediction", "Test_Product_Price"])





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_180756 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_180756';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:07:56.222545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:56.223122 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:08:24.012760 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"Index data must be 1-dimensional : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 91, in main\n   File \"<string>\", line 78, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/frame.py\", line 672, in __init__\n    mgr = ndarray_to_mgr(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 320, in ndarray_to_mgr\n    index, columns = _get_axes(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 697, in _get_axes\n    index = ensure_index(index)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/base.py\", line 6336, in ensure_index\n    return Index(index_like, copy=copy)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/base.py\", line 476, in __new__\n    return Index(np.asarray(data), dtype=dtype, copy=copy, name=name, **kwargs)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/base.py\", line 469, in __new__\n    arr = klass._ensure_array(arr, dtype, copy)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/numeric.py\", line 171, in _ensure_array\n    raise ValueError(\"Index data must be 1-dimensional\")\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 103
[0m11:08:24.017802 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:08:24.286768 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:07:52.666547 => 11:08:24.285473
[0m11:08:24.314503 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"Index data must be 1-dimensional : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 91, in main\n   File \"<string>\", line 78, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/frame.py\", line 672, in __init__\n    mgr = ndarray_to_mgr(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 320, in ndarray_to_mgr\n    index, columns = _get_axes(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 697, in _get_axes\n    index = ensure_index(index)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/base.py\", line 6336, in ensure_index\n    return Index(index_like, copy=copy)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/base.py\", line 476, in __new__\n    return Index(np.asarray(data), dtype=dtype, copy=copy, name=name, **kwargs)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/base.py\", line 469, in __new__\n    arr = klass._ensure_array(arr, dtype, copy)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/numeric.py\", line 171, in _ensure_array\n    raise ValueError(\"Index data must be 1-dimensional\")\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 103
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:08:24.318293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d206527-8540-46ab-91e0-d6723acb4034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108266d10>]}
[0m11:08:24.319469 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 31.67s]
[0m11:08:24.320352 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:08:24.323231 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:08:24.324042 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:08:27.487968 [debug] [MainThread]: On master: COMMIT
[0m11:08:27.490269 [debug] [MainThread]: Using oracle connection "master"
[0m11:08:27.491546 [debug] [MainThread]: On master: COMMIT
[0m11:08:27.699919 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:27.702368 [debug] [MainThread]: On master: Close
[0m11:08:27.916781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:27.918522 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:08:27.919408 [info ] [MainThread]: 
[0m11:08:27.920785 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 46.77 seconds (46.77s).
[0m11:08:27.922337 [debug] [MainThread]: Command end result
[0m11:08:27.944718 [info ] [MainThread]: 
[0m11:08:27.945374 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:08:27.945626 [info ] [MainThread]: 
[0m11:08:27.945812 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m11:08:27.946199 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"Index data must be 1-dimensional : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 91, in main\n   File \"<string>\", line 78, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/frame.py\", line 672, in __init__\n    mgr = ndarray_to_mgr(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 320, in ndarray_to_mgr\n    index, columns = _get_axes(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 697, in _get_axes\n    index = ensure_index(index)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/base.py\", line 6336, in ensure_index\n    return Index(index_like, copy=copy)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/base.py\", line 476, in __new__\n    return Index(np.asarray(data), dtype=dtype, copy=copy, name=name, **kwargs)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/base.py\", line 469, in __new__\n    arr = klass._ensure_array(arr, dtype, copy)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/indexes/numeric.py\", line 171, in _ensure_array\n    raise ValueError(\"Index data must be 1-dimensional\")\n"}
[0m11:08:27.946891 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m11:08:27.947327 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m11:08:27.947656 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m11:08:27.947972 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m11:08:27.948266 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m11:08:27.948567 [error] [MainThread]:   ORA-06512: at line 103
[0m11:08:27.948856 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:08:27.949185 [info ] [MainThread]: 
[0m11:08:27.949546 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:08:27.950326 [debug] [MainThread]: Command `dbt run` failed at 11:08:27.950202 after 46.99 seconds
[0m11:08:27.950896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104396c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104394e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a70390>]}
[0m11:08:27.951397 [debug] [MainThread]: Flushing usage events
[0m11:09:47.951560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f3f90>]}


============================== 11:09:47.954570 | 759afef6-1c40-4b32-9b17-c8cca25a640f ==============================
[0m11:09:47.954570 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:09:47.954894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:09:48.001490 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:09:48.024394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '759afef6-1c40-4b32-9b17-c8cca25a640f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106938390>]}
[0m11:09:48.030627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '759afef6-1c40-4b32-9b17-c8cca25a640f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107016590>]}
[0m11:09:48.063237 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:09:48.123155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:09:48.123620 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:09:48.144810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '759afef6-1c40-4b32-9b17-c8cca25a640f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691f350>]}
[0m11:09:48.151074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '759afef6-1c40-4b32-9b17-c8cca25a640f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107128250>]}
[0m11:09:48.151353 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:09:48.151525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '759afef6-1c40-4b32-9b17-c8cca25a640f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a66d0>]}
[0m11:09:48.152355 [info ] [MainThread]: 
[0m11:09:48.152804 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:09:48.153442 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:09:48.158623 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:09:48.158876 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:09:48.159046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:48.159219 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:09:51.453202 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:09:51.692701 [debug] [ThreadPool]: On list_None: Close
[0m11:09:51.912314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:09:51.918702 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:09:51.919194 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:09:51.919535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:51.919878 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:09:54.845442 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:09:54.858002 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:09:54.858929 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:09:55.126629 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:09:55.637671 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:09:55.892092 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:09:56.170189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '759afef6-1c40-4b32-9b17-c8cca25a640f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726bbd0>]}
[0m11:09:56.171032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:09:56.171356 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:09:58.836615 [debug] [MainThread]: On master: COMMIT
[0m11:09:58.838265 [debug] [MainThread]: Using oracle connection "master"
[0m11:09:58.839262 [debug] [MainThread]: On master: COMMIT
[0m11:09:59.078248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:09:59.079683 [debug] [MainThread]: On master: Close
[0m11:09:59.310377 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:09:59.311136 [info ] [MainThread]: 
[0m11:09:59.316832 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:09:59.317500 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:09:59.318196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:09:59.318515 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:09:59.335074 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:09:59.336214 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:09:59.318736 => 11:09:59.336088
[0m11:09:59.336498 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:09:59.346213 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:09:59.346585 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:09:59.356013 [info ] [Thread-1 (]: Python model materialization is table
[0m11:09:59.356473 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:10:01.922430 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:10:01.924618 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjEwMDEsImlhdCI6MTY4NzQ1NzQwMX0.GnmMVKpT1mtqyMSAVa-i0sPd0SQ693Avp1CP2z8G-uyuWaYsZ637cFKVr76A-v7R101zR-qyFBagtEkqEmSwm1bZTXFPzA_ibxwdSihAjGR2T3rPvx5vFDb3TRgE1zt4SBB-eA1gInQaKhGINHgSh04qkOXL6QbEnDOelsghKhRoxoAGgLxmABQnpb1H9Z7XlA2ey-kXXE4Ciy1T35Eul0kSFsU3YTHV3WBFhw-ufqa0En6a-VuJgFEv3RlSkktBbcJKMsUgtXAIu72q20VLYH0CAkVGQ7TDKEgysmhXoSfxGqNfJRw-WVcmWem0R9r7pmlPBeQeD8iXDLUY5bYdSA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Test_Product_Price": X_test})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181001 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181001';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:10:01.926673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:01.927380 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:10:29.012915 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"Data must be 1-dimensional : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 77, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/frame.py\", line 614, in __init__\n    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 464, in dict_to_mgr\n    return arrays_to_mgr(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 124, in arrays_to_mgr\n    arrays = _homogenize(arrays, index, dtype)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 589, in _homogenize\n    val = sanitize_array(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/construction.py\", line 576, in sanitize_array\n    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/construction.py\", line 627, in _sanitize_ndim\n    raise ValueError(\"Data must be 1-dimensional\")\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 104
[0m11:10:29.015436 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:10:29.194718 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:09:59.336674 => 11:10:29.193272
[0m11:10:29.213505 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"Data must be 1-dimensional : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 77, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/frame.py\", line 614, in __init__\n    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 464, in dict_to_mgr\n    return arrays_to_mgr(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 124, in arrays_to_mgr\n    arrays = _homogenize(arrays, index, dtype)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 589, in _homogenize\n    val = sanitize_array(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/construction.py\", line 576, in sanitize_array\n    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/construction.py\", line 627, in _sanitize_ndim\n    raise ValueError(\"Data must be 1-dimensional\")\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 104
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:10:29.216772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '759afef6-1c40-4b32-9b17-c8cca25a640f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10710d210>]}
[0m11:10:29.217539 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 29.90s]
[0m11:10:29.218145 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:10:29.220044 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:10:29.220719 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:10:31.772802 [debug] [MainThread]: On master: COMMIT
[0m11:10:31.774836 [debug] [MainThread]: Using oracle connection "master"
[0m11:10:31.775470 [debug] [MainThread]: On master: COMMIT
[0m11:10:32.065974 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:10:32.068318 [debug] [MainThread]: On master: Close
[0m11:10:32.285225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:32.286316 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:10:32.287074 [info ] [MainThread]: 
[0m11:10:32.287593 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 44.13 seconds (44.13s).
[0m11:10:32.288445 [debug] [MainThread]: Command end result
[0m11:10:32.301811 [info ] [MainThread]: 
[0m11:10:32.302287 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:10:32.302593 [info ] [MainThread]: 
[0m11:10:32.302882 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m11:10:32.303252 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"Data must be 1-dimensional : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 77, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/frame.py\", line 614, in __init__\n    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 464, in dict_to_mgr\n    return arrays_to_mgr(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 124, in arrays_to_mgr\n    arrays = _homogenize(arrays, index, dtype)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 589, in _homogenize\n    val = sanitize_array(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/construction.py\", line 576, in sanitize_array\n    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/construction.py\", line 627, in _sanitize_ndim\n    raise ValueError(\"Data must be 1-dimensional\")\n"}
[0m11:10:32.303749 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m11:10:32.304083 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m11:10:32.304363 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m11:10:32.304629 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m11:10:32.304880 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m11:10:32.305133 [error] [MainThread]:   ORA-06512: at line 104
[0m11:10:32.305385 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:10:32.305610 [info ] [MainThread]: 
[0m11:10:32.305864 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:10:32.306324 [debug] [MainThread]: Command `dbt run` failed at 11:10:32.306251 after 44.38 seconds
[0m11:10:32.306677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103228e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103228ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f3dd0>]}
[0m11:10:32.306999 [debug] [MainThread]: Flushing usage events
[0m11:11:02.591269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f7f90>]}


============================== 11:11:02.593639 | bbc3069c-c847-4a22-8797-8ab3494eb765 ==============================
[0m11:11:02.593639 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:11:02.593951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:11:02.642336 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:11:02.664419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbc3069c-c847-4a22-8797-8ab3494eb765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bce50>]}
[0m11:11:02.670433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbc3069c-c847-4a22-8797-8ab3494eb765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108924ad0>]}
[0m11:11:02.702494 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:11:02.733441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:11:02.733877 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:11:02.754290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbc3069c-c847-4a22-8797-8ab3494eb765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fecc10>]}
[0m11:11:02.764852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbc3069c-c847-4a22-8797-8ab3494eb765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10900a1d0>]}
[0m11:11:02.765215 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:11:02.765397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbc3069c-c847-4a22-8797-8ab3494eb765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109039e50>]}
[0m11:11:02.766154 [info ] [MainThread]: 
[0m11:11:02.766534 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:11:02.767067 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:11:02.771986 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:11:02.772201 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:11:02.772364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:02.772538 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:11:05.359021 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:11:05.532872 [debug] [ThreadPool]: On list_None: Close
[0m11:11:05.720369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:11:05.728524 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:11:05.729173 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:11:05.729521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:05.729883 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:11:08.083017 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:11:08.097109 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:11:08.097936 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:11:08.304880 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:11:08.748466 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:11:08.952561 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:11:09.158939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbc3069c-c847-4a22-8797-8ab3494eb765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925ae10>]}
[0m11:11:09.159984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:09.160523 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:11:10.968436 [debug] [MainThread]: On master: COMMIT
[0m11:11:10.970823 [debug] [MainThread]: Using oracle connection "master"
[0m11:11:10.971832 [debug] [MainThread]: On master: COMMIT
[0m11:11:11.112287 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:11:11.114761 [debug] [MainThread]: On master: Close
[0m11:11:11.264724 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:11:11.265730 [info ] [MainThread]: 
[0m11:11:11.272333 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:11:11.273044 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:11:11.273761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:11:11.274090 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:11:11.293800 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:11:11.295056 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:11:11.274323 => 11:11:11.294882
[0m11:11:11.295402 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:11:11.304380 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:11:11.304690 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:11:11.314694 [info ] [Thread-1 (]: Python model materialization is table
[0m11:11:11.315179 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:11:13.537586 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:11:13.539072 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjEwNzIsImlhdCI6MTY4NzQ1NzQ3Mn0.SjkRmDX8-ODO_Kujr22HveCfgkIwUOU8nh0dbiyw7ptxZbLEH_y2WFSCKYdcV7qLQGApCYDimh_2O28NFk8Ylu68LsnAE1EA5HwKDE92ZlrElGosJ9ASGEbnHXnhGuq1_fCFTtNPhWZEt7dVLGolt6fjdJeDmdKw8-1iG5JWI0RSV-jrwIuwu4NezY9nakm9y7fmYuXhBmF97C3m799dCoBebx6dGGkLriqcHRIZrIsTL72tiFJX1Anm-nMrsBHrJGN28useZ791w17FnosJndo21wBen_pwn2nUl6SVA871iyUu8Acold7W8rg_1uO-H-jduNaRaQyFG-qTq9wvlg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Test_Product_Price": y_test})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181113 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181113';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:11:13.540536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:13.541107 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:11:39.403505 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m11:11:39.408113 [info ] [Thread-1 (]: oracle adapter: OK
[0m11:11:39.423145 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:11:39.423692 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m11:11:39.682434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:11:39.689754 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:11:39.690456 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m11:11:39.946421 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:11:39.961996 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:11:39.962961 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:11:39.963424 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:11:40.212471 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:11:40.224596 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:11:40.225519 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m11:11:40.459192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:11:40.471074 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:11:11.295611 => 11:11:40.470924
[0m11:11:40.471510 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:11:40.685311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbc3069c-c847-4a22-8797-8ab3494eb765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092af690>]}
[0m11:11:40.687684 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 29.41s]
[0m11:11:40.688718 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:11:40.691261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:40.691990 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:11:43.460301 [debug] [MainThread]: On master: COMMIT
[0m11:11:43.462292 [debug] [MainThread]: Using oracle connection "master"
[0m11:11:43.463297 [debug] [MainThread]: On master: COMMIT
[0m11:11:43.684848 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:11:43.687261 [debug] [MainThread]: On master: Close
[0m11:11:43.912168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:43.913962 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:11:43.914938 [info ] [MainThread]: 
[0m11:11:43.915874 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 41.15 seconds (41.15s).
[0m11:11:43.916809 [debug] [MainThread]: Command end result
[0m11:11:43.927056 [info ] [MainThread]: 
[0m11:11:43.927780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:43.928109 [info ] [MainThread]: 
[0m11:11:43.928441 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:11:43.929118 [debug] [MainThread]: Command `dbt run` succeeded at 11:11:43.929013 after 41.36 seconds
[0m11:11:43.929594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ca510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10518aad0>]}
[0m11:11:43.930063 [debug] [MainThread]: Flushing usage events
[0m11:13:51.330509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a87e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a93e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a93fd0>]}


============================== 11:13:51.333115 | 0a25f595-0be5-4ef8-ac31-b93b62de46eb ==============================
[0m11:13:51.333115 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:13:51.333430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:13:51.385529 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:13:51.408016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a25f595-0be5-4ef8-ac31-b93b62de46eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa4950>]}
[0m11:13:51.414252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a25f595-0be5-4ef8-ac31-b93b62de46eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b6610>]}
[0m11:13:51.448479 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:13:51.483494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:51.483796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:51.487128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a25f595-0be5-4ef8-ac31-b93b62de46eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106289e90>]}
[0m11:13:51.491852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a25f595-0be5-4ef8-ac31-b93b62de46eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e4f10>]}
[0m11:13:51.492192 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:13:51.492368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a25f595-0be5-4ef8-ac31-b93b62de46eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10619ea90>]}
[0m11:13:51.493106 [info ] [MainThread]: 
[0m11:13:51.493488 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:13:51.494008 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:13:51.498953 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:13:51.499277 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:13:51.499578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:51.499767 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:13:52.984289 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m11:13:53.096159 [debug] [ThreadPool]: On list_None: Close
[0m11:13:53.205683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:13:53.214506 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:13:53.215203 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:13:53.215605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:53.216029 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:13:54.671840 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m11:13:54.684483 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:13:54.685312 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:13:54.827488 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:13:55.050847 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:13:55.189783 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:13:55.313761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a25f595-0be5-4ef8-ac31-b93b62de46eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af2c90>]}
[0m11:13:55.314622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:13:55.315057 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:13:56.745451 [debug] [MainThread]: On master: COMMIT
[0m11:13:56.747891 [debug] [MainThread]: Using oracle connection "master"
[0m11:13:56.748897 [debug] [MainThread]: On master: COMMIT
[0m11:13:56.866825 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:13:56.869199 [debug] [MainThread]: On master: Close
[0m11:13:56.999332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:13:57.000074 [info ] [MainThread]: 
[0m11:13:57.005902 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:13:57.006775 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:13:57.007749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:13:57.008225 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:13:57.029962 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:13:57.031075 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:13:57.008545 => 11:13:57.030957
[0m11:13:57.031403 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:13:57.040889 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:13:57.041299 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:13:57.052170 [info ] [Thread-1 (]: Python model materialization is table
[0m11:13:57.052598 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:13:59.816090 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:13:59.817673 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjEyMzgsImlhdCI6MTY4NzQ1NzYzOH0.QCikfrs4yOzG7k8G6lqDc1L-z6KU_H5To9RQgXsw8PBJ63J6WUnDKh4a7xmjA0scnDyqcc-one10DLESnjpNJzRdbHSf21-TY92l38cJK_xjJzYaLW4ScM2m1KGc7AlWVjQ-njdIFHeAh_41WyXEnPl-QqNZpLrM4kBQ7tAEaQsyLEaoYNlvOoIMwMMaFkc68qzgFEVdD5h8upIz9dFP1921BSRtLpos1DvKdPkJlXIU6K1xFG0UnT91xvk5Jx3oM49v3a4llsuUbQR67cGe0LCjLFaPRMFxq4oqJdROoyLhYX73xpd7xFTwTU_aZ7mYSxQv-Onbz83Y9V2kCYmEnQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Test_Product_Price": y_test})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181359 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181359';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:13:59.819255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:59.819824 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:14:26.484608 [debug] [Thread-1 (]: SQL status: OK in 27.0 seconds
[0m11:14:26.488654 [info ] [Thread-1 (]: oracle adapter: OK
[0m11:14:26.497795 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:14:26.498569 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m11:14:26.615398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:14:26.624628 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:14:26.625519 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m11:14:26.743071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:14:26.758334 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:14:26.758916 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:14:26.759303 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:14:26.871726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:14:26.882637 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:14:26.883176 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m11:14:27.040353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:14:27.060712 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:13:57.031580 => 11:14:27.060463
[0m11:14:27.061616 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:14:27.181876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a25f595-0be5-4ef8-ac31-b93b62de46eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d6290>]}
[0m11:14:27.183197 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 30.17s]
[0m11:14:27.183871 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:14:27.185916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:14:27.186369 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:14:28.871883 [debug] [MainThread]: On master: COMMIT
[0m11:14:28.874064 [debug] [MainThread]: Using oracle connection "master"
[0m11:14:28.874970 [debug] [MainThread]: On master: COMMIT
[0m11:14:29.056854 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:14:29.059773 [debug] [MainThread]: On master: Close
[0m11:14:29.227640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:29.228341 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:14:29.228739 [info ] [MainThread]: 
[0m11:14:29.229070 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 37.74 seconds (37.74s).
[0m11:14:29.229656 [debug] [MainThread]: Command end result
[0m11:14:29.235615 [info ] [MainThread]: 
[0m11:14:29.235869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:29.236064 [info ] [MainThread]: 
[0m11:14:29.236290 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:14:29.236649 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:29.236591 after 37.93 seconds
[0m11:14:29.236907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055347d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102266910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102266510>]}
[0m11:14:29.237188 [debug] [MainThread]: Flushing usage events
[0m11:15:21.512419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10713c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110017d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110017f90>]}


============================== 11:15:21.514830 | bc0abc94-2a75-42b0-a13e-3f991ac250fe ==============================
[0m11:15:21.514830 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:15:21.515162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:15:21.561313 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:15:21.583530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc0abc94-2a75-42b0-a13e-3f991ac250fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110008e50>]}
[0m11:15:21.589711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc0abc94-2a75-42b0-a13e-3f991ac250fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110729a90>]}
[0m11:15:21.622686 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:15:21.654766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:21.655072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:21.658422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc0abc94-2a75-42b0-a13e-3f991ac250fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109b1e90>]}
[0m11:15:21.662950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc0abc94-2a75-42b0-a13e-3f991ac250fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110907e90>]}
[0m11:15:21.663241 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:15:21.663415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc0abc94-2a75-42b0-a13e-3f991ac250fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110904310>]}
[0m11:15:21.664120 [info ] [MainThread]: 
[0m11:15:21.664481 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:15:21.664973 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:15:21.669900 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:15:21.670194 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:15:21.670369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:21.670535 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:15:23.316221 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:15:23.481775 [debug] [ThreadPool]: On list_None: Close
[0m11:15:23.608941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:15:23.617184 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:15:23.617610 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:15:23.617809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:23.618011 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:15:25.242453 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:15:25.253723 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:15:25.254562 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:15:25.386599 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:15:25.524708 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:15:25.634486 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:15:25.755541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc0abc94-2a75-42b0-a13e-3f991ac250fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11072bc90>]}
[0m11:15:25.756165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:25.756411 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:15:27.080307 [debug] [MainThread]: On master: COMMIT
[0m11:15:27.082676 [debug] [MainThread]: Using oracle connection "master"
[0m11:15:27.083658 [debug] [MainThread]: On master: COMMIT
[0m11:15:27.189841 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:15:27.192276 [debug] [MainThread]: On master: Close
[0m11:15:27.316751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:15:27.317627 [info ] [MainThread]: 
[0m11:15:27.323501 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:15:27.324054 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:15:27.324565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:15:27.324792 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:15:27.342347 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:15:27.343383 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:15:27.324962 => 11:15:27.343247
[0m11:15:27.343678 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:15:27.353464 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:15:27.353836 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:15:27.364420 [info ] [Thread-1 (]: Python model materialization is table
[0m11:15:27.364929 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:15:29.569932 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:15:29.572016 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjEzMjgsImlhdCI6MTY4NzQ1NzcyOH0.Ja6LXcZ3g8ZadwDD_khZcWBjsTnbeSURMf0d7Xm44BIB1j3qBJQRwnYsq9ELzZcSvrNAv1sHKKlH0z1nL-lHh1pzAUgS6XJxNOA5B72xILLgNEdcr8RpExxIBPCh5T567NfKKPJJkgoJUufxpgPSxHhZ2wIjlQ5DRlxdjPuPzBJijIzb-em5aN0eNYQHehQT6eKicmqX9I8vym7THjgd2xGbyxm641FR8gjD-Q5C58h_AW2eqKqZ0hzJPabP7F-cROmou87DPzo8lFDPBVieWXVtosvFaOku0O_iYWTZBGpqMMRM13dNQhOn4ZlGP5ky5CoMfyiw4Y9tymF2krhypA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Test_Product_Price": y_test})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181529 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181529';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:15:29.573554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:29.574126 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:15:55.572219 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m11:15:55.576911 [info ] [Thread-1 (]: oracle adapter: OK
[0m11:15:55.585897 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:15:55.586569 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m11:15:55.753385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:15:55.763231 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:15:55.764178 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m11:15:55.943137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:15:55.958863 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:15:55.959597 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:15:55.960113 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:15:56.116818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:15:56.128081 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:15:56.128979 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m11:15:56.300140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:15:56.316426 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:15:27.343845 => 11:15:56.316236
[0m11:15:56.316983 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:15:56.464912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0abc94-2a75-42b0-a13e-3f991ac250fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110079e10>]}
[0m11:15:56.466680 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 29.14s]
[0m11:15:56.467618 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:15:56.470670 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:56.471323 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:15:57.808233 [debug] [MainThread]: On master: COMMIT
[0m11:15:57.810288 [debug] [MainThread]: Using oracle connection "master"
[0m11:15:57.811006 [debug] [MainThread]: On master: COMMIT
[0m11:15:57.923332 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:15:57.924707 [debug] [MainThread]: On master: Close
[0m11:15:58.037384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:58.037990 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:15:58.038310 [info ] [MainThread]: 
[0m11:15:58.038524 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 36.37 seconds (36.37s).
[0m11:15:58.038921 [debug] [MainThread]: Command end result
[0m11:15:58.044033 [info ] [MainThread]: 
[0m11:15:58.044301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:58.044463 [info ] [MainThread]: 
[0m11:15:58.044632 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:58.044945 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:58.044896 after 36.55 seconds
[0m11:15:58.045163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071abb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f86ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c1e510>]}
[0m11:15:58.045376 [debug] [MainThread]: Flushing usage events
[0m11:16:18.188433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d3fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d4bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d4bf90>]}


============================== 11:16:18.190788 | 7385cfdb-bd8b-451b-8952-dda0aa94be8e ==============================
[0m11:16:18.190788 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:16:18.191099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:16:18.231522 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:16:18.254448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7385cfdb-bd8b-451b-8952-dda0aa94be8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e1a290>]}
[0m11:16:18.260726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7385cfdb-bd8b-451b-8952-dda0aa94be8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10445de50>]}
[0m11:16:18.294184 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:16:18.330137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:16:18.330572 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:16:18.351068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7385cfdb-bd8b-451b-8952-dda0aa94be8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104624250>]}
[0m11:16:18.356852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7385cfdb-bd8b-451b-8952-dda0aa94be8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104615d90>]}
[0m11:16:18.357176 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:16:18.357357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7385cfdb-bd8b-451b-8952-dda0aa94be8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d7d110>]}
[0m11:16:18.358105 [info ] [MainThread]: 
[0m11:16:18.358473 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:16:18.358972 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:16:18.363968 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:16:18.364276 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:16:18.364448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:18.364620 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:16:20.958799 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:16:21.185727 [debug] [ThreadPool]: On list_None: Close
[0m11:16:21.407266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:16:21.416452 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:16:21.417065 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:16:21.417475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:21.417881 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:16:24.099325 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:16:24.107451 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:16:24.107798 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:16:24.348738 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:16:24.670125 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:16:25.350736 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:16:25.596127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7385cfdb-bd8b-451b-8952-dda0aa94be8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104559f90>]}
[0m11:16:25.597571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:16:25.598503 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:16:28.333144 [debug] [MainThread]: On master: COMMIT
[0m11:16:28.333958 [debug] [MainThread]: Using oracle connection "master"
[0m11:16:28.334658 [debug] [MainThread]: On master: COMMIT
[0m11:16:28.648596 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:16:28.650877 [debug] [MainThread]: On master: Close
[0m11:16:28.879218 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:16:28.880952 [info ] [MainThread]: 
[0m11:16:28.888191 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:16:28.889067 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:16:28.890029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:16:28.890430 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:16:28.910279 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:16:28.911700 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:16:28.890707 => 11:16:28.911445
[0m11:16:28.912146 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:16:28.923233 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:16:28.923643 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:16:28.934642 [info ] [Thread-1 (]: Python model materialization is table
[0m11:16:28.935085 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:16:31.889878 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:16:31.891207 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjEzOTAsImlhdCI6MTY4NzQ1Nzc5MH0.nocGFGuuxzR2M6Ta6rRwyb402HGcSS_fbg_8CHWgo-OhuKiyy6buxXrFsHfqpyVXRJhTjuH2wNKjPN5inbCpKym2n8qlejxEVeiUxDRpEFozBRQaRLFhF8Xj5Osnip9TTvNchZxuEyWSxmDOJbNItmteQbqIl6qQXCbiBTY8T1LlVqEahKnWxe8D-g9W6eCJ_wMupg4PIpUJPf5yzXsZkyCKkwhtaD657cgh6amUUPwsj01eceGc6AMbXOKasA8Rg2bKyIXxDXApMhqMgBeaa0mfkROJrcg7el6JrE7uoJEaXQBDnH1S6pTnajhqkE-AbUtuLhTH90g3r6jlBxZabQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Test_Product_Price": y_test})
    
        return pd.DataFrame(y_pred, columns=['predictions'])





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181631 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181631';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:16:31.892600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:31.893291 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:16:34.895896 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-06550: line 83, column 47:
PLS-00103: Encountered the symbol "PREDICTIONS" when expecting one of the following:

   ) , * & = - + < / > at in is mod remainder not rem =>
   <an exponent (**)> <> or != or ~= >= <= <> and or like like2
   like4 likec between || multiset member submultiset
[0m11:16:34.898621 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:16:35.065912 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:16:28.912371 => 11:16:35.065257
[0m11:16:35.077811 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-06550: line 83, column 47:
  PLS-00103: Encountered the symbol "PREDICTIONS" when expecting one of the following:
  
     ) , * & = - + < / > at in is mod remainder not rem =>
     <an exponent (**)> <> or != or ~= >= <= <> and or like like2
     like4 likec between || multiset member submultiset
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:16:35.079470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7385cfdb-bd8b-451b-8952-dda0aa94be8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472e550>]}
[0m11:16:35.080049 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 6.19s]
[0m11:16:35.080323 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:16:35.081242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:16:35.081471 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:16:36.826863 [debug] [MainThread]: On master: COMMIT
[0m11:16:36.829290 [debug] [MainThread]: Using oracle connection "master"
[0m11:16:36.830378 [debug] [MainThread]: On master: COMMIT
[0m11:16:36.970916 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:16:36.973415 [debug] [MainThread]: On master: Close
[0m11:16:37.127091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:37.128343 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:16:37.128675 [info ] [MainThread]: 
[0m11:16:37.128904 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 18.77 seconds (18.77s).
[0m11:16:37.129242 [debug] [MainThread]: Command end result
[0m11:16:37.138314 [info ] [MainThread]: 
[0m11:16:37.138582 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:16:37.138751 [info ] [MainThread]: 
[0m11:16:37.138899 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m11:16:37.139125 [error] [MainThread]:   ORA-06550: line 83, column 47:
[0m11:16:37.139286 [error] [MainThread]:   PLS-00103: Encountered the symbol "PREDICTIONS" when expecting one of the following:
[0m11:16:37.139432 [error] [MainThread]:   
[0m11:16:37.139568 [error] [MainThread]:      ) , * & = - + < / > at in is mod remainder not rem =>
[0m11:16:37.139704 [error] [MainThread]:      <an exponent (**)> <> or != or ~= >= <= <> and or like like2
[0m11:16:37.139833 [error] [MainThread]:      like4 likec between || multiset member submultiset
[0m11:16:37.139960 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:16:37.140092 [info ] [MainThread]: 
[0m11:16:37.140245 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:16:37.140529 [debug] [MainThread]: Command `dbt run` failed at 11:16:37.140484 after 18.97 seconds
[0m11:16:37.140741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d5f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100682c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100680e10>]}
[0m11:16:37.140939 [debug] [MainThread]: Flushing usage events
[0m11:16:49.842995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b17c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b17f90>]}


============================== 11:16:49.845828 | 871a7f42-023b-496e-a8f0-88f1b54a3989 ==============================
[0m11:16:49.845828 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:16:49.846148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:16:49.890775 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:16:49.913249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '871a7f42-023b-496e-a8f0-88f1b54a3989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd6290>]}
[0m11:16:49.919775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '871a7f42-023b-496e-a8f0-88f1b54a3989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecd7d0>]}
[0m11:16:49.953783 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:16:49.987129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:16:49.987588 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:16:50.009618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '871a7f42-023b-496e-a8f0-88f1b54a3989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcb710>]}
[0m11:16:50.015550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '871a7f42-023b-496e-a8f0-88f1b54a3989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef27d0>]}
[0m11:16:50.015849 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:16:50.016031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '871a7f42-023b-496e-a8f0-88f1b54a3989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2a150>]}
[0m11:16:50.016756 [info ] [MainThread]: 
[0m11:16:50.017150 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:16:50.017695 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:16:50.022643 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:16:50.022876 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:16:50.023048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:50.023221 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:16:51.541669 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:16:51.660551 [debug] [ThreadPool]: On list_None: Close
[0m11:16:51.779604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:16:51.787857 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:16:51.788237 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:16:51.788418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:51.788607 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:16:53.537772 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:16:53.549638 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:16:53.550500 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:16:53.714581 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:16:53.962808 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:16:54.096759 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:16:54.244480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '871a7f42-023b-496e-a8f0-88f1b54a3989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b42a50>]}
[0m11:16:54.245342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:16:54.245708 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:16:56.174618 [debug] [MainThread]: On master: COMMIT
[0m11:16:56.176886 [debug] [MainThread]: Using oracle connection "master"
[0m11:16:56.177889 [debug] [MainThread]: On master: COMMIT
[0m11:16:56.367440 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:16:56.369876 [debug] [MainThread]: On master: Close
[0m11:16:56.568269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:16:56.570082 [info ] [MainThread]: 
[0m11:16:56.577971 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:16:56.578863 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:16:56.579816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:16:56.580292 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:16:56.599708 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:16:56.600922 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:16:56.580617 => 11:16:56.600757
[0m11:16:56.601266 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:16:56.609962 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:16:56.610320 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:16:56.622068 [info ] [Thread-1 (]: Python model materialization is table
[0m11:16:56.622556 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:16:58.918084 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:16:58.920284 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjE0MTgsImlhdCI6MTY4NzQ1NzgxOH0.mWnDDnzGAnx786EFiV76hsoLE6nQiaiWTQXXXqyCUtzZKcC6bj3Bn1Lt8hDYlexmoRle1C9FfdlEHdQRq8vToJ7FQuASHR-2UZnCmqQFXMMWNcH5y0ZN8UPyjTYsoAVd03kW9ezlC6AhcHkOuwhqM_wyEPAWxBuB7G_0iVKKDXwqMV1lryCRLmzeDWAbzTXe1SzRXuXhP7wWRHd-Bg0dPzjAuM5fCdCQVHXDJAB6s87dnmtjZT9PUCMUacXS-heC-Rwx55ZEsZMphZsTykl_R1CfLG4Ep8grqsB-pChcLuPSGytjT_aNGgiHdnXOeNGAVr-gCyH9kfBBlPxafc6-bQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Test_Product_Price": y_test})
    
        return pd.DataFrame(y_pred, columns=["predictions"])





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181658 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181658';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:16:58.922073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:58.922797 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:17:25.581302 [debug] [Thread-1 (]: SQL status: OK in 27.0 seconds
[0m11:17:25.585776 [info ] [Thread-1 (]: oracle adapter: OK
[0m11:17:25.602434 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:17:25.603194 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m11:17:25.785859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:17:25.794095 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:17:25.794982 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m11:17:25.948403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:17:25.968139 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:17:25.969036 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:17:25.969443 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:17:26.114741 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:17:26.123139 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:17:26.123937 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m11:17:26.286705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:17:26.305874 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:16:56.601490 => 11:17:26.305691
[0m11:17:26.306703 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:17:26.443045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871a7f42-023b-496e-a8f0-88f1b54a3989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108deb10>]}
[0m11:17:26.444707 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 29.86s]
[0m11:17:26.445579 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:17:26.448313 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:17:26.448972 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:17:28.081224 [debug] [MainThread]: On master: COMMIT
[0m11:17:28.083568 [debug] [MainThread]: Using oracle connection "master"
[0m11:17:28.084540 [debug] [MainThread]: On master: COMMIT
[0m11:17:28.209606 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:17:28.211911 [debug] [MainThread]: On master: Close
[0m11:17:28.343486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:28.345084 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:17:28.346088 [info ] [MainThread]: 
[0m11:17:28.346658 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 38.33 seconds (38.33s).
[0m11:17:28.347526 [debug] [MainThread]: Command end result
[0m11:17:28.356781 [info ] [MainThread]: 
[0m11:17:28.357292 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:17:28.357604 [info ] [MainThread]: 
[0m11:17:28.357777 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:17:28.358098 [debug] [MainThread]: Command `dbt run` succeeded at 11:17:28.358048 after 38.53 seconds
[0m11:17:28.358310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649a010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103162510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103222ad0>]}
[0m11:17:28.358514 [debug] [MainThread]: Flushing usage events
[0m11:19:16.443312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677bf90>]}


============================== 11:19:16.445618 | de41616d-3b31-4f91-9ea1-818a5ac5e1ec ==============================
[0m11:19:16.445618 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:19:16.445934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:19:16.488092 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:19:16.510343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de41616d-3b31-4f91-9ea1-818a5ac5e1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c0610>]}
[0m11:19:16.516752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de41616d-3b31-4f91-9ea1-818a5ac5e1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8da90>]}
[0m11:19:16.549692 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:19:16.583110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:19:16.583574 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:19:16.603614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de41616d-3b31-4f91-9ea1-818a5ac5e1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3f010>]}
[0m11:19:16.611947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de41616d-3b31-4f91-9ea1-818a5ac5e1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8f750>]}
[0m11:19:16.612298 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:19:16.612494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de41616d-3b31-4f91-9ea1-818a5ac5e1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec3ed0>]}
[0m11:19:16.613248 [info ] [MainThread]: 
[0m11:19:16.613645 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:19:16.614282 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:19:16.619143 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:19:16.619356 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:19:16.619521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:16.619692 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:19:18.346421 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:19:18.475668 [debug] [ThreadPool]: On list_None: Close
[0m11:19:18.603062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:19:18.612438 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:19:18.613049 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:19:18.613457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:19:18.613870 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:19:20.369943 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:19:20.383334 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:19:20.384065 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:19:20.532554 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:20.765954 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:19:20.954746 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:19:21.126610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de41616d-3b31-4f91-9ea1-818a5ac5e1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc1890>]}
[0m11:19:21.127534 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:19:21.128086 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:19:22.691456 [debug] [MainThread]: On master: COMMIT
[0m11:19:22.693700 [debug] [MainThread]: Using oracle connection "master"
[0m11:19:22.694845 [debug] [MainThread]: On master: COMMIT
[0m11:19:22.823377 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:19:22.825129 [debug] [MainThread]: On master: Close
[0m11:19:22.977735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:19:22.979338 [info ] [MainThread]: 
[0m11:19:22.986081 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:19:22.986873 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:19:22.987778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:19:22.988332 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:19:23.009920 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:19:23.011532 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:19:22.988729 => 11:19:23.011348
[0m11:19:23.011888 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:19:23.022908 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:19:23.023285 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:19:23.033974 [info ] [Thread-1 (]: Python model materialization is table
[0m11:19:23.034317 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:19:25.802880 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:19:25.804320 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjE1NjQsImlhdCI6MTY4NzQ1Nzk2NH0.k5cSk6WPVf5C2lp3L75Zwt2mI2r5Ikl7UNdfZAsdVzqFMlWyxzJv_KytuatATTpaycEATB8V-KXh2JUBZvkWuUCxufXjL4w02nUXOpEEqHnC6KNFgzw6g1_4TMfAxysMBGWVlBC3BGchqgEQVS6jROG4pvli_axoeD_wxvCM8PmM88EtiOcljVGzaLL3D6MWHSlC-DqakSAxb1Hj-svcCLLT0bBCmLPb-XhKHLENM1wd3_gyLtKCw-4MbWPt8jiqEvqF6TovcVqLlPJ234aArsEPOcKWAJiuxT1CvflQlC2tSQSe6Z8khKX8yVS04-MG44ktCUMRZ-s15rtYpzpQHw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Test_Product_Price": y_test})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181925 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_181925';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:19:25.805815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:19:25.806376 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:19:52.623602 [debug] [Thread-1 (]: SQL status: OK in 27.0 seconds
[0m11:19:52.628164 [info ] [Thread-1 (]: oracle adapter: OK
[0m11:19:52.644034 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:19:52.644623 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m11:19:52.913919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:52.920677 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:19:52.921233 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m11:19:53.236549 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:53.253191 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:19:53.253838 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:19:53.254230 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:19:53.508463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:53.519238 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:19:53.519740 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m11:19:53.779000 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:53.788446 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:19:23.012103 => 11:19:53.788324
[0m11:19:53.788785 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:19:54.032919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de41616d-3b31-4f91-9ea1-818a5ac5e1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067aff90>]}
[0m11:19:54.035343 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 31.04s]
[0m11:19:54.036898 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:19:54.039447 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:19:54.040064 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:19:57.130559 [debug] [MainThread]: On master: COMMIT
[0m11:19:57.132984 [debug] [MainThread]: Using oracle connection "master"
[0m11:19:57.134050 [debug] [MainThread]: On master: COMMIT
[0m11:19:57.434597 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:19:57.436533 [debug] [MainThread]: On master: Close
[0m11:19:57.702984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:57.703838 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:19:57.704442 [info ] [MainThread]: 
[0m11:19:57.704919 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 41.09 seconds (41.09s).
[0m11:19:57.705787 [debug] [MainThread]: Command end result
[0m11:19:57.717219 [info ] [MainThread]: 
[0m11:19:57.717645 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:19:57.717943 [info ] [MainThread]: 
[0m11:19:57.718252 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:19:57.718896 [debug] [MainThread]: Command `dbt run` succeeded at 11:19:57.718800 after 41.30 seconds
[0m11:19:57.719342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f4e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f4e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030b2c50>]}
[0m11:19:57.719757 [debug] [MainThread]: Flushing usage events
[0m11:27:44.229504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10833c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10833ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10833f790>]}


============================== 11:27:44.232216 | 99bb261b-c505-4f4e-b7f7-7d011e15a503 ==============================
[0m11:27:44.232216 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:27:44.232566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:27:44.278286 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:27:44.299758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99bb261b-c505-4f4e-b7f7-7d011e15a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c04e50>]}
[0m11:27:44.306182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99bb261b-c505-4f4e-b7f7-7d011e15a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a61f90>]}
[0m11:27:44.338562 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:27:44.370844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:27:44.371305 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:27:44.391894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99bb261b-c505-4f4e-b7f7-7d011e15a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf34d0>]}
[0m11:27:44.398036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99bb261b-c505-4f4e-b7f7-7d011e15a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b35e10>]}
[0m11:27:44.398351 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:27:44.398529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99bb261b-c505-4f4e-b7f7-7d011e15a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a30790>]}
[0m11:27:44.399268 [info ] [MainThread]: 
[0m11:27:44.399633 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:27:44.400178 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:27:44.405229 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:27:44.405546 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:27:44.405721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:44.405902 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:27:46.759084 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:27:46.935888 [debug] [ThreadPool]: On list_None: Close
[0m11:27:47.126656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:27:47.136379 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:27:47.137009 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:27:47.137432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:47.137843 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:27:49.377067 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:27:49.386112 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:27:49.386850 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:27:49.635470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:27:49.948162 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:27:50.147292 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:27:50.323628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99bb261b-c505-4f4e-b7f7-7d011e15a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a9b390>]}
[0m11:27:50.324631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:27:50.325084 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:27:52.402337 [debug] [MainThread]: On master: COMMIT
[0m11:27:52.405041 [debug] [MainThread]: Using oracle connection "master"
[0m11:27:52.405783 [debug] [MainThread]: On master: COMMIT
[0m11:27:52.605254 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:27:52.607848 [debug] [MainThread]: On master: Close
[0m11:27:52.771727 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:27:52.772638 [info ] [MainThread]: 
[0m11:27:52.778840 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:27:52.779606 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:27:52.780388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:27:52.780772 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:27:52.797353 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:27:52.798486 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:27:52.781046 => 11:27:52.798361
[0m11:27:52.798740 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:27:52.806623 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:27:52.807119 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:27:52.818020 [info ] [Thread-1 (]: Python model materialization is table
[0m11:27:52.818588 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:27:56.808067 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:27:56.809760 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjIwNzUsImlhdCI6MTY4NzQ1ODQ3NX0.Ny77IiHN9k53UMAgMMxKclrZmWiCx1LPeEkX1oMn9n8Aw1Uv5CQjpDD3usBMCtP4YRxwVIZY_HwAAOkm8tPU-NVpXyKjIPm9RtrQftMLLRh7b5FiR1F7PdHFvyzLFRUoi-YunSv8MUgdNvwqW56gQOizW_MlA5a-IMHraD5T4Pa2KZu-tMVCoUFkDrJZhQOUNqyxUR56YoEh6llCdmms-eQq8rwIBC8_dFP2za71nKh0vonj53sx0IpDhL4vRhx8Ya1hCdjrOflKnMa6vvvs4Swfvynp_qDzeULapmDbETFtbHUGWtzxiMEkQT1mTIxbOClxtyYKBeWhLg4XBWVPWQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Test_Product_Price": y_test})
    
        return pd.DataFrame(X_test, columns=["predictions"])





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_182756 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_182756';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:27:56.811357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:56.812034 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:28:23.392115 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"DPI-1043: invalid number : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 814, in oml.core.methods.__create\n   File \"oml/core/methods.py\", line 796, in oml.core.methods.__create\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 104
[0m11:28:23.395141 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:28:23.505511 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:27:52.798902 => 11:28:23.504068
[0m11:28:23.516754 [debug] [Thread-1 (]: Database Error in model web_events_python (models/staging/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"DPI-1043: invalid number : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 814, in oml.core.methods.__create\n   File \"oml/core/methods.py\", line 796, in oml.core.methods.__create\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 104
  compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:28:23.518535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99bb261b-c505-4f4e-b7f7-7d011e15a503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf4ad0>]}
[0m11:28:23.519112 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 30.74s]
[0m11:28:23.519652 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:28:23.520823 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:28:23.521080 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:28:25.178795 [debug] [MainThread]: On master: COMMIT
[0m11:28:25.180895 [debug] [MainThread]: Using oracle connection "master"
[0m11:28:25.181909 [debug] [MainThread]: On master: COMMIT
[0m11:28:25.294019 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:28:25.296963 [debug] [MainThread]: On master: Close
[0m11:28:25.416934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:25.418552 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:28:25.419327 [info ] [MainThread]: 
[0m11:28:25.419826 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 41.02 seconds (41.02s).
[0m11:28:25.420683 [debug] [MainThread]: Command end result
[0m11:28:25.445444 [info ] [MainThread]: 
[0m11:28:25.446090 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:28:25.446386 [info ] [MainThread]: 
[0m11:28:25.446682 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/staging/web_events_python.py)[0m
[0m11:28:25.447022 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"DPI-1043: invalid number : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 814, in oml.core.methods.__create\n   File \"oml/core/methods.py\", line 796, in oml.core.methods.__create\n"}
[0m11:28:25.447342 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m11:28:25.447599 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m11:28:25.447820 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m11:28:25.448037 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m11:28:25.448253 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m11:28:25.448470 [error] [MainThread]:   ORA-06512: at line 104
[0m11:28:25.448683 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/web_events_python.py
[0m11:28:25.448908 [info ] [MainThread]: 
[0m11:28:25.449169 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:28:25.449740 [debug] [MainThread]: Command `dbt run` failed at 11:28:25.449651 after 41.24 seconds
[0m11:28:25.450118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c76c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c74e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10831f050>]}
[0m11:28:25.450459 [debug] [MainThread]: Flushing usage events
[0m11:29:28.224100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d0bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d17f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d17fd0>]}


============================== 11:29:28.226582 | 9ce5362c-a904-48e8-81c7-d9f3649bf9b4 ==============================
[0m11:29:28.226582 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:29:28.226886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:29:28.268997 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:29:28.290913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ce5362c-a904-48e8-81c7-d9f3649bf9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d29ed0>]}
[0m11:29:28.297273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ce5362c-a904-48e8-81c7-d9f3649bf9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111429c90>]}
[0m11:29:28.332067 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:29:28.368123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:29:28.368569 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:29:28.389475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ce5362c-a904-48e8-81c7-d9f3649bf9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d44990>]}
[0m11:29:28.399580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ce5362c-a904-48e8-81c7-d9f3649bf9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116ab890>]}
[0m11:29:28.399945 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:29:28.400132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ce5362c-a904-48e8-81c7-d9f3649bf9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11144e910>]}
[0m11:29:28.400875 [info ] [MainThread]: 
[0m11:29:28.401258 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:29:28.401783 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:29:28.406645 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:29:28.406882 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:29:28.407041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:28.407207 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:29:30.288397 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:29:30.443712 [debug] [ThreadPool]: On list_None: Close
[0m11:29:30.589979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:29:30.599548 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:29:30.600323 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:29:30.600739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:29:30.601100 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:29:33.007954 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:29:33.014258 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:29:33.014729 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:29:33.219443 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:29:33.498218 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:29:33.677568 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:29:33.888801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ce5362c-a904-48e8-81c7-d9f3649bf9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116ca350>]}
[0m11:29:33.890025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:29:33.890579 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:29:35.850806 [debug] [MainThread]: On master: COMMIT
[0m11:29:35.852888 [debug] [MainThread]: Using oracle connection "master"
[0m11:29:35.854048 [debug] [MainThread]: On master: COMMIT
[0m11:29:36.002766 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:29:36.003604 [debug] [MainThread]: On master: Close
[0m11:29:36.152900 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:29:36.154672 [info ] [MainThread]: 
[0m11:29:36.161706 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:29:36.162560 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:29:36.163483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:29:36.163884 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:29:36.181402 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:29:36.182523 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:29:36.164164 => 11:29:36.182384
[0m11:29:36.182787 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:29:36.190734 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:29:36.191088 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:29:36.201523 [info ] [Thread-1 (]: Python model materialization is table
[0m11:29:36.201955 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:29:43.514912 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:29:43.517112 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjIxODIsImlhdCI6MTY4NzQ1ODU4Mn0.de7LSjFkJD-6iHl5HuBG0gzV5diVw273hzHQRkEm4QdtTpbKVepQgMQGfh961bpYRnUxxzH-ETTOlDGj94bXi70LlAyF3AuNNruhO6Q_tKxLuV5EOzZ6l0a4lBxKbb5AHlsBUoxCjg3eGf92CQAhzCmoBgltcWLKupOapIH8zEhiYHKoxGjuNJku_oBD2iNcTEKijARwdUwoFz-OezGvdOB4XyW-dMHmP8KlIVD-Zlk4_sr1E-AVNSeuVhnbRM26i4lCbMHBYgTqgfea259q9c9GStf7qaxtN8KYfrteADJhNAaZ1gD-BjhdjppsTA1joGhZIfLgjUdBAbUirm8_WQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Test_Product_Price": label_encoder.inverse_transform(y_test)})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_182943 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_182943';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:29:43.519740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:43.520362 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:30:09.703938 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m11:30:09.706308 [info ] [Thread-1 (]: oracle adapter: OK
[0m11:30:09.727728 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:30:09.728105 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m11:30:09.913510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:09.926039 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:30:09.927367 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m11:30:10.074691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:10.096501 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:30:10.096888 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:30:10.097110 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:30:10.232228 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:10.248315 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:30:10.249325 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m11:30:10.404739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:10.427578 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:29:36.182936 => 11:30:10.427439
[0m11:30:10.427987 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:30:10.553231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce5362c-a904-48e8-81c7-d9f3649bf9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116f0d50>]}
[0m11:30:10.554877 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 34.39s]
[0m11:30:10.556193 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:30:10.560043 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:10.561063 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:30:12.226038 [debug] [MainThread]: On master: COMMIT
[0m11:30:12.228267 [debug] [MainThread]: Using oracle connection "master"
[0m11:30:12.229308 [debug] [MainThread]: On master: COMMIT
[0m11:30:12.400585 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:12.401996 [debug] [MainThread]: On master: Close
[0m11:30:12.595089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:12.596989 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:30:12.597901 [info ] [MainThread]: 
[0m11:30:12.599232 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 44.20 seconds (44.20s).
[0m11:30:12.600847 [debug] [MainThread]: Command end result
[0m11:30:12.616460 [info ] [MainThread]: 
[0m11:30:12.617347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:30:12.617805 [info ] [MainThread]: 
[0m11:30:12.618253 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:30:12.619166 [debug] [MainThread]: Command `dbt run` succeeded at 11:30:12.619021 after 44.42 seconds
[0m11:30:12.619758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d17410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ae910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ae510>]}
[0m11:30:12.620244 [debug] [MainThread]: Flushing usage events
[0m11:30:43.581207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8bfd0>]}


============================== 11:30:43.583664 | 61be21c2-07ad-4aae-b038-917aea8ff7a7 ==============================
[0m11:30:43.583664 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:30:43.583973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:30:43.633176 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:30:43.655358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61be21c2-07ad-4aae-b038-917aea8ff7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb9650>]}
[0m11:30:43.661692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61be21c2-07ad-4aae-b038-917aea8ff7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110de610>]}
[0m11:30:43.695757 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:30:43.737471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:30:43.737897 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/web_events_python.py
[0m11:30:43.759442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61be21c2-07ad-4aae-b038-917aea8ff7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11137e750>]}
[0m11:30:43.765557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61be21c2-07ad-4aae-b038-917aea8ff7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111236b10>]}
[0m11:30:43.765920 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:30:43.766104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61be21c2-07ad-4aae-b038-917aea8ff7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113006d0>]}
[0m11:30:43.766856 [info ] [MainThread]: 
[0m11:30:43.767238 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:30:43.767778 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:30:43.772784 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:30:43.773070 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:30:43.773246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:43.773423 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:30:46.997320 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:30:47.226529 [debug] [ThreadPool]: On list_None: Close
[0m11:30:47.458520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:30:47.468033 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:30:47.468792 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:30:47.469188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:47.469931 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:30:50.305894 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m11:30:50.311958 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:30:50.312458 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:30:50.529894 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:50.806090 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:30:50.964405 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:30:51.188639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61be21c2-07ad-4aae-b038-917aea8ff7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b8d790>]}
[0m11:30:51.189546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:30:51.189916 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:30:53.322724 [debug] [MainThread]: On master: COMMIT
[0m11:30:53.323118 [debug] [MainThread]: Using oracle connection "master"
[0m11:30:53.323326 [debug] [MainThread]: On master: COMMIT
[0m11:30:53.486368 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:53.488122 [debug] [MainThread]: On master: Close
[0m11:30:53.652696 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:30:53.653747 [info ] [MainThread]: 
[0m11:30:53.660381 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m11:30:53.661241 [info ] [Thread-1 (]: 1 of 1 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m11:30:53.662105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.web_events_python)
[0m11:30:53.662552 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m11:30:53.682917 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m11:30:53.684293 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 11:30:53.662871 => 11:30:53.684072
[0m11:30:53.684721 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m11:30:53.694440 [debug] [Thread-1 (]: Preexisting intermediate relation=None
[0m11:30:53.694790 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m11:30:53.704986 [info ] [Thread-1 (]: Python model materialization is table
[0m11:30:53.705424 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m11:30:56.115320 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:30:56.117536 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjIyNTUsImlhdCI6MTY4NzQ1ODY1NX0.fmsA1aOd7dKlgNamy8b5S8rkpImjqJoeFHp8P4e9vRJRMW4Az0IV0vOQjuHZhd_cDZtntp3xU8oYD5iNGwkJIHznZs91ZJ3kqeLATBvPfFNg92jmLgJnnatYNZM7tNNZCrGpZiOcyv5G65zI283xCy3nD0fA9wk1l9yUNzDsqaqGp9kvPq6KNwT5J-cGmITemHkkIcmXFtI_va5GpL8Er3r2CbVYX31l6ZC_w_OQL2NrIiBe6GAVI_9K48UbTD0FBHlA-3C7mNAKSkx4m3Nw9TkpUHmkkkY-cMr6D3x9yVoY-ZyN9Lax3IUv3QelyA-lELju2A2eqORNY5Hn0GH1VA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test)})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_183056 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_183056';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m11:30:56.119391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:56.120095 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:31:22.825147 [debug] [Thread-1 (]: SQL status: OK in 27.0 seconds
[0m11:31:22.828176 [info ] [Thread-1 (]: oracle adapter: OK
[0m11:31:22.841630 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:31:22.842296 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m11:31:23.009769 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:23.013921 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:31:23.014604 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m11:31:23.191348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:23.208271 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:31:23.209031 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:31:23.209409 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m11:31:23.390020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:23.395667 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m11:31:23.396408 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m11:31:23.658298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:23.675652 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 11:30:53.684930 => 11:31:23.675402
[0m11:31:23.676350 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m11:31:23.857148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61be21c2-07ad-4aae-b038-917aea8ff7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9c890>]}
[0m11:31:23.858418 [info ] [Thread-1 (]: 1 of 1 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 30.20s]
[0m11:31:23.859130 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m11:31:23.861265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:31:23.861768 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:31:25.920014 [debug] [MainThread]: On master: COMMIT
[0m11:31:25.922354 [debug] [MainThread]: Using oracle connection "master"
[0m11:31:25.923281 [debug] [MainThread]: On master: COMMIT
[0m11:31:26.072859 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:31:26.076023 [debug] [MainThread]: On master: Close
[0m11:31:26.234238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:26.234966 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m11:31:26.235324 [info ] [MainThread]: 
[0m11:31:26.235595 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 42.47 seconds (42.47s).
[0m11:31:26.236098 [debug] [MainThread]: Command end result
[0m11:31:26.242999 [info ] [MainThread]: 
[0m11:31:26.243394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:31:26.243655 [info ] [MainThread]: 
[0m11:31:26.243905 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:31:26.244368 [debug] [MainThread]: Command `dbt run` succeeded at 11:31:26.244294 after 42.68 seconds
[0m11:31:26.244685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103be6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f53990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d26910>]}
[0m11:31:26.245003 [debug] [MainThread]: Flushing usage events
[0m11:55:04.561421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106897d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a3f90>]}


============================== 11:55:04.563797 | 2c3de62c-db69-49dc-ae56-153378baf94e ==============================
[0m11:55:04.563797 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:55:04.564116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:55:04.606260 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:55:04.628599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c3de62c-db69-49dc-ae56-153378baf94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e8390>]}
[0m11:55:04.634901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c3de62c-db69-49dc-ae56-153378baf94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068cebd0>]}
[0m11:55:04.667978 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:55:04.698291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:04.698614 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:04.702189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c3de62c-db69-49dc-ae56-153378baf94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709a010>]}
[0m11:55:04.709050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c3de62c-db69-49dc-ae56-153378baf94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd2ad0>]}
[0m11:55:04.709383 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:55:04.709559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c3de62c-db69-49dc-ae56-153378baf94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb5190>]}
[0m11:55:04.709916 [warn ] [MainThread]: The selection criterion '+stg_wev_order_info' does not match any nodes
[0m11:55:04.710392 [info ] [MainThread]: 
[0m11:55:04.710540 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:55:04.710761 [debug] [MainThread]: Command end result
[0m11:55:04.833719 [debug] [MainThread]: Command `dbt run` succeeded at 11:55:04.833539 after 0.29 seconds
[0m11:55:04.834230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103076910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103076510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031dac50>]}
[0m11:55:04.834575 [debug] [MainThread]: Flushing usage events
[0m11:55:17.274891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10404fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405bf90>]}


============================== 11:55:17.277803 | 22b3bc3d-8269-42c3-b8f3-0fc1badeaea8 ==============================
[0m11:55:17.277803 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:55:17.278133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:55:17.322091 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:55:17.343805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22b3bc3d-8269-42c3-b8f3-0fc1badeaea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104786290>]}
[0m11:55:17.350331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22b3bc3d-8269-42c3-b8f3-0fc1badeaea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476d5d0>]}
[0m11:55:17.382041 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:55:17.414835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:17.415153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:17.418742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22b3bc3d-8269-42c3-b8f3-0fc1badeaea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d9550>]}
[0m11:55:17.423219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22b3bc3d-8269-42c3-b8f3-0fc1badeaea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ad290>]}
[0m11:55:17.423529 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:55:17.423710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b3bc3d-8269-42c3-b8f3-0fc1badeaea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104751a10>]}
[0m11:55:17.424095 [warn ] [MainThread]: The selection criterion '+stg_web_order_info' does not match any nodes
[0m11:55:17.424612 [info ] [MainThread]: 
[0m11:55:17.424770 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:55:17.424992 [debug] [MainThread]: Command end result
[0m11:55:17.537078 [debug] [MainThread]: Command `dbt run` succeeded at 11:55:17.536915 after 0.28 seconds
[0m11:55:17.537566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10082e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10082e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10297a090>]}
[0m11:55:17.537912 [debug] [MainThread]: Flushing usage events
[0m11:55:36.981081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d17ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d17fd0>]}


============================== 11:55:36.983433 | 05d31e99-ed6d-4764-a975-768e720d7fa0 ==============================
[0m11:55:36.983433 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:55:36.983741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:55:37.028609 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m11:55:37.050475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05d31e99-ed6d-4764-a975-768e720d7fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d28a10>]}
[0m11:55:37.056841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05d31e99-ed6d-4764-a975-768e720d7fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105441990>]}
[0m11:55:37.088958 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:55:37.122581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:55:37.122999 [debug] [MainThread]: Partial parsing: added file: oracle_dbt://models/staging/stg_web_order_info.py
[0m11:55:37.143711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05d31e99-ed6d-4764-a975-768e720d7fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10492c750>]}
[0m11:55:37.155001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05d31e99-ed6d-4764-a975-768e720d7fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572bed0>]}
[0m11:55:37.155351 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:55:37.155532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05d31e99-ed6d-4764-a975-768e720d7fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105487990>]}
[0m11:55:37.156318 [info ] [MainThread]: 
[0m11:55:37.156701 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m11:55:37.157250 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m11:55:37.162190 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m11:55:37.162472 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m11:55:37.162650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:37.162821 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:55:39.260904 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m11:55:39.374191 [debug] [ThreadPool]: On list_None: Close
[0m11:55:39.484546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m11:55:39.492177 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:55:39.492582 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m11:55:39.492783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:39.492989 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:55:40.875410 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m11:55:40.890897 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m11:55:40.891703 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m11:55:41.349015 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:41.498179 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m11:55:41.710197 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m11:55:41.871081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05d31e99-ed6d-4764-a975-768e720d7fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105439bd0>]}
[0m11:55:41.871616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:41.871916 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:55:43.239213 [debug] [MainThread]: On master: COMMIT
[0m11:55:43.240363 [debug] [MainThread]: Using oracle connection "master"
[0m11:55:43.240872 [debug] [MainThread]: On master: COMMIT
[0m11:55:43.341671 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:43.343664 [debug] [MainThread]: On master: Close
[0m11:55:43.464006 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:43.464947 [info ] [MainThread]: 
[0m11:55:43.471040 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m11:55:43.471886 [info ] [Thread-1 (]: 1 of 1 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m11:55:43.472468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m11:55:43.472681 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m11:55:43.485406 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m11:55:43.486206 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 11:55:43.472824 => 11:55:43.486065
[0m11:55:43.486468 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m11:55:43.512941 [info ] [Thread-1 (]: Python model materialization is incremental
[0m11:55:43.513445 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.stg_web_order_info"
[0m11:55:46.168656 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m11:55:46.169715 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjM3NDUsImlhdCI6MTY4NzQ2MDE0NX0.okRpMJ4ePQnXcOB4sKN9MIcszoTDoi0bZdDEtdqom6vgtCem-SJEpzANRKh-zOxh8m1_vDvykwjWspifMvlq1BH1Bryqgv7IC7k7Dsxiuq_mM1mcCQtX0Mf59E_jpYO2rMvfpAfiSQsmsF07v94RPtPhxvT-uHGmXh6dZTcJEOg9z6Nduk0OGR88tdsu90dHMO0BzeD67-z5Ss65aHRSc0zK7gN0Jg_VQajlLkX0AjJNjASFd8NCmp4912Lexhx7PegIdwDRguIq1JnWB2dt3ou3kFSdEoRctJ_Pk6g4psgU2g9pZZbR-2IwTSMy3CcdqX_G_X3UMjS11pSGe5EdMA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = dbt.this.identifier
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_185546 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_185546';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m11:55:46.170757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:46.171118 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:56:12.328312 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m11:56:12.333044 [info ] [Thread-1 (]: oracle adapter: OK
[0m11:56:12.354118 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m11:56:12.355139 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m11:56:12.355707 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m11:56:12.504294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:56:12.530217 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 11:55:43.486608 => 11:56:12.529862
[0m11:56:12.531142 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m11:56:12.678637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05d31e99-ed6d-4764-a975-768e720d7fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105854450>]}
[0m11:56:12.681651 [info ] [Thread-1 (]: 1 of 1 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 29.21s]
[0m11:56:12.683105 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m11:56:12.690844 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:56:12.691737 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m11:56:14.664251 [debug] [MainThread]: On master: COMMIT
[0m11:56:14.666442 [debug] [MainThread]: Using oracle connection "master"
[0m11:56:14.667456 [debug] [MainThread]: On master: COMMIT
[0m11:56:14.827304 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:56:14.829742 [debug] [MainThread]: On master: Close
[0m11:56:15.013158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:15.014660 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m11:56:15.016218 [info ] [MainThread]: 
[0m11:56:15.017572 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 37.86 seconds (37.86s).
[0m11:56:15.020580 [debug] [MainThread]: Command end result
[0m11:56:15.039947 [info ] [MainThread]: 
[0m11:56:15.041089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:15.041654 [info ] [MainThread]: 
[0m11:56:15.042109 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:56:15.042965 [debug] [MainThread]: Command `dbt run` succeeded at 11:56:15.042828 after 38.08 seconds
[0m11:56:15.043572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b8e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b8e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100cf2c50>]}
[0m11:56:15.044402 [debug] [MainThread]: Flushing usage events
[0m12:02:04.614722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10804bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108057d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108057f90>]}


============================== 12:02:04.617297 | 25005315-530f-452a-b00f-bf35b7bf5871 ==============================
[0m12:02:04.617297 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:02:04.617627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:02:04.659975 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m12:02:04.682210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25005315-530f-452a-b00f-bf35b7bf5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691ce50>]}
[0m12:02:04.688465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25005315-530f-452a-b00f-bf35b7bf5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108780dd0>]}
[0m12:02:04.721303 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:02:05.127086 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m12:02:05.128416 [debug] [MainThread]: Partial parsing: added file: oracle_dbt://models/web_events_python.py
[0m12:02:05.128952 [debug] [MainThread]: Partial parsing: deleted file: oracle_dbt://models/staging/web_events_python.py
[0m12:02:05.165398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25005315-530f-452a-b00f-bf35b7bf5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891b090>]}
[0m12:02:05.171572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25005315-530f-452a-b00f-bf35b7bf5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108934350>]}
[0m12:02:05.171930 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:02:05.172115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25005315-530f-452a-b00f-bf35b7bf5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808bdd0>]}
[0m12:02:05.172926 [info ] [MainThread]: 
[0m12:02:05.173303 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m12:02:05.173852 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m12:02:05.178790 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m12:02:05.179203 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m12:02:05.179423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:05.179612 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:02:06.745774 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m12:02:06.858786 [debug] [ThreadPool]: On list_None: Close
[0m12:02:06.973687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m12:02:06.978505 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m12:02:06.978875 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m12:02:06.979111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:06.979346 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:02:08.441552 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m12:02:08.453152 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m12:02:08.453924 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m12:02:08.912983 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:09.065870 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m12:02:09.176567 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m12:02:09.295337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25005315-530f-452a-b00f-bf35b7bf5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c2e10>]}
[0m12:02:09.296506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:09.297048 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:02:10.979580 [debug] [MainThread]: On master: COMMIT
[0m12:02:10.981776 [debug] [MainThread]: Using oracle connection "master"
[0m12:02:10.982555 [debug] [MainThread]: On master: COMMIT
[0m12:02:11.127023 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:02:11.129978 [debug] [MainThread]: On master: Close
[0m12:02:11.273599 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:02:11.274595 [info ] [MainThread]: 
[0m12:02:11.280980 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m12:02:11.281738 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m12:02:11.282506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m12:02:11.282891 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m12:02:11.302784 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m12:02:11.303844 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 12:02:11.283163 => 12:02:11.303684
[0m12:02:11.304127 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m12:02:11.332891 [info ] [Thread-1 (]: Python model materialization is incremental
[0m12:02:13.796263 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:02:13.798504 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjQxMzIsImlhdCI6MTY4NzQ2MDUzMn0.JOWQVHGZ78xdxWlrwfUG0LxduMdnD4EhA4m7qGuI8Y7Ih_ygn3gRWwHNfO5kCGSiRn2OaqxPdzaiLJBMtRh_kUiyaoDS1ATIjdr3RX8dSyRBbM5GcF9OldZPqdHk8AiC_Vs6nj0R3cQpAvL13qWYYqnKYqoIYDPC-oTkn7EgKs5JuigMY-n6HfRbDMpLG0Ery0aETbQSixwpf-GDCaXUW-gUONXRvUUMsRa5MAO-IUw3MMUSLECI58OsBGNNR6Ia-Mv52bipr15K7jy690nMyeYWAJ5F8_BJrEReGoORia1FVAjWhj5GDhbQeHn9-P-NQ9Vjs5jOsvIqqpEqNXYNqQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info120211323651"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_190213 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_190213';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m12:02:13.800044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:13.800616 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:02:40.045731 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m12:02:40.050817 [info ] [Thread-1 (]: oracle adapter: OK
[0m12:02:40.070233 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:02:40.071264 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info120211323651')
        
      order by ordinal_position

  
[0m12:02:40.490955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:02:40.653918 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:02:40.655780 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m12:02:40.921114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:02:41.113754 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:02:41.114769 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m12:02:41.362415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:02:41.563834 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m12:02:41.566940 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:02:41.567405 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info120211323651
    )
  
[0m12:02:42.402568 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m12:02:42.423651 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m12:02:42.424414 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:02:42.424764 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m12:02:42.603008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:02:42.618587 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:02:42.620020 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info120211323651
[0m12:02:42.835602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:02:42.854067 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:02:42.855910 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info120211323651 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m12:02:43.015438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:02:43.041070 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 12:02:11.304272 => 12:02:43.040805
[0m12:02:43.041979 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m12:02:43.158973 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m12:02:43.290189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25005315-530f-452a-b00f-bf35b7bf5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10876b010>]}
[0m12:02:43.292191 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 32.01s]
[0m12:02:43.293833 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m12:02:43.297578 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m12:02:43.300714 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m12:02:43.301824 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m12:02:43.302542 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m12:02:43.311299 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m12:02:43.312990 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 12:02:43.303128 => 12:02:43.312598
[0m12:02:43.314040 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m12:02:43.322465 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m12:02:43.322840 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m12:02:43.324283 [info ] [Thread-3 (]: Python model materialization is table
[0m12:02:43.324668 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m12:02:45.887793 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m12:02:45.889573 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjQxNjQsImlhdCI6MTY4NzQ2MDU2NH0.VpgMGO5F7K21QK6vlIKnWe-nBw42ExboAUQABxetmgN8dpGb-uEvDIILQvfdEPKb108Fb_7kFeJDE_fLjDt8F4aXtjEdfwFrWQKHf8hPiQBGmTryA6axC7pUnnB7OlJPgVizmyn13Qml8VmaaNJLwt-Feh63gqfFwe50NBXq1FJN8ghs9KRVTA4irau6CrrTo9ICdExPIV63cxLz1TeNInaDlYj3kHSQ1zZ1FAeChgYdcE-ZP7-f4EBLdcJ7J9g6UNCMuBtWjCxg36zfzMnxrQxqOZ9RhsrO2GhrdPiZn-21RNinVtHtV6V6jHZ5KlXqvNMpO4MrIscw5KCaMz8qFg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test)})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_190245 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_190245';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m12:02:45.891618 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:02:45.892112 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:03:12.813921 [debug] [Thread-3 (]: SQL status: OK in 27.0 seconds
[0m12:03:12.817855 [info ] [Thread-3 (]: oracle adapter: OK
[0m12:03:12.825784 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m12:03:12.826409 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m12:03:12.945523 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:03:12.954498 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m12:03:12.955412 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m12:03:13.075783 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:03:13.082217 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m12:03:13.082728 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m12:03:13.082980 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m12:03:13.211594 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:03:13.219363 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m12:03:13.220254 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m12:03:13.383624 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:03:13.394690 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 12:02:43.314339 => 12:03:13.394458
[0m12:03:13.395336 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m12:03:13.519131 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25005315-530f-452a-b00f-bf35b7bf5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abb010>]}
[0m12:03:13.520641 [info ] [Thread-3 (]: 2 of 2 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 30.22s]
[0m12:03:13.521501 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m12:03:13.524025 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:13.524695 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:03:15.120969 [debug] [MainThread]: On master: COMMIT
[0m12:03:15.123526 [debug] [MainThread]: Using oracle connection "master"
[0m12:03:15.124729 [debug] [MainThread]: On master: COMMIT
[0m12:03:15.289176 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:03:15.291416 [debug] [MainThread]: On master: Close
[0m12:03:15.456884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:15.458662 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m12:03:15.459435 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m12:03:15.460039 [info ] [MainThread]: 
[0m12:03:15.460529 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 10.29 seconds (70.29s).
[0m12:03:15.461575 [debug] [MainThread]: Command end result
[0m12:03:15.476283 [info ] [MainThread]: 
[0m12:03:15.476758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:15.477057 [info ] [MainThread]: 
[0m12:03:15.477358 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:03:15.477919 [debug] [MainThread]: Command `dbt run` succeeded at 12:03:15.477835 after 70.88 seconds
[0m12:03:15.478320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498ec50>]}
[0m12:03:15.478807 [debug] [MainThread]: Flushing usage events
[0m12:03:41.441175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d01c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cecc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0ffd0>]}


============================== 12:03:41.443952 | 95be8cba-d275-4790-8c0c-58851fed61eb ==============================
[0m12:03:41.443952 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:03:41.444306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:03:41.487112 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m12:03:41.508997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95be8cba-d275-4790-8c0c-58851fed61eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bec290>]}
[0m12:03:41.515333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95be8cba-d275-4790-8c0c-58851fed61eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106421750>]}
[0m12:03:41.548129 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:03:41.580055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:03:41.580464 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m12:03:41.601598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95be8cba-d275-4790-8c0c-58851fed61eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110088950>]}
[0m12:03:41.611369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95be8cba-d275-4790-8c0c-58851fed61eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106402b90>]}
[0m12:03:41.611737 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:03:41.611919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95be8cba-d275-4790-8c0c-58851fed61eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d013d0>]}
[0m12:03:41.612738 [info ] [MainThread]: 
[0m12:03:41.613144 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m12:03:41.613742 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m12:03:41.618462 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m12:03:41.618695 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m12:03:41.618859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:41.619037 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:03:47.013311 [debug] [ThreadPool]: SQL status: OK in 5.0 seconds
[0m12:03:47.326368 [debug] [ThreadPool]: On list_None: Close
[0m12:03:47.635812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m12:03:47.645214 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m12:03:47.645939 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m12:03:47.646273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:47.646626 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:03:50.397180 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m12:03:50.406056 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m12:03:50.406621 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m12:03:50.599588 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:50.904595 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m12:03:51.065435 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m12:03:51.235714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95be8cba-d275-4790-8c0c-58851fed61eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbe850>]}
[0m12:03:51.236736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:51.237231 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:03:52.983858 [debug] [MainThread]: On master: COMMIT
[0m12:03:52.986278 [debug] [MainThread]: Using oracle connection "master"
[0m12:03:52.987334 [debug] [MainThread]: On master: COMMIT
[0m12:03:53.155898 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:03:53.158375 [debug] [MainThread]: On master: Close
[0m12:03:53.306020 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:03:53.306393 [info ] [MainThread]: 
[0m12:03:53.309335 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m12:03:53.309777 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m12:03:53.310215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m12:03:53.310423 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m12:03:53.324545 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m12:03:53.326467 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 12:03:53.310576 => 12:03:53.326266
[0m12:03:53.326821 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m12:03:53.359836 [info ] [Thread-1 (]: Python model materialization is incremental
[0m12:03:55.573508 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:03:55.574075 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjQyMzQsImlhdCI6MTY4NzQ2MDYzNH0.abx6yV_hVUspy1aBIVv34le1kWB9N38lODSUNds_wF0lGacCi7zNS4HEdo2iqLhHQHa-NlC162W-TWelgi-fsxSSREZIlG9_hu41vAGFUbtCeq8XysGOEIt1XySHD59KMenytupk8Biv6ewXElBmRvVFJpX-HpRgDEKUhUOSrysfcXnGS1z1_hPfrRcL8k7nn17y3NO9b9HbakPs8uTXlqZWn3oCaw2iBD6JGK_AJm0pK7ofCss0MmiwXOOyDvpmUgZg9a7lLOILi2tWBeXvbj3iFvLiAsf2opbj5j4aXMiO55fLlLrepbqazU_Zhti6G7hHFGqhVouUZzNqdKE-VQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info120353349939"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_190355 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_190355';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m12:03:55.574806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:55.575106 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:04:26.857726 [debug] [Thread-1 (]: SQL status: OK in 31.0 seconds
[0m12:04:26.861639 [info ] [Thread-1 (]: oracle adapter: OK
[0m12:04:26.871346 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:04:26.872276 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info120353349939')
        
      order by ordinal_position

  
[0m12:04:27.304544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:27.472150 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:04:27.473257 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m12:04:27.638243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:27.789347 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:04:27.790442 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m12:04:27.964211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:28.178241 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m12:04:28.179340 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:04:28.179655 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info120353349939
    )
  
[0m12:04:28.813087 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m12:04:28.829180 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m12:04:28.830083 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:04:28.830488 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m12:04:28.976793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:28.984242 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:04:28.985127 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info120353349939
[0m12:04:29.177930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:29.191890 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m12:04:29.192791 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info120353349939 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m12:04:29.344327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:29.356254 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 12:03:53.327015 => 12:04:29.356059
[0m12:04:29.356812 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m12:04:29.482129 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m12:04:29.618178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95be8cba-d275-4790-8c0c-58851fed61eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106515250>]}
[0m12:04:29.620365 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 36.31s]
[0m12:04:29.621328 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m12:04:29.622573 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m12:04:29.623877 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m12:04:29.625140 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m12:04:29.625636 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m12:04:29.630824 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m12:04:29.632657 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 12:04:29.625991 => 12:04:29.632376
[0m12:04:29.633229 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m12:04:29.643598 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m12:04:29.643980 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m12:04:29.645508 [info ] [Thread-3 (]: Python model materialization is table
[0m12:04:29.645840 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m12:04:31.900264 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m12:04:31.902344 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjQyNzAsImlhdCI6MTY4NzQ2MDY3MH0.pWSTlvR9tRV_gK5pOiUlaVYh2lEz7Fe4ebjRS1vFFiLTKUqYYvKWHZMd0eT3aq77RRZDBrQhenuAc0wwHuaJNz-Qs_6ZFbcPWL3SsslVAsbAv9Xpuwv3-V5vt2PLwsXAYAeu2sLPWNo8jSZDpNzThjK7ByM5TF-UctfUxUKdfB3Ti2Q2eABfrnWZc026sqOjGzLIr0yHG4YBqVmBiVB3RIibZS9U1HttxcMXqVkBJAo4xjXtQvYR4dKIExwYzcr1cxSXAOwtesD_FFe4CdA7Y_X8_BzQMaRNBHE3j8KgZqFB6BKMKVEddFoiE7u0m9GNbWss2Rt0FRdHIIjZbV3HBg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df["PRICE"]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Prices": X_test})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_190431 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_190431';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m12:04:31.904103 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:04:31.904798 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:04:58.387653 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"Expected 2D array, got 1D array instead:\narray=[270. 980. 210. ... 450. 380. 210.].\nReshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 70, in model\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 969, in fit\n    super().fit(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 172, in fit\n    X, y = self._validate_data(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/base.py\", line 591, in _validate_data\n    X = check_array(X, input_name=\"X\", **check_X_params)\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/utils/validation.py\", line 879, in check_array\n    raise ValueError(\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 104
[0m12:04:58.390557 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m12:04:58.548940 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 12:04:29.633625 => 12:04:58.547556
[0m12:04:58.560959 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"Expected 2D array, got 1D array instead:\narray=[270. 980. 210. ... 450. 380. 210.].\nReshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 70, in model\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 969, in fit\n    super().fit(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 172, in fit\n    X, y = self._validate_data(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/base.py\", line 591, in _validate_data\n    X = check_array(X, input_name=\"X\", **check_X_params)\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/utils/validation.py\", line 879, in check_array\n    raise ValueError(\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 104
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m12:04:58.563748 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95be8cba-d275-4790-8c0c-58851fed61eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d0090>]}
[0m12:04:58.564458 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 28.94s]
[0m12:04:58.565042 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m12:04:58.567023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:04:58.567579 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m12:05:00.903403 [debug] [MainThread]: On master: COMMIT
[0m12:05:00.905830 [debug] [MainThread]: Using oracle connection "master"
[0m12:05:00.906911 [debug] [MainThread]: On master: COMMIT
[0m12:05:01.084301 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:05:01.085734 [debug] [MainThread]: On master: Close
[0m12:05:01.244444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:01.245913 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m12:05:01.246541 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m12:05:01.247136 [info ] [MainThread]: 
[0m12:05:01.247637 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 19.63 seconds (79.63s).
[0m12:05:01.248743 [debug] [MainThread]: Command end result
[0m12:05:01.262926 [info ] [MainThread]: 
[0m12:05:01.263366 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:05:01.263526 [info ] [MainThread]: 
[0m12:05:01.263681 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m12:05:01.263968 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"Expected 2D array, got 1D array instead:\narray=[270. 980. 210. ... 450. 380. 210.].\nReshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 70, in model\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 969, in fit\n    super().fit(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 172, in fit\n    X, y = self._validate_data(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/base.py\", line 591, in _validate_data\n    X = check_array(X, input_name=\"X\", **check_X_params)\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/utils/validation.py\", line 879, in check_array\n    raise ValueError(\n"}
[0m12:05:01.264302 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m12:05:01.264455 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m12:05:01.264591 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m12:05:01.264720 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m12:05:01.264902 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m12:05:01.265122 [error] [MainThread]:   ORA-06512: at line 104
[0m12:05:01.265337 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m12:05:01.265565 [info ] [MainThread]: 
[0m12:05:01.265833 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m12:05:01.266327 [debug] [MainThread]: Command `dbt run` failed at 12:05:01.266253 after 79.84 seconds
[0m12:05:01.266700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102644e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102647910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0f310>]}
[0m12:05:01.267040 [debug] [MainThread]: Flushing usage events
[0m13:12:54.292571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b17e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b17fd0>]}


============================== 13:12:54.295212 | 169e7553-3f85-416d-9c34-6a1a317bd156 ==============================
[0m13:12:54.295212 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:12:54.295551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:12:54.363120 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:12:54.387234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '169e7553-3f85-416d-9c34-6a1a317bd156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b29dd0>]}
[0m13:12:54.393474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '169e7553-3f85-416d-9c34-6a1a317bd156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103cd450>]}
[0m13:12:54.426098 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:12:54.473111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:12:54.473540 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m13:12:54.493870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '169e7553-3f85-416d-9c34-6a1a317bd156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103adad0>]}
[0m13:12:54.501602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '169e7553-3f85-416d-9c34-6a1a317bd156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110433250>]}
[0m13:12:54.501929 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:12:54.502111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '169e7553-3f85-416d-9c34-6a1a317bd156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103eca50>]}
[0m13:12:54.502882 [info ] [MainThread]: 
[0m13:12:54.503266 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:12:54.503793 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:12:54.508740 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:12:54.509038 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:12:54.509218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:54.509396 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:12:56.670087 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:12:56.799736 [debug] [ThreadPool]: On list_None: Close
[0m13:12:56.927613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:12:56.934843 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:12:56.935350 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:12:56.935610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:56.935886 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:12:58.361578 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m13:12:58.373742 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:12:58.374697 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:12:59.113125 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m13:12:59.366885 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:12:59.499744 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:12:59.647094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '169e7553-3f85-416d-9c34-6a1a317bd156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105e7990>]}
[0m13:12:59.647965 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:59.648366 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:13:01.126600 [debug] [MainThread]: On master: COMMIT
[0m13:13:01.128506 [debug] [MainThread]: Using oracle connection "master"
[0m13:13:01.129108 [debug] [MainThread]: On master: COMMIT
[0m13:13:01.248444 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:13:01.253044 [debug] [MainThread]: On master: Close
[0m13:13:01.366504 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:01.367467 [info ] [MainThread]: 
[0m13:13:01.373872 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:13:01.374721 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:13:01.375663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:13:01.376133 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:13:01.399425 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:13:01.403007 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:13:01.376454 => 13:13:01.402785
[0m13:13:01.403416 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:13:01.433054 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:13:04.237268 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:13:04.238711 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjgzODIsImlhdCI6MTY4NzQ2NDc4Mn0.ONY_3ccsy4iaY1tRKci2k9YCuKpSA6tLYgzunEBzicSGWZXBv36W9xpPtGSgqutO7z_Qj6hqjm8SZ-DmS9QhrE0yClVGMn2EaxZq7_3F25pzv-cN76dhrN1BSIZJNCZbhuKqmldItHggeTAu8omr_T4exzmMIbyQ5FiBKy2BumnJRJWgSgVWcGXBKB-TmfpvPeqwIY_ed2CDUZzmjxxDcEH4tW8thdOFRtDS_w_-f0DhtASnCAuWvtybpHkBlcB7BC4TR5y1rrWItyl7mWIZLP82BEhl7JNpQYExAoJAs0SsG5y9foiGBcskANom7OkL6x9khpNeD9ceXNeOJb19JQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info131301423769"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_201304 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_201304';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:13:04.240166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:04.240786 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:13:36.355227 [debug] [Thread-1 (]: SQL status: OK in 32.0 seconds
[0m13:13:36.359069 [info ] [Thread-1 (]: oracle adapter: OK
[0m13:13:36.368261 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:13:36.369175 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info131301423769')
        
      order by ordinal_position

  
[0m13:13:36.709898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:13:36.837369 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:13:36.838460 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:13:37.032993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:13:37.157721 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:13:37.158737 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:13:37.354722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:13:37.485492 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m13:13:37.488003 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:13:37.488374 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info131301423769
    )
  
[0m13:13:38.108756 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:13:38.122400 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:13:38.123294 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:13:38.123738 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:13:38.232975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:13:38.243697 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:13:38.244575 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info131301423769
[0m13:13:38.429047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:13:38.439768 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:13:38.440611 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info131301423769 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:13:38.577975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:13:38.594427 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:13:01.403648 => 13:13:38.594197
[0m13:13:38.595310 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m13:13:38.705082 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:13:38.821993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '169e7553-3f85-416d-9c34-6a1a317bd156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b49150>]}
[0m13:13:38.823283 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 37.45s]
[0m13:13:38.824037 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:13:38.825266 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:13:38.826292 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:13:38.827272 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m13:13:38.827744 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:13:38.833045 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:13:38.835399 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:13:38.828310 => 13:13:38.835086
[0m13:13:38.835981 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:13:38.851187 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m13:13:38.851682 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m13:13:38.853752 [info ] [Thread-3 (]: Python model materialization is table
[0m13:13:38.854211 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:13:40.980160 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:13:40.981608 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Njg0MTksImlhdCI6MTY4NzQ2NDgxOX0.E6lw2MMf3L7uuRHDwtNBSFRe-9EV76HiRS1hYjJgKbUmpWvKrryMjnG_eGzXk5PUIOG_0IFPmRig_gTeTzs88GFz7nydohGlC5yMl0GFOsN59O-ccFC23OiZtXyCpERH-JSsR47BUuEsdICf9YHlz7kw4IU26yOrBl7ImZk1Y9lCBY6p_evZFxl9YlxgHMESokrIQ-h3YjPqPm-HBH0o_JLbGizkPw9GgEZeDLsT5eYv6of2-C8to9N16C5Y0-QK1_FLze2ez-JrJaF7lCx6jvodutfG3ElCWYn4rib525ezA8phbB4MEZl-4TJv6BZXQHmFuuhLtzJZZOSs6_T1FA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test)})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_201340 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_201340';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:13:40.982982 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:13:40.983556 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:14:07.122310 [debug] [Thread-3 (]: SQL status: OK in 26.0 seconds
[0m13:14:07.125943 [info ] [Thread-3 (]: oracle adapter: OK
[0m13:14:07.132735 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:14:07.133345 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m13:14:07.266771 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:07.274678 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:14:07.275529 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m13:14:07.411034 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:07.419454 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m13:14:07.420284 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:14:07.420827 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m13:14:07.522284 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:07.530892 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:14:07.531839 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:14:07.690368 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:07.697649 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:13:38.836315 => 13:14:07.697430
[0m13:14:07.698378 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m13:14:07.808715 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '169e7553-3f85-416d-9c34-6a1a317bd156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106a8b90>]}
[0m13:14:07.810181 [info ] [Thread-3 (]: 2 of 2 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 28.98s]
[0m13:14:07.811033 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:14:07.813515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:07.814083 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:14:09.221620 [debug] [MainThread]: On master: COMMIT
[0m13:14:09.223583 [debug] [MainThread]: Using oracle connection "master"
[0m13:14:09.224588 [debug] [MainThread]: On master: COMMIT
[0m13:14:09.326709 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:14:09.329061 [debug] [MainThread]: On master: Close
[0m13:14:09.434153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:09.435205 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:14:09.435684 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:14:09.436377 [info ] [MainThread]: 
[0m13:14:09.437230 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 14.93 seconds (74.93s).
[0m13:14:09.438334 [debug] [MainThread]: Command end result
[0m13:14:09.463316 [info ] [MainThread]: 
[0m13:14:09.463957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:09.464238 [info ] [MainThread]: 
[0m13:14:09.464530 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:14:09.465159 [debug] [MainThread]: Command `dbt run` succeeded at 13:14:09.465061 after 75.19 seconds
[0m13:14:09.465587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102916910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102916510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a7ac50>]}
[0m13:14:09.465965 [debug] [MainThread]: Flushing usage events
[0m13:20:00.638929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105117f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105117fd0>]}


============================== 13:20:00.641901 | 37464b43-867c-4fd6-9bb9-b541e53bd2f4 ==============================
[0m13:20:00.641901 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:20:00.642330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:20:00.694678 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:20:00.717533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37464b43-867c-4fd6-9bb9-b541e53bd2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105128ad0>]}
[0m13:20:00.723792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37464b43-867c-4fd6-9bb9-b541e53bd2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512a0d0>]}
[0m13:20:00.771237 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:20:00.839014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:00.839512 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m13:20:00.860809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37464b43-867c-4fd6-9bb9-b541e53bd2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059db4d0>]}
[0m13:20:00.868998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37464b43-867c-4fd6-9bb9-b541e53bd2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588de10>]}
[0m13:20:00.869391 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:20:00.869592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37464b43-867c-4fd6-9bb9-b541e53bd2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517dcd0>]}
[0m13:20:00.870405 [info ] [MainThread]: 
[0m13:20:00.870828 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:20:00.871412 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:20:00.876413 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:20:00.876655 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:20:00.876824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:00.876995 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:20:02.629233 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:20:02.738013 [debug] [ThreadPool]: On list_None: Close
[0m13:20:02.844690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:20:02.851774 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:20:02.852303 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:20:02.852722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:02.853187 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:20:04.298019 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m13:20:04.309162 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:20:04.309859 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:20:04.437151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:20:04.647520 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:20:04.752389 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:20:04.866583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37464b43-867c-4fd6-9bb9-b541e53bd2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a82e10>]}
[0m13:20:04.867730 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:04.868515 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:20:06.219077 [debug] [MainThread]: On master: COMMIT
[0m13:20:06.221556 [debug] [MainThread]: Using oracle connection "master"
[0m13:20:06.222573 [debug] [MainThread]: On master: COMMIT
[0m13:20:06.328604 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:20:06.332275 [debug] [MainThread]: On master: Close
[0m13:20:06.445041 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:20:06.446019 [info ] [MainThread]: 
[0m13:20:06.456728 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:20:06.457635 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:20:06.458331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:20:06.458670 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:20:06.480224 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:20:06.481474 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:20:06.458912 => 13:20:06.481324
[0m13:20:06.481789 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:20:06.511641 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:20:10.312919 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:20:10.314343 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Njg4MDksImlhdCI6MTY4NzQ2NTIwOX0.Jcn5-ydhakG2mHvJP_vJHosrdX3JGAJIPsZs-dQYnZzW8mXaz2n3Bc93YtF4f4wCw0lA0Z8eqlalAsZBQzHuupuRJ6V3MhustJGkWj31-ZEx4KboZnfBU4y7Kn6dggewu2uiVxy3Fw3vCW4afKcg-q7PmsCMYEeDUDvKM865FowLzl4p0OMu0S8png4yPptDpJrVRUHAy8iO3ktrGrCZt6mUVK7fQ0GA78pHNMkYBWqT6lPBgSJ_NILIDrUOL_hHqr9IJnIRvHNsaTo9NxX_UJTFjq0cKOqWLNxPQrJ1XWNRAYuxyVIY7NVjgRQKh2ITLiT2RpDhWRz7p6WI0Wu0PQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info132006502401"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_202010 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_202010';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:20:10.315892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:10.316485 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:20:42.387533 [debug] [Thread-1 (]: SQL status: OK in 32.0 seconds
[0m13:20:42.391533 [info ] [Thread-1 (]: oracle adapter: OK
[0m13:20:42.400934 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:20:42.402093 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info132006502401')
        
      order by ordinal_position

  
[0m13:20:42.709676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:42.833745 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:20:42.834759 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:20:42.980870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:43.105210 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:20:43.106084 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:20:43.243063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:43.392870 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m13:20:43.405610 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:20:43.406287 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info132006502401
    )
  
[0m13:20:44.026640 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:20:44.039529 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:20:44.040466 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:20:44.040899 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:20:44.185604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:44.196761 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:20:44.197659 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info132006502401
[0m13:20:44.402395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:44.411462 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:20:44.412436 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info132006502401 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:20:44.572615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:44.589168 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:20:06.482124 => 13:20:44.588967
[0m13:20:44.589787 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m13:20:44.701091 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:20:44.813629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37464b43-867c-4fd6-9bb9-b541e53bd2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b23f90>]}
[0m13:20:44.817405 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 38.35s]
[0m13:20:44.818799 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:20:44.820821 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:20:44.821693 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:20:44.822706 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m13:20:44.823321 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:20:44.828587 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:20:44.849479 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:20:44.823745 => 13:20:44.849056
[0m13:20:44.850100 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:20:44.864489 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m13:20:44.864976 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m13:20:44.867068 [info ] [Thread-3 (]: Python model materialization is table
[0m13:20:44.867532 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:20:47.205630 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:20:47.207142 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Njg4NDUsImlhdCI6MTY4NzQ2NTI0NX0.oj5aMLuIDbJVuoaFRQ18Xcr3UYjM7Bzu-SCXABLMChtlioA47cG4Ugd2OpHb2lC1rpVBLMTDfcoAeB-R_5oI22BbAnQqiGL2Iy2CMMVbYgcHupqXn00nbdKiMxrGUz4S35hSucoyOm67OP5db_U3FmyURwfORhs4sd7i2bUz9MGhLyprOGDdzPmJBzohuBE7krKmLpuvfgql77SuJgyjVTFXpmByRironG2Bor1IptQYTbs18c43JSeWLluAShN2gWKxa0-FkDDkM8_JzwtCV0J8R-kR0DtEFSRItoXevRTrFZCSumoP53ei3jzi4PUdZ1BjsyOHZQedgOdU-1B3dw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df["PRICE"]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test)})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_202047 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_202047';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:20:47.208743 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:20:47.209415 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:21:14.040236 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"Expected 2D array, got 1D array instead:\narray=[670.   660.    93.87 ... 450.   380.   210.  ].\nReshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 70, in model\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 969, in fit\n    super().fit(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 172, in fit\n    X, y = self._validate_data(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/base.py\", line 591, in _validate_data\n    X = check_array(X, input_name=\"X\", **check_X_params)\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/utils/validation.py\", line 879, in check_array\n    raise ValueError(\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 104
[0m13:21:14.042722 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m13:21:14.168900 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:20:44.850357 => 13:21:14.167950
[0m13:21:14.187413 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"Expected 2D array, got 1D array instead:\narray=[670.   660.    93.87 ... 450.   380.   210.  ].\nReshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 70, in model\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 969, in fit\n    super().fit(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 172, in fit\n    X, y = self._validate_data(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/base.py\", line 591, in _validate_data\n    X = check_array(X, input_name=\"X\", **check_X_params)\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/utils/validation.py\", line 879, in check_array\n    raise ValueError(\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 104
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:21:14.190492 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37464b43-867c-4fd6-9bb9-b541e53bd2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105144510>]}
[0m13:21:14.191373 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 29.37s]
[0m13:21:14.191994 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:21:14.193900 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:14.194375 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:21:15.592673 [debug] [MainThread]: On master: COMMIT
[0m13:21:15.594542 [debug] [MainThread]: Using oracle connection "master"
[0m13:21:15.595184 [debug] [MainThread]: On master: COMMIT
[0m13:21:15.704884 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:21:15.705498 [debug] [MainThread]: On master: Close
[0m13:21:15.816480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:15.817395 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:21:15.817852 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:21:15.818380 [info ] [MainThread]: 
[0m13:21:15.818859 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 14.95 seconds (74.95s).
[0m13:21:15.819769 [debug] [MainThread]: Command end result
[0m13:21:15.849334 [info ] [MainThread]: 
[0m13:21:15.849993 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:21:15.850309 [info ] [MainThread]: 
[0m13:21:15.850766 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m13:21:15.851580 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"Expected 2D array, got 1D array instead:\narray=[670.   660.    93.87 ... 450.   380.   210.  ].\nReshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 70, in model\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 969, in fit\n    super().fit(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 172, in fit\n    X, y = self._validate_data(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/base.py\", line 591, in _validate_data\n    X = check_array(X, input_name=\"X\", **check_X_params)\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/utils/validation.py\", line 879, in check_array\n    raise ValueError(\n"}
[0m13:21:15.852185 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m13:21:15.852553 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m13:21:15.852828 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:21:15.853100 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:21:15.853373 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:21:15.853616 [error] [MainThread]:   ORA-06512: at line 104
[0m13:21:15.853849 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:21:15.854100 [info ] [MainThread]: 
[0m13:21:15.854397 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:21:15.855281 [debug] [MainThread]: Command `dbt run` failed at 13:21:15.855126 after 75.24 seconds
[0m13:21:15.855788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100fa6c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100fa4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f7310>]}
[0m13:21:15.856209 [debug] [MainThread]: Flushing usage events
[0m13:23:00.290039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10710bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107117fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107117810>]}


============================== 13:23:00.292519 | a97b3cda-2d9f-4136-bf0d-b9deada90a31 ==============================
[0m13:23:00.292519 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:23:00.292851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:23:00.357454 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:23:00.379890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a97b3cda-2d9f-4136-bf0d-b9deada90a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107128a90>]}
[0m13:23:00.386029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a97b3cda-2d9f-4136-bf0d-b9deada90a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f151d0>]}
[0m13:23:00.425259 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:23:00.471706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:23:00.472139 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m13:23:00.492769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a97b3cda-2d9f-4136-bf0d-b9deada90a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11027eb10>]}
[0m13:23:00.504310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a97b3cda-2d9f-4136-bf0d-b9deada90a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c1550>]}
[0m13:23:00.504719 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:23:00.504908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a97b3cda-2d9f-4136-bf0d-b9deada90a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715c150>]}
[0m13:23:00.505723 [info ] [MainThread]: 
[0m13:23:00.506126 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:23:00.506675 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:23:00.511549 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:23:00.511768 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:23:00.511935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:00.512105 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:23:02.079004 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:23:02.183066 [debug] [ThreadPool]: On list_None: Close
[0m13:23:02.290421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:23:02.297492 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:23:02.298034 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:23:02.298322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:02.298616 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:23:03.688995 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m13:23:03.697762 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:23:03.698169 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:23:03.822950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:23:04.039863 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:23:04.143631 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:23:04.274713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a97b3cda-2d9f-4136-bf0d-b9deada90a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110326e10>]}
[0m13:23:04.275525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:23:04.276048 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:23:05.964883 [debug] [MainThread]: On master: COMMIT
[0m13:23:05.967817 [debug] [MainThread]: Using oracle connection "master"
[0m13:23:05.968571 [debug] [MainThread]: On master: COMMIT
[0m13:23:06.117509 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:23:06.119596 [debug] [MainThread]: On master: Close
[0m13:23:06.275313 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:23:06.277210 [info ] [MainThread]: 
[0m13:23:06.314326 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:23:06.314998 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:23:06.315783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:23:06.316153 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:23:06.337855 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:23:06.339029 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:23:06.316402 => 13:23:06.338870
[0m13:23:06.339362 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:23:06.369370 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:23:11.512243 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:23:11.513383 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Njg5ODgsImlhdCI6MTY4NzQ2NTM4OH0.GObEobFQg3YfGZWWN0HXxz65b0WJ2jxc3U1_Z-Broaz8LMQGooMpELxN6L8of675pOzYjueIKWUCsQFlBp00M_PHFu7TfYcGPoyoA2lXq-mrfxZhPXT55U5K2T0IfIodAxviDbIj7w4DYjOyRW0nN4btCWO9vrC5F2vYAVq5xv2EQkf_GbcnyEBMu2NmBoFTgs_JKeJ8_ZqoVF_qxUdKTrjGl8DjBsb6u8qApouWB3_UV2nRwp_MaV__nWudsDSPG9AmxqOb9AX73YVx4KspLL7FaY9Yn4k6KPstuwsiFc0PhUC9rFkiCXXYeZlgsSjcRA-JsKeUfsuUf4ogPythHw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info132306360282"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_202311 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_202311';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:23:11.514787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:11.515520 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:23:44.356946 [debug] [Thread-1 (]: SQL status: OK in 33.0 seconds
[0m13:23:44.361207 [info ] [Thread-1 (]: oracle adapter: OK
[0m13:23:44.371318 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:23:44.372214 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info132306360282')
        
      order by ordinal_position

  
[0m13:23:44.639725 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:23:44.756790 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:23:44.757887 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:23:44.889659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:23:45.005284 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:23:45.006191 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:23:45.142512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:23:45.275246 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m13:23:45.277530 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:23:45.277936 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info132306360282
    )
  
[0m13:23:45.904220 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:23:45.918748 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:23:45.919573 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:23:45.920026 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:23:46.041957 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:23:46.051949 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:23:46.052784 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info132306360282
[0m13:23:46.240415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:23:46.251847 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:23:46.252727 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info132306360282 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:23:46.409513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:23:46.426669 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:23:06.339581 => 13:23:46.426472
[0m13:23:46.427279 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m13:23:46.541607 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:23:46.659497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a97b3cda-2d9f-4136-bf0d-b9deada90a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103bab10>]}
[0m13:23:46.661978 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 40.34s]
[0m13:23:46.663051 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:23:46.664336 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:23:46.665474 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:23:46.666350 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m13:23:46.666768 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:23:46.671456 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:23:46.706736 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:23:46.667046 => 13:23:46.706315
[0m13:23:46.707427 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:23:46.721583 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m13:23:46.722177 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m13:23:46.724445 [info ] [Thread-3 (]: Python model materialization is table
[0m13:23:46.724814 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:23:48.908528 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:23:48.910336 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjkwMjcsImlhdCI6MTY4NzQ2NTQyN30.MlxLK7sSTVNEDORnKDSLrQbu1wQuads8EhDO1_RCD7-jk0xt6KKVZdETOfWP5_s1J-2FsX7pDd1EzKdnEIOeF_Mkknz8oWFzXTIOrVRBmVA-a2-KeL-XvZr0FFE1iLO5D6f-zYNAQicEUgbvNreGfmKyVLH-oe55FwccQB2RJ9X6-pn5X02G489Hmdi67KWfDSUaetuycMrIEoRHlfcHvZEsZsieEtTcs96VU-nC-0iX9L3aANoV1VkNKgcNy-22Uts0b9qMTHIJLsHbFDbcG1wyHC5WUPeeruJgIL_3uQ-gU4hSAgfA898hO8vXrn7EmHgppw5U7spnX0Od9j_K5w!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test)})
    
        return pd.concat([res_df, X_test])





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_202348 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_202348';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:23:48.912106 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:23:48.912575 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:24:19.982177 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"Cannot determine a default type for column(s) \"Shipping_City_Prediction\", \"Shipping_City_Actual\". Use argument 'dbtypes' to explicitly set them. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 740, in oml.core.methods.__create\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 104
[0m13:24:19.983529 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m13:24:20.134171 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:23:46.707722 => 13:24:20.133191
[0m13:24:20.145689 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"Cannot determine a default type for column(s) \"Shipping_City_Prediction\", \"Shipping_City_Actual\". Use argument 'dbtypes' to explicitly set them. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 740, in oml.core.methods.__create\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 104
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:24:20.147666 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a97b3cda-2d9f-4136-bf0d-b9deada90a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a04bd0>]}
[0m13:24:20.148285 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 33.48s]
[0m13:24:20.148909 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:24:20.150377 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:24:20.150730 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:24:22.136321 [debug] [MainThread]: On master: COMMIT
[0m13:24:22.138549 [debug] [MainThread]: Using oracle connection "master"
[0m13:24:22.139195 [debug] [MainThread]: On master: COMMIT
[0m13:24:22.267518 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:24:22.270315 [debug] [MainThread]: On master: Close
[0m13:24:22.431612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:22.432283 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:24:22.432535 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:24:22.432858 [info ] [MainThread]: 
[0m13:24:22.433143 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 21.93 seconds (81.93s).
[0m13:24:22.433803 [debug] [MainThread]: Command end result
[0m13:24:22.446164 [info ] [MainThread]: 
[0m13:24:22.446519 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:24:22.446703 [info ] [MainThread]: 
[0m13:24:22.446885 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m13:24:22.447095 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"Cannot determine a default type for column(s) \"Shipping_City_Prediction\", \"Shipping_City_Actual\". Use argument 'dbtypes' to explicitly set them. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 740, in oml.core.methods.__create\n"}
[0m13:24:22.447301 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m13:24:22.447467 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m13:24:22.447629 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:24:22.447784 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:24:22.447942 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:24:22.448100 [error] [MainThread]:   ORA-06512: at line 104
[0m13:24:22.448258 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:24:22.448427 [info ] [MainThread]: 
[0m13:24:22.448629 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:24:22.449078 [debug] [MainThread]: Command `dbt run` failed at 13:24:22.448994 after 82.18 seconds
[0m13:24:22.449405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fe2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fe0e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101abd90>]}
[0m13:24:22.449680 [debug] [MainThread]: Flushing usage events
[0m13:27:23.935030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104717cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104717f90>]}


============================== 13:27:23.937458 | bdf035a6-6ade-45b3-a1de-b14ca91b77fd ==============================
[0m13:27:23.937458 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:27:23.937793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:27:23.990786 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:27:24.011712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdf035a6-6ade-45b3-a1de-b14ca91b77fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104728390>]}
[0m13:27:24.017793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdf035a6-6ade-45b3-a1de-b14ca91b77fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104717050>]}
[0m13:27:24.056112 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:27:24.103133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:27:24.103553 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m13:27:24.124213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdf035a6-6ade-45b3-a1de-b14ca91b77fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509bf10>]}
[0m13:27:24.133791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdf035a6-6ade-45b3-a1de-b14ca91b77fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105102790>]}
[0m13:27:24.134129 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:27:24.134317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdf035a6-6ade-45b3-a1de-b14ca91b77fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051025d0>]}
[0m13:27:24.135128 [info ] [MainThread]: 
[0m13:27:24.135546 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:27:24.136100 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:27:24.140861 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:27:24.141072 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:27:24.141235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:24.141406 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:27:25.964096 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:27:26.072889 [debug] [ThreadPool]: On list_None: Close
[0m13:27:26.213089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:27:26.220987 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:27:26.221660 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:27:26.222088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:26.222499 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:27:27.620560 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m13:27:27.632355 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:27:27.633114 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:27:27.758825 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:27:27.969204 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:27:28.071370 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:27:28.196491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdf035a6-6ade-45b3-a1de-b14ca91b77fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fac750>]}
[0m13:27:28.197585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:28.198068 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:27:29.477341 [debug] [MainThread]: On master: COMMIT
[0m13:27:29.479917 [debug] [MainThread]: Using oracle connection "master"
[0m13:27:29.480454 [debug] [MainThread]: On master: COMMIT
[0m13:27:29.586821 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:27:29.589534 [debug] [MainThread]: On master: Close
[0m13:27:29.701960 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:27:29.702974 [info ] [MainThread]: 
[0m13:27:30.340573 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:27:30.342445 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:27:30.343734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:27:30.344348 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:27:30.368821 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:27:30.371270 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:27:30.344751 => 13:27:30.371101
[0m13:27:30.371625 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:27:30.406254 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:27:32.830656 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:27:32.831947 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjkyNTEsImlhdCI6MTY4NzQ2NTY1MX0.GdJ8hM19zGLYmOaWZne34raCjDjJEukCoObpy9GJ_UJaJm2z4lhReI5f5DNSPqNaDw4gjHfANMRh--71nlCSPgH5fZnM8FPyLmO7fxoZXuKXsBVq_xXXrFezC6UDI4NgDPDkwKv6-kTbBfum6Q-ahArbKTQVGN9OyyJJTw8HUeytefH7FGJgfzq9QDC_lQltdu31EXdKfs6MD1rlM6sQwU_7XU1HkNwCRB-kvAXXT2JAwk6iNMvK8ZcAOrDcOiKrg36s-5Najwi-HcR-vnTUbFN7Ed22MRec3jLzODj-Oi4avqs5kNE-aqW2zKZ3mSJVDwOBsqPuhBQIM8TWj5TfGw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info132730397102"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_202732 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_202732';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:27:32.833567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:32.834267 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:27:34.127455 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m13:27:34.129564 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:27:34.238097 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:27:30.371843 => 13:27:34.235612
[0m13:27:34.256821 [debug] [Thread-1 (]: Database Error in model stg_web_order_info (models/staging/stg_web_order_info.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m13:27:34.260276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf035a6-6ade-45b3-a1de-b14ca91b77fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105260b90>]}
[0m13:27:34.261092 [error] [Thread-1 (]: 1 of 2 ERROR creating python incremental model FAWDBTCORE.stg_web_order_info ... [[31mERROR[0m in 3.92s]
[0m13:27:34.261557 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:27:34.262533 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:27:34.263061 [info ] [Thread-3 (]: 2 of 2 SKIP relation FAWDBTCORE.web_events_python .............................. [[33mSKIP[0m]
[0m13:27:34.263695 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:27:34.265581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:34.266203 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:27:35.558253 [debug] [MainThread]: On master: COMMIT
[0m13:27:35.560747 [debug] [MainThread]: Using oracle connection "master"
[0m13:27:35.561429 [debug] [MainThread]: On master: COMMIT
[0m13:27:35.666299 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:27:35.668768 [debug] [MainThread]: On master: Close
[0m13:27:35.784021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:35.785041 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:27:35.785620 [info ] [MainThread]: 
[0m13:27:35.786437 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 11.65 seconds (11.65s).
[0m13:27:35.787233 [debug] [MainThread]: Command end result
[0m13:27:35.802574 [info ] [MainThread]: 
[0m13:27:35.803205 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:27:35.803526 [info ] [MainThread]: 
[0m13:27:35.803826 [error] [MainThread]: [33mDatabase Error in model stg_web_order_info (models/staging/stg_web_order_info.py)[0m
[0m13:27:35.804120 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m13:27:35.804390 [info ] [MainThread]: 
[0m13:27:35.804701 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m13:27:35.805378 [debug] [MainThread]: Command `dbt run` failed at 13:27:35.805276 after 11.89 seconds
[0m13:27:35.805837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100642c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100640e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb6ed0>]}
[0m13:27:35.806254 [debug] [MainThread]: Flushing usage events
[0m13:29:00.138310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f0bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f17e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f17fd0>]}


============================== 13:29:00.140969 | 24c10dbb-727d-44b2-bf06-b9decccee1ce ==============================
[0m13:29:00.140969 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:29:00.141321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:29:00.217564 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:29:00.250740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24c10dbb-727d-44b2-bf06-b9decccee1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ef4a90>]}
[0m13:29:00.257189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24c10dbb-727d-44b2-bf06-b9decccee1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217cd750>]}
[0m13:29:00.291607 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:29:00.334193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:29:00.334490 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:29:00.338096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24c10dbb-727d-44b2-bf06-b9decccee1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fcadd0>]}
[0m13:29:00.343572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24c10dbb-727d-44b2-bf06-b9decccee1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f09b50>]}
[0m13:29:00.343852 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:29:00.344032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24c10dbb-727d-44b2-bf06-b9decccee1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217b1e50>]}
[0m13:29:00.344814 [info ] [MainThread]: 
[0m13:29:00.345221 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:29:00.345851 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:29:00.350884 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:29:00.351122 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:29:00.351295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:00.351462 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:29:02.155424 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:29:02.282402 [debug] [ThreadPool]: On list_None: Close
[0m13:29:02.401976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:29:02.410296 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:29:02.410986 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:29:02.411340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:02.411704 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:29:03.874627 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m13:29:03.887547 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:29:03.888438 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:29:04.025143 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:29:04.237918 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:29:04.341911 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:29:04.455946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24c10dbb-727d-44b2-bf06-b9decccee1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120782810>]}
[0m13:29:04.456750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:04.457134 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:29:05.759776 [debug] [MainThread]: On master: COMMIT
[0m13:29:05.761826 [debug] [MainThread]: Using oracle connection "master"
[0m13:29:05.762596 [debug] [MainThread]: On master: COMMIT
[0m13:29:05.865761 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:29:05.867885 [debug] [MainThread]: On master: Close
[0m13:29:05.976218 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:29:05.977193 [info ] [MainThread]: 
[0m13:29:05.983840 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:29:05.984708 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:29:05.985580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:29:05.986041 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:29:06.011235 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:29:06.012364 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:29:05.986363 => 13:29:06.012219
[0m13:29:06.012671 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:29:06.038823 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:29:08.265663 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:29:08.267067 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjkzNDYsImlhdCI6MTY4NzQ2NTc0Nn0.iE3xaBzt_NGt37vUq6t2_IweFrXjGwSJskF4anITBynM211P73IMyXHTZht-Tc_A08RrpVJ7Ouy3kG6ObQA2vHH4N_LjZl9LFbQtPKhxFkLBbUlpuFVK3ALBRu9LmW7UincHvmiRLs2QfBG02OKq2kp6-N0IGzy_mwmeht-3CFml9bCyLYwjM2UrrYOemuDyzu6xTHaBg6V-GZmbQgVr4TbklfoqUkqkF_HYLsGRFY3dHbf-xue9OJi6DglfrBi16s5GJYDk4B0dJGdlVfgARx3qECTXFkKY72qvpiS1XzY-tC6GtH0r7HFI5EKGBBdqvYuJrigo3_dxAhJQpcm0Aw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info132906032536"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_202908 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_202908';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:29:08.268489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:08.269041 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:29:39.696204 [debug] [Thread-1 (]: SQL status: OK in 31.0 seconds
[0m13:29:39.700836 [info ] [Thread-1 (]: oracle adapter: OK
[0m13:29:39.711801 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:29:39.712714 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info132906032536')
        
      order by ordinal_position

  
[0m13:29:40.001605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:29:40.121164 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:29:40.122227 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:29:40.328388 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:29:40.443230 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:29:40.443903 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:29:40.637880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:29:40.767998 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m13:29:40.769316 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:29:40.769660 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info132906032536
    )
  
[0m13:29:41.414175 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:29:41.428024 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:29:41.428721 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:29:41.429166 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:29:41.541007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:29:41.551822 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:29:41.552325 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info132906032536
[0m13:29:41.733794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:29:41.747571 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:29:41.748450 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info132906032536 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:29:41.928379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:29:41.946358 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:29:06.012943 => 13:29:41.946127
[0m13:29:41.947030 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m13:29:42.055125 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:29:42.166119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24c10dbb-727d-44b2-bf06-b9decccee1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12224cad0>]}
[0m13:29:42.168363 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 36.18s]
[0m13:29:42.168969 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:29:42.169723 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:29:42.170091 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:29:42.170778 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m13:29:42.171147 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:29:42.174256 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:29:42.175182 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:29:42.171327 => 13:29:42.175086
[0m13:29:42.175383 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:29:42.187305 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m13:29:42.187896 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m13:29:42.190281 [info ] [Thread-3 (]: Python model materialization is table
[0m13:29:42.190675 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:29:44.515309 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:29:44.516359 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NjkzODMsImlhdCI6MTY4NzQ2NTc4M30.SM6eKfyRMksDg1lHSk0l3WaqLSLSmC0YpE63u0M9bHbN-e6tXOUg3F9rmRSGQuAuhUUOvdtRKNamKHh8tQyBqeYBQGnl1Wm2WSJwyDy6XGnIx2Hm2U0gwG2TVSO5v203OcjhTG1gHbtrzIgjgGmXHt-2ysq7Z85n9jdgv3AAS-SgQCUsuTB6-34HrN6Q2hlLIgeVDWhlV2QBDQ3wHqt-q4d6wizGUoP2I-PkSJQEGTDXFuZ6Jz_xk1eqCwccYYqIn9Gj0s4HetcJVInI6VbsKjJ7vgBk78r5NhFkXssvcxENG_XVHC4pnHbygCTvsI4sJP3TGMM9mT-XvYc5r0Es-w!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test)})
    
        return df.append(res_df, ignore_index=True)





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_202944 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_202944';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:29:44.517710 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:29:44.518427 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:30:26.849605 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"Cannot determine a default type for column(s) \"PRODUCT\", \"SHIPPING_CITY\", \"CATEGORY\", \"PAYMENT_TYPE\", \"Shipping_City_Prediction\", \"Shipping_City_Actual\". Use argument 'dbtypes' to explicitly set them. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 740, in oml.core.methods.__create\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 104
[0m13:30:26.852296 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m13:30:26.965198 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:29:42.175531 => 13:30:26.963885
[0m13:30:26.982272 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"Cannot determine a default type for column(s) \"PRODUCT\", \"SHIPPING_CITY\", \"CATEGORY\", \"PAYMENT_TYPE\", \"Shipping_City_Prediction\", \"Shipping_City_Actual\". Use argument 'dbtypes' to explicitly set them. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 740, in oml.core.methods.__create\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 104
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:30:26.984184 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24c10dbb-727d-44b2-bf06-b9decccee1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222e4410>]}
[0m13:30:26.984672 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 44.81s]
[0m13:30:26.984970 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:30:26.985978 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:26.986210 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:30:28.441991 [debug] [MainThread]: On master: COMMIT
[0m13:30:28.444257 [debug] [MainThread]: Using oracle connection "master"
[0m13:30:28.445380 [debug] [MainThread]: On master: COMMIT
[0m13:30:28.548840 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:30:28.551957 [debug] [MainThread]: On master: Close
[0m13:30:28.665817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:28.666654 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:30:28.667030 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:30:28.667480 [info ] [MainThread]: 
[0m13:30:28.667880 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 28.32 seconds (88.32s).
[0m13:30:28.668728 [debug] [MainThread]: Command end result
[0m13:30:28.676862 [info ] [MainThread]: 
[0m13:30:28.677222 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:30:28.677384 [info ] [MainThread]: 
[0m13:30:28.677549 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m13:30:28.677725 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"Cannot determine a default type for column(s) \"PRODUCT\", \"SHIPPING_CITY\", \"CATEGORY\", \"PAYMENT_TYPE\", \"Shipping_City_Prediction\", \"Shipping_City_Actual\". Use argument 'dbtypes' to explicitly set them. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 740, in oml.core.methods.__create\n"}
[0m13:30:28.677974 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m13:30:28.678134 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m13:30:28.678276 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:30:28.678491 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:30:28.678655 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:30:28.678800 [error] [MainThread]:   ORA-06512: at line 104
[0m13:30:28.678941 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:30:28.679090 [info ] [MainThread]: 
[0m13:30:28.679260 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:30:28.679571 [debug] [MainThread]: Command `dbt run` failed at 13:30:28.679522 after 88.58 seconds
[0m13:30:28.679792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c74e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c74e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ef72d0>]}
[0m13:30:28.680008 [debug] [MainThread]: Flushing usage events
[0m13:31:11.645694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c08f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c17fd0>]}


============================== 13:31:11.648114 | 53a71fb7-3bb0-48c5-9372-3044f801f8af ==============================
[0m13:31:11.648114 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:31:11.648457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:31:11.692493 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:31:11.715100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53a71fb7-3bb0-48c5-9372-3044f801f8af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccb3d0>]}
[0m13:31:11.721321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53a71fb7-3bb0-48c5-9372-3044f801f8af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c86290>]}
[0m13:31:11.754228 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:31:11.786885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:31:11.787345 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m13:31:11.807567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53a71fb7-3bb0-48c5-9372-3044f801f8af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10733ae50>]}
[0m13:31:11.813896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53a71fb7-3bb0-48c5-9372-3044f801f8af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745e2d0>]}
[0m13:31:11.814263 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:31:11.814448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a71fb7-3bb0-48c5-9372-3044f801f8af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734d2d0>]}
[0m13:31:11.815228 [info ] [MainThread]: 
[0m13:31:11.815630 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:31:11.816205 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:31:11.821014 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:31:11.821247 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:31:11.821417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:11.821590 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:31:13.781166 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:31:13.941664 [debug] [ThreadPool]: On list_None: Close
[0m13:31:14.097038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:31:14.106347 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:31:14.107086 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:31:14.107525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:14.107933 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:31:15.842326 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:31:15.854549 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:31:15.855386 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:31:15.998520 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:31:16.232481 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:31:16.336054 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:31:16.458786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a71fb7-3bb0-48c5-9372-3044f801f8af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107440ad0>]}
[0m13:31:16.459433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:16.459688 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:31:17.724991 [debug] [MainThread]: On master: COMMIT
[0m13:31:17.727285 [debug] [MainThread]: Using oracle connection "master"
[0m13:31:17.728262 [debug] [MainThread]: On master: COMMIT
[0m13:31:17.833545 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:31:17.836150 [debug] [MainThread]: On master: Close
[0m13:31:17.948028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:31:17.949198 [info ] [MainThread]: 
[0m13:31:17.955498 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:31:17.956049 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:31:17.956594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:31:17.956926 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:31:17.972447 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:31:17.973786 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:31:17.957084 => 13:31:17.973602
[0m13:31:17.974079 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:31:18.002119 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:31:20.297844 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:31:20.298900 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Njk0NzksImlhdCI6MTY4NzQ2NTg3OX0.GZp9fY7YatpOXJZRwlLuQ7qikf6FKItd4KzPbgJGBshhQTPwXre3Ue-mOv2Y3y2-03fpYYCvg1GRGKxCyLrnmo0X5wCgRlmSoEzsTzxeiIi2RhTR_AJXato0BhzCnVRQoKn-C8Kux77Ms8WwaPDApHWOhsPDi2TKXFJBhoWlOaIih8kvTzqr4WaKdAuEaJLpoKwAaAS1sd_hiuRXcy_wnUT3qAw6eG9IMPlPrII0_eHeGgj16bEXbICrfWCKvlnI5WjGpP2r0Yc1EMZEcj6X2NqiAvvpyay_wy0Hl-_FeU-ph98kYjG0O5T8bWDWaL2jGlFbaPD-JE0DXXISFJX0Pw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info133117992005"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_203120 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_203120';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:31:20.300052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:20.300606 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:31:47.710790 [debug] [Thread-1 (]: SQL status: OK in 27.0 seconds
[0m13:31:47.715558 [info ] [Thread-1 (]: oracle adapter: OK
[0m13:31:47.727276 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:31:47.728214 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info133117992005')
        
      order by ordinal_position

  
[0m13:31:48.031796 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:31:48.145266 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:31:48.146255 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:31:48.277377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:31:48.395993 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:31:48.397058 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:31:48.532778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:31:48.664633 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m13:31:48.665795 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:31:48.666089 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info133117992005
    )
  
[0m13:31:49.397185 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:31:49.412830 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:31:49.413762 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:31:49.414224 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:31:49.526634 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:31:49.537513 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:31:49.538345 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info133117992005
[0m13:31:49.766282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:31:49.779435 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:31:49.780283 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info133117992005 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:31:49.934103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:31:49.950621 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:31:17.974234 => 13:31:49.950388
[0m13:31:49.951365 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m13:31:50.074412 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:31:50.208133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53a71fb7-3bb0-48c5-9372-3044f801f8af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cff90>]}
[0m13:31:50.210880 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 32.25s]
[0m13:31:50.212139 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:31:50.213554 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:31:50.214437 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:31:50.215372 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m13:31:50.215870 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:31:50.218757 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:31:50.219603 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:31:50.216046 => 13:31:50.219503
[0m13:31:50.219803 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:31:50.230044 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m13:31:50.230400 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m13:31:50.232048 [info ] [Thread-3 (]: Python model materialization is table
[0m13:31:50.232402 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:31:52.600773 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:31:52.602944 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Njk1MTEsImlhdCI6MTY4NzQ2NTkxMX0.KDsgoSa7vC2a9Fre6B0LiJxSH0LveTbWWXN5gKkDbNB9x4DWiiT0VJzQmpjpHTaqw3mgPCv8m4nl2eH_TOikPJRYJzPT4OgtYgMtK01Tpo5_z_AXgBZcU1Ao5LmroEpq0fXQoYnpc1AE2X44xy8TtTbbWpSAKH3bAWyA0bsPh21eDUWZs-hliL4nAtanzWcf1UrSBhW-iB4yNp-20h56ecveO-JQtxksGfF2ZUsNPdboANCi3ZS9sP26_mBpJk5sBuVKqR1bIdj_euPqYSKTHEj4nh3SgHu1ihk4ktG2cKOLdoICix3c8Hf9g7xIE-BAdxfdAXC_OM574TjMYal8Gg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test)})
    
        return X_test.append(res_df, ignore_index=True)





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_203152 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_203152';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:31:52.604682 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:31:52.605377 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:32:23.316472 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"Cannot determine a default type for column(s) \"Shipping_City_Prediction\", \"Shipping_City_Actual\". Use argument 'dbtypes' to explicitly set them. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 740, in oml.core.methods.__create\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 104
[0m13:32:23.319941 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m13:32:23.469989 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:31:50.219939 => 13:32:23.469585
[0m13:32:23.483194 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"Cannot determine a default type for column(s) \"Shipping_City_Prediction\", \"Shipping_City_Actual\". Use argument 'dbtypes' to explicitly set them. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 740, in oml.core.methods.__create\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 104
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:32:23.485520 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53a71fb7-3bb0-48c5-9372-3044f801f8af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c21250>]}
[0m13:32:23.486164 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 33.27s]
[0m13:32:23.486707 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:32:23.488868 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:23.489212 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:32:24.986678 [debug] [MainThread]: On master: COMMIT
[0m13:32:24.987429 [debug] [MainThread]: Using oracle connection "master"
[0m13:32:24.987701 [debug] [MainThread]: On master: COMMIT
[0m13:32:25.090981 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:32:25.093618 [debug] [MainThread]: On master: Close
[0m13:32:25.211841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:25.213314 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:32:25.213757 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:32:25.214895 [info ] [MainThread]: 
[0m13:32:25.215564 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 13.40 seconds (73.40s).
[0m13:32:25.216392 [debug] [MainThread]: Command end result
[0m13:32:25.229679 [info ] [MainThread]: 
[0m13:32:25.230195 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:32:25.230583 [info ] [MainThread]: 
[0m13:32:25.230839 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m13:32:25.231033 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"Cannot determine a default type for column(s) \"Shipping_City_Prediction\", \"Shipping_City_Actual\". Use argument 'dbtypes' to explicitly set them. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 740, in oml.core.methods.__create\n"}
[0m13:32:25.231207 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m13:32:25.231336 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m13:32:25.231471 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:32:25.231678 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:32:25.231895 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:32:25.232116 [error] [MainThread]:   ORA-06512: at line 104
[0m13:32:25.232334 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:32:25.232564 [info ] [MainThread]: 
[0m13:32:25.232835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:32:25.233445 [debug] [MainThread]: Command `dbt run` failed at 13:32:25.233349 after 73.61 seconds
[0m13:32:25.233892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c17c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c17810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025e8e10>]}
[0m13:32:25.234240 [debug] [MainThread]: Flushing usage events
[0m13:36:33.915925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094175d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109417fd0>]}


============================== 13:36:33.918214 | 96b397b3-0713-43f7-8c3e-bba974547e44 ==============================
[0m13:36:33.918214 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:36:33.918538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:36:33.969166 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:36:33.991241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96b397b3-0713-43f7-8c3e-bba974547e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109428a10>]}
[0m13:36:33.997494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96b397b3-0713-43f7-8c3e-bba974547e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ccd4d0>]}
[0m13:36:34.041703 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:36:34.087722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:36:34.088159 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m13:36:34.108395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96b397b3-0713-43f7-8c3e-bba974547e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f99f50>]}
[0m13:36:34.114442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96b397b3-0713-43f7-8c3e-bba974547e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df0090>]}
[0m13:36:34.114755 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:36:34.114932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96b397b3-0713-43f7-8c3e-bba974547e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109486090>]}
[0m13:36:34.115696 [info ] [MainThread]: 
[0m13:36:34.116074 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:36:34.116647 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:36:34.121732 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:36:34.122051 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:36:34.122231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:34.122405 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:36:36.050800 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:36:36.175228 [debug] [ThreadPool]: On list_None: Close
[0m13:36:36.311207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:36:36.320285 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:36:36.321064 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:36:36.321457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:36.322074 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:36:38.125659 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:36:38.138736 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:36:38.139604 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:36:38.288116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:36:38.512197 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:36:38.624875 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:36:38.739819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96b397b3-0713-43f7-8c3e-bba974547e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d041d0>]}
[0m13:36:38.740595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:38.740963 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:36:40.035922 [debug] [MainThread]: On master: COMMIT
[0m13:36:40.037782 [debug] [MainThread]: Using oracle connection "master"
[0m13:36:40.038439 [debug] [MainThread]: On master: COMMIT
[0m13:36:40.145776 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:36:40.148727 [debug] [MainThread]: On master: Close
[0m13:36:40.262193 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:36:40.263053 [info ] [MainThread]: 
[0m13:36:40.272689 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:36:40.273563 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:36:40.274387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:36:40.274791 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:36:40.295150 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:36:40.296404 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:36:40.275041 => 13:36:40.296219
[0m13:36:40.296705 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:36:40.325074 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:36:43.092821 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:36:43.094222 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Njk4MDEsImlhdCI6MTY4NzQ2NjIwMX0.dVwjlOqNcNTCRMyZED3dVFrSHTbXCM8lyOCmuPluB6KkxpVn-Dxnd_RxZpoYcFIuIsriGH-3ju-29gDOz4JTYGpH7PDLYtvgpskKD5M3Ce_B8WLdcEA0ca6pZPGIS_fsxMxpS4DaQEpACi19mWhh66Y8rV9B5JZKWnYXUHl9JlQX866EaXVDP4MjiL27yX7QiC5hzu-LQMvPzb6BFDdYaEc2ZxTBs-PEpEM-QGsXjc-Nl6g05xJZt1iJjmERyq7hbD18z7sxGIJ5fMNEEjtxJUiXFMD0xMwTNaKHkcdPTIHUu3spgPje1Aq2vo-d6ON6wa5pVKugSSv_0twljglIJg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info133640315808"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_203643 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_203643';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:36:43.095892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:43.096592 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:37:09.530396 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m13:37:09.533857 [info ] [Thread-1 (]: oracle adapter: OK
[0m13:37:09.544129 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:37:09.545231 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info133640315808')
        
      order by ordinal_position

  
[0m13:37:09.827086 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:37:09.948305 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:37:09.949396 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:37:10.084435 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:37:10.203148 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:37:10.204162 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:37:10.367494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:37:10.557545 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m13:37:10.563704 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:37:10.564151 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info133640315808
    )
  
[0m13:37:11.271062 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:37:11.283929 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:37:11.285110 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:37:11.285721 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:37:11.404529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:37:11.415846 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:37:11.416765 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info133640315808
[0m13:37:11.586797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:37:11.597759 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:37:11.598575 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info133640315808 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:37:11.743516 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:37:11.757573 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:36:40.296897 => 13:37:11.757339
[0m13:37:11.758217 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m13:37:11.859859 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:37:11.973997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96b397b3-0713-43f7-8c3e-bba974547e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b004450>]}
[0m13:37:11.975951 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 31.70s]
[0m13:37:11.977085 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:37:11.978520 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:37:11.979538 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:37:11.980719 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m13:37:11.981287 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:37:11.986132 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:37:11.988956 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:37:11.981684 => 13:37:11.988658
[0m13:37:11.989514 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:37:12.003453 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m13:37:12.004005 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m13:37:12.006023 [info ] [Thread-3 (]: Python model materialization is table
[0m13:37:12.006407 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:37:14.143778 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:37:14.145306 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Njk4MzIsImlhdCI6MTY4NzQ2NjIzMn0.O90FaY5zUOcvQsOaqtIQXv5mjGuFe4AJLmeKT1W44FMNyMhU8IKr5rOXmjiZ41R4OMiAufLLTFirRRI5otMDqRBQ-h-bbWSI48mkHGhF3-b2tRwMglpiZMDdEfplLh6GTM0PCadmUsE4S9HSKmp-2-6B2MpkAMnRt3H8HDB-jP9c6YAb74HhfD-TW8J7bE6ZUie8GmjPUxDNqQ0tluJjlTw7nDG9BDwlN7Z9Sj1iOTtUS_jTk4ruknYKEFJ7ts2TkQJvsUOaO1hVmT_a-DRd1WOVZnAkFbU1ZZMryWw8AbXf5rn7XZbWghgGJmSIwVKlPtVArVdM35IpR4ME6t6Q-g!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["PRICE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test), "Accuracy": accuracy})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_203714 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_203714';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:37:14.147906 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:37:14.148521 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:37:44.846130 [debug] [Thread-3 (]: SQL status: OK in 31.0 seconds
[0m13:37:44.849349 [info ] [Thread-3 (]: oracle adapter: OK
[0m13:37:44.858990 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:37:44.860141 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m13:37:44.995969 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:37:45.002639 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:37:45.003297 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m13:37:45.122568 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:37:45.132607 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m13:37:45.133482 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:37:45.133944 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m13:37:45.245736 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:37:45.253013 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:37:45.253812 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:37:45.384385 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:37:45.394378 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:37:11.989842 => 13:37:45.394141
[0m13:37:45.395049 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m13:37:45.506959 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96b397b3-0713-43f7-8c3e-bba974547e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af7de90>]}
[0m13:37:45.508142 [info ] [Thread-3 (]: 2 of 2 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 33.53s]
[0m13:37:45.508839 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:37:45.510712 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:37:45.511311 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:37:46.811839 [debug] [MainThread]: On master: COMMIT
[0m13:37:46.813719 [debug] [MainThread]: Using oracle connection "master"
[0m13:37:46.814329 [debug] [MainThread]: On master: COMMIT
[0m13:37:46.916669 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:37:46.918086 [debug] [MainThread]: On master: Close
[0m13:37:47.039044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:47.039760 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:37:47.040136 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:37:47.040553 [info ] [MainThread]: 
[0m13:37:47.040938 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 12.92 seconds (72.92s).
[0m13:37:47.041733 [debug] [MainThread]: Command end result
[0m13:37:47.054196 [info ] [MainThread]: 
[0m13:37:47.054862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:37:47.055155 [info ] [MainThread]: 
[0m13:37:47.055443 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:37:47.056077 [debug] [MainThread]: Command `dbt run` succeeded at 13:37:47.055977 after 73.16 seconds
[0m13:37:47.056521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a36910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a36510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b9ac50>]}
[0m13:37:47.056914 [debug] [MainThread]: Flushing usage events
[0m13:45:55.296684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107517c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107517f90>]}


============================== 13:45:55.313659 | 42bd1bd4-5e31-47df-b66f-7fc1b3f14732 ==============================
[0m13:45:55.313659 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:45:55.314206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:45:56.215194 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:45:56.283278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42bd1bd4-5e31-47df-b66f-7fc1b3f14732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750b450>]}
[0m13:45:56.292250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42bd1bd4-5e31-47df-b66f-7fc1b3f14732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcd290>]}
[0m13:45:56.346804 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:45:59.055354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:45:59.056771 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m13:45:59.093280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42bd1bd4-5e31-47df-b66f-7fc1b3f14732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc42d0>]}
[0m13:45:59.337333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42bd1bd4-5e31-47df-b66f-7fc1b3f14732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f34d90>]}
[0m13:45:59.338313 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:45:59.338688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42bd1bd4-5e31-47df-b66f-7fc1b3f14732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df2710>]}
[0m13:45:59.340430 [info ] [MainThread]: 
[0m13:45:59.341218 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:45:59.342315 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:45:59.351042 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:45:59.351567 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:45:59.351838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:59.352116 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:46:01.471159 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:46:01.611025 [debug] [ThreadPool]: On list_None: Close
[0m13:46:01.737855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:46:01.741843 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:46:01.742144 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:46:01.742352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:01.742563 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:46:03.368184 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:46:03.379965 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:46:03.380794 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:46:03.507772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:46:03.715710 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:46:03.820557 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:46:03.944807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42bd1bd4-5e31-47df-b66f-7fc1b3f14732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1b550>]}
[0m13:46:03.945747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:03.946289 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:46:05.441969 [debug] [MainThread]: On master: COMMIT
[0m13:46:05.444295 [debug] [MainThread]: Using oracle connection "master"
[0m13:46:05.445028 [debug] [MainThread]: On master: COMMIT
[0m13:46:05.589859 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:46:05.592146 [debug] [MainThread]: On master: Close
[0m13:46:05.748996 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:46:05.750012 [info ] [MainThread]: 
[0m13:46:05.794300 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:46:05.795071 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:46:05.795778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:46:05.796112 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:46:05.816756 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:46:05.856646 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:46:05.796330 => 13:46:05.856381
[0m13:46:05.857155 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:46:05.892401 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:46:08.729706 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:46:08.730464 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzAzNjcsImlhdCI6MTY4NzQ2Njc2N30.blLWzl3Lk6fdp8_RWqtqqwlpJPvIu7TCaB9-SPnj5efmqyHjGpS-iuUgnhrZoAkYmWWp_6mWYNvE6iV-AR4mLdX_sJzrPAiZpLiwGN8tWG0mM8OYhcLOFW0dIGDRmcHrefCj-sZSsFHGcVjP4bfRv-GCzk-Sdrbg_3CpStHE-kta2BVnUks1E6rj6KFmBsFzeS0yNPX49dttVTUbVtRTKRHsmsd2vwV3LThqJbsKh8PMg2BPzOxexh82Yv1m-c9ZfCSKyIK5nRKUv4otnrL-jfG4MREdsuJ9O5b-zrGrR2qA0yKcBuF68Z0hp1aL6ci9-iK6w5l8hFAFJb1JbYdhqQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info134605882301"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_204608 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_204608';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:46:08.731439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:08.731866 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:46:36.259642 [debug] [Thread-1 (]: SQL status: OK in 28.0 seconds
[0m13:46:36.263916 [info ] [Thread-1 (]: oracle adapter: OK
[0m13:46:36.273397 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:46:36.274224 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info134605882301')
        
      order by ordinal_position

  
[0m13:46:36.577936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:46:36.733846 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:46:36.734910 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:46:36.961515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:46:37.108461 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:46:37.109590 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:46:37.373081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:46:37.544500 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m13:46:37.555883 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:46:37.556818 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info134605882301
    )
  
[0m13:46:38.306089 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:46:38.319833 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:46:38.320667 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:46:38.321187 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:46:38.450186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:46:38.462836 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:46:38.463657 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info134605882301
[0m13:46:38.655730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:46:38.667082 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:46:38.667938 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info134605882301 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:46:38.811304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:46:38.823753 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:46:05.857478 => 13:46:38.823526
[0m13:46:38.824437 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m13:46:38.929586 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:46:39.050984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42bd1bd4-5e31-47df-b66f-7fc1b3f14732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12026cb90>]}
[0m13:46:39.051498 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 33.26s]
[0m13:46:39.051811 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:46:39.052308 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:46:39.052790 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:46:39.053307 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m13:46:39.053522 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:46:39.055854 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:46:39.064259 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:46:39.053698 => 13:46:39.064063
[0m13:46:39.064580 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:46:39.078305 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m13:46:39.078861 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m13:46:39.081013 [info ] [Thread-3 (]: Python model materialization is table
[0m13:46:39.081592 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:46:41.587717 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:46:41.589185 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzA0MDAsImlhdCI6MTY4NzQ2NjgwMH0.AIx0tkLsWY8cMlzHce_lPt5c9Vjyrm7Zm-65eQHmIUDjf3oRtlw_xovLA0S_T4YAPiL6C1rTF3DCWeIZyDgXD4MY14F0026lMgoiN8s4VZNkPk6LHvK10XzuDTpxGe_S7RcNRb34rMe6K1VUpi_UGXkZXOXCKld-h3ERAQY9XJTFbZ0JAaSUJomNaVPgW4Rd3B_W3DrBT3SpfSqVaK3NscjBw7j1Y9y6y9XhNiSMEcGjuyF3L2nSyTKihqy3Y-lSu-CZqYXbaDPXHbd5FLzlzMysxvtAytIyRficvQ6abzvgaJRlLiqFP7iG7633WCl26C97xevGcR74mgH25Jlu9g!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT", "PRODUCT_ID", "PRICE" , "QUANTITY", "SHIPPING_CITY", "ORDER_DATE", "CUSTOMER_ID", "CATEGORY", "PAYMENT_TYPE"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test), "Accuracy": accuracy})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_204641 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_204641';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:46:41.590843 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:46:41.591411 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:47:11.556181 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"could not convert string to float: 'Product 66' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 70, in model\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 969, in fit\n    super().fit(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 172, in fit\n    X, y = self._validate_data(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/base.py\", line 591, in _validate_data\n    X = check_array(X, input_name=\"X\", **check_X_params)\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/utils/validation.py\", line 856, in check_array\n    array = np.asarray(array, order=order, dtype=dtype)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/generic.py\", line 1993, in __array__\n    return np.asarray(self._values, dtype=dtype)\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 104
[0m13:47:11.559226 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m13:47:11.675391 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:46:39.064837 => 13:47:11.674090
[0m13:47:11.783259 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"could not convert string to float: 'Product 66' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 70, in model\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 969, in fit\n    super().fit(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 172, in fit\n    X, y = self._validate_data(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/base.py\", line 591, in _validate_data\n    X = check_array(X, input_name=\"X\", **check_X_params)\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/utils/validation.py\", line 856, in check_array\n    array = np.asarray(array, order=order, dtype=dtype)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/generic.py\", line 1993, in __array__\n    return np.asarray(self._values, dtype=dtype)\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 104
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:47:11.787092 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42bd1bd4-5e31-47df-b66f-7fc1b3f14732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12022dc90>]}
[0m13:47:11.788435 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 32.73s]
[0m13:47:11.789849 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:47:11.797384 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:11.798244 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:47:13.196929 [debug] [MainThread]: On master: COMMIT
[0m13:47:13.198664 [debug] [MainThread]: Using oracle connection "master"
[0m13:47:13.200366 [debug] [MainThread]: On master: COMMIT
[0m13:47:13.304867 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:47:13.307449 [debug] [MainThread]: On master: Close
[0m13:47:13.418057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:13.419347 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:47:13.420529 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:47:13.421369 [info ] [MainThread]: 
[0m13:47:13.423986 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 14.08 seconds (74.08s).
[0m13:47:13.426073 [debug] [MainThread]: Command end result
[0m13:47:13.446796 [info ] [MainThread]: 
[0m13:47:13.447342 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:47:13.447661 [info ] [MainThread]: 
[0m13:47:13.447974 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m13:47:13.448492 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"could not convert string to float: 'Product 66' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 70, in model\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 969, in fit\n    super().fit(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 172, in fit\n    X, y = self._validate_data(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/base.py\", line 591, in _validate_data\n    X = check_array(X, input_name=\"X\", **check_X_params)\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/utils/validation.py\", line 856, in check_array\n    array = np.asarray(array, order=order, dtype=dtype)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/generic.py\", line 1993, in __array__\n    return np.asarray(self._values, dtype=dtype)\n"}
[0m13:47:13.449398 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m13:47:13.449936 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m13:47:13.450413 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:47:13.450771 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:47:13.450976 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:47:13.451161 [error] [MainThread]:   ORA-06512: at line 104
[0m13:47:13.451340 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:47:13.451531 [info ] [MainThread]: 
[0m13:47:13.451738 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:47:13.452305 [debug] [MainThread]: Command `dbt run` failed at 13:47:13.452204 after 78.40 seconds
[0m13:47:13.452777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107517bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022c2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022c1550>]}
[0m13:47:13.453225 [debug] [MainThread]: Flushing usage events
[0m13:47:52.357216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465bf90>]}


============================== 13:47:52.359652 | c931c154-9b56-42cb-b83d-0e0842b71bf9 ==============================
[0m13:47:52.359652 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:47:52.359963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:47:52.430613 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:47:52.453825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c931c154-9b56-42cb-b83d-0e0842b71bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104723b50>]}
[0m13:47:52.460225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c931c154-9b56-42cb-b83d-0e0842b71bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d854d0>]}
[0m13:47:52.500123 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:47:52.547582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:47:52.548034 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m13:47:52.568893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c931c154-9b56-42cb-b83d-0e0842b71bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f316d0>]}
[0m13:47:52.584503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c931c154-9b56-42cb-b83d-0e0842b71bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dad710>]}
[0m13:47:52.584882 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:47:52.585064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c931c154-9b56-42cb-b83d-0e0842b71bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d86fd0>]}
[0m13:47:52.585855 [info ] [MainThread]: 
[0m13:47:52.586235 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:47:52.586825 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:47:52.591887 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:47:52.592186 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:47:52.592360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:52.592535 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:47:54.124796 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:47:54.236473 [debug] [ThreadPool]: On list_None: Close
[0m13:47:54.387862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:47:54.395785 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:47:54.396439 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:47:54.396775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:54.397127 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:47:55.768815 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m13:47:55.780049 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:47:55.780828 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:47:55.913151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:47:56.119782 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:47:56.221879 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:47:56.335332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c931c154-9b56-42cb-b83d-0e0842b71bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e86c10>]}
[0m13:47:56.336314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:56.336767 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:47:57.632602 [debug] [MainThread]: On master: COMMIT
[0m13:47:57.634730 [debug] [MainThread]: Using oracle connection "master"
[0m13:47:57.636409 [debug] [MainThread]: On master: COMMIT
[0m13:47:57.747112 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:47:57.748263 [debug] [MainThread]: On master: Close
[0m13:47:57.857079 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:57.858110 [info ] [MainThread]: 
[0m13:47:57.865501 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:47:57.866369 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:47:57.867324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:47:57.867783 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:47:57.890425 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:47:57.892297 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:47:57.868107 => 13:47:57.892073
[0m13:47:57.892701 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:47:57.922209 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:48:00.255729 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:48:00.256412 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzA0NzksImlhdCI6MTY4NzQ2Njg3OX0.WavMEetPfD-PzJVGS8WLKVo-lf9GdRC_KoWmltL2p-TANdAj0F4-8yIcuo9KFOk2gQIykwlv2jxnbwCqDld2qYUE5cvJ8fhb8k41eERjEGl_1O2YnQuWVTxau7w4lC0Qc70bTwYfdIV50XsF74W5UNyenu-dvGZ9yuJHLrpRdyxnnAhD0L2eFElSGikUxMd81e8f8bkWP_ckjqF6JCQIJ27wC6AB_b713uFwryg2N6ilXl_9ie1Cv6uriD1Es6Fw1dxH_p1etnyMfqitmyFdwn9EzDWnChDMHofo8Gu6nDsoKFxH387swzV8DfFzbkDx_GSEo2cDEO9Tv_Xyn5POeQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info134757913142"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_204800 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_204800';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:48:00.257238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:00.257623 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:48:25.928308 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m13:48:25.932238 [info ] [Thread-1 (]: oracle adapter: OK
[0m13:48:25.942013 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:48:25.942964 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info134757913142')
        
      order by ordinal_position

  
[0m13:48:26.219428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:48:26.335185 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:48:26.336224 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:48:26.474614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:48:26.592561 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:48:26.593637 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:48:26.729086 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:48:26.873558 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m13:48:26.876056 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:48:26.876622 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info134757913142
    )
  
[0m13:48:27.567503 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:48:27.580300 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:48:27.581445 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:48:27.581958 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:48:27.691775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:48:27.702162 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:48:27.702965 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info134757913142
[0m13:48:27.893609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:48:27.904928 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:48:27.905716 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info134757913142 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:48:28.043113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:48:28.060071 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:47:57.892907 => 13:48:28.059840
[0m13:48:28.060743 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m13:48:28.165885 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:48:28.275634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c931c154-9b56-42cb-b83d-0e0842b71bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105023c90>]}
[0m13:48:28.276804 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.41s]
[0m13:48:28.277443 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:48:28.278327 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:48:28.279472 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:48:28.280367 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m13:48:28.280773 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:48:28.284780 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:48:28.290534 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:48:28.281016 => 13:48:28.290216
[0m13:48:28.291034 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:48:28.304060 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m13:48:28.304478 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m13:48:28.306233 [info ] [Thread-3 (]: Python model materialization is table
[0m13:48:28.306538 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:48:30.923710 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:48:30.925148 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzA1MDksImlhdCI6MTY4NzQ2NjkwOX0.CpLkR4wcy9qOiqD6tZ3zql7-sLVp28gcKt0mQN1K5qqtqMchjcCVD6TeNtcdJqtn9RhTI9CNrLugydL7ZbPXkWlugeDksLA7X_qU-xmgw6eKMZfrVkNDoA0zfUelX83dFFS-QyKONQgV46pcwx9DvLygKb9mrgbq7TIVX2UBTq0xhUVOqY8BzZMZAzC81LD3sC1iDYK_JlBFKwk7S7xOZfbGfCZKYJVkxcnO1RdCDz8D3QiL_sU67KPSdXeiczl2T0mASj3IaUf0hJHBNOFERJMkX7i9VBawxw21dEyiDgyHdjeIBQjF_g7MQkbUh3l1UWHlavv9Q80M7OhXWR49GQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "ORDER_DATE", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test), "Accuracy": accuracy})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_204830 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_204830';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:48:30.926986 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:48:30.927683 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:49:02.263773 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"The DType <class 'numpy.dtype[float64]'> could not be promoted by <class 'numpy.dtype[datetime64]'>. This means that no common DType exists for the given inputs. For example they cannot be stored in a single array unless the dtype is `object`. The full list of DTypes is: (<class 'numpy.dtype[int64]'>, <class 'numpy.dtype[int64]'>, <class 'numpy.dtype[float64]'>, <class 'numpy.dtype[int64]'>, <class 'numpy.dtype[datetime64]'>, <class 'numpy.dtype[int64]'>) : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 70, in model\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 969, in fit\n    super().fit(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 172, in fit\n    X, y = self._validate_data(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/base.py\", line 591, in _validate_data\n    X = check_array(X, input_name=\"X\", **check_X_params)\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/utils/validation.py\", line 768, in check_array\n    dtype_orig = np.result_type(*dtypes_orig)\n   File \"<__array_function__ internals>\", line 180, in result_type\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 104
[0m13:49:02.267969 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m13:49:02.387669 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:48:28.291289 => 13:49:02.386615
[0m13:49:02.400952 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"The DType <class 'numpy.dtype[float64]'> could not be promoted by <class 'numpy.dtype[datetime64]'>. This means that no common DType exists for the given inputs. For example they cannot be stored in a single array unless the dtype is `object`. The full list of DTypes is: (<class 'numpy.dtype[int64]'>, <class 'numpy.dtype[int64]'>, <class 'numpy.dtype[float64]'>, <class 'numpy.dtype[int64]'>, <class 'numpy.dtype[datetime64]'>, <class 'numpy.dtype[int64]'>) : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 70, in model\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 969, in fit\n    super().fit(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 172, in fit\n    X, y = self._validate_data(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/base.py\", line 591, in _validate_data\n    X = check_array(X, input_name=\"X\", **check_X_params)\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/utils/validation.py\", line 768, in check_array\n    dtype_orig = np.result_type(*dtypes_orig)\n   File \"<__array_function__ internals>\", line 180, in result_type\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 104
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:49:02.403143 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c931c154-9b56-42cb-b83d-0e0842b71bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1e8d0>]}
[0m13:49:02.403641 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 34.12s]
[0m13:49:02.404043 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:49:02.405200 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:02.405521 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:49:03.979088 [debug] [MainThread]: On master: COMMIT
[0m13:49:03.981465 [debug] [MainThread]: Using oracle connection "master"
[0m13:49:03.982330 [debug] [MainThread]: On master: COMMIT
[0m13:49:04.095590 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:49:04.097635 [debug] [MainThread]: On master: Close
[0m13:49:04.232163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:04.233113 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:49:04.233615 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:49:04.234145 [info ] [MainThread]: 
[0m13:49:04.234757 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 11.65 seconds (71.65s).
[0m13:49:04.235974 [debug] [MainThread]: Command end result
[0m13:49:04.253030 [info ] [MainThread]: 
[0m13:49:04.253694 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:49:04.253979 [info ] [MainThread]: 
[0m13:49:04.254240 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m13:49:04.254578 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"The DType <class 'numpy.dtype[float64]'> could not be promoted by <class 'numpy.dtype[datetime64]'>. This means that no common DType exists for the given inputs. For example they cannot be stored in a single array unless the dtype is `object`. The full list of DTypes is: (<class 'numpy.dtype[int64]'>, <class 'numpy.dtype[int64]'>, <class 'numpy.dtype[float64]'>, <class 'numpy.dtype[int64]'>, <class 'numpy.dtype[datetime64]'>, <class 'numpy.dtype[int64]'>) : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 92, in main\n   File \"<string>\", line 70, in model\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 969, in fit\n    super().fit(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/tree/_classes.py\", line 172, in fit\n    X, y = self._validate_data(\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/base.py\", line 591, in _validate_data\n    X = check_array(X, input_name=\"X\", **check_X_params)\n   File \"/usr/local/lib/python3.10/site-packages/sklearn/utils/validation.py\", line 768, in check_array\n    dtype_orig = np.result_type(*dtypes_orig)\n   File \"<__array_function__ internals>\", line 180, in result_type\n"}
[0m13:49:04.254940 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m13:49:04.255171 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m13:49:04.255400 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:49:04.255617 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:49:04.255838 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:49:04.256062 [error] [MainThread]:   ORA-06512: at line 104
[0m13:49:04.256277 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:49:04.256506 [info ] [MainThread]: 
[0m13:49:04.256775 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:49:04.257395 [debug] [MainThread]: Command `dbt run` failed at 13:49:04.257299 after 71.92 seconds
[0m13:49:04.258062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d65c90>]}
[0m13:49:04.258550 [debug] [MainThread]: Flushing usage events
[0m13:49:29.584174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106643e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664ffd0>]}


============================== 13:49:29.586799 | 4ccc143d-db2a-40cb-8ae6-0e1964467538 ==============================
[0m13:49:29.586799 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:49:29.587126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:49:29.648661 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:49:29.670038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ccc143d-db2a-40cb-8ae6-0e1964467538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066604d0>]}
[0m13:49:29.676350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ccc143d-db2a-40cb-8ae6-0e1964467538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d617d0>]}
[0m13:49:29.714565 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:49:29.765370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:49:29.765808 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m13:49:29.786313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ccc143d-db2a-40cb-8ae6-0e1964467538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d72350>]}
[0m13:49:29.798973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ccc143d-db2a-40cb-8ae6-0e1964467538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2ac10>]}
[0m13:49:29.799320 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:49:29.799500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ccc143d-db2a-40cb-8ae6-0e1964467538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d92310>]}
[0m13:49:29.800247 [info ] [MainThread]: 
[0m13:49:29.800628 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:49:29.801178 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:49:29.806163 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:49:29.806440 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:49:29.806611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:29.806785 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:49:31.818664 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:49:31.943334 [debug] [ThreadPool]: On list_None: Close
[0m13:49:32.053606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:49:32.062311 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:49:32.063083 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:49:32.063491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:32.063896 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:49:33.604348 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:49:33.615703 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:49:33.616561 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:49:33.744621 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:49:33.953680 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:49:34.057498 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:49:34.175643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ccc143d-db2a-40cb-8ae6-0e1964467538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7e9d0>]}
[0m13:49:34.176683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:34.177162 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:49:35.487331 [debug] [MainThread]: On master: COMMIT
[0m13:49:35.489464 [debug] [MainThread]: Using oracle connection "master"
[0m13:49:35.490283 [debug] [MainThread]: On master: COMMIT
[0m13:49:35.591958 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:49:35.594682 [debug] [MainThread]: On master: Close
[0m13:49:35.711115 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:49:35.712672 [info ] [MainThread]: 
[0m13:49:35.723072 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:49:35.724018 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:49:35.725097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:49:35.725526 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:49:35.745240 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:49:35.749700 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:49:35.725792 => 13:49:35.749514
[0m13:49:35.750037 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:49:35.779082 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:49:37.918013 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:49:37.918994 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzA1NzYsImlhdCI6MTY4NzQ2Njk3Nn0.DDcpbhzLdqYuq0GKNGgBhSfidL35ormtmsPcGU2zpUltMRwk_4ghCOU76yBOaOZ77lhij88dTRWFtIPOjmGt8gHUBJz5cZ8myeAfd9KaLu79dNedcipX4BHNyhjYuhpjnEmnJ7p8n80ojua_2V5VQwnrZ4Qs5FIhd5Yu8eosym49et850khTkptYv8x_SJkiteyag-IkblTKcbt70m6C6Y9dHR0CdBX71-Bu4CcyiRIS0FG6m4Wh_DF92bv9tOEOCKtHNJzuAafLT_iCH2Bl9AKjE2ELN7WHNiSNAip9TMARiM7nI0uYwAgjAB8mStryMWIGWktgf7N5F0uK7ehqpw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info134935770227"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_204937 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_204937';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:49:37.919989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:37.920473 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:04.129165 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m13:50:04.133595 [info ] [Thread-1 (]: oracle adapter: OK
[0m13:50:04.143294 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:50:04.144236 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info134935770227')
        
      order by ordinal_position

  
[0m13:50:04.442145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:04.561412 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:50:04.562368 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:50:04.700162 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:04.824856 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:50:04.825890 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:50:04.960877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:05.103845 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m13:50:05.107730 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:50:05.108333 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info134935770227
    )
  
[0m13:50:05.874579 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:50:05.888253 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:50:05.889118 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:50:05.889562 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:50:06.003788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:06.011749 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:50:06.012445 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info134935770227
[0m13:50:06.191151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:06.202844 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:50:06.203696 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info134935770227 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:50:06.355236 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:06.368060 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:49:35.750238 => 13:50:06.367910
[0m13:50:06.368458 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m13:50:06.470120 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:50:06.578106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccc143d-db2a-40cb-8ae6-0e1964467538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7bf10>]}
[0m13:50:06.579239 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.85s]
[0m13:50:06.579804 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:50:06.580720 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:50:06.581530 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:50:06.582309 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m13:50:06.582689 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:50:06.586884 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:50:06.588665 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:50:06.582931 => 13:50:06.588364
[0m13:50:06.589123 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:50:06.600881 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m13:50:06.601338 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m13:50:06.603079 [info ] [Thread-3 (]: Python model materialization is table
[0m13:50:06.603445 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:50:08.836984 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:50:08.838642 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzA2MDcsImlhdCI6MTY4NzQ2NzAwN30.UZ-ue40Y6bwRq9KlBZPDgrZVpbpu2uKgwoObJepijran2D4qZwawb708chhtF2GBSE_1gN64PL4bViTFtNKSZ3vJhWUgANwckLf_aEYmgn6y7aP6yVQ-Dmw7IV0VQCFnCs9xbfDQDFCsVTX3Hb3gzGVMd-jaJpTcUEVMFaBC03SpBw_A9xc0IuxFCWbPbwfvdlgmD5zOXtP9KOlohFdi8YRuq8ER12lhDR5TSiico8yi8KQFrn3aajACepi39IpXEqz1bWuVoR6-Em39aam_HmFEnNv_7vziAYBrVzdijZspdohfn-uVNcRj9b2DAuu1esFZ_6xorYI8NBBDELgzeg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test), "Accuracy": accuracy})
    
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_205008 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_205008';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:50:08.840340 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:50:08.840770 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:39.284944 [debug] [Thread-3 (]: SQL status: OK in 30.0 seconds
[0m13:50:39.288814 [info ] [Thread-3 (]: oracle adapter: OK
[0m13:50:39.298046 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:50:39.298765 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m13:50:39.566820 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:50:39.573939 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:50:39.574485 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m13:50:39.708961 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:50:39.718106 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m13:50:39.719128 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:50:39.719653 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m13:50:39.827495 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:50:39.834531 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:50:39.835452 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:50:40.095208 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:50:40.107514 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:50:06.589352 => 13:50:40.107275
[0m13:50:40.108200 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m13:50:40.263217 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccc143d-db2a-40cb-8ae6-0e1964467538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704b010>]}
[0m13:50:40.264268 [info ] [Thread-3 (]: 2 of 2 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 33.68s]
[0m13:50:40.264805 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:50:40.266222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:40.266538 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:41.874783 [debug] [MainThread]: On master: COMMIT
[0m13:50:41.877186 [debug] [MainThread]: Using oracle connection "master"
[0m13:50:41.877921 [debug] [MainThread]: On master: COMMIT
[0m13:50:41.995012 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:50:41.997114 [debug] [MainThread]: On master: Close
[0m13:50:42.116037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:42.116606 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:50:42.116853 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:50:42.117153 [info ] [MainThread]: 
[0m13:50:42.117403 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 12.32 seconds (72.32s).
[0m13:50:42.117942 [debug] [MainThread]: Command end result
[0m13:50:42.128830 [info ] [MainThread]: 
[0m13:50:42.129358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:50:42.129622 [info ] [MainThread]: 
[0m13:50:42.129852 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:50:42.130265 [debug] [MainThread]: Command `dbt run` succeeded at 13:50:42.130198 after 72.57 seconds
[0m13:50:42.130550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e22910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e22510>]}
[0m13:50:42.130819 [debug] [MainThread]: Flushing usage events
[0m13:51:33.159767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10520bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105217ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105217f90>]}


============================== 13:51:33.162218 | 46bf8d7e-83c3-4024-b3c5-5070c8af648d ==============================
[0m13:51:33.162218 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:51:33.162530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:51:33.215402 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:51:33.237060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46bf8d7e-83c3-4024-b3c5-5070c8af648d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105217d50>]}
[0m13:51:33.243396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46bf8d7e-83c3-4024-b3c5-5070c8af648d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b41f50>]}
[0m13:51:33.277751 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:51:33.319972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:51:33.320414 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m13:51:33.341047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46bf8d7e-83c3-4024-b3c5-5070c8af648d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf72d0>]}
[0m13:51:33.357825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46bf8d7e-83c3-4024-b3c5-5070c8af648d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b93c50>]}
[0m13:51:33.358271 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:51:33.358530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46bf8d7e-83c3-4024-b3c5-5070c8af648d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b69510>]}
[0m13:51:33.359291 [info ] [MainThread]: 
[0m13:51:33.359667 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:51:33.360173 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:51:33.364927 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:51:33.365152 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:51:33.365313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:33.365480 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:51:34.985230 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:51:35.099298 [debug] [ThreadPool]: On list_None: Close
[0m13:51:35.225101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:51:35.233866 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:51:35.234627 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:51:35.235033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:35.235445 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:51:36.951401 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:51:36.959450 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:51:36.960152 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:51:37.094055 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:51:37.230946 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:51:37.350647 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:51:37.463711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46bf8d7e-83c3-4024-b3c5-5070c8af648d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8ee10>]}
[0m13:51:37.464804 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:37.465331 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:51:38.799011 [debug] [MainThread]: On master: COMMIT
[0m13:51:38.801283 [debug] [MainThread]: Using oracle connection "master"
[0m13:51:38.801910 [debug] [MainThread]: On master: COMMIT
[0m13:51:38.907721 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:51:38.909542 [debug] [MainThread]: On master: Close
[0m13:51:39.017883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:51:39.018858 [info ] [MainThread]: 
[0m13:51:39.026219 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:51:39.027262 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:51:39.028273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:51:39.028759 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:51:39.050974 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:51:39.053205 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:51:39.029091 => 13:51:39.053025
[0m13:51:39.053733 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:51:39.083065 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:51:41.518486 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:51:41.520128 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzA3MDAsImlhdCI6MTY4NzQ2NzEwMH0.lHPE-VA_K6PlGZ52Y2PLUBjVw-NYVuf1JZktWB6jQmm__9ZGIG4LE9VM8PDGgoH93O6bUo5ywa8BgdV1UZgySMb-BC36kWMHIoCFkM-RAANl1ItopVkbMv5Xhlr8TxyWm1WcuKf0e3gwWueZL_Zew3jp47cO0-Cq4LR4GNPuy488RwEE-c8cyok19nEBV1-bjTDWGABdiTq2cl8nCGryjxmRoQ6v836nPeJQCJXSTmZHcj9VdD_fSs13sWsJxuX_njVz0vlGab8elsiCr4xzs7UqDFTJt2vnuqM9SFjzHtgaUChdUoTHYuGBUgq2f8x_FSO5UIrC7U3rKvEH4Q1oBA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info135139074176"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_205141 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_205141';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:51:41.521908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:41.522501 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:52:06.617645 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m13:52:06.621746 [info ] [Thread-1 (]: oracle adapter: OK
[0m13:52:06.631528 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:52:06.632428 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info135139074176')
        
      order by ordinal_position

  
[0m13:52:06.928443 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:52:07.049827 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:52:07.050812 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:52:07.193121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:52:07.316001 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:52:07.317036 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:52:07.472508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:52:07.604794 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m13:52:07.609249 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:52:07.609757 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info135139074176
    )
  
[0m13:52:08.355645 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:52:08.369672 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:52:08.370541 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:52:08.370995 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:52:08.514338 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:52:08.524294 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:52:08.525046 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info135139074176
[0m13:52:08.729226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:52:08.741068 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:52:08.741966 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info135139074176 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:52:08.878193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:52:08.889886 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:51:39.054095 => 13:52:08.889696
[0m13:52:08.890674 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m13:52:08.992778 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:52:09.101082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46bf8d7e-83c3-4024-b3c5-5070c8af648d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c32b10>]}
[0m13:52:09.101833 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.07s]
[0m13:52:09.102342 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:52:09.103138 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:52:09.103941 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:52:09.104808 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m13:52:09.105184 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:52:09.108677 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:52:09.109793 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:52:09.105431 => 13:52:09.109610
[0m13:52:09.110194 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:52:09.123168 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m13:52:09.123621 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m13:52:09.125606 [info ] [Thread-3 (]: Python model materialization is table
[0m13:52:09.126013 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:52:11.215431 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:52:11.217559 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzA3MzAsImlhdCI6MTY4NzQ2NzEzMH0.pP-OtwXAVkqbXkCogpmsknz_dzRoLYKOiflWwZpL2qB35CePjdLOuaU6s2mCysW99ZE1GsOLibWXMdvMSysjbT6TRjEjz34iY3R_79qH9LVEG5QA4dNTRWnUXO9u9E_K4qL22VNO-HoO-FP7lt7Br0DMHmxjqIvS1tWMgTlqIQPTXvNXv7kgOKS5bpA-On1TXuUD64g3QEiR_Ivk0DRhV7Jul9Gj2bg4nZaGkD5FEFS1LAGSi4C7WIgAzFgtPr5NPOybWEewm27gW9sMDLXI_Fv_b8GqpHabK8-mwRmsTmfaCqBYN_r4S7nnRHVYqCnwh_DLriM50sdg1HXZZZmuIw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test), "Accuracy": accuracy})
    
        return res_df.append(X_test)





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_205211 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_205211';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:52:11.219529 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:52:11.220223 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:52:42.245697 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"Cannot determine a default type for column(s) \"Shipping_City_Prediction\", \"Shipping_City_Actual\". Use argument 'dbtypes' to explicitly set them. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 740, in oml.core.methods.__create\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 104
[0m13:52:42.248139 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m13:52:42.357883 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:52:09.110460 => 13:52:42.356396
[0m13:52:42.376166 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"Cannot determine a default type for column(s) \"Shipping_City_Prediction\", \"Shipping_City_Actual\". Use argument 'dbtypes' to explicitly set them. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 740, in oml.core.methods.__create\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 104
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:52:42.378922 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46bf8d7e-83c3-4024-b3c5-5070c8af648d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c33a10>]}
[0m13:52:42.379622 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 33.27s]
[0m13:52:42.380102 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:52:42.382058 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:42.382707 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:52:44.831314 [debug] [MainThread]: On master: COMMIT
[0m13:52:44.834280 [debug] [MainThread]: Using oracle connection "master"
[0m13:52:44.834851 [debug] [MainThread]: On master: COMMIT
[0m13:52:44.944539 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:52:44.946371 [debug] [MainThread]: On master: Close
[0m13:52:45.059427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:45.060447 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:52:45.060817 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:52:45.061259 [info ] [MainThread]: 
[0m13:52:45.061654 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 11.70 seconds (71.70s).
[0m13:52:45.062638 [debug] [MainThread]: Command end result
[0m13:52:45.085102 [info ] [MainThread]: 
[0m13:52:45.085808 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:52:45.086138 [info ] [MainThread]: 
[0m13:52:45.086439 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m13:52:45.086785 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"Cannot determine a default type for column(s) \"Shipping_City_Prediction\", \"Shipping_City_Actual\". Use argument 'dbtypes' to explicitly set them. : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 98, in main\n   File \"<string>\", line 87, in materialize\n   File \"oml/core/methods.py\", line 609, in oml.core.methods.create\n   File \"oml/core/methods.py\", line 740, in oml.core.methods.__create\n"}
[0m13:52:45.087121 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m13:52:45.087388 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m13:52:45.087995 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:52:45.088373 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:52:45.088669 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:52:45.088943 [error] [MainThread]:   ORA-06512: at line 104
[0m13:52:45.089212 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:52:45.089497 [info ] [MainThread]: 
[0m13:52:45.089776 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:52:45.090376 [debug] [MainThread]: Command `dbt run` failed at 13:52:45.090284 after 71.95 seconds
[0m13:52:45.090818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f4ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f7090>]}
[0m13:52:45.091272 [debug] [MainThread]: Flushing usage events
[0m13:55:30.166689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043dbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e7f90>]}


============================== 13:55:30.168985 | 1d179c8b-a36b-45a0-94f8-2c4fbda04918 ==============================
[0m13:55:30.168985 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:55:30.169323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:55:30.225637 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:55:30.248840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d179c8b-a36b-45a0-94f8-2c4fbda04918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104465210>]}
[0m13:55:30.255215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d179c8b-a36b-45a0-94f8-2c4fbda04918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043d8990>]}
[0m13:55:30.292250 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:55:30.329366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:55:30.329806 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m13:55:30.350288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d179c8b-a36b-45a0-94f8-2c4fbda04918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104419d10>]}
[0m13:55:30.356875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d179c8b-a36b-45a0-94f8-2c4fbda04918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af0110>]}
[0m13:55:30.357213 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:55:30.357502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d179c8b-a36b-45a0-94f8-2c4fbda04918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1e690>]}
[0m13:55:30.358390 [info ] [MainThread]: 
[0m13:55:30.358810 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:55:30.359424 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:55:30.364292 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:55:30.364494 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:55:30.364650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:30.364819 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:55:32.434194 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:55:32.612918 [debug] [ThreadPool]: On list_None: Close
[0m13:55:32.797948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:55:32.806317 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:55:32.807040 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:55:32.807527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:32.807905 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:55:34.693800 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:55:34.705652 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:55:34.706555 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:55:34.855803 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:55:35.065125 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:55:35.175089 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:55:35.290890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d179c8b-a36b-45a0-94f8-2c4fbda04918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441aad0>]}
[0m13:55:35.291881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:35.292342 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:55:36.542605 [debug] [MainThread]: On master: COMMIT
[0m13:55:36.544868 [debug] [MainThread]: Using oracle connection "master"
[0m13:55:36.545815 [debug] [MainThread]: On master: COMMIT
[0m13:55:36.650104 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:55:36.652357 [debug] [MainThread]: On master: Close
[0m13:55:36.765773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:36.766755 [info ] [MainThread]: 
[0m13:55:36.779415 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:55:36.780315 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:55:36.780859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:55:36.781081 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:55:36.801840 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:55:36.802791 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:55:36.781231 => 13:55:36.802681
[0m13:55:36.803220 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:55:36.834123 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:55:39.185645 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:55:39.187134 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzA5MzcsImlhdCI6MTY4NzQ2NzMzN30.JX3degkylxi2BhFFNS3B87KpnDt6sQ-kdpBcTuw_S8kkys8JA6yqtooWRV03zPCFVNFT4BtFW4ynE9IvQMiVrU8Bvn2f_sLAFFRY4SagJ-WbOFV8mAdV_QuOEVcOJC-B0PDivcMeuoRlRmBU7AJPVOssXLliWvUSMTEcLycbTVCNwAUC9R-nAtACrpVADr9ARg5zqPDZS67tgFaZfa3Z2vhKXFGD1-TxfDbDZIvybhzOH_v60EujCji3QtZ8huOezhmAxhZ3TDiH-xmX3WuflxGsi39XGbV9IhEomNdo5vU-VLNRt0PpHSFM0dwSDw4hmMWfzU1xAhHlrLZ9l_LrHQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info135536824811"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_205539 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_205539';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:55:39.188611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:39.189265 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:56:07.546726 [debug] [Thread-1 (]: SQL status: OK in 28.0 seconds
[0m13:56:07.550415 [info ] [Thread-1 (]: oracle adapter: OK
[0m13:56:07.560082 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:56:07.561017 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info135536824811')
        
      order by ordinal_position

  
[0m13:56:07.834466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:07.948780 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:56:07.949804 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:56:08.169485 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:08.288717 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:56:08.289756 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:56:08.497890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:08.626155 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m13:56:08.627210 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:56:08.627534 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info135536824811
    )
  
[0m13:56:09.388371 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:56:09.402238 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:56:09.403088 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:56:09.403534 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:56:09.510488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:09.520972 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:56:09.521602 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info135536824811
[0m13:56:09.722599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:09.735801 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:56:09.736639 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info135536824811 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:56:09.870276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:09.882083 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:55:36.803446 => 13:56:09.881884
[0m13:56:09.882650 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m13:56:09.990623 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:56:10.099606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d179c8b-a36b-45a0-94f8-2c4fbda04918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4fb50>]}
[0m13:56:10.100811 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 33.32s]
[0m13:56:10.101544 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:56:10.102249 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:56:10.102887 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:56:10.103764 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m13:56:10.104122 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:56:10.106415 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:56:10.107740 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:56:10.104284 => 13:56:10.107555
[0m13:56:10.108038 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:56:10.115816 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m13:56:10.116153 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m13:56:10.117550 [info ] [Thread-3 (]: Python model materialization is table
[0m13:56:10.117812 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:56:12.160015 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:56:12.161581 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzA5NzEsImlhdCI6MTY4NzQ2NzM3MX0.NAJyX81qodgKT1Gy9wyEkgGxtxLO8N8TQ5lyWvOy8TTc3-BuincGGHnn6zVqiCGJU_sZpYUmmmkeL8ZF20DJ81t6kDTixPka2_mDehsC9CR1V3SOnAz7LgILe_zKFphZGcIA5cddEJQE3ML697wMlenhvZC3zUxbeY6QKM3czzS5cdJ_RQkzy-GcLnAxZaTIJkUv5QLZgrMn3W2V3zUrdmYEhU0_ITMvgLchrGmvLyNE5YAk68UMc8PHaqPpEzxPRG0rv5m6RUOUguwsznhZ54hw6ZsOPpg9jZQlzlzPN6veCJR8mUAQfWM046VdmKI7Fkjk3dz01dfcHMdvhGc56A!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test), "Accuracy": accuracy})
        res_df = res_df.pull()
        X_test = X_test.pull
        return res_df.concat(X_test)





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_205612 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_205612';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:56:12.162903 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:56:12.163446 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:56:42.874731 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"'DataFrame' object has no attribute 'pull' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 93, in main\n   File \"<string>\", line 78, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/generic.py\", line 5487, in __getattr__\n    return object.__getattribute__(self, name)\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 105
[0m13:56:42.876883 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m13:56:42.983398 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:56:10.108194 => 13:56:42.982671
[0m13:56:42.999810 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"'DataFrame' object has no attribute 'pull' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 93, in main\n   File \"<string>\", line 78, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/generic.py\", line 5487, in __getattr__\n    return object.__getattribute__(self, name)\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 105
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:56:43.001870 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d179c8b-a36b-45a0-94f8-2c4fbda04918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9d490>]}
[0m13:56:43.002372 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 32.90s]
[0m13:56:43.002982 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:56:43.004454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:43.004880 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:56:44.380663 [debug] [MainThread]: On master: COMMIT
[0m13:56:44.387603 [debug] [MainThread]: Using oracle connection "master"
[0m13:56:44.388549 [debug] [MainThread]: On master: COMMIT
[0m13:56:44.493504 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:44.495431 [debug] [MainThread]: On master: Close
[0m13:56:44.604940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:44.605842 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:56:44.606460 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:56:44.606969 [info ] [MainThread]: 
[0m13:56:44.607437 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 14.25 seconds (74.25s).
[0m13:56:44.608380 [debug] [MainThread]: Command end result
[0m13:56:44.619932 [info ] [MainThread]: 
[0m13:56:44.620635 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:56:44.620949 [info ] [MainThread]: 
[0m13:56:44.621255 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m13:56:44.621597 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"'DataFrame' object has no attribute 'pull' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 93, in main\n   File \"<string>\", line 78, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/generic.py\", line 5487, in __getattr__\n    return object.__getattribute__(self, name)\n"}
[0m13:56:44.621925 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m13:56:44.622200 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m13:56:44.622461 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:56:44.622715 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:56:44.622969 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:56:44.623224 [error] [MainThread]:   ORA-06512: at line 105
[0m13:56:44.623474 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:56:44.623740 [info ] [MainThread]: 
[0m13:56:44.624035 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:56:44.624592 [debug] [MainThread]: Command `dbt run` failed at 13:56:44.624506 after 74.48 seconds
[0m13:56:44.625013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f88d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d1ced0>]}
[0m13:56:44.625382 [debug] [MainThread]: Flushing usage events
[0m13:57:11.243557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a2c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107917e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107917fd0>]}


============================== 13:57:11.246414 | 875c1001-5f88-4647-9d5b-33305fe293c5 ==============================
[0m13:57:11.246414 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:57:11.246721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:57:11.292622 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:57:11.314983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '875c1001-5f88-4647-9d5b-33305fe293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079289d0>]}
[0m13:57:11.320968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '875c1001-5f88-4647-9d5b-33305fe293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe4850>]}
[0m13:57:11.353930 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:57:11.388600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:57:11.389056 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m13:57:11.409933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '875c1001-5f88-4647-9d5b-33305fe293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107943f10>]}
[0m13:57:11.420985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '875c1001-5f88-4647-9d5b-33305fe293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108399dd0>]}
[0m13:57:11.421346 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:57:11.421534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '875c1001-5f88-4647-9d5b-33305fe293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820c850>]}
[0m13:57:11.422334 [info ] [MainThread]: 
[0m13:57:11.422731 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:57:11.423304 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:57:11.428242 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:57:11.428468 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:57:11.428640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:11.428817 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:57:12.920930 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m13:57:13.029876 [debug] [ThreadPool]: On list_None: Close
[0m13:57:13.143627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:57:13.151380 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:57:13.151907 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:57:13.152133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:13.152360 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:57:14.490690 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m13:57:14.502782 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:57:14.503615 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:57:14.626805 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:57:14.747178 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:57:14.850536 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:57:14.965163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '875c1001-5f88-4647-9d5b-33305fe293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e7f10>]}
[0m13:57:14.966328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:14.966830 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:57:16.240943 [debug] [MainThread]: On master: COMMIT
[0m13:57:16.243410 [debug] [MainThread]: Using oracle connection "master"
[0m13:57:16.244158 [debug] [MainThread]: On master: COMMIT
[0m13:57:16.349402 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:57:16.351670 [debug] [MainThread]: On master: Close
[0m13:57:16.462896 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:16.464193 [info ] [MainThread]: 
[0m13:57:16.470624 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:57:16.471336 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:57:16.471752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:57:16.471940 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:57:16.489234 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:57:16.490427 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:57:16.472083 => 13:57:16.490269
[0m13:57:16.490721 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:57:16.518903 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:57:19.332748 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:57:19.334061 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzEwMzgsImlhdCI6MTY4NzQ2NzQzOH0.PBeXLrzu1Pvl-A_RyS9qT3e8T44LsACxHsZkrCNUgCGO7kr_SRLx8qO-izPS20OnektuhCSxaaCYSmBaImmlP7R533ZlsfFhVqKCEwUdEcos34_GQ8toydxQbwUbJleYo5eojlgzcbbpU2x14TxjsYK7HA-qr7mVj-apKp0kgRL_7O1NV6J0So9JMZZjTZoV8Bv06aLPynh55yXjBphCTXYZZQ2Ncf0_vT6VYZ0Lf3UjcTAUodBOCRTpoo16rXLMJerf6Dim9C0VdmpPR3p0IOfQV7zGT3xpfYtI9KY4rxq1_r6FZEUmbA2GZTNF_7_FoeS-HjyqiqycDUj8tf1mqQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info135716508687"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_205719 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_205719';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:57:19.335478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:19.336162 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:57:45.406271 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m13:57:45.408442 [info ] [Thread-1 (]: oracle adapter: OK
[0m13:57:45.414252 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:57:45.414627 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info135716508687')
        
      order by ordinal_position

  
[0m13:57:45.681469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:45.814073 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:57:45.814809 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:57:45.948389 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:46.059329 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:57:46.059712 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:57:46.194122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:46.313782 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m13:57:46.315899 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:57:46.316175 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info135716508687
    )
  
[0m13:57:47.011565 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:57:47.018369 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:57:47.018707 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:57:47.018900 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:57:47.130666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:47.138584 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:57:47.139050 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info135716508687
[0m13:57:47.320208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:47.331182 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:57:47.332081 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info135716508687 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:57:47.462081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:47.475120 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:57:16.490872 => 13:57:47.475008
[0m13:57:47.475445 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m13:57:47.576625 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:57:47.719491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '875c1001-5f88-4647-9d5b-33305fe293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108447f90>]}
[0m13:57:47.720967 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 31.25s]
[0m13:57:47.722126 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:57:47.723368 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:57:47.724480 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:57:47.725436 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m13:57:47.725899 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:57:47.730615 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:57:47.732439 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:57:47.726228 => 13:57:47.732218
[0m13:57:47.732897 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:57:47.747343 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m13:57:47.747835 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m13:57:47.749772 [info ] [Thread-3 (]: Python model materialization is table
[0m13:57:47.750151 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:57:49.861264 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:57:49.862724 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzEwNjgsImlhdCI6MTY4NzQ2NzQ2OH0.etfnGVsF8D3yWpFxqusuQKm0L2wzNwio1zrBxmYRrYd7aQJjsxJjmmqMqxAXL7KUGxSg_ji9Bak8JkM0XWR_2HOnAAgp0hB-9Ge_2KrMEeSi5zHUB96kMeHD4UupuAd_svSp3h3QwUVKi06TQepbSlZE7j16h7msMT61Z11LGHIJujGklK_izqvj2wF7qy10hZc6J3eOlQMfDYV-JnleXbrs7HHWEJg7501GInJso23Ta4ss9QOS7kYFE9mHg-4ODgWLHVCzL4gqDJrzpaJLaFyIBh9j7_UdZw3H-FJgDE-PhT0TcaTvftLCjLAO_UD9bwjY4r2FPFsZ1m9LlO0HTw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test), "Accuracy": accuracy})
        res_df = res_df.push()
        X_test = X_test.push()
        return res_df.concat(X_test)





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_205749 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_205749';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:57:49.864985 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:57:49.865669 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:58:28.142640 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"'DataFrame' object has no attribute 'push' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 93, in main\n   File \"<string>\", line 78, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/generic.py\", line 5487, in __getattr__\n    return object.__getattribute__(self, name)\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 105
[0m13:58:28.146630 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m13:58:28.255090 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:57:47.733206 => 13:58:28.253818
[0m13:58:28.265998 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"'DataFrame' object has no attribute 'push' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 93, in main\n   File \"<string>\", line 78, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/generic.py\", line 5487, in __getattr__\n    return object.__getattribute__(self, name)\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 105
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:58:28.268935 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '875c1001-5f88-4647-9d5b-33305fe293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c26d0>]}
[0m13:58:28.269658 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 40.54s]
[0m13:58:28.270182 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:58:28.271549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:28.271795 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:58:29.808152 [debug] [MainThread]: On master: COMMIT
[0m13:58:29.810957 [debug] [MainThread]: Using oracle connection "master"
[0m13:58:29.811580 [debug] [MainThread]: On master: COMMIT
[0m13:58:29.926773 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:58:29.929020 [debug] [MainThread]: On master: Close
[0m13:58:30.036966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:30.038209 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:58:30.038687 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:58:30.039280 [info ] [MainThread]: 
[0m13:58:30.039782 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 18.62 seconds (78.62s).
[0m13:58:30.040824 [debug] [MainThread]: Command end result
[0m13:58:30.055235 [info ] [MainThread]: 
[0m13:58:30.055632 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:58:30.055788 [info ] [MainThread]: 
[0m13:58:30.055940 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m13:58:30.056108 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"'DataFrame' object has no attribute 'push' : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 93, in main\n   File \"<string>\", line 78, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/generic.py\", line 5487, in __getattr__\n    return object.__getattribute__(self, name)\n"}
[0m13:58:30.056282 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m13:58:30.056415 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m13:58:30.056553 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:58:30.056682 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:58:30.056817 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:58:30.056953 [error] [MainThread]:   ORA-06512: at line 105
[0m13:58:30.057097 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:58:30.057234 [info ] [MainThread]: 
[0m13:58:30.057392 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:58:30.057758 [debug] [MainThread]: Command `dbt run` failed at 13:58:30.057697 after 78.83 seconds
[0m13:58:30.057992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079288d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032b2c50>]}
[0m13:58:30.058205 [debug] [MainThread]: Flushing usage events
[0m14:01:02.863343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f17950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f17f90>]}


============================== 14:01:02.865908 | 759d74fb-b8e5-4d08-b6be-bde2504d422e ==============================
[0m14:01:02.865908 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:01:02.866240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:01:02.918240 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:01:02.941801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '759d74fb-b8e5-4d08-b6be-bde2504d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f96e50>]}
[0m14:01:02.947956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '759d74fb-b8e5-4d08-b6be-bde2504d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cd2d0>]}
[0m14:01:02.980606 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:01:03.021421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:03.021894 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m14:01:03.042945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '759d74fb-b8e5-4d08-b6be-bde2504d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071882d0>]}
[0m14:01:03.051337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '759d74fb-b8e5-4d08-b6be-bde2504d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dd650>]}
[0m14:01:03.051725 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:01:03.051906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '759d74fb-b8e5-4d08-b6be-bde2504d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700cb50>]}
[0m14:01:03.052702 [info ] [MainThread]: 
[0m14:01:03.053104 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:01:03.053665 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:01:03.058615 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:01:03.058868 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:01:03.059042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:03.059219 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:01:05.489302 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:01:05.620636 [debug] [ThreadPool]: On list_None: Close
[0m14:01:05.757001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:01:05.765223 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:01:05.765893 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:01:05.766253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:05.766624 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:01:07.813920 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:01:07.825663 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:01:07.826472 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:01:08.004328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:01:08.270380 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:01:08.420451 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:01:08.579715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '759d74fb-b8e5-4d08-b6be-bde2504d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679df50>]}
[0m14:01:08.580849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:08.581334 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:01:10.565151 [debug] [MainThread]: On master: COMMIT
[0m14:01:10.567239 [debug] [MainThread]: Using oracle connection "master"
[0m14:01:10.567850 [debug] [MainThread]: On master: COMMIT
[0m14:01:10.689306 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:01:10.691942 [debug] [MainThread]: On master: Close
[0m14:01:10.822394 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:01:10.823346 [info ] [MainThread]: 
[0m14:01:10.829257 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:01:10.830079 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:01:10.830974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:01:10.831386 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:01:10.850999 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:01:10.852238 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:01:10.831671 => 14:01:10.852098
[0m14:01:10.852533 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:01:10.880865 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:01:13.207530 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:01:13.208923 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzEyNzEsImlhdCI6MTY4NzQ2NzY3MX0.gAiH5Kf45p8WPr9XYnmheAGcyl3CagCv2AKxO6wKDWWOzu5ocyU0kydOF2yYpX6jSKZMrvLylqF6IXVJyi6bsfLqlzngGIwxBfKllnhNRHc0QT--WH9ZaAMV8enJTgTTHBinZ3gcaRXK_greGFncuaIlRvVBZraJeUCze9ug2qZ6d4t4A74Ko07gwd4YmqopHmrJNod22g13eztdVXb1XwAmYzzVqDLIzrQltu7jFSuEbSuyD0vXX-kYd6f5eODEupQ2qmJa0zIMRbZdIvpudPtHslR7v2JkgJZt-Ezi8V0T4TYukFOyWT7Neg6o3vnjm2ZcAjX_WD-iD_VLS4q3WA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info140110871026"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_210113 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_210113';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:01:13.210495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:13.211174 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:01:14.952826 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m14:01:14.954503 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:01:15.057467 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:01:10.852722 => 14:01:15.056111
[0m14:01:15.103245 [debug] [Thread-1 (]: Database Error in model stg_web_order_info (models/staging/stg_web_order_info.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m14:01:15.107189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '759d74fb-b8e5-4d08-b6be-bde2504d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738ff50>]}
[0m14:01:15.108384 [error] [Thread-1 (]: 1 of 2 ERROR creating python incremental model FAWDBTCORE.stg_web_order_info ... [[31mERROR[0m in 4.28s]
[0m14:01:15.109041 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:01:15.110186 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:01:15.111025 [info ] [Thread-3 (]: 2 of 2 SKIP relation FAWDBTCORE.web_events_python .............................. [[33mSKIP[0m]
[0m14:01:15.111744 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:01:15.113768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:01:15.114360 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:01:16.520359 [debug] [MainThread]: On master: COMMIT
[0m14:01:16.522093 [debug] [MainThread]: Using oracle connection "master"
[0m14:01:16.522615 [debug] [MainThread]: On master: COMMIT
[0m14:01:16.641122 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:01:16.642820 [debug] [MainThread]: On master: Close
[0m14:01:16.746475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:16.747410 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:01:16.748222 [info ] [MainThread]: 
[0m14:01:16.748939 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 13.70 seconds (13.70s).
[0m14:01:16.749704 [debug] [MainThread]: Command end result
[0m14:01:16.757495 [info ] [MainThread]: 
[0m14:01:16.757843 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:01:16.758027 [info ] [MainThread]: 
[0m14:01:16.758191 [error] [MainThread]: [33mDatabase Error in model stg_web_order_info (models/staging/stg_web_order_info.py)[0m
[0m14:01:16.758344 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m14:01:16.758499 [info ] [MainThread]: 
[0m14:01:16.758649 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m14:01:16.758947 [debug] [MainThread]: Command `dbt run` failed at 14:01:16.758898 after 13.91 seconds
[0m14:01:16.759179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026f2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026f0e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f5c290>]}
[0m14:01:16.759375 [debug] [MainThread]: Flushing usage events
[0m14:01:53.622644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10560bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105617d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105617f90>]}


============================== 14:01:53.625011 | 5e57de7d-1336-4c1f-bda0-cf85f7677e4a ==============================
[0m14:01:53.625011 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:01:53.625328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:01:53.671269 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:01:53.693424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e57de7d-1336-4c1f-bda0-cf85f7677e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e6290>]}
[0m14:01:53.699515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e57de7d-1336-4c1f-bda0-cf85f7677e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d29b50>]}
[0m14:01:53.731624 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:01:53.771113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:01:53.771420 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:01:53.775129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e57de7d-1336-4c1f-bda0-cf85f7677e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0eed0>]}
[0m14:01:53.779728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e57de7d-1336-4c1f-bda0-cf85f7677e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105642f50>]}
[0m14:01:53.780001 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:01:53.780182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e57de7d-1336-4c1f-bda0-cf85f7677e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d46310>]}
[0m14:01:53.780925 [info ] [MainThread]: 
[0m14:01:53.781281 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:01:53.781841 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:01:53.786924 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:01:53.787197 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:01:53.787364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:53.787539 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:01:55.994116 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:01:56.102651 [debug] [ThreadPool]: On list_None: Close
[0m14:01:56.210376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:01:56.218593 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:01:56.219414 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:01:56.219818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:56.220215 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:01:57.678392 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:01:57.690253 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:01:57.691007 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:01:57.825796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:01:58.167674 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:01:58.268477 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:01:58.398101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e57de7d-1336-4c1f-bda0-cf85f7677e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0ac50>]}
[0m14:01:58.399099 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:58.399556 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:02:00.099492 [debug] [MainThread]: On master: COMMIT
[0m14:02:00.101806 [debug] [MainThread]: Using oracle connection "master"
[0m14:02:00.102444 [debug] [MainThread]: On master: COMMIT
[0m14:02:00.266729 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:02:00.269210 [debug] [MainThread]: On master: Close
[0m14:02:00.441486 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:02:00.442554 [info ] [MainThread]: 
[0m14:02:00.449186 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:02:00.449980 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:02:00.450857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:02:00.451314 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:02:00.473372 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:02:00.474434 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:02:00.451626 => 14:02:00.474335
[0m14:02:00.474709 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:02:00.498695 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:02:03.942676 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:02:03.944097 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzEzMjIsImlhdCI6MTY4NzQ2NzcyMn0.Ulen2gh7PzPEDx-TCMzVHIBua4BfJWsLXN_awXCJGIzva2igm5dWmGmAmRcdsz30rn7UcuuCtbUPzh_XBPMnoP-EwnbyMM0JvLIv2DPJ3G5HG7s-_Jmmlg_KsDP0B4osFSPS5WVRFHI0oYtEdJH7o2qspfUbBOM0u2Gpn-m_PmIlqI8WMAMo0xNTFLma9w5VwkIX0sSoaTZ9kMHuu8aEDoUEzePrX3n316HBqthvunNoq8OomLFfgzCeXrC6S0pMOZmjGRVn5DJltIHluoFpYbXj37SiZIXcrMB87PjCmxym-Kg9Or_tUqmGTXqJXvME-KqMrxbo5yrnEE8A2qhiEQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info140200492060"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_210203 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_210203';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:02:03.945561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:03.946236 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:02:31.026688 [debug] [Thread-1 (]: SQL status: OK in 27.0 seconds
[0m14:02:31.030907 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:02:31.040825 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:02:31.041904 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info140200492060')
        
      order by ordinal_position

  
[0m14:02:31.447252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:02:31.726569 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:02:31.727678 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:02:32.023107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:02:32.278847 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:02:32.279871 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:02:32.545351 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:02:32.772288 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:02:32.774651 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:02:32.775019 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info140200492060
    )
  
[0m14:02:33.540889 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:02:33.553426 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:02:33.554286 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:02:33.554831 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:02:33.806976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:02:33.815987 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:02:33.816703 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info140200492060
[0m14:02:34.114544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:02:34.126384 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:02:34.127250 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info140200492060 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:02:34.380601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:02:34.391876 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:02:00.474855 => 14:02:34.391705
[0m14:02:34.392346 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:02:34.636898 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:02:34.900429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e57de7d-1336-4c1f-bda0-cf85f7677e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc9510>]}
[0m14:02:34.903434 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 34.45s]
[0m14:02:34.904553 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:02:34.905777 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:02:34.907079 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:02:34.908372 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:02:34.908844 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:02:34.913968 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:02:34.919638 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:02:34.909167 => 14:02:34.919403
[0m14:02:34.920005 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:02:34.936886 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m14:02:34.937332 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:02:34.938632 [info ] [Thread-3 (]: Python model materialization is table
[0m14:02:34.938882 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:02:37.515809 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:02:37.517292 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzEzNTYsImlhdCI6MTY4NzQ2Nzc1Nn0.iMvhBjgglCqs-ctROI28EY3lbay20SLPpIZz3NYlgCWCzji8BtbPdQIpc92zLGk0toy7aE07968hSTcbx3Ejtvbe3e_raVdY-J44blQ8wKLwEABYzuUEJb1Ugu6ba7KFVO_f9aEZkWFr4MWL7ljnMSQoCgELzyj3mxPbmEgye0iB6ah6ZA9sqX5upZEzdl8k1k0YrMzEI8oZT9WaeNNciIb51HG9m2Bs_kg8TPWKs1Fk2VuznLLwTwKugcCs3_ui4uBm-2uo1LZtgXdJqRkwMLNXUTPqnHSrJtyebyN13HLjq5iN7iI-iN7sYQDXOWokH80fVi8aTmMsKRqZkey0Fg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_Actual": label_encoder.inverse_transform(y_test), "Accuracy": accuracy})
        res_df = oml.push(res_df)
        X_test = oml.push(X_test)
        return res_df.concat(X_test)





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_210237 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_210237';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:02:37.518864 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:02:37.519852 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:03:15.408126 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"OML objects are not from same data source : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 93, in main\n   File \"<string>\", line 80, in model\n   File \"oml/core/vector.py\", line 407, in oml.core.vector._Vector.concat\n   File \"oml/core/util.py\", line 244, in oml.core.util._checkObject\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 105
[0m14:03:15.410996 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:03:15.541804 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:02:34.920263 => 14:03:15.538496
[0m14:03:15.554983 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"OML objects are not from same data source : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 93, in main\n   File \"<string>\", line 80, in model\n   File \"oml/core/vector.py\", line 407, in oml.core.vector._Vector.concat\n   File \"oml/core/util.py\", line 244, in oml.core.util._checkObject\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 105
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:03:15.557178 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e57de7d-1336-4c1f-bda0-cf85f7677e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f3ed0>]}
[0m14:03:15.557677 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 40.65s]
[0m14:03:15.557965 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:03:15.559457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:15.559739 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:03:16.955146 [debug] [MainThread]: On master: COMMIT
[0m14:03:16.957367 [debug] [MainThread]: Using oracle connection "master"
[0m14:03:16.958812 [debug] [MainThread]: On master: COMMIT
[0m14:03:17.060743 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:03:17.063062 [debug] [MainThread]: On master: Close
[0m14:03:17.178766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:17.179730 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:03:17.180186 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:03:17.180714 [info ] [MainThread]: 
[0m14:03:17.181181 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 23.40 seconds (83.40s).
[0m14:03:17.182128 [debug] [MainThread]: Command end result
[0m14:03:17.208605 [info ] [MainThread]: 
[0m14:03:17.209259 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:03:17.209486 [info ] [MainThread]: 
[0m14:03:17.209688 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:03:17.209901 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"OML objects are not from same data source : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 93, in main\n   File \"<string>\", line 80, in model\n   File \"oml/core/vector.py\", line 407, in oml.core.vector._Vector.concat\n   File \"oml/core/util.py\", line 244, in oml.core.util._checkObject\n"}
[0m14:03:17.210120 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m14:03:17.210284 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m14:03:17.210446 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:03:17.210603 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:03:17.210767 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:03:17.211305 [error] [MainThread]:   ORA-06512: at line 105
[0m14:03:17.211625 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:03:17.211851 [info ] [MainThread]: 
[0m14:03:17.212082 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:03:17.212607 [debug] [MainThread]: Command `dbt run` failed at 14:03:17.212525 after 83.61 seconds
[0m14:03:17.212977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10132ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10132ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f8290>]}
[0m14:03:17.213351 [debug] [MainThread]: Flushing usage events
[0m14:11:11.884141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108913b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891ff90>]}


============================== 14:11:11.886534 | 29ff8b99-2f95-40c0-8aa9-e43617a20ef0 ==============================
[0m14:11:11.886534 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:11:11.886840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:11:11.928010 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:11:11.950431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29ff8b99-2f95-40c0-8aa9-e43617a20ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108930850>]}
[0m14:11:11.956749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29ff8b99-2f95-40c0-8aa9-e43617a20ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109031510>]}
[0m14:11:11.988596 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:11:12.019473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:12.019952 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m14:11:12.035986 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.oracle_dbt.web_events_python' (models/web_events_python.py) depends on a source named 'FAWDBTCORE.new_products' which was not found
[0m14:11:12.036436 [debug] [MainThread]: Command `dbt run` failed at 14:11:12.036385 after 0.17 seconds
[0m14:11:12.036666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089337d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109042050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a8610>]}
[0m14:11:12.036886 [debug] [MainThread]: Flushing usage events
[0m14:11:29.392804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107917fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107917810>]}


============================== 14:11:29.395571 | 3cb24fb5-52de-487a-8f85-ef52dfd4e6aa ==============================
[0m14:11:29.395571 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:11:29.395901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:11:29.438834 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:11:29.461290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cb24fb5-52de-487a-8f85-ef52dfd4e6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107928a90>]}
[0m14:11:29.467608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cb24fb5-52de-487a-8f85-ef52dfd4e6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c9210>]}
[0m14:11:29.499631 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:11:29.531040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:29.531506 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m14:11:29.552115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cb24fb5-52de-487a-8f85-ef52dfd4e6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11027e790>]}
[0m14:11:29.562206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cb24fb5-52de-487a-8f85-ef52dfd4e6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110137210>]}
[0m14:11:29.562574 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:11:29.562753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cb24fb5-52de-487a-8f85-ef52dfd4e6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100fc110>]}
[0m14:11:29.563518 [info ] [MainThread]: 
[0m14:11:29.563895 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:11:29.564460 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:11:29.569153 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:11:29.569368 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:11:29.569535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:29.569706 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:11:31.148863 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:11:31.260026 [debug] [ThreadPool]: On list_None: Close
[0m14:11:31.369639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:11:31.378005 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:11:31.378485 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:11:31.378780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:31.379080 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:11:32.744507 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:11:32.756844 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:11:32.757647 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:11:32.883149 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:33.092493 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:11:33.196147 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:11:33.305081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cb24fb5-52de-487a-8f85-ef52dfd4e6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f15d0>]}
[0m14:11:33.305653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:33.306016 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:11:34.563699 [debug] [MainThread]: On master: COMMIT
[0m14:11:34.565735 [debug] [MainThread]: Using oracle connection "master"
[0m14:11:34.566509 [debug] [MainThread]: On master: COMMIT
[0m14:11:34.670746 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:34.673257 [debug] [MainThread]: On master: Close
[0m14:11:34.794621 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:34.795544 [info ] [MainThread]: 
[0m14:11:34.801198 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:11:34.801961 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:11:34.802522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:11:34.802715 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:11:34.819067 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:11:34.820654 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:11:34.802859 => 14:11:34.820453
[0m14:11:34.821040 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:11:34.848766 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:11:37.164135 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:11:37.165320 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzE4OTYsImlhdCI6MTY4NzQ2ODI5Nn0.UlieSC0zXYGSUw-eWBhw8nL8ul_D3ExBR-9TIrIEJRFX1vGCSrfmSK0AsfrOihmmz-LetAfycmvpMPrAazuOC2OipdbicHzYdX5kbrhm6PhWcJabdTl09nR-Ba7wVgPwokeCStdTTSs-3kx4SwPRakSGMtTJEun5Uh4aQye69TkQdMU2FnQ3SEKDasRbemPA9QNUV6Za_25WnVyAdfx7m5YcLwYjAOFh4B0jpgiaiB3YSo9POSqq_WnrLO2L2Z1Niviqwbf3i8JouLRjuGa1fhdz5AV2DJbCOw6MrAUcleMFeSgNsOnkayCzpTNNTiZ3tzeF7Kd3plQTg0o_XZQzkQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info141134839131"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_211137 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_211137';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:11:37.166696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:37.167360 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:12:02.451298 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m14:12:02.455904 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:12:02.466687 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:02.467721 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info141134839131')
        
      order by ordinal_position

  
[0m14:12:02.762986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:02.877263 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:02.878216 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:12:03.084989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:03.202557 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:03.203378 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:12:03.412150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:03.533030 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:12:03.534070 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:03.534349 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info141134839131
    )
  
[0m14:12:04.191793 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:12:04.206721 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:12:04.207445 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:04.207817 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:12:04.311238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:04.320186 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:04.320949 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info141134839131
[0m14:12:04.551180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:04.565153 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:04.565995 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info141134839131 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:12:04.861314 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:04.879160 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:11:34.821249 => 14:12:04.878907
[0m14:12:04.879883 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:12:04.984786 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:12:05.128386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cb24fb5-52de-487a-8f85-ef52dfd4e6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104af910>]}
[0m14:12:05.131101 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.33s]
[0m14:12:05.132549 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:12:05.134135 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:12:05.135079 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:12:05.136087 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:12:05.136555 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:12:05.141812 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:12:05.143812 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:12:05.136884 => 14:12:05.143598
[0m14:12:05.144287 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:12:05.156944 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m14:12:05.157413 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:12:05.159307 [info ] [Thread-3 (]: Python model materialization is table
[0m14:12:05.159655 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:12:07.235031 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:12:07.236010 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzE5MjYsImlhdCI6MTY4NzQ2ODMyNn0.lQDGtnQEMkTpXl_0P5Gu-_RZl6mJFUi80xG2yVeygL7O7Ek4Tqxv2p9b_zaO8Xo8fkYJ2rT1AkE2H5bRuqtr47qEZ4w-eilmLOw8wX7iWWEwvMU4JwYP40T74B7_JOYM-B9yo7qyYR6qa-FcTAxxHh2qRc_5NRRil-Km1qY7AB9cTp0dygMRAd3-I-hIrXsoQWAm4_EeuU4Ootek20wvhOsNzxNBTi6G6xGSoXRRhzeL6ueuQe_sbt1E03awBRzJKqiEoT50TZmkqwyeBtSwMMYy5tC4d28pAHaVq8rrrgCmRmlwJnBBqFWeEY_3-rQe0C_NlRyA0AkxhBRy2QKNJQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Accuracy": accuracy})
        y_pred = classifier.predict(x)
    
        df['Shipping_City_Prediction'] = y_pred
        
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211207 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211207';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:12:07.236993 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:12:07.237628 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:12:08.963921 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-06550: line 84, column 13:
PLS-00103: Encountered the symbol "SHIPPING_CITY_PREDICTION" when expecting one of the following:

   ) , * & = - + < / > at in is mod remainder not rem =>
   <an exponent (**)> <> or != or ~= >= <= <> and or like like2
   like4 likec between || multiset member submultiset
[0m14:12:08.966529 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:12:09.080182 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:12:05.144567 => 14:12:09.078880
[0m14:12:09.093612 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06550: line 84, column 13:
  PLS-00103: Encountered the symbol "SHIPPING_CITY_PREDICTION" when expecting one of the following:
  
     ) , * & = - + < / > at in is mod remainder not rem =>
     <an exponent (**)> <> or != or ~= >= <= <> and or like like2
     like4 likec between || multiset member submultiset
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:12:09.096257 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cb24fb5-52de-487a-8f85-ef52dfd4e6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046c890>]}
[0m14:12:09.096989 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.96s]
[0m14:12:09.097514 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:12:09.099235 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:09.099575 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:12:10.480434 [debug] [MainThread]: On master: COMMIT
[0m14:12:10.482793 [debug] [MainThread]: Using oracle connection "master"
[0m14:12:10.483780 [debug] [MainThread]: On master: COMMIT
[0m14:12:10.612092 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:10.614364 [debug] [MainThread]: On master: Close
[0m14:12:10.749572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:10.750902 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:12:10.751452 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:12:10.752016 [info ] [MainThread]: 
[0m14:12:10.752443 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 41.19 seconds (41.19s).
[0m14:12:10.753263 [debug] [MainThread]: Command end result
[0m14:12:10.766567 [info ] [MainThread]: 
[0m14:12:10.766913 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:12:10.767062 [info ] [MainThread]: 
[0m14:12:10.767207 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:12:10.767350 [error] [MainThread]:   ORA-06550: line 84, column 13:
[0m14:12:10.767488 [error] [MainThread]:   PLS-00103: Encountered the symbol "SHIPPING_CITY_PREDICTION" when expecting one of the following:
[0m14:12:10.767625 [error] [MainThread]:   
[0m14:12:10.767754 [error] [MainThread]:      ) , * & = - + < / > at in is mod remainder not rem =>
[0m14:12:10.767938 [error] [MainThread]:      <an exponent (**)> <> or != or ~= >= <= <> and or like like2
[0m14:12:10.768191 [error] [MainThread]:      like4 likec between || multiset member submultiset
[0m14:12:10.768441 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:12:10.768700 [info ] [MainThread]: 
[0m14:12:10.768984 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:12:10.769508 [debug] [MainThread]: Command `dbt run` failed at 14:12:10.769427 after 41.40 seconds
[0m14:12:10.769906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102502c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102500e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec6290>]}
[0m14:12:10.770234 [debug] [MainThread]: Flushing usage events
[0m14:12:22.487764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107575f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a07fd0>]}


============================== 14:12:22.490585 | a5a52a68-179b-4b8a-984d-5b573fac825d ==============================
[0m14:12:22.490585 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:12:22.490908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:12:22.533691 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:12:22.556028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5a52a68-179b-4b8a-984d-5b573fac825d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a18810>]}
[0m14:12:22.562369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5a52a68-179b-4b8a-984d-5b573fac825d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a320d0>]}
[0m14:12:22.594016 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:12:22.629845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:12:22.630301 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m14:12:22.650634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5a52a68-179b-4b8a-984d-5b573fac825d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e7b10>]}
[0m14:12:22.657596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5a52a68-179b-4b8a-984d-5b573fac825d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a07f10>]}
[0m14:12:22.657913 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:12:22.658093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5a52a68-179b-4b8a-984d-5b573fac825d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a79410>]}
[0m14:12:22.658854 [info ] [MainThread]: 
[0m14:12:22.659306 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:12:22.659884 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:12:22.665014 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:12:22.665281 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:12:22.665448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:22.665616 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:12:24.051905 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:12:24.167096 [debug] [ThreadPool]: On list_None: Close
[0m14:12:24.283558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:12:24.290552 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:12:24.290903 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:12:24.291313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:24.291526 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:12:25.640211 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:12:25.651737 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:12:25.652351 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:12:25.792542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:12:26.005673 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:12:26.107602 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:12:26.222523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5a52a68-179b-4b8a-984d-5b573fac825d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109222a50>]}
[0m14:12:26.223249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:26.223503 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:12:27.608332 [debug] [MainThread]: On master: COMMIT
[0m14:12:27.610516 [debug] [MainThread]: Using oracle connection "master"
[0m14:12:27.611633 [debug] [MainThread]: On master: COMMIT
[0m14:12:27.718050 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:27.720415 [debug] [MainThread]: On master: Close
[0m14:12:27.832229 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:12:27.833020 [info ] [MainThread]: 
[0m14:12:27.838190 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:12:27.838900 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:12:27.839430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:12:27.839686 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:12:27.851557 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:12:27.852795 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:12:27.839843 => 14:12:27.852644
[0m14:12:27.853095 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:12:27.878285 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:12:30.228481 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:30.229850 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzE5NDgsImlhdCI6MTY4NzQ2ODM0OH0.IdPlXQeHozTOPMM7TfVJie32mEw9GsYtvqC8u9UdNcHalH-Um74_enDO_eozgWBY7FVRRfSderQ_H9zHxAvXJHb6Ut_dUc30PsyZSdMl-kklDh_w16ky8oqWZb0xqIXriMejhDfOpNhv1Ix87uBt2w6WK8PIzkuFEctIqGUtiprCRUsMmj2PBVpHojZvUHNQttVx7tOJ4wdp1ETHWzqpx_uhmbShcBZJ_yF3Qusw7YrI29d4ZdchgwJEPLp0jPReFJxCK-a_2I_azb-oRp3HV2GqsqUE2Huc8oBKwvHMWl0OiE5jdUruFMZGhYXBNYt1klJNuvB1hAzK3x9T9FLKYQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info141227869069"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_211230 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_211230';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:12:30.231472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:30.232048 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:12:55.592388 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m14:12:55.597634 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:12:55.607267 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:55.608214 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info141227869069')
        
      order by ordinal_position

  
[0m14:12:55.961383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:56.160800 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:56.161904 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:12:56.377990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:56.563280 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:56.564348 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:12:56.784881 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:56.986300 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:12:56.988088 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:56.988497 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info141227869069
    )
  
[0m14:12:57.645011 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:12:57.657405 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:12:57.658188 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:57.658570 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:12:57.848268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:57.858949 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:57.859746 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info141227869069
[0m14:12:58.061866 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:58.072450 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:12:58.072887 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info141227869069 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:12:58.361441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:58.378259 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:12:27.853238 => 14:12:58.378051
[0m14:12:58.378875 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:12:58.572667 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:12:58.746960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5a52a68-179b-4b8a-984d-5b573fac825d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109372cd0>]}
[0m14:12:58.749673 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.91s]
[0m14:12:58.750907 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:12:58.752449 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:12:58.753460 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:12:58.754644 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:12:58.755128 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:12:58.760546 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:12:58.762500 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:12:58.755456 => 14:12:58.762290
[0m14:12:58.762924 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:12:58.776012 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m14:12:58.776448 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:12:58.778428 [info ] [Thread-3 (]: Python model materialization is table
[0m14:12:58.778780 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:13:01.336204 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:13:01.338271 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzE5ODAsImlhdCI6MTY4NzQ2ODM4MH0.WZQbJqgSDY-8aYGPvlZCfc37O5PYFX7xo3ZmcJ98tdMSEz8Of9OwrB6M_61Vbv4BdFdzjqjYOyKMHPK0PlMzdbU32ZKjpbBQCc1MVnUcH2rJzNl-03sbegUS47v_O5FYTcy8OGCrVRFiCZRO06E3E5szslbzY8-jb1kCFSJ6v3WEjB0oWhVGiwHgCE3denZGqczS2IG7_ZnxnV-lMgWj903aNIrjag_X00RgLRZRuiMeUffsfIGjMtQUHlhqesRdzI0kkZhoWx1qq_owZB8KbRmvtUpNDB6NSjrKVaeBlziGsGcDWox4gGls3K4-AlNkwRLikZBkkq_eBm5jeam4gw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Accuracy": accuracy})
        y_pred = classifier.predict(x)
    
        df["Shipping_City_Prediction"] = y_pred
        
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211301 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211301';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:13:01.339954 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:13:01.340557 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:14:03.588142 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m14:14:03.590204 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:14:03.703861 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:12:58.763193 => 14:14:03.702256
[0m14:14:03.716145 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:14:03.718471 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5a52a68-179b-4b8a-984d-5b573fac825d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946cad0>]}
[0m14:14:03.719085 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 64.96s]
[0m14:14:03.719514 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:14:03.720998 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:03.721356 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:14:05.108517 [debug] [MainThread]: On master: COMMIT
[0m14:14:05.110904 [debug] [MainThread]: Using oracle connection "master"
[0m14:14:05.111715 [debug] [MainThread]: On master: COMMIT
[0m14:14:05.218412 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:14:05.220835 [debug] [MainThread]: On master: Close
[0m14:14:05.334900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:05.335844 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:14:05.336302 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:14:05.336824 [info ] [MainThread]: 
[0m14:14:05.337305 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 42.68 seconds (102.68s).
[0m14:14:05.338145 [debug] [MainThread]: Command end result
[0m14:14:05.349008 [info ] [MainThread]: 
[0m14:14:05.349448 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:14:05.349738 [info ] [MainThread]: 
[0m14:14:05.350026 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:14:05.350302 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m14:14:05.350566 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m14:14:05.350829 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m14:14:05.351089 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m14:14:05.351336 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m14:14:05.351554 [error] [MainThread]:   ORA-29276: transfer timeout
[0m14:14:05.351778 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m14:14:05.351994 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m14:14:05.352216 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m14:14:05.352436 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:14:05.352648 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:14:05.352860 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:14:05.353068 [error] [MainThread]:   ORA-06512: at line 107
[0m14:14:05.353278 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:14:05.353504 [info ] [MainThread]: 
[0m14:14:05.353761 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:14:05.354234 [debug] [MainThread]: Command `dbt run` failed at 14:14:05.354160 after 102.89 seconds
[0m14:14:05.354592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10533ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10533ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e8650>]}
[0m14:14:05.354914 [debug] [MainThread]: Flushing usage events
[0m14:18:56.682283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067efd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fbf90>]}


============================== 14:18:56.685132 | 9b2817a1-4204-4a30-9bc0-1e1b4812c94b ==============================
[0m14:18:56.685132 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:18:56.685474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:18:56.728491 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:18:56.751077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b2817a1-4204-4a30-9bc0-1e1b4812c94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ecb10>]}
[0m14:18:56.757259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b2817a1-4204-4a30-9bc0-1e1b4812c94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0dd50>]}
[0m14:18:56.789739 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:18:56.824790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:18:56.825095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:18:56.828504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b2817a1-4204-4a30-9bc0-1e1b4812c94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff23d0>]}
[0m14:18:56.833197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b2817a1-4204-4a30-9bc0-1e1b4812c94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ecc10>]}
[0m14:18:56.833537 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:18:56.833716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b2817a1-4204-4a30-9bc0-1e1b4812c94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0e110>]}
[0m14:18:56.834467 [info ] [MainThread]: 
[0m14:18:56.834854 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:18:56.835396 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:18:56.840277 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:18:56.840491 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:18:56.840657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:56.840829 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:18:58.344309 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:18:58.454288 [debug] [ThreadPool]: On list_None: Close
[0m14:18:58.569863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:18:58.578624 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:18:58.579326 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:18:58.579712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:58.580112 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:18:59.921435 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:18:59.932519 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:18:59.933152 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:19:00.059516 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:00.258219 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:19:00.360018 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:19:00.473157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b2817a1-4204-4a30-9bc0-1e1b4812c94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687b890>]}
[0m14:19:00.474280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:00.474764 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:19:01.734590 [debug] [MainThread]: On master: COMMIT
[0m14:19:01.736605 [debug] [MainThread]: Using oracle connection "master"
[0m14:19:01.737423 [debug] [MainThread]: On master: COMMIT
[0m14:19:01.839266 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:19:01.841614 [debug] [MainThread]: On master: Close
[0m14:19:01.950279 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:19:01.951907 [info ] [MainThread]: 
[0m14:19:01.958026 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:19:01.958406 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:19:01.958885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:19:01.959079 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:19:01.976722 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:19:01.977679 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:19:01.959217 => 14:19:01.977553
[0m14:19:01.977915 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:19:02.005957 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:19:04.239934 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:19:04.241258 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzIzNDMsImlhdCI6MTY4NzQ2ODc0M30.Zt1W10zrKu9onqw6MGLY__93ysbBjsSzgrYYASnKVOmEC3Tw6wvqiruGECGVzc2wZJTGuRNm0bnMuZJfxATh94r8IcuwgO6lbkCoSscL4WjW49amylpnh6aMDHfjeyuLu5IhAZkdyS6nR9tgqu8UihK3nrJncfe7v8DwZru0lRZBCkz7jlHF5B7RiP4mTWyV5yfEzrqO2bEYIwjojdsUX36NQnaDdOYNrKnwkWEZiK_Qxr-fE2bDqhuw6Isu6-7y4PfKBugXH6VnfPpv-Mv6WtBzv2MyfYOu8NTFgs6-8mPy3Iet66mZUtyJ9lTUBtAYLI3qpyLEe-OLtFLC_urolA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info141901999025"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_211904 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_211904';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:19:04.242670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:04.243267 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:19:31.013381 [debug] [Thread-1 (]: SQL status: OK in 27.0 seconds
[0m14:19:31.018945 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:19:31.029126 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:19:31.030123 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info141901999025')
        
      order by ordinal_position

  
[0m14:19:31.295027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:31.406970 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:19:31.408001 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:19:31.537065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:31.652307 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:19:31.653358 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:19:31.782911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:31.910227 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:19:31.912269 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:19:31.912641 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info141901999025
    )
  
[0m14:19:32.605605 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:19:32.620673 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:19:32.621564 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:19:32.622214 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:19:32.722953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:32.728470 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:19:32.728842 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info141901999025
[0m14:19:32.903198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:32.914615 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:19:32.915379 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info141901999025 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:19:33.037497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:33.054566 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:19:01.978058 => 14:19:33.054326
[0m14:19:33.055259 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:19:33.153231 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:19:33.258694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b2817a1-4204-4a30-9bc0-1e1b4812c94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107179750>]}
[0m14:19:33.261976 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 31.30s]
[0m14:19:33.263075 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:19:33.264555 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:19:33.265732 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:19:33.266928 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:19:33.267405 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:19:33.272761 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:19:33.274936 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:19:33.267731 => 14:19:33.274714
[0m14:19:33.275398 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:19:33.291619 [debug] [Thread-3 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m14:19:33.292047 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:19:33.295290 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:19:33.295612 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:19:33.295886 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:19:33.296141 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:19:34.758507 [debug] [Thread-3 (]: SQL status: OK in 1.0 seconds
[0m14:19:34.765174 [info ] [Thread-3 (]: Python model materialization is table
[0m14:19:34.766186 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:19:36.912087 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:19:36.914015 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzIzNzUsImlhdCI6MTY4NzQ2ODc3NX0.Xbgw2wYEsw5pE-9ndoD5Ar1Cg0D32pj5fnf4mazUbb1rX-2-rnir7A8pjQX-Wk2ABr1R53NoehbHIyVc9DvPSMDoZNyrYLxF3GUCLAHWIwaAXU3h8T5oGBC-T_ggCpaf6G0B-2_Pw1z7cv-B4NMh9cSE_DPUmO3qrcQqln5LfMd9tob3egglHibE553kYWLqjWTr2h4k_LXstbU8yyumwLeyxAjvAA2MTIrK3X179bFtW9ZTs_11BS1Y2IM8tH-E-xQzwCmvTeDWXulScOZegYjnY665ihTtjBGy2fWhcn8118eh0ammC14XprKAvusjXaCOJ85y0NfdNMfcuM41KQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Accuracy": accuracy})
        y_pred = classifier.predict(x)
    
        df["Shipping_City_Prediction"] = y_pred
        
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211936 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_211936';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:20:37.412950 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m14:20:37.415355 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:20:37.523065 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:19:33.275686 => 14:20:37.522564
[0m14:20:37.536831 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:20:37.539175 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b2817a1-4204-4a30-9bc0-1e1b4812c94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072329d0>]}
[0m14:20:37.539706 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 64.27s]
[0m14:20:37.540514 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:20:37.542036 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:20:37.542521 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:20:39.173975 [debug] [MainThread]: On master: COMMIT
[0m14:20:39.176848 [debug] [MainThread]: Using oracle connection "master"
[0m14:20:39.177846 [debug] [MainThread]: On master: COMMIT
[0m14:20:39.297533 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:20:39.300269 [debug] [MainThread]: On master: Close
[0m14:20:39.430162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:39.431209 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:20:39.431665 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:20:39.432109 [info ] [MainThread]: 
[0m14:20:39.432502 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 42.60 seconds (102.60s).
[0m14:20:39.433336 [debug] [MainThread]: Command end result
[0m14:20:39.442463 [info ] [MainThread]: 
[0m14:20:39.442946 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:20:39.443241 [info ] [MainThread]: 
[0m14:20:39.443523 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:20:39.443808 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m14:20:39.444066 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m14:20:39.444320 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m14:20:39.444565 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m14:20:39.444806 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m14:20:39.445047 [error] [MainThread]:   ORA-29276: transfer timeout
[0m14:20:39.445293 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m14:20:39.445530 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m14:20:39.445769 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m14:20:39.446003 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:20:39.446242 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:20:39.446485 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:20:39.446725 [error] [MainThread]:   ORA-06512: at line 107
[0m14:20:39.446971 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:20:39.447231 [info ] [MainThread]: 
[0m14:20:39.447525 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:20:39.448101 [debug] [MainThread]: Command `dbt run` failed at 14:20:39.447982 after 102.79 seconds
[0m14:20:39.448459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575a010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103130e10>]}
[0m14:20:39.448705 [debug] [MainThread]: Flushing usage events
[0m14:21:15.741834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d17bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d17f90>]}


============================== 14:21:15.745228 | f503c544-7109-4829-a9fd-599a3b04cb11 ==============================
[0m14:21:15.745228 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:21:15.745808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:21:15.801296 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:21:15.823735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f503c544-7109-4829-a9fd-599a3b04cb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0b190>]}
[0m14:21:15.830185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f503c544-7109-4829-a9fd-599a3b04cb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095cdad0>]}
[0m14:21:15.870096 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:21:15.913762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:15.914107 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:15.917809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f503c544-7109-4829-a9fd-599a3b04cb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d857d0>]}
[0m14:21:15.922759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f503c544-7109-4829-a9fd-599a3b04cb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095eaa90>]}
[0m14:21:15.923102 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:21:15.923277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f503c544-7109-4829-a9fd-599a3b04cb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c58d0>]}
[0m14:21:15.924064 [info ] [MainThread]: 
[0m14:21:15.924453 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:21:15.925050 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:21:15.930189 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:21:15.930424 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:21:15.930588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:15.930752 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:21:17.365872 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:21:17.468622 [debug] [ThreadPool]: On list_None: Close
[0m14:21:17.573943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:21:17.582052 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:21:17.582636 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:21:17.582989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:17.583334 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:21:18.957816 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:21:18.962285 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:21:18.962681 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:21:19.086199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:21:19.206034 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:21:19.307575 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:21:19.420665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f503c544-7109-4829-a9fd-599a3b04cb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a39550>]}
[0m14:21:19.421666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:21:19.422137 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:21:20.853693 [debug] [MainThread]: On master: COMMIT
[0m14:21:20.855940 [debug] [MainThread]: Using oracle connection "master"
[0m14:21:20.856809 [debug] [MainThread]: On master: COMMIT
[0m14:21:20.957464 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:21:20.959739 [debug] [MainThread]: On master: Close
[0m14:21:21.066559 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:21:21.067011 [info ] [MainThread]: 
[0m14:21:21.085091 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:21:21.085537 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:21:21.086048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:21:21.086307 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:21:21.103520 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:21:21.104611 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:21:21.086498 => 14:21:21.104417
[0m14:21:21.104941 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:21:21.128567 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:21:23.404336 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:21:23.406014 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzI0ODIsImlhdCI6MTY4NzQ2ODg4Mn0.ctgs5pES0omHhJvxrv-9Dum6EyEHQVzQqCI95sp8ZoODaR6LjgneOxPf7pXFKgORoAAlUrBeY86EW0tB_U061z82at5LkmHAByt7ZCreYhWPlNX58SyxLsWIYtiDBe7b5uHS0fOd9OqycF0ei55raxfIIUylcU5GKu_7DIfa0agm9woq6jijxhPwM6j_ei44jMnRcKby4ixQOtg1_ChPQ8Q7PnY7IJa7jGztVIcF8pKLGQopXkhQHqfIMmqz-3bzU2Ug0RjSVAJ61HKJbmEnfJ_UC5dwT715qxBwfUjW43ciMvEntdZkZ6Ef_Pg-6H1OmfaBBMslxSbws6Jr91Uwag!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info142121122557"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_212123 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_212123';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:21:23.407455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:23.408034 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:21:48.874402 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m14:21:48.881705 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:21:48.889407 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:21:48.890147 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info142121122557')
        
      order by ordinal_position

  
[0m14:21:49.203817 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:21:49.348682 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:21:49.350511 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:21:49.563205 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:21:49.770426 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:21:49.771737 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:21:49.939841 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:21:50.129383 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:21:50.131194 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:21:50.131562 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info142121122557
    )
  
[0m14:21:50.819777 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:21:50.842949 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:21:50.843978 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:21:50.844716 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:21:50.952286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:21:50.966998 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:21:50.968105 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info142121122557
[0m14:21:51.135629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:21:51.151894 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:21:51.152941 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info142121122557 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:21:51.281347 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:21:51.309376 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:21:21.105114 => 14:21:51.309149
[0m14:21:51.310137 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:21:51.411263 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:21:51.520135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f503c544-7109-4829-a9fd-599a3b04cb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1fde90>]}
[0m14:21:51.522428 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.43s]
[0m14:21:51.525118 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:21:51.528560 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:21:51.531742 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:21:51.533509 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:21:51.534703 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:21:51.544317 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:21:51.546039 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:21:51.535336 => 14:21:51.545800
[0m14:21:51.546645 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:21:51.566844 [debug] [Thread-3 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m14:21:51.567494 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:21:51.571727 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:21:51.572154 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:21:51.572415 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:21:51.572669 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:21:53.119872 [debug] [Thread-3 (]: SQL status: OK in 2.0 seconds
[0m14:21:53.128082 [info ] [Thread-3 (]: Python model materialization is table
[0m14:21:53.131114 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:21:55.233785 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:21:55.236546 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzI1MTQsImlhdCI6MTY4NzQ2ODkxNH0.acmFD-rYuwAj6E7fldqN6_IHUh4Lbgnj8m0FqIZuBEFr8NcsQgJ8KOUOjVEReZTFdv1U0Kunjp5eRTssKqrED9CqrIEppRELwnvGF-iSR4O-bo2tw_hGilZEN-ljCokqHOqgf5DjXJW-y6tNa2ouxjKBuIkF6RRlBaGpfDIjk7x-MwlhsvquSUsOwhp0SC9e3pOenGwdbQZnqpjB4wYEKa1qm7r443d10o2hICDvte53Z5noDQdp2_afQaGyQh3KEoJA3j3Hb4jIs16GNB44mHQ2b-vK81A_U4QPntr6ID3Ox8yn_neKr-tdOhAt7gy9lEwoUEZyPhvGBzdXDqJ4pA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Accuracy": accuracy})
        y_pred = classifier.predict(x)
    
        df["Shipping_City_Prediction"] = y_pred
        
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_212155 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_212155';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:22:55.855748 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m14:22:55.857530 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:22:56.022780 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:21:51.547066 => 14:22:56.020576
[0m14:22:56.057487 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:22:56.059934 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f503c544-7109-4829-a9fd-599a3b04cb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ec110>]}
[0m14:22:56.060725 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 64.53s]
[0m14:22:56.061277 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:22:56.064084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:56.064779 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:22:57.887268 [debug] [MainThread]: On master: COMMIT
[0m14:22:57.889702 [debug] [MainThread]: Using oracle connection "master"
[0m14:22:57.890789 [debug] [MainThread]: On master: COMMIT
[0m14:22:58.014330 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:58.016292 [debug] [MainThread]: On master: Close
[0m14:22:58.149892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:58.151957 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:22:58.152947 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:22:58.154073 [info ] [MainThread]: 
[0m14:22:58.155894 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 42.23 seconds (102.23s).
[0m14:22:58.158605 [debug] [MainThread]: Command end result
[0m14:22:58.175064 [info ] [MainThread]: 
[0m14:22:58.175830 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:22:58.176204 [info ] [MainThread]: 
[0m14:22:58.176555 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:22:58.176906 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m14:22:58.177221 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m14:22:58.177535 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m14:22:58.177838 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m14:22:58.178136 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m14:22:58.178426 [error] [MainThread]:   ORA-29276: transfer timeout
[0m14:22:58.178725 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m14:22:58.179026 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m14:22:58.179319 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m14:22:58.179865 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:22:58.180347 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:22:58.180700 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:22:58.181014 [error] [MainThread]:   ORA-06512: at line 107
[0m14:22:58.181326 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:22:58.181659 [info ] [MainThread]: 
[0m14:22:58.182042 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:22:58.182839 [debug] [MainThread]: Command `dbt run` failed at 14:22:58.182713 after 102.47 seconds
[0m14:22:58.183394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b9ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b9ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a3c10>]}
[0m14:22:58.183882 [debug] [MainThread]: Flushing usage events
[0m14:25:24.312784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108717e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108717fd0>]}


============================== 14:25:24.315838 | 342eea22-a2fa-40eb-97ca-8a7861099159 ==============================
[0m14:25:24.315838 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:25:24.316178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:25:24.371133 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:25:24.393844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '342eea22-a2fa-40eb-97ca-8a7861099159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108728990>]}
[0m14:25:24.400079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '342eea22-a2fa-40eb-97ca-8a7861099159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e28fd0>]}
[0m14:25:24.436034 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:25:24.441964 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m14:25:24.442296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '342eea22-a2fa-40eb-97ca-8a7861099159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4d290>]}
[0m14:25:24.797881 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m14:25:24.804492 [debug] [MainThread]: 1603: static parser failed on combined_categorized_events.sql
[0m14:25:24.810109 [debug] [MainThread]: 1602: parser fallback to jinja rendering on combined_categorized_events.sql
[0m14:25:24.811412 [debug] [MainThread]: 1699: static parser successfully parsed event_counts_by_platform.sql
[0m14:25:24.813444 [debug] [MainThread]: 1699: static parser successfully parsed average_duration_by_platform_country.sql
[0m14:25:24.816860 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m14:25:24.819246 [debug] [MainThread]: 1699: static parser successfully parsed most_frequent_browser.sql
[0m14:25:24.821485 [debug] [MainThread]: 1699: static parser successfully parsed most_active_mobile_users.sql
[0m14:25:24.823797 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
[0m14:25:24.825881 [debug] [MainThread]: 1603: static parser failed on staging/stg_web_events.sql
[0m14:25:24.828772 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_web_events.sql
[0m14:25:24.829833 [debug] [MainThread]: 1603: static parser failed on staging/stg_mobile_events.sql
[0m14:25:24.832819 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_mobile_events.sql
[0m14:25:24.875042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '342eea22-a2fa-40eb-97ca-8a7861099159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e21110>]}
[0m14:25:24.880920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '342eea22-a2fa-40eb-97ca-8a7861099159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e75d90>]}
[0m14:25:24.881328 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:25:24.881512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '342eea22-a2fa-40eb-97ca-8a7861099159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108facc50>]}
[0m14:25:24.882446 [info ] [MainThread]: 
[0m14:25:24.882920 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:25:24.883590 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:25:24.888447 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:25:24.888682 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:25:24.888849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:24.889022 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:25:26.777283 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:25:26.911367 [debug] [ThreadPool]: On list_None: Close
[0m14:25:27.037069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:25:27.050752 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:25:27.052472 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:25:27.053329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:27.054167 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:25:28.696014 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:25:28.715404 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:25:28.716021 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:25:28.866251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:25:29.115737 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:25:29.263502 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:25:29.421775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '342eea22-a2fa-40eb-97ca-8a7861099159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ecc3d0>]}
[0m14:25:29.423684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:29.424588 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:25:30.757274 [debug] [MainThread]: On master: COMMIT
[0m14:25:30.760211 [debug] [MainThread]: Using oracle connection "master"
[0m14:25:30.761439 [debug] [MainThread]: On master: COMMIT
[0m14:25:30.865260 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:25:30.867664 [debug] [MainThread]: On master: Close
[0m14:25:31.001362 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:31.002352 [info ] [MainThread]: 
[0m14:25:31.016709 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:25:31.017277 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:25:31.017869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:25:31.018237 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:25:31.033933 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:25:31.035291 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:25:31.018734 => 14:25:31.035051
[0m14:25:31.035744 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:25:31.067762 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:25:33.349000 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:25:33.350166 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzI3MzIsImlhdCI6MTY4NzQ2OTEzMn0.oV0CMFh5W8dNoxr9BiGGiMJ4gR8Pg-vRcqYItkL0TRRVVzYgxOLTkRd5BA2KWSkCjmlxo41BMCUxA4bel39pyL006Xt0ZaYM29uMp2JXlO-tWig9QluoZhbAKzN9bQ8osGetQnwk0TjtcNRy3MqCjR_qf0MGUefXhz_GgYASYhNhmRpAX47Mh7ov1Xn_TCKHvsfatKYGvw4eMObGr2eb1ZAom4cNI6ZkmbpZcw_rgKILcwGYTb_42pJZd21-TZ34u3KgBD2zkLPGtXknC0SyfNksZIpbDvQIuoQa8CH39nvfFXxdLslTtRK81pYtWqFwVOh3SVzvxdWHZTlOI--aew!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info142531059999"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_212533 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_212533';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:25:33.351548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:33.352274 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:25:34.691256 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m14:25:34.694220 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:25:34.815312 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:25:31.035978 => 14:25:34.814669
[0m14:25:34.853491 [debug] [Thread-1 (]: Database Error in model stg_web_order_info (models/staging/stg_web_order_info.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m14:25:34.857012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '342eea22-a2fa-40eb-97ca-8a7861099159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10912f450>]}
[0m14:25:34.857762 [error] [Thread-1 (]: 1 of 2 ERROR creating python incremental model FAWDBTCORE.stg_web_order_info ... [[31mERROR[0m in 3.84s]
[0m14:25:34.858463 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:25:34.859725 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:25:34.860516 [info ] [Thread-3 (]: 2 of 2 SKIP relation FAWDBTCORE.web_events_python .............................. [[33mSKIP[0m]
[0m14:25:34.861047 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:25:34.862616 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:25:34.863150 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:25:36.163247 [debug] [MainThread]: On master: COMMIT
[0m14:25:36.165657 [debug] [MainThread]: Using oracle connection "master"
[0m14:25:36.166713 [debug] [MainThread]: On master: COMMIT
[0m14:25:36.272337 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:25:36.273824 [debug] [MainThread]: On master: Close
[0m14:25:36.382083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:36.383159 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:25:36.383924 [info ] [MainThread]: 
[0m14:25:36.384666 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 11.50 seconds (11.50s).
[0m14:25:36.389137 [debug] [MainThread]: Command end result
[0m14:25:36.413880 [info ] [MainThread]: 
[0m14:25:36.414273 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:25:36.414472 [info ] [MainThread]: 
[0m14:25:36.414656 [error] [MainThread]: [33mDatabase Error in model stg_web_order_info (models/staging/stg_web_order_info.py)[0m
[0m14:25:36.414842 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m14:25:36.415019 [info ] [MainThread]: 
[0m14:25:36.415210 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m14:25:36.415576 [debug] [MainThread]: Command `dbt run` failed at 14:25:36.415521 after 12.13 seconds
[0m14:25:36.415840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f86ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103240e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ca790>]}
[0m14:25:36.416088 [debug] [MainThread]: Flushing usage events
[0m14:27:18.414150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107317890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107317e90>]}


============================== 14:27:18.416992 | 678b10dd-5d7f-4fcf-9784-f1c2fd9f13ad ==============================
[0m14:27:18.416992 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:27:18.417357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:27:18.462363 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:27:18.484171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '678b10dd-5d7f-4fcf-9784-f1c2fd9f13ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107360150>]}
[0m14:27:18.490728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '678b10dd-5d7f-4fcf-9784-f1c2fd9f13ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102e5450>]}
[0m14:27:18.525768 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:27:18.558548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:18.558848 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:18.562265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '678b10dd-5d7f-4fcf-9784-f1c2fd9f13ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ca310>]}
[0m14:27:18.566807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '678b10dd-5d7f-4fcf-9784-f1c2fd9f13ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107340fd0>]}
[0m14:27:18.567125 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:27:18.567299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '678b10dd-5d7f-4fcf-9784-f1c2fd9f13ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102fe690>]}
[0m14:27:18.568049 [info ] [MainThread]: 
[0m14:27:18.568419 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:27:18.568991 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:27:18.573780 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:27:18.574032 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:27:18.574203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:18.574381 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:27:20.080990 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:27:20.185858 [debug] [ThreadPool]: On list_None: Close
[0m14:27:20.293974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:27:20.299907 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:27:20.300256 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:27:20.300437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:20.300636 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:27:21.666327 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:27:21.681176 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:27:21.681982 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:27:21.804040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:22.007958 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:27:22.118229 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:27:22.239849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '678b10dd-5d7f-4fcf-9784-f1c2fd9f13ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f7410>]}
[0m14:27:22.240650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:22.241170 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:27:23.476434 [debug] [MainThread]: On master: COMMIT
[0m14:27:23.478761 [debug] [MainThread]: Using oracle connection "master"
[0m14:27:23.479851 [debug] [MainThread]: On master: COMMIT
[0m14:27:23.579927 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:23.582119 [debug] [MainThread]: On master: Close
[0m14:27:23.687023 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:23.687631 [info ] [MainThread]: 
[0m14:27:23.692297 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:27:23.692689 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:27:23.693088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:27:23.693285 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:27:23.712191 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:27:23.713326 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:27:23.693419 => 14:27:23.713163
[0m14:27:23.713641 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:27:23.738705 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:27:25.782917 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:27:25.784155 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzI4NDQsImlhdCI6MTY4NzQ2OTI0NH0.GquR-AukiNIdVhvLVg5RnvOwDA1imhWWwIVdhPXdoUObFX5WoOIggueu4z8hx-2EmxoQPtr7VfuiDZKrTntuNu66gNWpaNqSs_y54AYKCQhz1gh-6Kdi0ycSvD9solcKcnNxLHcDa-AKk5w1ffhytckbO9LvtBBeWj0LMjASB1RXTJvlsj6LwVqLQGXFPlKlmAogoTWmyVL6I-xXH4qI74YCzrUli1oZ_j874nOwgCAmjkh9_V2LvA_vxA6tg_BvD5cw-DVZFjUMRrApV8EgkyhBWIR2fm2uuAyadnRxJJqp3MeyND4vHWn6FI1O0E7r7S9Fsd_vfon-ZKeg5StCdg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info142723731493"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_212725 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_212725';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:27:25.785674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:25.786281 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:27:50.468884 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m14:27:50.473258 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:27:50.484336 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:27:50.485339 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info142723731493')
        
      order by ordinal_position

  
[0m14:27:50.786310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:50.901889 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:27:50.902852 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:27:51.128804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:51.272857 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:27:51.273799 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:27:51.483463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:51.595547 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:27:51.596562 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:27:51.596852 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info142723731493
    )
  
[0m14:27:52.299676 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:27:52.312016 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:27:52.312943 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:27:52.313425 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:27:52.426214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:52.434130 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:27:52.434477 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info142723731493
[0m14:27:52.597650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:52.611251 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:27:52.612100 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info142723731493 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:27:52.751844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:52.763223 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:27:23.713812 => 14:27:52.763054
[0m14:27:52.763700 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:27:52.863540 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:27:52.976200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678b10dd-5d7f-4fcf-9784-f1c2fd9f13ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111058650>]}
[0m14:27:52.978460 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 29.28s]
[0m14:27:52.979057 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:27:52.979995 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:27:52.981083 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:27:52.981837 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:27:52.982096 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:27:52.984436 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:27:52.985310 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:27:52.982249 => 14:27:52.985203
[0m14:27:52.985516 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:27:52.999453 [debug] [Thread-3 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m14:27:52.999801 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:27:53.002118 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:27:53.002481 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:27:53.002792 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:27:53.003078 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:27:54.626795 [debug] [Thread-3 (]: SQL status: OK in 2.0 seconds
[0m14:27:54.633241 [info ] [Thread-3 (]: Python model materialization is table
[0m14:27:54.634399 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:27:57.318864 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:27:57.320344 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzI4NzYsImlhdCI6MTY4NzQ2OTI3Nn0.mT5xK8z9otkcY3Ys0sO9JVS3i-qrGRdEJwJB_yaazko9cmgSnvRrQ800ieji1QXdPn4uLR52XTukCbhamX2FaGTWmb68CR7JbfPHS4U0B--c2a2LTLpy9Xxb10R79vIbgFuZ8lJPdsXjyqSx12vFrJ2k1Vw-qCRcHS81Y-fQBNksfEQK1Lf1MqziWYQzLWGrBsFXvqHchPoC-22_3AmAF8b4RojaaLFFkpjAtm-H-PQ1r4ENE13ZfibDsaA1ThLxdmNePJowYD-38e_MTFaKTvgkEjLu93DLCtpQhZSVNtGakh7LSTZukuszp--i7gTYm6ghu3FssG2W1c2w7x01xA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Accuracy": accuracy})
        y_pred = classifier.predict(x)
    
        df["Shipping_City_Prediction"] = y_pred
        
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_212757 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_212757';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:27:57.323082 [info ] [Thread-3 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m14:27:57.323662 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:27:57.424755 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:27:52.985661 => 14:27:57.424275
[0m14:27:57.656116 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:27:57.660325 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678b10dd-5d7f-4fcf-9784-f1c2fd9f13ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110ef690>]}
[0m14:27:57.661532 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 4.68s]
[0m14:27:57.662275 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:27:57.664593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:57.665179 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:27:58.910120 [debug] [MainThread]: On master: COMMIT
[0m14:27:58.912589 [debug] [MainThread]: Using oracle connection "master"
[0m14:27:58.913734 [debug] [MainThread]: On master: COMMIT
[0m14:27:59.015207 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:59.017539 [debug] [MainThread]: On master: Close
[0m14:27:59.132567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:59.133547 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:27:59.134010 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:27:59.134560 [info ] [MainThread]: 
[0m14:27:59.135053 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 40.57 seconds (40.57s).
[0m14:27:59.135967 [debug] [MainThread]: Command end result
[0m14:27:59.147387 [info ] [MainThread]: 
[0m14:27:59.147963 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:27:59.148266 [info ] [MainThread]: 
[0m14:27:59.148559 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:27:59.148854 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m14:27:59.149120 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:27:59.149392 [info ] [MainThread]: 
[0m14:27:59.149709 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:27:59.150394 [debug] [MainThread]: Command `dbt run` failed at 14:27:59.150291 after 40.76 seconds
[0m14:27:59.150877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024d6c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024d4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103a1e90>]}
[0m14:27:59.151301 [debug] [MainThread]: Flushing usage events
[0m14:28:19.897377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a15f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a23e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a23fd0>]}


============================== 14:28:19.899707 | 3bbcc131-538f-4622-9f81-5988c90e1101 ==============================
[0m14:28:19.899707 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:28:19.900041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:28:19.942093 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:28:19.964191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bbcc131-538f-4622-9f81-5988c90e1101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a34490>]}
[0m14:28:19.970605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bbcc131-538f-4622-9f81-5988c90e1101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104135790>]}
[0m14:28:20.003033 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:28:20.042513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:20.042819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:20.046320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bbcc131-538f-4622-9f81-5988c90e1101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a15490>]}
[0m14:28:20.053497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bbcc131-538f-4622-9f81-5988c90e1101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041667d0>]}
[0m14:28:20.053851 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:28:20.054022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bbcc131-538f-4622-9f81-5988c90e1101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041653d0>]}
[0m14:28:20.054819 [info ] [MainThread]: 
[0m14:28:20.055204 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:28:20.055839 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:28:20.061209 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:28:20.061537 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:28:20.061715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:20.061902 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:28:21.858779 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:28:21.999022 [debug] [ThreadPool]: On list_None: Close
[0m14:28:22.153186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:28:22.163296 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:28:22.164107 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:28:22.164845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:22.165229 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:28:23.718420 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:28:23.733653 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:28:23.734438 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:28:23.871843 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:28:24.078723 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:28:24.188870 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:28:24.311204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bbcc131-538f-4622-9f81-5988c90e1101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a91e10>]}
[0m14:28:24.312193 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:24.312665 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:28:25.575431 [debug] [MainThread]: On master: COMMIT
[0m14:28:25.578345 [debug] [MainThread]: Using oracle connection "master"
[0m14:28:25.579699 [debug] [MainThread]: On master: COMMIT
[0m14:28:25.696769 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:28:25.699112 [debug] [MainThread]: On master: Close
[0m14:28:25.817348 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:28:25.819058 [info ] [MainThread]: 
[0m14:28:25.826997 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:28:25.827430 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:28:25.827882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:28:25.828088 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:28:25.844921 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:28:25.845994 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:28:25.828260 => 14:28:25.845838
[0m14:28:25.846287 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:28:25.870741 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:28:27.874616 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:28:27.876068 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzI5MDYsImlhdCI6MTY4NzQ2OTMwNn0.NB1CS1IxLv_2FRcin37wWMTP05WhSXjtV_Wgb7_Hvg3e89jGkqHEVsg1dRDdbrZHhpd-NEAjT1m9J6wUFZoXmaSNvDDyPGpT67vdMRy0_20560WFKkCQkeBUmiJ409GPRs4Dca6qJXlV8F0zRt-WiM1QEicwe-snkOkPJRu7yZZ0w4KEV9DbTdzroD5qZLSjli2RQb-1RLp8PJ4MJ_r2dIEi7Fklcl3dsz8JRHPsnekcc6yL4MOWupKLwf6qoG-i6WlIjke0TXYM9Uth5Jn3R_bOE6b41w2uTVlKJd59oBB0pyHVNNDiRJ0YQE_VLU1q21JzWu_Nwax_3lwvIB92dA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info142825863989"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_212827 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_212827';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:28:27.877670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:27.878258 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:28:53.493556 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m14:28:53.498150 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:28:53.509155 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:28:53.510021 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info142825863989')
        
      order by ordinal_position

  
[0m14:28:53.829714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:28:53.946994 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:28:53.947964 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:28:54.077413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:28:54.195407 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:28:54.196458 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:28:54.325338 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:28:54.455340 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:28:54.457360 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:28:54.457726 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info142825863989
    )
  
[0m14:28:55.059775 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:28:55.073824 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:28:55.074701 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:28:55.075588 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:28:55.177134 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:28:55.188319 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:28:55.188794 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info142825863989
[0m14:28:55.328607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:28:55.341530 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:28:55.342408 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info142825863989 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:28:55.466455 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:28:55.482819 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:28:25.846440 => 14:28:55.482587
[0m14:28:55.483517 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:28:55.583530 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:28:55.695107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bbcc131-538f-4622-9f81-5988c90e1101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104199210>]}
[0m14:28:55.696047 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 29.87s]
[0m14:28:55.696620 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:28:55.697519 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:28:55.698315 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:28:55.699097 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:28:55.699478 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:28:55.702967 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:28:55.704423 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:28:55.699752 => 14:28:55.704249
[0m14:28:55.704716 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:28:55.718016 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m14:28:55.718371 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:28:55.719713 [info ] [Thread-3 (]: Python model materialization is table
[0m14:28:55.719955 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:28:57.896572 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:28:57.898112 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzI5MzYsImlhdCI6MTY4NzQ2OTMzNn0.BsYcwS5BojZTVj_ZbOL_rdMU6ykyqfUqo73sGd1VDDQaYvMyfYt_qTPEWyh7Y4UmO5Z1HP3qT8Zdwb20NuXeavGXQnU-Yjnp2eNI3pT7DuS_sEt4xqpyd7GFYCOaGiJr5PIawx5epEJCIpQQR0za5KNRexk-6QcSEk4nSO7Ek0NwjnPYIfmzsJWfWvyJxZZ4jgt1YLVMmnStZ3e3ZdzggmarSK-4tRWLY61KRxes_J09E_tHYYLddqIlrnDaUiN1d3kQlzqwqMZFYMCbRId6OC42UlQagtw5fMtLgzYyuAiS9VhAe8X9gglu0dD86_jCGO_QNBJ7anR73J3kTWUYwQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Accuracy": accuracy})
        y_pred = classifier.predict(x)
    
        df["Shipping_City_Prediction"] = y_pred
        
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_212857 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_212857';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:28:57.899649 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:28:57.900214 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:29:59.762796 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m14:29:59.765149 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:29:59.909259 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:28:55.704869 => 14:29:59.907825
[0m14:29:59.922523 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:29:59.924753 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bbcc131-538f-4622-9f81-5988c90e1101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104457f90>]}
[0m14:29:59.925329 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 64.23s]
[0m14:29:59.925719 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:29:59.926943 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:29:59.927376 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:30:01.432481 [debug] [MainThread]: On master: COMMIT
[0m14:30:01.434526 [debug] [MainThread]: Using oracle connection "master"
[0m14:30:01.435155 [debug] [MainThread]: On master: COMMIT
[0m14:30:01.574458 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:30:01.576873 [debug] [MainThread]: On master: Close
[0m14:30:01.710802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:01.711358 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:30:01.711525 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:30:01.711751 [info ] [MainThread]: 
[0m14:30:01.711939 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 41.66 seconds (101.66s).
[0m14:30:01.712350 [debug] [MainThread]: Command end result
[0m14:30:01.720998 [info ] [MainThread]: 
[0m14:30:01.721462 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:30:01.721775 [info ] [MainThread]: 
[0m14:30:01.722065 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:30:01.722346 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m14:30:01.722611 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m14:30:01.722872 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m14:30:01.723125 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m14:30:01.723375 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m14:30:01.723627 [error] [MainThread]:   ORA-29276: transfer timeout
[0m14:30:01.723883 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m14:30:01.724131 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m14:30:01.724375 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m14:30:01.724623 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:30:01.724863 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:30:01.725063 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:30:01.725187 [error] [MainThread]:   ORA-06512: at line 107
[0m14:30:01.725315 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:30:01.725452 [info ] [MainThread]: 
[0m14:30:01.725613 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:30:01.725943 [debug] [MainThread]: Command `dbt run` failed at 14:30:01.725892 after 101.85 seconds
[0m14:30:01.726189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026934d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100358e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100358ed0>]}
[0m14:30:01.726560 [debug] [MainThread]: Flushing usage events
[0m14:30:12.490862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d09f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d17f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d17fd0>]}


============================== 14:30:12.493651 | 4dfcc4fd-e7e1-4c60-ab10-88811f9c8777 ==============================
[0m14:30:12.493651 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:30:12.493981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:30:12.545309 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:30:12.567204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dfcc4fd-e7e1-4c60-ab10-88811f9c8777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d091d0>]}
[0m14:30:12.573288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dfcc4fd-e7e1-4c60-ab10-88811f9c8777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b158d0>]}
[0m14:30:12.605205 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:30:12.636476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:12.636776 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:12.640262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dfcc4fd-e7e1-4c60-ab10-88811f9c8777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfad50>]}
[0m14:30:12.644890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dfcc4fd-e7e1-4c60-ab10-88811f9c8777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d43110>]}
[0m14:30:12.645222 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:30:12.645399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dfcc4fd-e7e1-4c60-ab10-88811f9c8777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b15ad0>]}
[0m14:30:12.646168 [info ] [MainThread]: 
[0m14:30:12.646551 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:30:12.647111 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:30:12.652080 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:30:12.652428 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:30:12.652609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:12.652790 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:30:14.075078 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:30:14.178977 [debug] [ThreadPool]: On list_None: Close
[0m14:30:14.303238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:30:14.311948 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:30:14.312592 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:30:14.312979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:14.313380 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:30:15.691388 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:30:15.703232 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:30:15.704033 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:30:15.831019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:30:15.928129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:15.928461 [debug] [MainThread]: Connection 'list_None_FAWDBTCORE' was left open.
[0m14:30:15.928648 [debug] [MainThread]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:30:16.246360 [error] [MainThread]: Encountered an error:

[0m14:30:16.248273 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:30:16.379330 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:30:16.395314 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 435, in _relations_cache_for_schemas
    for future in as_completed(futures):
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 622, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 403, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/run.py", line 447, in before_run
    self.populate_adapter_cache(adapter, required_schemas)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 381, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 461, in set_relations_cache
    self._relations_cache_for_schemas(manifest, required_schemas)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 424, in _relations_cache_for_schemas
    with executor(self.config) as tpe:
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/_base.py", line 647, in __exit__
    self.shutdown(wait=True)
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 235, in shutdown
    t.join()
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1112, in join
    self._wait_for_tstate_lock()
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1132, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/main.py", line 565, in run
    results = task.run()
              ^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 441, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 407, in execute_with_hooks
    adapter.cleanup_connections()
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 241, in cleanup_connections
    self.connections.cleanup_all()
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/connections.py", line 315, in cleanup_all
    self.close(connection)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/connections.py", line 382, in close
    cls._rollback_handle(connection)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/connections.py", line 334, in _rollback_handle
    connection.handle.rollback()
  File "/opt/homebrew/lib/python3.11/site-packages/oracledb/connection.py", line 642, in rollback
    self._impl.rollback()
  File "src/oracledb/impl/thin/connection.pyx", line 370, in oracledb.thin_impl.ThinConnImpl.rollback
  File "src/oracledb/impl/thin/protocol.pyx", line 382, in oracledb.thin_impl.Protocol._process_single_message
  File "src/oracledb/impl/thin/protocol.pyx", line 383, in oracledb.thin_impl.Protocol._process_single_message
  File "src/oracledb/impl/thin/protocol.pyx", line 343, in oracledb.thin_impl.Protocol._process_message
  File "src/oracledb/impl/thin/protocol.pyx", line 321, in oracledb.thin_impl.Protocol._process_message
  File "src/oracledb/impl/thin/protocol.pyx", line 389, in oracledb.thin_impl.Protocol._receive_packet
  File "src/oracledb/impl/thin/packet.pyx", line 559, in oracledb.thin_impl.ReadBuffer.receive_packet
  File "src/oracledb/impl/thin/packet.pyx", line 358, in oracledb.thin_impl.ReadBuffer._receive_packet_helper
  File "src/oracledb/impl/thin/packet.pyx", line 195, in oracledb.thin_impl.ReadBuffer._get_data_from_socket
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1278, in recv_into
    return self.read(nbytes, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1134, in read
    return self._sslobj.read(len, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m14:30:16.396800 [debug] [MainThread]: Command `dbt run` failed at 14:30:16.396710 after 3.92 seconds
[0m14:30:16.397089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:16.397308 [debug] [MainThread]: Connection 'list_None_FAWDBTCORE' was left open.
[0m14:30:16.397517 [debug] [MainThread]: On list_None_FAWDBTCORE: Close
[0m14:30:16.492929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d179d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d43110>]}
[0m14:30:16.494341 [debug] [MainThread]: Flushing usage events
[0m14:30:31.084581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f726d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c3690>]}


============================== 14:30:31.087581 | 1d169450-7f1c-407d-b0e8-05e33fedec89 ==============================
[0m14:30:31.087581 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:30:31.087905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:30:31.088203 [info ] [MainThread]: dbt version: 1.5.1
[0m14:30:31.088380 [info ] [MainThread]: python version: 3.11.3
[0m14:30:31.088553 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m14:30:31.088701 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m14:30:31.088843 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/Desktop/oracle-dbt/profiles.yml
[0m14:30:31.089049 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m14:30:31.089273 [info ] [MainThread]: Configuration:
[0m14:30:31.136399 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:30:31.152796 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:30:31.161082 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:30:31.161313 [info ] [MainThread]: Required dependencies:
[0m14:30:31.161530 [debug] [MainThread]: Executing "git --help"
[0m14:30:31.168980 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:30:31.169516 [debug] [MainThread]: STDERR: "b''"
[0m14:30:31.169680 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:30:31.169853 [info ] [MainThread]: Connection:
[0m14:30:31.170047 [info ] [MainThread]:   user: fawdbtcore
[0m14:30:31.170193 [info ] [MainThread]:   database: None
[0m14:30:31.170326 [info ] [MainThread]:   schema: FAWDBTCORE
[0m14:30:31.170458 [info ] [MainThread]:   protocol: None
[0m14:30:31.170587 [info ] [MainThread]:   host: None
[0m14:30:31.170717 [info ] [MainThread]:   port: None
[0m14:30:31.170844 [info ] [MainThread]:   tns_name: cfg57adw_high
[0m14:30:31.170976 [info ] [MainThread]:   service: None
[0m14:30:31.171104 [info ] [MainThread]:   connection_string: None
[0m14:30:31.171230 [info ] [MainThread]:   shardingkey: []
[0m14:30:31.171355 [info ] [MainThread]:   supershardingkey: []
[0m14:30:31.171478 [info ] [MainThread]:   cclass: None
[0m14:30:31.171605 [info ] [MainThread]:   purity: None
[0m14:30:31.171729 [info ] [MainThread]:   retry_count: 1
[0m14:30:31.171854 [info ] [MainThread]:   retry_delay: 3
[0m14:30:31.171979 [info ] [MainThread]:   oml_auth_token_uri: https://tv1lg8pdut4n8vc-cfg57adw.adb.us-ashburn-1.oraclecloudapps.com/omlusers/api/oauth2/v1/token
[0m14:30:31.175633 [debug] [MainThread]: Acquiring new oracle connection 'debug'
[0m14:30:31.176463 [debug] [MainThread]: Using oracle connection "debug"
[0m14:30:31.176619 [debug] [MainThread]: On debug: select 1 as id from dual
[0m14:30:31.176742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:31.177043 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:30:32.650034 [debug] [MainThread]: SQL status: OK in 1.0 seconds
[0m14:30:32.654492 [debug] [MainThread]: On debug: Close
[0m14:30:32.757526 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:30:32.759344 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:30:32.761330 [debug] [MainThread]: Command `dbt debug` succeeded at 14:30:32.761018 after 1.69 seconds
[0m14:30:32.762425 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:30:32.763437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061359d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029f8d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029fb7d0>]}
[0m14:30:32.764390 [debug] [MainThread]: Flushing usage events
[0m14:30:56.945508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107417d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107417f90>]}


============================== 14:30:56.948063 | ff8f6307-8501-47b6-9b8b-54f69848f12e ==============================
[0m14:30:56.948063 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:30:56.948378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:30:56.993164 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:30:57.014943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff8f6307-8501-47b6-9b8b-54f69848f12e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074289d0>]}
[0m14:30:57.021763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff8f6307-8501-47b6-9b8b-54f69848f12e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ca7d0>]}
[0m14:30:57.054073 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:30:57.059382 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m14:30:57.059682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ff8f6307-8501-47b6-9b8b-54f69848f12e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff1f10>]}
[0m14:30:57.391479 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m14:30:57.398297 [debug] [MainThread]: 1603: static parser failed on combined_categorized_events.sql
[0m14:30:57.402854 [debug] [MainThread]: 1602: parser fallback to jinja rendering on combined_categorized_events.sql
[0m14:30:57.403944 [debug] [MainThread]: 1699: static parser successfully parsed event_counts_by_platform.sql
[0m14:30:57.405958 [debug] [MainThread]: 1699: static parser successfully parsed average_duration_by_platform_country.sql
[0m14:30:57.407847 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m14:30:57.409753 [debug] [MainThread]: 1699: static parser successfully parsed most_frequent_browser.sql
[0m14:30:57.411924 [debug] [MainThread]: 1699: static parser successfully parsed most_active_mobile_users.sql
[0m14:30:57.413903 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
[0m14:30:57.415649 [debug] [MainThread]: 1603: static parser failed on staging/stg_web_events.sql
[0m14:30:57.418275 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_web_events.sql
[0m14:30:57.419261 [debug] [MainThread]: 1603: static parser failed on staging/stg_mobile_events.sql
[0m14:30:57.421762 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_mobile_events.sql
[0m14:30:57.463521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff8f6307-8501-47b6-9b8b-54f69848f12e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe9110>]}
[0m14:30:57.469406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff8f6307-8501-47b6-9b8b-54f69848f12e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbd550>]}
[0m14:30:57.469757 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:30:57.469936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff8f6307-8501-47b6-9b8b-54f69848f12e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffe050>]}
[0m14:30:57.470825 [info ] [MainThread]: 
[0m14:30:57.471315 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:30:57.471957 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:30:57.476842 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:30:57.477063 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:30:57.477235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:57.477400 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:30:59.867687 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:31:00.014066 [debug] [ThreadPool]: On list_None: Close
[0m14:31:00.194735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:31:00.203195 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:31:00.203900 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:31:00.204306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:31:00.204716 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:31:01.967043 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:31:01.978281 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:31:01.979071 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:31:02.140184 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:31:02.573942 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:31:02.716950 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:31:02.860614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff8f6307-8501-47b6-9b8b-54f69848f12e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108b6e10>]}
[0m14:31:02.861868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:02.862468 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:31:04.386387 [debug] [MainThread]: On master: COMMIT
[0m14:31:04.388667 [debug] [MainThread]: Using oracle connection "master"
[0m14:31:04.389268 [debug] [MainThread]: On master: COMMIT
[0m14:31:04.518591 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:31:04.520780 [debug] [MainThread]: On master: Close
[0m14:31:04.675889 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:31:04.676790 [info ] [MainThread]: 
[0m14:31:04.682571 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:31:04.683448 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:31:04.684330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:31:04.684908 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:31:04.703484 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:31:04.704550 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:31:04.685247 => 14:31:04.704435
[0m14:31:04.704802 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:31:04.731828 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:31:06.937210 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:31:06.939298 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzMwNjUsImlhdCI6MTY4NzQ2OTQ2NX0.h9lDDOxp4itYCQmhNgGyMkCvQyiPW2J9Xo-C-S6nSZI1hdUI6FWDpbPj52mGREkrmhLxvBgsCWy8OQHKJqXohXeku_VnyE9EZvh62ZFbRSaU_Qfv7Uq6045CbO7OinlFhlc8GDX3VI5A-OUlm_ghnO1_67vEDDWcpWFoZP2rX8djX_XgY7q6y9j69MjsRB90CzHcyYd7xWttkkux-hmEiZidR2KoA9PD2Jzqh-zrYDJmvlPFYgHfixQM8BRYI-wmSCdClqDDXX1c-LEuRl6mHq6UTWqK1ryEfSocs1CIdsie8-G3wk4h7cAtZSxvrf9hUdlv1R8pJxVvAvedLWH2_Q!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info143104725002"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_213106 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_213106';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:31:06.941446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:06.942040 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:31:32.747850 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m14:31:32.754235 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:31:32.771864 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:31:32.773010 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info143104725002')
        
      order by ordinal_position

  
[0m14:31:33.065463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:33.184691 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:31:33.186567 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:31:33.323173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:33.455792 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:31:33.456551 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:31:33.597827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:33.730133 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:31:33.731366 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:31:33.731707 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info143104725002
    )
  
[0m14:31:34.367345 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:31:34.391162 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:31:34.392116 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:31:34.392659 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:31:34.497796 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:34.517043 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:31:34.518764 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info143104725002
[0m14:31:34.692871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:34.714896 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:31:34.715671 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info143104725002 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:31:34.838187 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:34.858619 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:31:04.704946 => 14:31:34.858458
[0m14:31:34.859149 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:31:34.959081 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:31:35.835438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff8f6307-8501-47b6-9b8b-54f69848f12e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aa8b50>]}
[0m14:31:35.837674 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 31.15s]
[0m14:31:35.839535 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:31:35.842122 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:31:35.843259 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:31:35.844917 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:31:35.846306 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:31:35.853628 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:31:35.856110 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:31:35.847212 => 14:31:35.855869
[0m14:31:35.856454 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:31:35.867911 [debug] [Thread-3 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m14:31:35.868294 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:31:35.870795 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:31:35.871225 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:31:35.871575 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:31:35.872035 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:31:37.350570 [debug] [Thread-3 (]: SQL status: OK in 1.0 seconds
[0m14:31:37.357984 [info ] [Thread-3 (]: Python model materialization is table
[0m14:31:37.359274 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:31:39.568069 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:31:39.570491 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzMwOTgsImlhdCI6MTY4NzQ2OTQ5OH0.O_WGITXUTXJpxRF-dAxYHw6Q_QY9uS968fe1uMdR_dB6bkaI5Xw7zjRe7cOQZmZnzsixT6HwLNM1W6PAQ2wsn9yij-4ZzT40XSgf496v7QrnK-3pRkK02QQaZNF9jDf6jz-b26K9sio18rgmyh6_q1p2F9njdVstV4NIl3j4fP6JlWVyJ-6ACgHvfzfCax6nBoeQnPcTcNjW9p8ZoGlKV7GsgwhXHEidgy5lK_NVJF-YQsUZgbTB1lIpUKQqYeNPrdLqvl2l0a9ass_DEZrqj119MlV8GQnvgNa_OiSQGDYnarLggmzLZ48JUmqC1d1osInqu25YWL24I2bSzABLHw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Accuracy": accuracy})
        y_pred = classifier.predict(x)
    
        df["Shipping_City_Prediction"] = y_pred
        
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_213139 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_213139';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:32:40.228135 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m14:32:40.231412 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:32:40.343764 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:31:35.856642 => 14:32:40.342952
[0m14:32:40.382752 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:32:40.385755 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff8f6307-8501-47b6-9b8b-54f69848f12e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbded0>]}
[0m14:32:40.386287 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 64.54s]
[0m14:32:40.386583 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:32:40.387656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:32:40.387938 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:32:42.012620 [debug] [MainThread]: On master: COMMIT
[0m14:32:42.014506 [debug] [MainThread]: Using oracle connection "master"
[0m14:32:42.015124 [debug] [MainThread]: On master: COMMIT
[0m14:32:42.139022 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:32:42.141520 [debug] [MainThread]: On master: Close
[0m14:32:42.259592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:42.260434 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:32:42.260761 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:32:42.261147 [info ] [MainThread]: 
[0m14:32:42.261484 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 44.79 seconds (104.79s).
[0m14:32:42.262197 [debug] [MainThread]: Command end result
[0m14:32:42.271160 [info ] [MainThread]: 
[0m14:32:42.271668 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:32:42.271912 [info ] [MainThread]: 
[0m14:32:42.272146 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:32:42.272379 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m14:32:42.272588 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m14:32:42.273171 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m14:32:42.273524 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m14:32:42.273767 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m14:32:42.273984 [error] [MainThread]:   ORA-29276: transfer timeout
[0m14:32:42.274195 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m14:32:42.274395 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m14:32:42.274595 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m14:32:42.274789 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:32:42.274984 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:32:42.275179 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:32:42.275369 [error] [MainThread]:   ORA-06512: at line 107
[0m14:32:42.275559 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:32:42.275776 [info ] [MainThread]: 
[0m14:32:42.276020 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:32:42.276483 [debug] [MainThread]: Command `dbt run` failed at 14:32:42.276407 after 105.36 seconds
[0m14:32:42.276811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023c2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023c0e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f6bd0>]}
[0m14:32:42.277124 [debug] [MainThread]: Flushing usage events
[0m14:33:55.888106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106027f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106027fd0>]}


============================== 14:33:55.890469 | 1050f4b8-f1c2-4a4f-8f01-163f8f4e8952 ==============================
[0m14:33:55.890469 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:33:55.890787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:33:55.932403 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:33:55.954238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1050f4b8-f1c2-4a4f-8f01-163f8f4e8952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106038450>]}
[0m14:33:55.960779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1050f4b8-f1c2-4a4f-8f01-163f8f4e8952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106739a50>]}
[0m14:33:55.994282 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:33:56.025816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:56.026237 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m14:33:56.047158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1050f4b8-f1c2-4a4f-8f01-163f8f4e8952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f2b90>]}
[0m14:33:56.053505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1050f4b8-f1c2-4a4f-8f01-163f8f4e8952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e8c50>]}
[0m14:33:56.053883 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:33:56.054070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1050f4b8-f1c2-4a4f-8f01-163f8f4e8952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a7950>]}
[0m14:33:56.054886 [info ] [MainThread]: 
[0m14:33:56.055278 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:33:56.055879 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:33:56.061212 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:33:56.061534 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:33:56.061702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:56.061876 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:33:57.963694 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:33:58.073774 [debug] [ThreadPool]: On list_None: Close
[0m14:33:58.186059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:33:58.194982 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:33:58.195694 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:33:58.196101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:58.196513 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:33:59.559513 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:33:59.575934 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:33:59.576692 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:33:59.702193 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:33:59.911032 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:34:00.027961 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:34:00.148259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1050f4b8-f1c2-4a4f-8f01-163f8f4e8952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106843410>]}
[0m14:34:00.148786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:34:00.149049 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:34:01.490686 [debug] [MainThread]: On master: COMMIT
[0m14:34:01.492367 [debug] [MainThread]: Using oracle connection "master"
[0m14:34:01.492952 [debug] [MainThread]: On master: COMMIT
[0m14:34:01.612725 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:34:01.614593 [debug] [MainThread]: On master: Close
[0m14:34:01.725427 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:34:01.726295 [info ] [MainThread]: 
[0m14:34:01.732156 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:34:01.732823 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:34:01.733558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:34:01.733915 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:34:01.751872 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:34:01.753450 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:34:01.734155 => 14:34:01.753235
[0m14:34:01.753848 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:34:01.786168 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:34:04.071809 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:34:04.072981 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzMyNDMsImlhdCI6MTY4NzQ2OTY0M30.qc_Lch0x18RTvlZiIi9rMxjLCJsJz_zC7ph7XjX4OsMyyKG2Fem7JQm9FVxcHmozmKYT5FOBju1zXEtpBE0hqJBc3YS1sqVCLDkat3PLFqS8zq97Vs7cgSEOBEoEcD1g3cakwO85_RPsnBRXzXmOtjB1IyiVn3qt2aFqy5P8TxxHPmXwIDljzUXV_gC5OQOiSqxBVffBg8kF9DTYF8lf0N-jFLfNglQXz4r22G35DcRn1n7M4cTIHbX9spn4qlP64BtD_mcJkDCO6SyIMCSvFEQFe8PvyE6IGF8sC3P70nR3GmzU3hS_Cn0owq3q8My9LRZYt5Tq4kRmGIcNR0Q-Vw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info143401774844"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_213404 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_213404';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:34:04.074944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:04.075564 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:34:30.282027 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m14:34:30.285461 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:34:30.299846 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:34:30.301046 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info143401774844')
        
      order by ordinal_position

  
[0m14:34:30.564370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:34:30.681648 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:34:30.683185 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:34:30.814624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:34:30.940394 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:34:30.942220 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:34:31.075433 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:34:31.209180 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:34:31.210490 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:34:31.210858 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info143401774844
    )
  
[0m14:34:31.825649 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:34:31.855123 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:34:31.857381 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:34:31.858027 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:34:31.963900 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:34:31.984441 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:34:31.985221 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info143401774844
[0m14:34:32.136747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:34:32.159381 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:34:32.160551 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info143401774844 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:34:32.284847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:34:32.307057 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:34:01.754059 => 14:34:32.306788
[0m14:34:32.307769 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:34:32.408913 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:34:32.521440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1050f4b8-f1c2-4a4f-8f01-163f8f4e8952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a06010>]}
[0m14:34:32.524888 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.79s]
[0m14:34:32.526894 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:34:32.531193 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:34:32.532633 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:34:32.534269 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:34:32.537444 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:34:32.543144 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:34:32.545166 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:34:32.539006 => 14:34:32.544954
[0m14:34:32.545624 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:34:32.557564 [debug] [Thread-3 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m14:34:32.557995 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:34:32.560709 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:34:32.561024 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:34:32.561295 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:34:32.561571 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:34:34.070783 [debug] [Thread-3 (]: SQL status: OK in 2.0 seconds
[0m14:34:34.077519 [info ] [Thread-3 (]: Python model materialization is table
[0m14:34:34.078795 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:34:36.226440 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:34:36.228340 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzMyNzUsImlhdCI6MTY4NzQ2OTY3NX0.NxWgG_hVWwdlkErNanvSm8hlIMt6J2_MLWWJW1sKZXd9_t1AXu5cAVUcFM7ZJSSpNONKdHGXvmyZS84pk2OWXYirCUUThHytWbsinEqWvFgPqFZJ82IwmroS_2A4jjmqoJf1_ggAulRZ-NhRNSDoBsk7BjF1Iwj0dshoHjLaAeC1wAyeoBNDVHzZl-mdVybg1TKB-I5xsG0JqrQehuQmMzB9b6Gg8gNYmXdpIvZRGtiok_TxRhKWmcPNXw4pkYXO8JkeMjNXyKPTTKBiJq1phRUZme_wR5KQam05L_vsaI5gO5RXdz0AmjaeApVpzPNlIOAlKB6uTulJU-IWay2c8A!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
        # y_pred = classifier.predict(x)
    
        # df["Shipping_City_Prediction"] = y_pred
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_213436 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_213436';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:35:16.154841 [debug] [Thread-3 (]: SQL status: OK in 40.0 seconds
[0m14:35:16.159293 [info ] [Thread-3 (]: oracle adapter: OK
[0m14:35:16.170816 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:35:16.171538 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.WEB_EVENTS_PYTHON rename to web_events_python__dbt_backup
[0m14:35:16.283950 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:35:16.292294 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:35:16.293193 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
ALTER table FAWDBTCORE.web_events_python__dbt_tmp rename to web_events_python
[0m14:35:16.402610 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:35:16.411989 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m14:35:16.412430 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:35:16.412843 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: COMMIT
[0m14:35:16.514093 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:35:16.525941 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:35:16.526434 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.web_events_python__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:35:16.658209 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:35:16.668323 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:34:32.545845 => 14:35:16.668061
[0m14:35:16.669118 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:35:16.783962 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1050f4b8-f1c2-4a4f-8f01-163f8f4e8952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d51c50>]}
[0m14:35:16.785059 [info ] [Thread-3 (]: 2 of 2 OK created python table model FAWDBTCORE.web_events_python .............. [[32mOK[0m in 44.25s]
[0m14:35:16.785598 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:35:16.787462 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:16.787997 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:35:18.875293 [debug] [MainThread]: On master: COMMIT
[0m14:35:18.876593 [debug] [MainThread]: Using oracle connection "master"
[0m14:35:18.877438 [debug] [MainThread]: On master: COMMIT
[0m14:35:18.979815 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:35:18.982083 [debug] [MainThread]: On master: Close
[0m14:35:19.091159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:19.091783 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:35:19.091959 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:35:19.092206 [info ] [MainThread]: 
[0m14:35:19.092418 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 23.04 seconds (83.04s).
[0m14:35:19.092854 [debug] [MainThread]: Command end result
[0m14:35:19.098641 [info ] [MainThread]: 
[0m14:35:19.098887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:19.099047 [info ] [MainThread]: 
[0m14:35:19.099207 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:35:19.099516 [debug] [MainThread]: Command `dbt run` succeeded at 14:35:19.099470 after 83.23 seconds
[0m14:35:19.099738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027fa910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027fa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10295ec50>]}
[0m14:35:19.099950 [debug] [MainThread]: Flushing usage events
[0m14:35:29.036251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10680b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068178d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106817f10>]}


============================== 14:35:29.038981 | 72cad934-52d0-4443-8547-123a0e5cfef3 ==============================
[0m14:35:29.038981 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:35:29.039336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:35:29.082549 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:35:29.104333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72cad934-52d0-4443-8547-123a0e5cfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092cddd0>]}
[0m14:35:29.110492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72cad934-52d0-4443-8547-123a0e5cfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b4e90>]}
[0m14:35:29.144053 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:35:29.174846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:35:29.175302 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m14:35:29.195713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72cad934-52d0-4443-8547-123a0e5cfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946c590>]}
[0m14:35:29.202367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72cad934-52d0-4443-8547-123a0e5cfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f3d90>]}
[0m14:35:29.202698 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:35:29.202883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72cad934-52d0-4443-8547-123a0e5cfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109300090>]}
[0m14:35:29.203678 [info ] [MainThread]: 
[0m14:35:29.204073 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:35:29.204648 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:35:29.209457 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:35:29.209690 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:35:29.209857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:29.210024 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:35:30.631550 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:35:30.739521 [debug] [ThreadPool]: On list_None: Close
[0m14:35:30.849156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:35:30.857860 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:35:30.858606 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:35:30.859001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:30.859411 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:35:32.247261 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:35:32.260811 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:35:32.261285 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:35:32.388634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:35:32.597277 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:35:32.710399 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:35:32.825835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72cad934-52d0-4443-8547-123a0e5cfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068099d0>]}
[0m14:35:32.826882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:32.827355 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:35:34.306667 [debug] [MainThread]: On master: COMMIT
[0m14:35:34.308438 [debug] [MainThread]: Using oracle connection "master"
[0m14:35:34.308985 [debug] [MainThread]: On master: COMMIT
[0m14:35:34.413437 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:35:34.414349 [debug] [MainThread]: On master: Close
[0m14:35:34.520088 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:35:34.520841 [info ] [MainThread]: 
[0m14:35:34.595945 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:35:34.597011 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:35:34.598225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:35:34.598830 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:35:34.617409 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:35:34.618353 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:35:34.599234 => 14:35:34.618233
[0m14:35:34.618598 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:35:34.646670 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:35:36.871376 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:35:36.872408 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzMzMzUsImlhdCI6MTY4NzQ2OTczNX0.l2bhd87CK-uUD58W9J4VMIjCLIDRLklUjyHkPtC6uukehL2vzjneQ1Of9ksWLwCycWp7EQ_ab2Uua3PPriRvuPkcygHJFrDDsD5qvYiTv0UMxYLnlqmGfLL4wfkCe7F-JAnWGoE3P4slgb7ourC0Tcru-7l3J57_v7mVsHv2tplGDJcGw7NProq7JXKAmwPpVK50MFVd6G8QLy4UUoMhkfvt8lH2cPs5XF3ZqzdcZ8P4rySF5wY3HCOh3Pj3Vtf3CAvWZGyflOCkcAL0TTyKQ5snEcevMnVIRSdzasLf6pj0XAu7RSbp8pyzk3Po8FLOMIms3hSjWgJdl3Nyl5oE9Q!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info143534637433"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_213536 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_213536';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:35:36.873637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:36.873882 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:36:02.744677 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m14:36:02.748420 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:36:02.758590 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:36:02.759541 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info143534637433')
        
      order by ordinal_position

  
[0m14:36:03.031923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:36:03.148264 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:36:03.149364 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:36:03.285839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:36:03.393216 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:36:03.393644 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:36:03.529819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:36:03.660305 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:36:03.662301 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:36:03.662707 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info143534637433
    )
  
[0m14:36:04.381727 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:36:04.386465 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:36:04.386858 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:36:04.387053 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:36:04.489984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:36:04.499773 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:36:04.500352 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info143534637433
[0m14:36:04.651707 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:36:04.666214 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:36:04.667082 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info143534637433 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:36:04.796942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:36:04.814504 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:35:34.618744 => 14:36:04.814208
[0m14:36:04.815143 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:36:04.917107 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:36:05.027451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72cad934-52d0-4443-8547-123a0e5cfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109523c10>]}
[0m14:36:05.030908 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.43s]
[0m14:36:05.031594 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:36:05.032441 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:36:05.032908 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:36:05.033474 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:36:05.033736 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:36:05.036531 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:36:05.037553 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:36:05.033907 => 14:36:05.037402
[0m14:36:05.037828 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:36:05.047732 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m14:36:05.048129 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:36:05.049520 [info ] [Thread-3 (]: Python model materialization is table
[0m14:36:05.049771 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:36:07.103553 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:36:07.105701 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzMzNjYsImlhdCI6MTY4NzQ2OTc2Nn0.N8h92Nvn0_jSdfqDfxHAH-xHfqzae8YzMNyAWYhODlkFf9EqJlEk-f_hDlz5D6MMy45axeIyLMJylg9O7ux0fY5-00xgmFeG0RkSEL2b-vL9-y5qNZH1W9THMmRdYqvFE_CKNvaWIUowfEdHAsvlFrZBbuKkiZtcljVzIQsg33i4jH0Pfse3z3kzvWenqNkglrvGsT0NM7zgxl6qhpIH5fUhUrEm3TngdWYow-QwWpIyySM1fyuts51AXE4PusHgLFuHEAuXp2vZ2G9vItaPleFIAXq26-tGKbnI_xNDlBFkKyWBTlqF6mFzfu_sdGZSfMUTaCUeCLBdQltkaC86Kw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": X_test})
        # y_pred = classifier.predict(x)
    
        # df["Shipping_City_Prediction"] = y_pred
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_213607 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_213607';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:36:07.106956 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:36:07.107384 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:36:48.108208 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-20100: {"Unexpected Script Execution Error":"Data must be 1-dimensional : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 95, in main\n   File \"<string>\", line 77, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/frame.py\", line 614, in __init__\n    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 464, in dict_to_mgr\n    return arrays_to_mgr(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 124, in arrays_to_mgr\n    arrays = _homogenize(arrays, index, dtype)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 589, in _homogenize\n    val = sanitize_array(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/construction.py\", line 576, in sanitize_array\n    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/construction.py\", line 627, in _sanitize_ndim\n    raise ValueError(\"Data must be 1-dimensional\")\n"}
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m14:36:48.110984 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:36:48.227833 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:36:05.037998 => 14:36:48.226489
[0m14:36:48.237984 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-20100: {"Unexpected Script Execution Error":"Data must be 1-dimensional : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 95, in main\n   File \"<string>\", line 77, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/frame.py\", line 614, in __init__\n    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 464, in dict_to_mgr\n    return arrays_to_mgr(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 124, in arrays_to_mgr\n    arrays = _homogenize(arrays, index, dtype)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 589, in _homogenize\n    val = sanitize_array(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/construction.py\", line 576, in sanitize_array\n    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/construction.py\", line 627, in _sanitize_ndim\n    raise ValueError(\"Data must be 1-dimensional\")\n"}
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:36:48.239892 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72cad934-52d0-4443-8547-123a0e5cfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099053d0>]}
[0m14:36:48.240326 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 43.21s]
[0m14:36:48.240655 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:36:48.241754 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:36:48.242087 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:36:49.601526 [debug] [MainThread]: On master: COMMIT
[0m14:36:49.603625 [debug] [MainThread]: Using oracle connection "master"
[0m14:36:49.604718 [debug] [MainThread]: On master: COMMIT
[0m14:36:49.707381 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:36:49.709048 [debug] [MainThread]: On master: Close
[0m14:36:49.824647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:49.825798 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:36:49.826257 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:36:49.826790 [info ] [MainThread]: 
[0m14:36:49.827273 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 20.62 seconds (80.62s).
[0m14:36:49.828328 [debug] [MainThread]: Command end result
[0m14:36:49.836937 [info ] [MainThread]: 
[0m14:36:49.837199 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:36:49.837350 [info ] [MainThread]: 
[0m14:36:49.837496 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:36:49.837686 [error] [MainThread]:   ORA-20100: {"Unexpected Script Execution Error":"Data must be 1-dimensional : Line 168  File \"/u01/embedded_python.py\", line 168, in <module>\n    res = oml.do_eval(func=script, func_owner=scriptowner, graphics=graphics, **p)\n   File \"oml/embed/eval.py\", line 108, in oml.embed.eval.do_eval\n   File \"oml/embed/eval2.py\", line 93, in oml.embed.eval2.__eval\n   File \"oml/embed/eval2.py\", line 369, in oml.embed.eval2.__run_func\n   File \"oml/embed/eval2.py\", line 365, in oml.embed.eval2.__run_func\n   File \"oml/script/script.py\", line 64, in oml.script.script.Callable.__call__\n   File \"<string>\", line 95, in main\n   File \"<string>\", line 77, in model\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/frame.py\", line 614, in __init__\n    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 464, in dict_to_mgr\n    return arrays_to_mgr(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 124, in arrays_to_mgr\n    arrays = _homogenize(arrays, index, dtype)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py\", line 589, in _homogenize\n    val = sanitize_array(\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/construction.py\", line 576, in sanitize_array\n    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)\n   File \"/usr/local/lib/python3.10/site-packages/pandas/core/construction.py\", line 627, in _sanitize_ndim\n    raise ValueError(\"Data must be 1-dimensional\")\n"}
[0m14:36:49.837962 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m14:36:49.838144 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 196
[0m14:36:49.838290 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:36:49.838431 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:36:49.838563 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:36:49.838696 [error] [MainThread]:   ORA-06512: at line 107
[0m14:36:49.838830 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:36:49.838971 [info ] [MainThread]: 
[0m14:36:49.839126 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:36:49.839422 [debug] [MainThread]: Command `dbt run` failed at 14:36:49.839377 after 80.83 seconds
[0m14:36:49.839648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e6ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e68e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106848250>]}
[0m14:36:49.839855 [debug] [MainThread]: Flushing usage events
[0m14:39:13.549759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106567ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106567f90>]}


============================== 14:39:13.552492 | fe1b25bb-a390-4d96-9d28-b6ff2f7d2a8e ==============================
[0m14:39:13.552492 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:39:13.552805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:39:13.599070 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:39:13.621546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe1b25bb-a390-4d96-9d28-b6ff2f7d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106598fd0>]}
[0m14:39:13.627750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe1b25bb-a390-4d96-9d28-b6ff2f7d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c79bd0>]}
[0m14:39:13.660775 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:39:13.693056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:13.693524 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m14:39:13.713746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe1b25bb-a390-4d96-9d28-b6ff2f7d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2bc50>]}
[0m14:39:13.719993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe1b25bb-a390-4d96-9d28-b6ff2f7d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cddfd0>]}
[0m14:39:13.720327 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:39:13.720507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe1b25bb-a390-4d96-9d28-b6ff2f7d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106598950>]}
[0m14:39:13.721268 [info ] [MainThread]: 
[0m14:39:13.721637 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:39:13.722240 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:39:13.727210 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:39:13.727512 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:39:13.727685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:13.727863 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:39:15.887746 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:39:16.000781 [debug] [ThreadPool]: On list_None: Close
[0m14:39:16.114782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:39:16.123135 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:39:16.123559 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:39:16.123752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:16.124204 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:39:17.560326 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:39:17.570130 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:39:17.570791 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:39:17.695747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:39:17.907712 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:39:18.012529 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:39:18.137117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe1b25bb-a390-4d96-9d28-b6ff2f7d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661b010>]}
[0m14:39:18.137785 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:18.138028 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:39:19.433299 [debug] [MainThread]: On master: COMMIT
[0m14:39:19.435526 [debug] [MainThread]: Using oracle connection "master"
[0m14:39:19.436842 [debug] [MainThread]: On master: COMMIT
[0m14:39:19.539728 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:39:19.541892 [debug] [MainThread]: On master: Close
[0m14:39:19.653911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:39:19.654622 [info ] [MainThread]: 
[0m14:39:19.659348 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:39:19.660065 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:39:19.660922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:39:19.661373 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:39:19.681292 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:39:19.682415 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:39:19.661693 => 14:39:19.682288
[0m14:39:19.682681 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:39:19.709105 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:39:22.022107 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:39:22.024321 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzM1NjEsImlhdCI6MTY4NzQ2OTk2MX0.ZINs_jBFVGDHRIfwpubBYDnxBDf9IblBZWp432CsnHAzhq6LmyxKwHFttEV8QZA4FEdkPJIyd-emt_5t5pZdyoldzeEVBCbXfMk5KrNxRw4F08cqWCx68AlsYsz2H6WiXt9SI76-kZXikl18du3yHCVeTTR6GUduz0WVvAtjyWVZ6H3Ii5p3EHiGDEH39tDQL1P-dW5JahF56KdriQgEzMcRZIgDXp3zdnF7q5SF_PTRGfte689J-GKiHQ6K6qoaE3y4yfugRk228n2WuqHkr_1C9Wxgu1qp3647LLywgHxZbRphqT9cZQoUCw0n4T5qvPNmQTwwUczz_EO4lmlVgw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info143919698713"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_213922 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_213922';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:39:22.025992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:22.026599 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:39:51.290534 [debug] [Thread-1 (]: SQL status: OK in 29.0 seconds
[0m14:39:51.295131 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:39:51.306470 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:39:51.307515 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info143919698713')
        
      order by ordinal_position

  
[0m14:39:51.570484 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:39:51.686849 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:39:51.687896 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:39:51.817557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:39:51.935407 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:39:51.936373 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:39:52.069295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:39:52.203162 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:39:52.205196 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:39:52.205631 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info143919698713
    )
  
[0m14:39:52.832991 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:39:52.848046 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:39:52.848746 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:39:52.849084 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:39:52.952802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:39:52.961289 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:39:52.961806 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info143919698713
[0m14:39:53.123892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:39:53.131733 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:39:53.132069 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info143919698713 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:39:53.257321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:39:53.274189 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:39:19.682834 => 14:39:53.273960
[0m14:39:53.274883 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:39:53.378270 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:39:53.483932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe1b25bb-a390-4d96-9d28-b6ff2f7d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e86b10>]}
[0m14:39:53.484635 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 33.82s]
[0m14:39:53.485089 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:39:53.485934 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:39:53.486533 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:39:53.487273 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:39:53.487660 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:39:53.489760 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:39:53.491647 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:39:53.487802 => 14:39:53.491446
[0m14:39:53.492006 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:39:53.501022 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m14:39:53.501455 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:39:53.502869 [info ] [Thread-3 (]: Python model materialization is table
[0m14:39:53.503130 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:39:55.518402 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:39:55.519741 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzM1OTQsImlhdCI6MTY4NzQ2OTk5NH0.cbdIW4Q__lyMoL8VY8Z3_gs6yupPHwj2ez_WJaLFoDHI9_RDF-zKb7mDyqh7mMwECr1-TqnQMZ0o9cYUUe4Qj9HRQ6I3joiBY-gPA8na-lgKEs2QG1hNJze38sSeoRcabfTqh6-RNmaWTQMHzgfjzLAzzMXAxkNf8Dyt8aJODjeJeSBVUhfiSIqLH106Jcmg9JfZXrMYFGoIeUq1TExxF1w87f1bEfIaVr65nlJ8Fcj6cKtsTG3OVYZKOdj9l-BDEVYDTfJPRo0RkXpVbTjkEoANbtoOgStiaEVRfoeQ_tFt-If31fu2M52e-IKONqdFWHdt-M-0gv9lELZcfhPrcw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        #y_pred = classifier.predict(X_test)
    
        #y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        #accuracy = classifier.score(X_test, y_test)
        #res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
        y_pred = classifier.predict(x)
    
        df["Shipping_City_Prediction"] = y_pred
        
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_213955 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_213955';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:39:55.521129 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:39:55.521670 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:40:57.542427 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m14:40:57.545307 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:40:57.656266 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:39:53.492203 => 14:40:57.654900
[0m14:40:57.671888 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:40:57.674528 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe1b25bb-a390-4d96-9d28-b6ff2f7d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c725d0>]}
[0m14:40:57.675259 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 64.19s]
[0m14:40:57.675812 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:40:57.677634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:40:57.678015 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:41:00.082030 [debug] [MainThread]: On master: COMMIT
[0m14:41:00.084320 [debug] [MainThread]: Using oracle connection "master"
[0m14:41:00.085464 [debug] [MainThread]: On master: COMMIT
[0m14:41:00.191820 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:41:00.192643 [debug] [MainThread]: On master: Close
[0m14:41:00.302737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:00.304100 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:41:00.304652 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:41:00.305384 [info ] [MainThread]: 
[0m14:41:00.305643 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 46.58 seconds (106.58s).
[0m14:41:00.306014 [debug] [MainThread]: Command end result
[0m14:41:00.540879 [info ] [MainThread]: 
[0m14:41:00.542627 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:41:00.543110 [info ] [MainThread]: 
[0m14:41:00.543563 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:41:00.544027 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m14:41:00.545087 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m14:41:00.545560 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m14:41:00.545976 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m14:41:00.546359 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m14:41:00.546735 [error] [MainThread]:   ORA-29276: transfer timeout
[0m14:41:00.547108 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m14:41:00.547476 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m14:41:00.547846 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m14:41:00.548214 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:41:00.548570 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:41:00.548932 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:41:00.549287 [error] [MainThread]:   ORA-06512: at line 107
[0m14:41:00.549643 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:41:00.550035 [info ] [MainThread]: 
[0m14:41:00.550409 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:41:00.551115 [debug] [MainThread]: Command `dbt run` failed at 14:41:00.551005 after 107.03 seconds
[0m14:41:00.551629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e9ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e9ce10>]}
[0m14:41:00.552099 [debug] [MainThread]: Flushing usage events
[0m14:41:17.262709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c08f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c17fd0>]}


============================== 14:41:17.265736 | 9109d3d6-ec5d-48dc-8942-d9651698ed5a ==============================
[0m14:41:17.265736 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:41:17.266097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:41:17.312452 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:41:17.335687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9109d3d6-ec5d-48dc-8942-d9651698ed5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc9410>]}
[0m14:41:17.341910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9109d3d6-ec5d-48dc-8942-d9651698ed5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096cd290>]}
[0m14:41:17.376125 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:41:17.417649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:17.417977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:17.421712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9109d3d6-ec5d-48dc-8942-d9651698ed5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097e74d0>]}
[0m14:41:17.427363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9109d3d6-ec5d-48dc-8942-d9651698ed5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ce450>]}
[0m14:41:17.427705 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:41:17.427880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9109d3d6-ec5d-48dc-8942-d9651698ed5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c41bd0>]}
[0m14:41:17.428642 [info ] [MainThread]: 
[0m14:41:17.429046 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:41:17.429622 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:41:17.434812 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:41:17.435115 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:41:17.435286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:17.435454 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:41:18.874957 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:41:18.985798 [debug] [ThreadPool]: On list_None: Close
[0m14:41:19.099614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:41:19.107947 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:41:19.108525 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:41:19.108924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:19.109334 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:41:20.618368 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:41:20.630360 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:41:20.631127 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:41:20.760572 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:20.967126 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:41:21.071292 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:41:21.185488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9109d3d6-ec5d-48dc-8942-d9651698ed5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c5990>]}
[0m14:41:21.186440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:21.186851 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:41:22.646987 [debug] [MainThread]: On master: COMMIT
[0m14:41:22.649364 [debug] [MainThread]: Using oracle connection "master"
[0m14:41:22.650008 [debug] [MainThread]: On master: COMMIT
[0m14:41:22.753356 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:41:22.755796 [debug] [MainThread]: On master: Close
[0m14:41:22.865337 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:22.866336 [info ] [MainThread]: 
[0m14:41:22.873918 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:41:22.874407 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:41:22.874866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:41:22.875085 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:41:22.891141 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:41:22.892198 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:41:22.875231 => 14:41:22.892092
[0m14:41:22.892423 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:41:22.916186 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:41:25.296417 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:41:25.297704 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzM2ODQsImlhdCI6MTY4NzQ3MDA4NH0.B4xcuQnEdGcClnyj1U3GTcYhrLiqwc0eu6lw1_6gKTOXuE-mdmunXPoqsXReSFKXXT_uHVf6MVPwHia2Y-rmOKzjJyHBq3UPqQur5SODFb_JLz6_ttz8kQj7fsam0ofrNGcU9XBJzr6VY8m7DuS0k1AosUMLqIOs1kKAKo4F_kIQVTzdtjodEJvAddiBl8OTXrtBmALO0XUECG-OPd4W9YoEGbgGFJNwoZzyQVGkEJZmyz_RJXC1fXLNRvrgWGigZVs04IuLqyyIX5Cr3FRmPKK_OLEJLk3y4-fZCBrx6VpKhEH6AeeubaILWZq8Brbbf63jAkJD6cdWX4LpmySfyA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info144122909086"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_214125 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_214125';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:41:25.298899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:25.299402 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:41:50.610728 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m14:41:50.614881 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:41:50.625118 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:41:50.625989 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info144122909086')
        
      order by ordinal_position

  
[0m14:41:50.894340 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:51.010338 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:41:51.011403 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:41:51.198150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:51.317646 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:41:51.318625 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:41:51.509604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:51.642022 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:41:51.643362 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:41:51.643808 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info144122909086
    )
  
[0m14:41:52.424003 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:41:52.437539 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:41:52.438473 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:41:52.438931 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:41:52.542603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:52.551454 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:41:52.551857 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info144122909086
[0m14:41:52.710493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:52.722478 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:41:52.723329 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info144122909086 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:41:52.850543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:52.860671 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:41:22.892569 => 14:41:52.860518
[0m14:41:52.861102 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:41:52.961602 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:41:53.068490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9109d3d6-ec5d-48dc-8942-d9651698ed5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10979b450>]}
[0m14:41:53.069261 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.19s]
[0m14:41:53.069718 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:41:53.070417 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:41:53.070868 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:41:53.071355 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:41:53.071582 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:41:53.074508 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:41:53.075547 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:41:53.071749 => 14:41:53.075443
[0m14:41:53.075771 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:41:53.088890 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m14:41:53.089357 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:41:53.091235 [info ] [Thread-3 (]: Python model materialization is table
[0m14:41:53.091574 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:41:55.194969 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:41:55.195734 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzM3MTQsImlhdCI6MTY4NzQ3MDExNH0.jQJkyjq4wWfO9pefmSOIrJ5xT9ryiN5Pcb0rYmFwXzO6CivW5giQi4VgvOAPZ2O_gLrWIawt_EoBkhBmWVrL16DyDAYcdHuKJaKOoMx-wBPMFxbs3UVqGoaeZvT_A-IJ_nfTaOt6Gk3_XyeDxY5x8SFzJBzmYQvCwQaBcEjGTfpSRBDByfkk3cLU4X9rQSdcCRtZ_Ae6s9q1ufJV3bdfB2FQSR4b7tdyL1oeNDgnlogRjkRqOQGYY8aXJv2AlLzzebQFQjSNIoa5a8DBbB5Tnp3CsbL6JKddFb6E50YVMfeYKUNqnYMiwnReMIkoC86BOWHJOrlBKiS8qeu3xYfs6g!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        #y_pred = classifier.predict(X_test)
    
        #y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        #accuracy = classifier.score(X_test, y_test)
        #res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
        y_pred = classifier.predict(x)
    
        df["Shipping_City_Prediction"] = y_pred
        
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_214155 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_214155';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:41:55.197144 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:41:55.197517 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:42:57.137411 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m14:42:57.140070 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:42:57.258513 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:41:53.075924 => 14:42:57.257212
[0m14:42:57.266748 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:42:57.268134 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9109d3d6-ec5d-48dc-8942-d9651698ed5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099dbe90>]}
[0m14:42:57.268547 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 64.20s]
[0m14:42:57.268849 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:42:57.270420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:57.270958 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:42:58.654738 [debug] [MainThread]: On master: COMMIT
[0m14:42:58.656924 [debug] [MainThread]: Using oracle connection "master"
[0m14:42:58.658066 [debug] [MainThread]: On master: COMMIT
[0m14:42:58.783077 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:42:58.784699 [debug] [MainThread]: On master: Close
[0m14:42:58.891720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:58.892419 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:42:58.892801 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:42:58.893235 [info ] [MainThread]: 
[0m14:42:58.893698 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 41.46 seconds (101.46s).
[0m14:42:58.894603 [debug] [MainThread]: Command end result
[0m14:42:58.900781 [info ] [MainThread]: 
[0m14:42:58.901063 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:42:58.901421 [info ] [MainThread]: 
[0m14:42:58.901755 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:42:58.902086 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m14:42:58.902408 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m14:42:58.902721 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m14:42:58.903033 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m14:42:58.903689 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m14:42:58.904049 [error] [MainThread]:   ORA-29276: transfer timeout
[0m14:42:58.904381 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m14:42:58.904685 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m14:42:58.904992 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m14:42:58.905244 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:42:58.905493 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:42:58.905737 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:42:58.905982 [error] [MainThread]:   ORA-06512: at line 107
[0m14:42:58.906224 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:42:58.906486 [info ] [MainThread]: 
[0m14:42:58.906696 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:42:58.907000 [debug] [MainThread]: Command `dbt run` failed at 14:42:58.906952 after 101.69 seconds
[0m14:42:58.907275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c2b810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c28290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a52c50>]}
[0m14:42:58.907583 [debug] [MainThread]: Flushing usage events
[0m14:43:32.720200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a17ed0>]}


============================== 14:43:32.722530 | 4d5d9920-b96d-4525-b12e-f4bb27cf8454 ==============================
[0m14:43:32.722530 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:43:32.722862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:43:32.763287 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:43:32.784827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a28550>]}
[0m14:43:32.790850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3a5d0>]}
[0m14:43:32.822632 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:43:32.858341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:32.858652 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m14:43:32.877637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a46e50>]}
[0m14:43:32.883125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3a450>]}
[0m14:43:32.883321 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:43:32.883499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11114d050>]}
[0m14:43:32.884449 [info ] [MainThread]: 
[0m14:43:32.884841 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:43:32.885564 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:43:32.890551 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:43:32.890804 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:43:32.890948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:32.891089 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:43:34.533548 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:43:34.643142 [debug] [ThreadPool]: On list_None: Close
[0m14:43:34.764278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:43:34.772098 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:43:34.772513 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:43:34.772792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:34.773069 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:43:36.543217 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:43:36.556403 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:43:36.556895 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:43:36.727389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:43:36.993944 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:43:37.157388 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:43:37.315135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a48490>]}
[0m14:43:37.316174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:37.316535 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:43:39.138142 [debug] [MainThread]: On master: COMMIT
[0m14:43:39.139319 [debug] [MainThread]: Using oracle connection "master"
[0m14:43:39.140083 [debug] [MainThread]: On master: COMMIT
[0m14:43:39.286397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:43:39.288277 [debug] [MainThread]: On master: Close
[0m14:43:39.481360 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:43:39.483066 [info ] [MainThread]: 
[0m14:43:39.493537 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:43:39.494075 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:43:39.494885 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:43:39.496009 [debug] [Thread-4 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:43:39.495556 [info ] [Thread-1 (]: 1 of 12 START sql incremental model FAWDBTCORE.stg_mobile_events ............... [RUN]
[0m14:43:39.496899 [info ] [Thread-2 (]: 2 of 12 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:43:39.497431 [info ] [Thread-3 (]: 3 of 12 START sql incremental model FAWDBTCORE.stg_web_events .................. [RUN]
[0m14:43:39.497867 [info ] [Thread-4 (]: 4 of 12 START python incremental model FAWDBTCORE.stg_web_order_info ........... [RUN]
[0m14:43:39.498642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:43:39.499255 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:43:39.500167 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:43:39.500720 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_order_info'
[0m14:43:39.501012 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:43:39.501285 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:43:39.501528 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:43:39.501749 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:43:39.510430 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:43:39.512816 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:43:39.515547 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:43:39.529112 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:43:39.530855 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:43:39.515688 => 14:43:39.530616
[0m14:43:39.531131 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:43:39.553930 [info ] [Thread-4 (]: Python model materialization is incremental
[0m14:43:39.554514 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:43:39.513067 => 14:43:39.554411
[0m14:43:39.554702 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:43:39.510888 => 14:43:39.554618
[0m14:43:39.554944 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:43:39.501913 => 14:43:39.554824
[0m14:43:39.555136 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:43:39.555334 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:43:39.555523 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:43:39.557598 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:43:39.566250 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:43:39.568462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:39.569045 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:43:39.569279 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:43:39.581811 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:43:39.582050 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:43:41.164540 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:43:41.165229 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m14:43:41.166052 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

        
  
    
      create global temporary table o$pt_stg_web_events144339557243
      on commit preserve rows
      
      as
        


with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  created_at
    FROM FAWDBTCORE.web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned



  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.stg_web_events)


  
      
[0m14:43:41.167179 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:43:41.167997 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users
)

select * from users_cleaned


[0m14:43:41.168912 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

        
  
    
      create global temporary table o$pt_stg_mobile_events144339568150
      on commit preserve rows
      
      as
        


with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  created_at
FROM FAWDBTCORE.mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned





  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.stg_mobile_events)


  
      
[0m14:43:41.443663 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:43:41.456376 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m14:43:41.456974 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m14:43:41.457295 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m14:43:41.578600 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:43:41.591613 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m14:43:41.592144 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:43:41.710860 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:43:41.727034 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:43:39.557754 => 14:43:41.726837
[0m14:43:41.727532 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:43:41.836231 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114d8210>]}
[0m14:43:41.837568 [info ] [Thread-2 (]: 2 of 12 OK created sql view model FAWDBTCORE.stg_users ......................... [[32mOK[0m in 2.34s]
[0m14:43:41.838475 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:43:41.845847 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:43:41.846559 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzM4MjAsImlhdCI6MTY4NzQ3MDIyMH0.DjsDE8IPgjEqdSNoUJYNHp_t3_vc4I5GfmTINVdodvxELjAHOn2CeO1FX5rIqEzWqn4FI1jIP6gDxhEsVVp90BUL-cFCg2U5a49O9VlrfKgwYsGbX8Ejct8dJVz3FdUIAMK_d9UeQmgiN9BqGhJ8T7E6Er1qCjd735ozULHFD2M2QigGMBpSk3t5wTwZSzaByJngNiItt1LIDud5SFzpr-n-ydfZ9l1lnF8C0_8eLMWW4-y93epLM6d0FIDeFfGbP2OeU5AnQVruLXH_9GgSLUGjG5VhphwtcWHlatGnONwVBA0BsDgCTaOKK6xPBWHXjDi1EicHAU8ILKn6A-hPzw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info144339548575"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_214341 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_214341';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:43:41.847194 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:43:41.847551 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:43:41.992549 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:43:42.000442 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:43:42.000928 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_mobile_events144339568150')
        
      order by ordinal_position

  
[0m14:43:42.263665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:42.377043 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:43:42.377748 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_mobile_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:43:42.581561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:42.694448 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:43:42.694985 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_MOBILE_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:43:42.887424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:43.009795 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:43:43.017378 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:43:43.017696 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      merge  into FAWDBTCORE.stg_mobile_events DBT_INTERNAL_DEST
          using o$pt_stg_mobile_events144339568150 DBT_INTERNAL_SOURCE
          on (
            DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
        )
        when matched then
          update set
          DBT_INTERNAL_DEST.EVENT_TYPE = DBT_INTERNAL_SOURCE.EVENT_TYPE, 
          DBT_INTERNAL_DEST.EVENT_TIMESTAMP = DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
          DBT_INTERNAL_DEST.USER_ID = DBT_INTERNAL_SOURCE.USER_ID, 
          DBT_INTERNAL_DEST.APP_NAME = DBT_INTERNAL_SOURCE.APP_NAME, 
          DBT_INTERNAL_DEST.OPERATING_SYSTEM = DBT_INTERNAL_SOURCE.OPERATING_SYSTEM, 
          DBT_INTERNAL_DEST.COUNTRY = DBT_INTERNAL_SOURCE.COUNTRY, 
          DBT_INTERNAL_DEST.DURATION_SECONDS = DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
          DBT_INTERNAL_DEST.CONVERSION_STATUS = DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
          DBT_INTERNAL_DEST.CREATED_AT = DBT_INTERNAL_SOURCE.CREATED_AT
          when not matched then
          insert(EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, APP_NAME, OPERATING_SYSTEM, COUNTRY, DURATION_SECONDS, CONVERSION_STATUS, CREATED_AT)
          values(
            DBT_INTERNAL_SOURCE.EVENT_ID, 
            DBT_INTERNAL_SOURCE.EVENT_TYPE, 
            DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
            DBT_INTERNAL_SOURCE.USER_ID, 
            DBT_INTERNAL_SOURCE.APP_NAME, 
            DBT_INTERNAL_SOURCE.OPERATING_SYSTEM, 
            DBT_INTERNAL_SOURCE.COUNTRY, 
            DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
            DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
            DBT_INTERNAL_SOURCE.CREATED_AT
            )
  
[0m14:43:43.627206 [debug] [Thread-3 (]: SQL status: OK in 2.0 seconds
[0m14:43:43.635063 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:43:43.635977 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_events144339557243')
        
      order by ordinal_position

  
[0m14:43:43.903586 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:43:44.008202 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:43:44.008620 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:43:44.219029 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:43:44.326403 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:43:44.327031 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:43:44.526062 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:43:44.639675 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:43:44.650883 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:43:44.651483 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      merge  into FAWDBTCORE.stg_web_events DBT_INTERNAL_DEST
          using o$pt_stg_web_events144339557243 DBT_INTERNAL_SOURCE
          on (
            DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
        )
        when matched then
          update set
          DBT_INTERNAL_DEST.EVENT_TYPE = DBT_INTERNAL_SOURCE.EVENT_TYPE, 
          DBT_INTERNAL_DEST.EVENT_TIMESTAMP = DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
          DBT_INTERNAL_DEST.USER_ID = DBT_INTERNAL_SOURCE.USER_ID, 
          DBT_INTERNAL_DEST.PAGE_URL = DBT_INTERNAL_SOURCE.PAGE_URL, 
          DBT_INTERNAL_DEST.BROWSER = DBT_INTERNAL_SOURCE.BROWSER, 
          DBT_INTERNAL_DEST.DEVICE_TYPE = DBT_INTERNAL_SOURCE.DEVICE_TYPE, 
          DBT_INTERNAL_DEST.COUNTRY = DBT_INTERNAL_SOURCE.COUNTRY, 
          DBT_INTERNAL_DEST.DURATION_SECONDS = DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
          DBT_INTERNAL_DEST.CONVERSION_STATUS = DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
          DBT_INTERNAL_DEST.CREATED_AT = DBT_INTERNAL_SOURCE.CREATED_AT
          when not matched then
          insert(EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, PAGE_URL, BROWSER, DEVICE_TYPE, COUNTRY, DURATION_SECONDS, CONVERSION_STATUS, CREATED_AT)
          values(
            DBT_INTERNAL_SOURCE.EVENT_ID, 
            DBT_INTERNAL_SOURCE.EVENT_TYPE, 
            DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
            DBT_INTERNAL_SOURCE.USER_ID, 
            DBT_INTERNAL_SOURCE.PAGE_URL, 
            DBT_INTERNAL_SOURCE.BROWSER, 
            DBT_INTERNAL_SOURCE.DEVICE_TYPE, 
            DBT_INTERNAL_SOURCE.COUNTRY, 
            DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
            DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
            DBT_INTERNAL_SOURCE.CREATED_AT
            )
  
[0m14:43:45.312075 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m14:43:45.317787 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m14:43:45.318513 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:43:45.318941 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m14:43:45.428034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:45.440873 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:43:45.441531 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
truncate table o$pt_stg_mobile_events144339568150
[0m14:43:45.546636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:45.553843 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:43:45.554435 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_mobile_events144339568150 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:43:45.686813 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:45.689809 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:43:39.566633 => 14:43:45.689542
[0m14:43:45.690417 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:43:45.792141 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:43:45.984074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11153add0>]}
[0m14:43:45.984557 [info ] [Thread-1 (]: 1 of 12 OK created sql incremental model FAWDBTCORE.stg_mobile_events .......... [[32mOK[0m in 6.49s]
[0m14:43:45.984958 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:44:07.584207 [debug] [Thread-4 (]: SQL status: OK in 26.0 seconds
[0m14:44:07.585572 [info ] [Thread-4 (]: oracle adapter: OK
[0m14:44:07.588589 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:44:07.589056 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info144339548575')
        
      order by ordinal_position

  
[0m14:44:07.865363 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:44:07.985894 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:44:07.986877 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:44:07.992761 [debug] [Thread-3 (]: SQL status: OK in 23.0 seconds
[0m14:44:07.994718 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m14:44:07.995161 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:44:07.995537 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m14:44:08.121004 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:44:08.197785 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:08.205638 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:44:08.206315 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
truncate table o$pt_stg_web_events144339557243
[0m14:44:08.265680 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:44:08.266367 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:44:08.440234 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:44:08.570413 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:44:08.572754 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:44:08.573334 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info144339548575
    )
  
[0m14:44:08.657312 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:08.660480 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:44:08.660770 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_events144339557243 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:44:08.802578 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:08.805006 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:43:39.555668 => 14:44:08.804825
[0m14:44:08.805369 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:44:08.916309 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:44:09.057926 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111531f10>]}
[0m14:44:09.058763 [info ] [Thread-3 (]: 3 of 12 OK created sql incremental model FAWDBTCORE.stg_web_events ............. [[32mOK[0m in 29.56s]
[0m14:44:09.059306 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:44:09.060189 [debug] [Thread-2 (]: Began running node model.oracle_dbt.combined_categorized_events
[0m14:44:09.060742 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:44:09.061250 [debug] [Thread-3 (]: Began running node model.oracle_dbt.most_active_mobile_users
[0m14:44:09.061844 [info ] [Thread-2 (]: 5 of 12 START sql incremental model FAWDBTCORE.combined_categorized_events ..... [RUN]
[0m14:44:09.062555 [info ] [Thread-1 (]: 6 of 12 START sql view model FAWDBTCORE.mobile_event_durations ................. [RUN]
[0m14:44:09.063152 [info ] [Thread-3 (]: 7 of 12 START sql view model FAWDBTCORE.most_active_mobile_users ............... [RUN]
[0m14:44:09.064113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.combined_categorized_events)
[0m14:44:09.064847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m14:44:09.065468 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.most_active_mobile_users)
[0m14:44:09.065842 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.combined_categorized_events
[0m14:44:09.066311 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m14:44:09.066712 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.most_active_mobile_users
[0m14:44:09.071987 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.combined_categorized_events"
[0m14:44:09.075041 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m14:44:09.077774 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.most_active_mobile_users"
[0m14:44:09.089993 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.most_active_mobile_users (compile): 14:44:09.075458 => 14:44:09.089669
[0m14:44:09.090555 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 14:44:09.072692 => 14:44:09.090256
[0m14:44:09.091064 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.most_active_mobile_users
[0m14:44:09.091451 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m14:44:09.095801 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.most_active_mobile_users"
[0m14:44:09.096151 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.combined_categorized_events (compile): 14:44:09.066994 => 14:44:09.096017
[0m14:44:09.098358 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m14:44:09.098804 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.combined_categorized_events
[0m14:44:09.101621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:44:09.101969 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:44:09.119959 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:44:09.120294 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:44:09.126165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:09.126451 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:44:09.256376 [debug] [Thread-4 (]: SQL status: OK in 1.0 seconds
[0m14:44:09.258272 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:44:09.258640 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:44:09.258932 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:44:09.372910 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:44:09.374867 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:44:09.375153 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info144339548575
[0m14:44:09.565220 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:44:09.568735 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:44:09.569121 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info144339548575 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:44:09.729999 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:44:09.732880 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:43:39.531268 => 14:44:09.732665
[0m14:44:09.733303 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:44:09.852266 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:44:09.959492 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111120390>]}
[0m14:44:09.960730 [info ] [Thread-4 (]: 4 of 12 OK created python incremental model FAWDBTCORE.stg_web_order_info ...... [[32mOK[0m in 30.46s]
[0m14:44:09.961237 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:44:09.961564 [debug] [Thread-4 (]: Began running node model.oracle_dbt.most_frequent_browser
[0m14:44:09.962003 [info ] [Thread-4 (]: 8 of 12 START sql view model FAWDBTCORE.most_frequent_browser .................. [RUN]
[0m14:44:09.963160 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_order_info, now model.oracle_dbt.most_frequent_browser)
[0m14:44:09.963772 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.most_frequent_browser
[0m14:44:09.966801 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.most_frequent_browser"
[0m14:44:09.978745 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.most_frequent_browser (compile): 14:44:09.964018 => 14:44:09.978396
[0m14:44:09.979168 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.most_frequent_browser
[0m14:44:09.982517 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.most_frequent_browser"
[0m14:44:09.995372 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:44:09.995914 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:44:10.552047 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.most_active_mobile_users"
[0m14:44:10.552770 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_active_mobile_users"} */

  
  create or replace view FAWDBTCORE.most_active_mobile_users as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
),

mobile_users_names as (
    select start_users_cleaned.name, count(start_mobile_events_cleaned.event_id) as num_mobile_events
    from start_users_cleaned
    join start_mobile_events_cleaned on start_mobile_events_cleaned.user_id = start_users_cleaned.user_id
    group by start_users_cleaned.name
    ORDER BY num_mobile_events DESC
)

select * from mobile_users_names


[0m14:44:10.554202 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:44:10.554521 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

        
  
    
      create global temporary table o$pt_combined_categorized_events144409101147
      on commit preserve rows
      
      as
        

with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM start_web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM start_mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
)


select * from combined_categorized_events



  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.combined_categorized_events)


  
      
[0m14:44:10.666816 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:10.668836 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: COMMIT
[0m14:44:10.669202 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.most_active_mobile_users"
[0m14:44:10.669488 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: COMMIT
[0m14:44:10.698056 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.mobile_event_durations"
[0m14:44:10.698616 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m14:44:10.772762 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:10.778871 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.most_active_mobile_users"
[0m14:44:10.779464 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_active_mobile_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.most_active_mobile_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:44:10.808689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:44:10.812520 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m14:44:10.813100 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.mobile_event_durations"
[0m14:44:10.813563 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m14:44:10.886601 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:10.891091 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.most_active_mobile_users (execute): 14:44:09.091723 => 14:44:10.890838
[0m14:44:10.891617 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: Close
[0m14:44:10.916839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:44:10.921603 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.mobile_event_durations"
[0m14:44:10.922104 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:44:11.001240 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c50650>]}
[0m14:44:11.002135 [info ] [Thread-3 (]: 7 of 12 OK created sql view model FAWDBTCORE.most_active_mobile_users .......... [[32mOK[0m in 1.94s]
[0m14:44:11.003177 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.most_active_mobile_users
[0m14:44:11.003772 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:44:11.004747 [info ] [Thread-3 (]: 9 of 12 START sql view model FAWDBTCORE.web_events_counts ...................... [RUN]
[0m14:44:11.006001 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.most_active_mobile_users, now model.oracle_dbt.web_events_counts)
[0m14:44:11.006406 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m14:44:11.010212 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m14:44:11.022682 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 14:44:11.006642 => 14:44:11.022214
[0m14:44:11.023460 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_counts
[0m14:44:11.026957 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m14:44:11.028922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:44:11.031540 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 14:44:09.096384 => 14:44:11.031361
[0m14:44:11.031851 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m14:44:11.041556 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:44:11.042137 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:44:11.141175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11153a790>]}
[0m14:44:11.141997 [info ] [Thread-1 (]: 6 of 12 OK created sql view model FAWDBTCORE.mobile_event_durations ............ [[32mOK[0m in 2.08s]
[0m14:44:11.142508 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:44:11.142831 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_python
[0m14:44:11.143435 [info ] [Thread-1 (]: 10 of 12 START python table model FAWDBTCORE.web_events_python ................. [RUN]
[0m14:44:11.144284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.mobile_event_durations, now model.oracle_dbt.web_events_python)
[0m14:44:11.144581 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:44:11.148227 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:44:11.160067 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:44:11.144743 => 14:44:11.159829
[0m14:44:11.160392 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:44:11.170563 [debug] [Thread-1 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m14:44:11.170876 [debug] [Thread-1 (]: Preexisting backup relation=None
[0m14:44:11.173537 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:44:11.173763 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:44:11.173949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:11.174118 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:44:11.249286 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.most_frequent_browser"
[0m14:44:11.249677 [debug] [Thread-4 (]: On model.oracle_dbt.most_frequent_browser: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_frequent_browser"} */

  
  create or replace view FAWDBTCORE.most_frequent_browser as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
),

web_users_names as (
      SELECT u.name, w.most_frequent_browser
FROM start_users_cleaned u
JOIN (
  SELECT w.user_id, w.browser AS most_frequent_browser
  FROM (
    SELECT user_id, browser, ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY COUNT(*) DESC) AS rn
    FROM start_web_events_cleaned
    GROUP BY user_id, browser
  ) w
  WHERE rn = 1
) w ON u.user_id = w.user_id
)

select * from web_users_names


[0m14:44:11.361455 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:44:11.362803 [debug] [Thread-4 (]: On model.oracle_dbt.most_frequent_browser: COMMIT
[0m14:44:11.363068 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.most_frequent_browser"
[0m14:44:11.363275 [debug] [Thread-4 (]: On model.oracle_dbt.most_frequent_browser: COMMIT
[0m14:44:11.467868 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:44:11.471775 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.most_frequent_browser"
[0m14:44:11.472297 [debug] [Thread-4 (]: On model.oracle_dbt.most_frequent_browser: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_frequent_browser"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.most_frequent_browser__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:44:11.581526 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:44:11.584867 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.most_frequent_browser (execute): 14:44:09.979360 => 14:44:11.584751
[0m14:44:11.585163 [debug] [Thread-4 (]: On model.oracle_dbt.most_frequent_browser: Close
[0m14:44:11.691799 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111527f10>]}
[0m14:44:11.692767 [info ] [Thread-4 (]: 8 of 12 OK created sql view model FAWDBTCORE.most_frequent_browser ............. [[32mOK[0m in 1.73s]
[0m14:44:11.693478 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.most_frequent_browser
[0m14:44:12.288858 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_counts"
[0m14:44:12.298693 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_events_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_events_counts


[0m14:44:12.418055 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:12.422770 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m14:44:12.423773 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_counts"
[0m14:44:12.424284 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m14:44:12.524889 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:12.531532 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_counts"
[0m14:44:12.532074 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:44:12.569984 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:44:12.574836 [info ] [Thread-1 (]: Python model materialization is table
[0m14:44:12.575609 [debug] [Thread-1 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:44:12.638183 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:12.640207 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 14:44:11.023761 => 14:44:12.640103
[0m14:44:12.640419 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: Close
[0m14:44:12.752372 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113f7590>]}
[0m14:44:12.754020 [info ] [Thread-3 (]: 9 of 12 OK created sql view model FAWDBTCORE.web_events_counts ................. [[32mOK[0m in 1.75s]
[0m14:44:12.754770 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:44:14.683007 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:44:14.686401 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzM4NTMsImlhdCI6MTY4NzQ3MDI1M30.pN6LADlfTfPsraoYN7OULRhqAyQqlewW3TYPNbloUr3rS3f8BsTzy1P5X4U5--VGi3QBQcEgE_gEU_VjssafIYy64wnUv5IxnLdYSZ3OI02a8zRXRj4eYF8FkrsMj6Z67x541EFfE3SPwJMq_F1sNbaUvJ-t2a458eU_2IzMme1qzDbO6rZC7QvW8gAfrjvXhnlZADBvXtb9nUKUIQA79lQ10V6j3puDiy_8W7HNAWk3DwwkcnT_gJEu1YG-ityBt7jXHN8tU8wcyUpoJsTqduDsydANtI-empYEqBxATPWmdBuJr-bRvBBuJc5EuAxZfyPu4Y3TyelRTKgUYopMgg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
        # y_pred = classifier.predict(x)
    
        # df["Shipping_City_Prediction"] = y_pred
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_214414 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_214414';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:44:14.688143 [info ] [Thread-1 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m14:44:14.688803 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_python: Close
[0m14:44:14.795773 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:44:11.160537 => 14:44:14.794863
[0m14:44:14.812171 [debug] [Thread-1 (]: Database Error in model web_events_python (models/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:44:14.816287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115fb2d0>]}
[0m14:44:14.817526 [error] [Thread-1 (]: 10 of 12 ERROR creating python table model FAWDBTCORE.web_events_python ........ [[31mERROR[0m in 3.67s]
[0m14:44:14.818729 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:44:36.942806 [debug] [Thread-2 (]: SQL status: OK in 26.0 seconds
[0m14:44:36.952568 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:44:36.954093 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_combined_categorized_events144409101147')
        
      order by ordinal_position

  
[0m14:44:37.379197 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:44:37.507209 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:44:37.508702 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('combined_categorized_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:44:37.724818 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:44:37.851532 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:44:37.853481 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('COMBINED_CATEGORIZED_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:44:38.058390 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:44:38.173805 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.combined_categorized_events"
[0m14:44:38.188485 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:44:38.189763 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      insert  into  FAWDBTCORE.combined_categorized_events (EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, PAGE_URL, BROWSER, DEVICE_TYPE, COUNTRY, DURATION_SECONDS, CREATED_AT, CONVERSION_STATUS, APP_NAME, PLATFORM, WEB_DURATION_SECONDS, MOBILE_DURATION_SECONDS)
    (
       select EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, PAGE_URL, BROWSER, DEVICE_TYPE, COUNTRY, DURATION_SECONDS, CREATED_AT, CONVERSION_STATUS, APP_NAME, PLATFORM, WEB_DURATION_SECONDS, MOBILE_DURATION_SECONDS
       from o$pt_combined_categorized_events144409101147
    )
  
[0m14:44:58.476014 [debug] [Thread-2 (]: SQL status: OK in 20.0 seconds
[0m14:44:58.482216 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: COMMIT
[0m14:44:58.483201 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:44:58.483742 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: COMMIT
[0m14:44:58.607231 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:44:58.615482 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:44:58.616311 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */
truncate table o$pt_combined_categorized_events144409101147
[0m14:44:58.732405 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:44:58.740074 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:44:58.740935 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_combined_categorized_events144409101147 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:44:58.957599 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:44:58.963613 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.combined_categorized_events (execute): 14:44:09.099024 => 14:44:58.963328
[0m14:44:58.964280 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: ROLLBACK
[0m14:44:59.069437 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: Close
[0m14:44:59.215380 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d5d9920-b96d-4525-b12e-f4bb27cf8454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111573790>]}
[0m14:44:59.217665 [info ] [Thread-2 (]: 5 of 12 OK created sql incremental model FAWDBTCORE.combined_categorized_events  [[32mOK[0m in 50.15s]
[0m14:44:59.219753 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.combined_categorized_events
[0m14:44:59.222428 [debug] [Thread-4 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:44:59.223518 [info ] [Thread-4 (]: 11 of 12 START sql view model FAWDBTCORE.average_duration_by_platform_country .. [RUN]
[0m14:44:59.224498 [debug] [Thread-3 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:44:59.225428 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.most_frequent_browser, now model.oracle_dbt.average_duration_by_platform_country)
[0m14:44:59.226128 [info ] [Thread-3 (]: 12 of 12 START sql view model FAWDBTCORE.event_counts_by_platform .............. [RUN]
[0m14:44:59.226790 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m14:44:59.227996 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.web_events_counts, now model.oracle_dbt.event_counts_by_platform)
[0m14:44:59.232025 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m14:44:59.232742 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m14:44:59.236259 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m14:44:59.244917 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 14:44:59.233347 => 14:44:59.244612
[0m14:44:59.245275 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 14:44:59.228488 => 14:44:59.245171
[0m14:44:59.245464 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m14:44:59.245634 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m14:44:59.247866 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m14:44:59.249879 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m14:44:59.254758 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:44:59.254929 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:44:59.262216 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:44:59.262416 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:44:59.621813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:59.622531 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:44:59.858681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:59.859351 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:44:59.859688 [debug] [MainThread]: Connection 'model.oracle_dbt.combined_categorized_events' was properly closed.
[0m14:44:59.860018 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m14:44:59.860461 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m14:44:59.860959 [info ] [MainThread]: 
[0m14:44:59.861444 [info ] [MainThread]: Finished running 5 view models, 4 incremental models, 1 table model in 0 hours 1 minutes and 26.98 seconds (86.98s).
[0m14:44:59.862268 [error] [MainThread]: Encountered an error:

[0m14:44:59.902639 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 350, in execute_nodes
    self.run_queue(pool)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 277, in run_queue
    self.job_queue.join()
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/main.py", line 565, in run
    results = task.run()
              ^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 441, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 404, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 358, in execute_nodes
    self._cancel_connections(pool)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 323, in _cancel_connections
    for conn_name in adapter.cancel_open_connections():
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1099, in cancel_open_connections
    return self.connections.cancel_open()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 42, in cancel_open
    if connection.handle is not None and connection.state == ConnectionState.OPEN:
       ^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/contracts/connection.py", line 94, in handle
    self._handle.resolve(self)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/contracts/connection.py", line 118, in resolve
    return self.opener(connection)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/oracle/connections.py", line 217, in open
    handle = oracledb.connect(**conn_config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/oracledb/connection.py", line 1008, in connect
    return conn_class(dsn=dsn, pool=pool, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/oracledb/connection.py", line 130, in __init__
    impl.connect(params_impl)
  File "src/oracledb/impl/thin/connection.pyx", line 314, in oracledb.thin_impl.ThinConnImpl.connect
  File "src/oracledb/impl/thin/connection.pyx", line 202, in oracledb.thin_impl.ThinConnImpl._connect_with_params
  File "src/oracledb/impl/thin/connection.pyx", line 173, in oracledb.thin_impl.ThinConnImpl._connect_with_description
  File "src/oracledb/impl/thin/connection.pyx", line 102, in oracledb.thin_impl.ThinConnImpl._connect_with_address
  File "src/oracledb/impl/thin/protocol.pyx", line 150, in oracledb.thin_impl.Protocol._connect_phase_one
  File "src/oracledb/impl/thin/protocol.pyx", line 286, in oracledb.thin_impl.Protocol._connect_tcp
  File "src/oracledb/impl/thin/crypto.pyx", line 139, in oracledb.thin_impl.get_ssl_socket
  File "src/oracledb/impl/thin/crypto.pyx", line 149, in oracledb.thin_impl.perform_tls_negotiation
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
KeyboardInterrupt

[0m14:44:59.904076 [debug] [MainThread]: Command `dbt run` failed at 14:44:59.903987 after 87.20 seconds
[0m14:44:59.904297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a28a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a28590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cbd3d0>]}
[0m14:44:59.904489 [debug] [MainThread]: Flushing usage events
[0m14:45:03.822622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c73f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c5f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7ffd0>]}


============================== 14:45:03.825156 | 21873a63-a323-43fc-b88c-988a53a7fca0 ==============================
[0m14:45:03.825156 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:45:03.825483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:45:03.868568 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:45:03.891609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c908d0>]}
[0m14:45:03.897828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106391cd0>]}
[0m14:45:03.929629 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:45:03.960291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:03.960512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:03.963734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d319d0>]}
[0m14:45:03.968076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639ef50>]}
[0m14:45:03.968306 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:45:03.968483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106389a10>]}
[0m14:45:03.969480 [info ] [MainThread]: 
[0m14:45:03.969880 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:45:03.970566 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:45:03.975676 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:45:03.975952 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:45:03.976108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:03.976243 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:45:05.406930 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:45:05.512845 [debug] [ThreadPool]: On list_None: Close
[0m14:45:05.619360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:45:05.626276 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:45:05.626620 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:45:05.626884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:05.627170 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:45:06.986004 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:45:06.999267 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:45:06.999755 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:45:07.130154 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:07.339719 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:45:07.448635 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:45:07.565658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106376410>]}
[0m14:45:07.566334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:07.566746 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:45:08.821465 [debug] [MainThread]: On master: COMMIT
[0m14:45:08.823699 [debug] [MainThread]: Using oracle connection "master"
[0m14:45:08.825235 [debug] [MainThread]: On master: COMMIT
[0m14:45:08.928441 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:45:08.930367 [debug] [MainThread]: On master: Close
[0m14:45:09.041930 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:45:09.042696 [info ] [MainThread]: 
[0m14:45:09.047910 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:45:09.048320 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:45:09.048627 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:45:09.049118 [debug] [Thread-4 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:45:09.049629 [info ] [Thread-1 (]: 1 of 12 START sql incremental model FAWDBTCORE.stg_mobile_events ............... [RUN]
[0m14:45:09.050281 [info ] [Thread-2 (]: 2 of 12 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:45:09.050989 [info ] [Thread-3 (]: 3 of 12 START sql incremental model FAWDBTCORE.stg_web_events .................. [RUN]
[0m14:45:09.051465 [info ] [Thread-4 (]: 4 of 12 START python incremental model FAWDBTCORE.stg_web_order_info ........... [RUN]
[0m14:45:09.052101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:45:09.052587 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:45:09.053022 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:45:09.053466 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_order_info'
[0m14:45:09.053686 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:45:09.053896 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:45:09.054089 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:45:09.054285 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:45:09.063114 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:45:09.067046 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:45:09.069946 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:45:09.081960 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:45:09.082669 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:45:09.061273 => 14:45:09.082572
[0m14:45:09.082959 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:45:09.054429 => 14:45:09.082802
[0m14:45:09.083152 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:45:09.083390 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:45:09.083551 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:45:09.067550 => 14:45:09.083477
[0m14:45:09.089828 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:45:09.070317 => 14:45:09.089677
[0m14:45:09.094247 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:45:09.110891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:09.111087 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:45:09.111234 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:45:09.111476 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:45:09.113177 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:45:09.116052 [info ] [Thread-4 (]: Python model materialization is incremental
[0m14:45:09.116595 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:45:09.116816 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:45:09.117277 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:45:10.361869 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:45:10.362191 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:45:10.362497 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

        
  
    
      create global temporary table o$pt_stg_web_events144509112819
      on commit preserve rows
      
      as
        


with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  created_at
    FROM FAWDBTCORE.web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned



  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.stg_web_events)


  
      
[0m14:45:10.362753 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

        
  
    
      create global temporary table o$pt_stg_mobile_events144509106928
      on commit preserve rows
      
      as
        


with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  created_at
FROM FAWDBTCORE.mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned





  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.stg_mobile_events)


  
      
[0m14:45:10.366825 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m14:45:10.367042 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users
)

select * from users_cleaned


[0m14:45:10.474504 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:45:10.483778 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m14:45:10.484203 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m14:45:10.484513 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m14:45:10.586817 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:45:10.597509 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m14:45:10.598044 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:45:10.702521 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:45:10.717202 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:45:09.083692 => 14:45:10.717019
[0m14:45:10.717595 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:45:10.825260 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667a7d0>]}
[0m14:45:10.826349 [info ] [Thread-2 (]: 2 of 12 OK created sql view model FAWDBTCORE.stg_users ......................... [[32mOK[0m in 1.77s]
[0m14:45:10.827041 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:45:11.042680 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:45:11.055772 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:45:11.056400 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_mobile_events144509106928')
        
      order by ordinal_position

  
[0m14:45:11.254921 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:45:11.255816 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzM5MTAsImlhdCI6MTY4NzQ3MDMxMH0.nIlA4GMw-pUDYxhrTuLzSHEsv60hLEnS6oRUM7X7leE-NPxZzBci9b5_O_JwL5N2-BloFMGzEbfNyiHs5MgHSNBh9NwJSwrS9a4AGB7Ia063kA6_ej_UZO9WtkQvSq9VeGUm1lFTYk9bUShaIV1YMVe053UtAwAPBgbiztoXMWHtEGjuukm4rM2ZTAVcFgXbmGy8_wKsvpqFwgA8jt_1edmEM-N5oWXqaOb3XwRiZu_Wio77WTkoFsw8WuKblQjy4PAdQUfZRTJeczA5uMwwqY2zwtSpDx5DQdP77-a9ewkIqyxzhoPSthbR3Tscf1ICxtYjVfbg0Can6Jt12xU8Og!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info144509114510"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_214511 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_214511';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:45:11.256317 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:45:11.256629 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:45:11.317905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:11.430441 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:45:11.431109 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_mobile_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:45:11.599822 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:11.714155 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:45:11.714852 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_MOBILE_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:45:11.848683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:11.991541 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:45:11.992988 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:45:11.993337 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      merge  into FAWDBTCORE.stg_mobile_events DBT_INTERNAL_DEST
          using o$pt_stg_mobile_events144509106928 DBT_INTERNAL_SOURCE
          on (
            DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
        )
        when matched then
          update set
          DBT_INTERNAL_DEST.EVENT_TYPE = DBT_INTERNAL_SOURCE.EVENT_TYPE, 
          DBT_INTERNAL_DEST.EVENT_TIMESTAMP = DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
          DBT_INTERNAL_DEST.USER_ID = DBT_INTERNAL_SOURCE.USER_ID, 
          DBT_INTERNAL_DEST.APP_NAME = DBT_INTERNAL_SOURCE.APP_NAME, 
          DBT_INTERNAL_DEST.OPERATING_SYSTEM = DBT_INTERNAL_SOURCE.OPERATING_SYSTEM, 
          DBT_INTERNAL_DEST.COUNTRY = DBT_INTERNAL_SOURCE.COUNTRY, 
          DBT_INTERNAL_DEST.DURATION_SECONDS = DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
          DBT_INTERNAL_DEST.CONVERSION_STATUS = DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
          DBT_INTERNAL_DEST.CREATED_AT = DBT_INTERNAL_SOURCE.CREATED_AT
          when not matched then
          insert(EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, APP_NAME, OPERATING_SYSTEM, COUNTRY, DURATION_SECONDS, CONVERSION_STATUS, CREATED_AT)
          values(
            DBT_INTERNAL_SOURCE.EVENT_ID, 
            DBT_INTERNAL_SOURCE.EVENT_TYPE, 
            DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
            DBT_INTERNAL_SOURCE.USER_ID, 
            DBT_INTERNAL_SOURCE.APP_NAME, 
            DBT_INTERNAL_SOURCE.OPERATING_SYSTEM, 
            DBT_INTERNAL_SOURCE.COUNTRY, 
            DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
            DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
            DBT_INTERNAL_SOURCE.CREATED_AT
            )
  
[0m14:45:12.710323 [debug] [Thread-3 (]: SQL status: OK in 2.0 seconds
[0m14:45:12.716472 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:45:12.717080 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_events144509112819')
        
      order by ordinal_position

  
[0m14:45:12.992039 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:45:13.110394 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:45:13.111083 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:45:13.314429 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:45:13.433828 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:45:13.434566 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:45:13.633519 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:45:13.743418 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:45:13.745699 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:45:13.746213 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      merge  into FAWDBTCORE.stg_web_events DBT_INTERNAL_DEST
          using o$pt_stg_web_events144509112819 DBT_INTERNAL_SOURCE
          on (
            DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
        )
        when matched then
          update set
          DBT_INTERNAL_DEST.EVENT_TYPE = DBT_INTERNAL_SOURCE.EVENT_TYPE, 
          DBT_INTERNAL_DEST.EVENT_TIMESTAMP = DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
          DBT_INTERNAL_DEST.USER_ID = DBT_INTERNAL_SOURCE.USER_ID, 
          DBT_INTERNAL_DEST.PAGE_URL = DBT_INTERNAL_SOURCE.PAGE_URL, 
          DBT_INTERNAL_DEST.BROWSER = DBT_INTERNAL_SOURCE.BROWSER, 
          DBT_INTERNAL_DEST.DEVICE_TYPE = DBT_INTERNAL_SOURCE.DEVICE_TYPE, 
          DBT_INTERNAL_DEST.COUNTRY = DBT_INTERNAL_SOURCE.COUNTRY, 
          DBT_INTERNAL_DEST.DURATION_SECONDS = DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
          DBT_INTERNAL_DEST.CONVERSION_STATUS = DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
          DBT_INTERNAL_DEST.CREATED_AT = DBT_INTERNAL_SOURCE.CREATED_AT
          when not matched then
          insert(EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, PAGE_URL, BROWSER, DEVICE_TYPE, COUNTRY, DURATION_SECONDS, CONVERSION_STATUS, CREATED_AT)
          values(
            DBT_INTERNAL_SOURCE.EVENT_ID, 
            DBT_INTERNAL_SOURCE.EVENT_TYPE, 
            DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
            DBT_INTERNAL_SOURCE.USER_ID, 
            DBT_INTERNAL_SOURCE.PAGE_URL, 
            DBT_INTERNAL_SOURCE.BROWSER, 
            DBT_INTERNAL_SOURCE.DEVICE_TYPE, 
            DBT_INTERNAL_SOURCE.COUNTRY, 
            DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
            DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
            DBT_INTERNAL_SOURCE.CREATED_AT
            )
  
[0m14:45:14.029823 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m14:45:14.035170 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m14:45:14.036060 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:45:14.036483 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m14:45:14.142454 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:14.155525 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:45:14.156075 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
truncate table o$pt_stg_mobile_events144509106928
[0m14:45:14.267244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:14.274667 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:45:14.275206 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_mobile_events144509106928 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:45:14.416665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:14.423469 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:45:09.094427 => 14:45:14.423222
[0m14:45:14.423935 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:45:14.529696 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:45:14.649284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106516850>]}
[0m14:45:14.651718 [info ] [Thread-1 (]: 1 of 12 OK created sql incremental model FAWDBTCORE.stg_mobile_events .......... [[32mOK[0m in 5.60s]
[0m14:45:14.653528 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:45:34.929060 [debug] [Thread-3 (]: SQL status: OK in 21.0 seconds
[0m14:45:34.935141 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m14:45:34.936357 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:45:34.937234 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m14:45:35.125974 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:45:35.132849 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:45:35.133686 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
truncate table o$pt_stg_web_events144509112819
[0m14:45:35.239357 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:45:35.247505 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:45:35.247903 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_events144509112819 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:45:35.382757 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:45:35.387322 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:45:09.111600 => 14:45:35.387063
[0m14:45:35.387816 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:45:35.491531 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:45:35.621683 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106516850>]}
[0m14:45:35.624090 [info ] [Thread-3 (]: 3 of 12 OK created sql incremental model FAWDBTCORE.stg_web_events ............. [[32mOK[0m in 26.57s]
[0m14:45:35.625815 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:45:35.627558 [debug] [Thread-2 (]: Began running node model.oracle_dbt.combined_categorized_events
[0m14:45:35.628187 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:45:35.629326 [info ] [Thread-2 (]: 5 of 12 START sql incremental model FAWDBTCORE.combined_categorized_events ..... [RUN]
[0m14:45:35.630376 [debug] [Thread-3 (]: Began running node model.oracle_dbt.most_active_mobile_users
[0m14:45:35.631234 [info ] [Thread-1 (]: 6 of 12 START sql view model FAWDBTCORE.mobile_event_durations ................. [RUN]
[0m14:45:35.632352 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.combined_categorized_events)
[0m14:45:35.632907 [info ] [Thread-3 (]: 7 of 12 START sql view model FAWDBTCORE.most_active_mobile_users ............... [RUN]
[0m14:45:35.633801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m14:45:35.634246 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.combined_categorized_events
[0m14:45:35.634913 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.most_active_mobile_users)
[0m14:45:35.635237 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m14:45:35.640787 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.combined_categorized_events"
[0m14:45:35.641193 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.most_active_mobile_users
[0m14:45:35.643969 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m14:45:35.648601 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.most_active_mobile_users"
[0m14:45:35.649195 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.combined_categorized_events (compile): 14:45:35.635466 => 14:45:35.649076
[0m14:45:35.649417 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.combined_categorized_events
[0m14:45:35.651799 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:35.652223 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:45:35.652630 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 14:45:35.641413 => 14:45:35.652441
[0m14:45:35.653084 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.most_active_mobile_users (compile): 14:45:35.644581 => 14:45:35.652947
[0m14:45:35.653544 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m14:45:35.653854 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.most_active_mobile_users
[0m14:45:35.656110 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m14:45:35.658260 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.most_active_mobile_users"
[0m14:45:35.663569 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:35.663770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:35.663970 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:45:35.664132 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:45:36.161466 [debug] [Thread-4 (]: SQL status: OK in 25.0 seconds
[0m14:45:36.166880 [info ] [Thread-4 (]: oracle adapter: OK
[0m14:45:36.170415 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:45:36.170923 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info144509114510')
        
      order by ordinal_position

  
[0m14:45:36.438859 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:45:36.547575 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:45:36.548402 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:45:36.685134 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:45:36.789261 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:45:36.789729 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:45:36.925791 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:45:37.048060 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.mobile_event_durations"
[0m14:45:37.050111 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m14:45:37.051697 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:45:37.052476 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.most_active_mobile_users"
[0m14:45:37.056991 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:45:37.057673 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

        
  
    
      create global temporary table o$pt_combined_categorized_events144535650947
      on commit preserve rows
      
      as
        

with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM start_web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM start_mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
)


select * from combined_categorized_events



  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.combined_categorized_events)


  
      
[0m14:45:37.058253 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_active_mobile_users"} */

  
  create or replace view FAWDBTCORE.most_active_mobile_users as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
),

mobile_users_names as (
    select start_users_cleaned.name, count(start_mobile_events_cleaned.event_id) as num_mobile_events
    from start_users_cleaned
    join start_mobile_events_cleaned on start_mobile_events_cleaned.user_id = start_users_cleaned.user_id
    group by start_users_cleaned.name
    ORDER BY num_mobile_events DESC
)

select * from mobile_users_names


[0m14:45:37.061151 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:45:37.061582 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info144509114510
    )
  
[0m14:45:37.161028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:37.164626 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m14:45:37.165314 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.mobile_event_durations"
[0m14:45:37.165743 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m14:45:37.171419 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:45:37.173155 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: COMMIT
[0m14:45:37.173571 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.most_active_mobile_users"
[0m14:45:37.173949 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: COMMIT
[0m14:45:37.267965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:37.277047 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.mobile_event_durations"
[0m14:45:37.277625 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:45:37.278178 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:45:37.281541 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.most_active_mobile_users"
[0m14:45:37.282244 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_active_mobile_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.most_active_mobile_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:45:37.384925 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:45:37.385341 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:37.387566 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.most_active_mobile_users (execute): 14:45:35.656293 => 14:45:37.387401
[0m14:45:37.389216 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 14:45:35.654037 => 14:45:37.389086
[0m14:45:37.389551 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: Close
[0m14:45:37.389809 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m14:45:37.496106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106517510>]}
[0m14:45:37.497946 [info ] [Thread-1 (]: 6 of 12 OK created sql view model FAWDBTCORE.mobile_event_durations ............ [[32mOK[0m in 1.86s]
[0m14:45:37.499005 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:45:37.499565 [debug] [Thread-1 (]: Began running node model.oracle_dbt.most_frequent_browser
[0m14:45:37.500018 [info ] [Thread-1 (]: 8 of 12 START sql view model FAWDBTCORE.most_frequent_browser .................. [RUN]
[0m14:45:37.501413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.mobile_event_durations, now model.oracle_dbt.most_frequent_browser)
[0m14:45:37.501712 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.most_frequent_browser
[0m14:45:37.505745 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.most_frequent_browser"
[0m14:45:37.507871 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b8890>]}
[0m14:45:37.508719 [info ] [Thread-3 (]: 7 of 12 OK created sql view model FAWDBTCORE.most_active_mobile_users .......... [[32mOK[0m in 1.87s]
[0m14:45:37.509398 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.most_active_mobile_users
[0m14:45:37.509903 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:45:37.510431 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.most_frequent_browser (compile): 14:45:37.501937 => 14:45:37.510265
[0m14:45:37.510769 [info ] [Thread-3 (]: 9 of 12 START sql view model FAWDBTCORE.web_events_counts ...................... [RUN]
[0m14:45:37.511166 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.most_frequent_browser
[0m14:45:37.511660 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.most_active_mobile_users, now model.oracle_dbt.web_events_counts)
[0m14:45:37.514418 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.most_frequent_browser"
[0m14:45:37.514703 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m14:45:37.517315 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m14:45:37.517949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:37.518308 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:45:37.524032 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 14:45:37.514956 => 14:45:37.523877
[0m14:45:37.524249 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_counts
[0m14:45:37.525865 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m14:45:37.526669 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:37.526842 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:45:37.662354 [debug] [Thread-4 (]: SQL status: OK in 1.0 seconds
[0m14:45:37.664017 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:45:37.664344 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:45:37.664612 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:45:37.781325 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:45:37.785896 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:45:37.786595 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info144509114510
[0m14:45:37.981250 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:45:37.984845 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:45:37.985384 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info144509114510 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:45:38.110155 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:45:38.116557 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:45:09.113296 => 14:45:38.115926
[0m14:45:38.117769 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:45:38.221470 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:45:38.329229 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106662c50>]}
[0m14:45:38.332075 [info ] [Thread-4 (]: 4 of 12 OK created python incremental model FAWDBTCORE.stg_web_order_info ...... [[32mOK[0m in 29.28s]
[0m14:45:38.333275 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:45:38.334050 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_python
[0m14:45:38.334543 [info ] [Thread-4 (]: 10 of 12 START python table model FAWDBTCORE.web_events_python ................. [RUN]
[0m14:45:38.335348 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_order_info, now model.oracle_dbt.web_events_python)
[0m14:45:38.335711 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:45:38.340640 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:45:38.342158 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:45:38.335946 => 14:45:38.341961
[0m14:45:38.342498 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:45:38.355526 [debug] [Thread-4 (]: Preexisting intermediate relation=None
[0m14:45:38.355907 [debug] [Thread-4 (]: Preexisting backup relation=None
[0m14:45:38.356710 [info ] [Thread-4 (]: Python model materialization is table
[0m14:45:38.357053 [debug] [Thread-4 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:45:38.768148 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.most_frequent_browser"
[0m14:45:38.770277 [debug] [Thread-1 (]: On model.oracle_dbt.most_frequent_browser: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_frequent_browser"} */

  
  create or replace view FAWDBTCORE.most_frequent_browser as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
),

web_users_names as (
      SELECT u.name, w.most_frequent_browser
FROM start_users_cleaned u
JOIN (
  SELECT w.user_id, w.browser AS most_frequent_browser
  FROM (
    SELECT user_id, browser, ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY COUNT(*) DESC) AS rn
    FROM start_web_events_cleaned
    GROUP BY user_id, browser
  ) w
  WHERE rn = 1
) w ON u.user_id = w.user_id
)

select * from web_users_names


[0m14:45:38.779319 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_counts"
[0m14:45:38.780420 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_events_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_events_counts


[0m14:45:38.880301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:38.885433 [debug] [Thread-1 (]: On model.oracle_dbt.most_frequent_browser: COMMIT
[0m14:45:38.886140 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.most_frequent_browser"
[0m14:45:38.886899 [debug] [Thread-1 (]: On model.oracle_dbt.most_frequent_browser: COMMIT
[0m14:45:38.887566 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:45:38.890021 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m14:45:38.890483 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_counts"
[0m14:45:38.890837 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m14:45:38.987856 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:38.995647 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.most_frequent_browser"
[0m14:45:38.996132 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:45:38.996560 [debug] [Thread-1 (]: On model.oracle_dbt.most_frequent_browser: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_frequent_browser"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.most_frequent_browser__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:45:38.999933 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_counts"
[0m14:45:39.000492 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:45:39.102116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:39.103447 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:45:39.108393 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.most_frequent_browser (execute): 14:45:37.511860 => 14:45:39.108081
[0m14:45:39.111311 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 14:45:37.524348 => 14:45:39.111115
[0m14:45:39.111712 [debug] [Thread-1 (]: On model.oracle_dbt.most_frequent_browser: Close
[0m14:45:39.112041 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: Close
[0m14:45:39.228221 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665bd10>]}
[0m14:45:39.231244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0ad10>]}
[0m14:45:39.232034 [info ] [Thread-3 (]: 9 of 12 OK created sql view model FAWDBTCORE.web_events_counts ................. [[32mOK[0m in 1.72s]
[0m14:45:39.232908 [info ] [Thread-1 (]: 8 of 12 OK created sql view model FAWDBTCORE.most_frequent_browser ............. [[32mOK[0m in 1.73s]
[0m14:45:39.233599 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:45:39.234106 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.most_frequent_browser
[0m14:45:40.615982 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:45:40.617066 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzM5MzksImlhdCI6MTY4NzQ3MDMzOX0.jrw50dC8ndToItQFjkxjsjow0dZAa2X7xA6EXf5cuVZWTDFvRxK85AAisqHN5sG17QPVoz0gU03xG1GDzZHLdV4JWpZNbI8YRXOroaGIib0NNXTF425YlIZs0kIbsbk5L_MIY7aWYiNwLSrTipliy-WCKAFhDbBWy3mEUOuD1b8xz00bMuCEX55e_2lmbT4y_CiQRjo5BgiXOUwu3uoK15BgtX_3oNr2pYJW4cS9Kr3qZxeCVSo9c1rFBm0PlcrTyLkULrF2Y_AEnTiVF603l2SG6IBP4TEqjQ4dU0EGY4uvB_riZi8GZ0ArvTqWJEdv67b05Yt759PJ2cvAKvsJrA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
        # y_pred = classifier.predict(x)
    
        # df["Shipping_City_Prediction"] = y_pred
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_214540 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_214540';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:45:40.617691 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:45:40.618030 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:46:04.149726 [debug] [Thread-2 (]: SQL status: OK in 27.0 seconds
[0m14:46:04.159368 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:46:04.159923 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_combined_categorized_events144535650947')
        
      order by ordinal_position

  
[0m14:46:04.525243 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:46:04.638077 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:46:04.639083 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('combined_categorized_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:46:04.852494 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:46:04.971191 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:46:04.971901 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('COMBINED_CATEGORIZED_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:46:05.186355 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:46:05.299251 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.combined_categorized_events"
[0m14:46:05.301597 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:46:05.302113 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      insert  into  FAWDBTCORE.combined_categorized_events (EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, PAGE_URL, BROWSER, DEVICE_TYPE, COUNTRY, DURATION_SECONDS, CREATED_AT, CONVERSION_STATUS, APP_NAME, PLATFORM, WEB_DURATION_SECONDS, MOBILE_DURATION_SECONDS)
    (
       select EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, PAGE_URL, BROWSER, DEVICE_TYPE, COUNTRY, DURATION_SECONDS, CREATED_AT, CONVERSION_STATUS, APP_NAME, PLATFORM, WEB_DURATION_SECONDS, MOBILE_DURATION_SECONDS
       from o$pt_combined_categorized_events144535650947
    )
  
[0m14:46:24.892736 [debug] [Thread-2 (]: SQL status: OK in 20.0 seconds
[0m14:46:24.897108 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: COMMIT
[0m14:46:24.897679 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:46:24.898156 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: COMMIT
[0m14:46:25.027497 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:46:25.033615 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:46:25.034572 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */
truncate table o$pt_combined_categorized_events144535650947
[0m14:46:25.140637 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:46:25.149695 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:46:25.150343 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_combined_categorized_events144535650947 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:46:25.296888 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:46:25.303667 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.combined_categorized_events (execute): 14:45:35.649548 => 14:46:25.303098
[0m14:46:25.304779 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: ROLLBACK
[0m14:46:25.413184 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: Close
[0m14:46:25.562777 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065efd90>]}
[0m14:46:25.565509 [info ] [Thread-2 (]: 5 of 12 OK created sql incremental model FAWDBTCORE.combined_categorized_events  [[32mOK[0m in 49.93s]
[0m14:46:25.567451 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.combined_categorized_events
[0m14:46:25.569258 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:46:25.570210 [info ] [Thread-3 (]: 11 of 12 START sql view model FAWDBTCORE.average_duration_by_platform_country .. [RUN]
[0m14:46:25.571423 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.web_events_counts, now model.oracle_dbt.average_duration_by_platform_country)
[0m14:46:25.571983 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m14:46:25.577164 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m14:46:25.577838 [debug] [Thread-1 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:46:25.578693 [info ] [Thread-1 (]: 12 of 12 START sql view model FAWDBTCORE.event_counts_by_platform .............. [RUN]
[0m14:46:25.579687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.most_frequent_browser, now model.oracle_dbt.event_counts_by_platform)
[0m14:46:25.580188 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m14:46:25.580705 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 14:46:25.572334 => 14:46:25.580484
[0m14:46:25.583753 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m14:46:25.584250 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m14:46:25.587727 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m14:46:25.588554 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 14:46:25.580923 => 14:46:25.588339
[0m14:46:25.588766 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m14:46:25.593864 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m14:46:25.594461 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:46:25.594734 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:46:25.601689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:25.602115 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:46:27.025967 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.event_counts_by_platform"
[0m14:46:27.026864 [debug] [Thread-1 (]: On model.oracle_dbt.event_counts_by_platform: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with events as (

    select * from FAWDBTCORE.combined_categorized_events
),


event_counts_by_platform as (

    SELECT
  platform,
  COUNT(*) AS event_count
FROM events
GROUP BY platform
)

select * from event_counts_by_platform


[0m14:46:27.027958 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country"
[0m14:46:27.028354 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.combined_categorized_events
), 

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  ROUND(AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END), 2) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
ORDER BY platform
)

select * from average_duration_by_platform_country


[0m14:46:27.156067 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:46:27.157313 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:27.160186 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m14:46:27.161543 [debug] [Thread-1 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m14:46:27.161805 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country"
[0m14:46:27.162022 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.event_counts_by_platform"
[0m14:46:27.162227 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m14:46:27.162465 [debug] [Thread-1 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m14:46:27.275662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:27.276402 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:46:27.281103 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.event_counts_by_platform"
[0m14:46:27.284617 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country"
[0m14:46:27.285144 [debug] [Thread-1 (]: On model.oracle_dbt.event_counts_by_platform: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:46:27.285669 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:46:27.402935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:27.404024 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:46:27.408925 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 14:46:25.588871 => 14:46:27.408636
[0m14:46:27.411798 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 14:46:25.584732 => 14:46:27.411578
[0m14:46:27.412313 [debug] [Thread-1 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m14:46:27.412737 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m14:46:27.527218 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666bf50>]}
[0m14:46:27.529756 [info ] [Thread-3 (]: 11 of 12 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 1.96s]
[0m14:46:27.533180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5e450>]}
[0m14:46:27.533995 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:46:27.534723 [info ] [Thread-1 (]: 12 of 12 OK created sql view model FAWDBTCORE.event_counts_by_platform ......... [[32mOK[0m in 1.95s]
[0m14:46:27.535997 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:46:42.408805 [info ] [Thread-4 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m14:46:42.411359 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_python: Close
[0m14:46:42.563742 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:45:38.342692 => 14:46:42.562447
[0m14:46:42.574863 [debug] [Thread-4 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:46:42.577027 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21873a63-a323-43fc-b88c-988a53a7fca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b88e10>]}
[0m14:46:42.577592 [error] [Thread-4 (]: 10 of 12 ERROR creating python table model FAWDBTCORE.web_events_python ........ [[31mERROR[0m in 64.24s]
[0m14:46:42.578058 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:46:42.579967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:46:42.580363 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:46:43.874958 [debug] [MainThread]: On master: COMMIT
[0m14:46:43.876964 [debug] [MainThread]: Using oracle connection "master"
[0m14:46:43.877643 [debug] [MainThread]: On master: COMMIT
[0m14:46:43.981842 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:46:43.983345 [debug] [MainThread]: On master: Close
[0m14:46:44.098534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:44.099688 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m14:46:44.100340 [debug] [MainThread]: Connection 'model.oracle_dbt.combined_categorized_events' was properly closed.
[0m14:46:44.101092 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m14:46:44.101436 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:46:44.102116 [info ] [MainThread]: 
[0m14:46:44.102700 [info ] [MainThread]: Finished running 7 view models, 4 incremental models, 1 table model in 0 hours 1 minutes and 40.13 seconds (100.13s).
[0m14:46:44.105336 [debug] [MainThread]: Command end result
[0m14:46:44.132200 [info ] [MainThread]: 
[0m14:46:44.132823 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:46:44.133184 [info ] [MainThread]: 
[0m14:46:44.133530 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:46:44.133866 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m14:46:44.134180 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m14:46:44.134470 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m14:46:44.134720 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m14:46:44.134968 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m14:46:44.135214 [error] [MainThread]:   ORA-29276: transfer timeout
[0m14:46:44.135459 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m14:46:44.135702 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m14:46:44.135953 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m14:46:44.136195 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:46:44.136435 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:46:44.136678 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:46:44.136925 [error] [MainThread]:   ORA-06512: at line 107
[0m14:46:44.137167 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:46:44.137442 [info ] [MainThread]: 
[0m14:46:44.137754 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m14:46:44.138322 [debug] [MainThread]: Command `dbt run` failed at 14:46:44.138237 after 100.29 seconds
[0m14:46:44.138654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025b4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025b77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567a810>]}
[0m14:46:44.138954 [debug] [MainThread]: Flushing usage events
[0m14:47:08.422666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10411b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10411bf90>]}


============================== 14:47:08.425298 | 9bb69523-6e63-43ad-9f94-d4d7e8553399 ==============================
[0m14:47:08.425298 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:47:08.425643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:47:08.468190 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:47:08.490102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104149650>]}
[0m14:47:08.496137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482d5d0>]}
[0m14:47:08.527424 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:47:08.564441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:47:08.564702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:47:08.568053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410d990>]}
[0m14:47:08.572211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104146d90>]}
[0m14:47:08.572404 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:47:08.572584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104811d90>]}
[0m14:47:08.573545 [info ] [MainThread]: 
[0m14:47:08.573943 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:47:08.574608 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:47:08.579680 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:47:08.579928 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:47:08.580061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:08.580195 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:47:10.107295 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:47:10.214373 [debug] [ThreadPool]: On list_None: Close
[0m14:47:10.321226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:47:10.327258 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:47:10.327657 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:47:10.327888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:10.328136 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:47:11.679748 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:47:11.691545 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:47:11.692071 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:47:11.833315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:47:12.041293 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:47:12.143059 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:47:12.256565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104909210>]}
[0m14:47:12.257258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:47:12.257569 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:47:13.514752 [debug] [MainThread]: On master: COMMIT
[0m14:47:13.516821 [debug] [MainThread]: Using oracle connection "master"
[0m14:47:13.517583 [debug] [MainThread]: On master: COMMIT
[0m14:47:13.619654 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:47:13.621360 [debug] [MainThread]: On master: Close
[0m14:47:13.730759 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:47:13.731977 [info ] [MainThread]: 
[0m14:47:13.740699 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:47:13.741251 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:47:13.741823 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:47:13.742409 [debug] [Thread-4 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:47:13.743216 [info ] [Thread-1 (]: 1 of 12 START sql incremental model FAWDBTCORE.stg_mobile_events ............... [RUN]
[0m14:47:13.743817 [info ] [Thread-2 (]: 2 of 12 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:47:13.744340 [info ] [Thread-3 (]: 3 of 12 START sql incremental model FAWDBTCORE.stg_web_events .................. [RUN]
[0m14:47:13.745029 [info ] [Thread-4 (]: 4 of 12 START python incremental model FAWDBTCORE.stg_web_order_info ........... [RUN]
[0m14:47:13.746083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:47:13.746805 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:47:13.747385 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:47:13.747963 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_order_info'
[0m14:47:13.748279 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:47:13.748565 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:47:13.748846 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:47:13.749105 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:47:13.762544 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:47:13.765122 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:47:13.768312 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:47:13.778900 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:47:13.780258 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:47:13.749309 => 14:47:13.780090
[0m14:47:13.780514 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:47:13.781019 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:47:13.768726 => 14:47:13.780840
[0m14:47:13.793939 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:47:13.763079 => 14:47:13.793798
[0m14:47:13.801022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:13.801236 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:47:13.801443 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:47:13.801617 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:47:13.765622 => 14:47:13.801541
[0m14:47:13.801786 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:47:13.804840 [info ] [Thread-4 (]: Python model materialization is incremental
[0m14:47:13.813184 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:47:13.813478 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:47:13.816113 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:47:13.816372 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:47:13.822608 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:47:13.822814 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:47:15.129570 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:47:15.130273 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:47:15.130869 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

        
  
    
      create global temporary table o$pt_stg_mobile_events144713796990
      on commit preserve rows
      
      as
        


with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  created_at
FROM FAWDBTCORE.mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned





  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.stg_mobile_events)


  
      
[0m14:47:15.131324 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m14:47:15.131761 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

        
  
    
      create global temporary table o$pt_stg_web_events144713815739
      on commit preserve rows
      
      as
        


with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  created_at
    FROM FAWDBTCORE.web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned



  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.stg_web_events)


  
      
[0m14:47:15.132431 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users
)

select * from users_cleaned


[0m14:47:15.242099 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:47:15.254832 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m14:47:15.255427 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m14:47:15.255729 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m14:47:15.357770 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:47:15.364456 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.stg_users"
[0m14:47:15.364869 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:47:15.469323 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:47:15.488856 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:47:13.805031 => 14:47:15.488645
[0m14:47:15.489289 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:47:15.596862 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b04c90>]}
[0m14:47:15.597937 [info ] [Thread-2 (]: 2 of 12 OK created sql view model FAWDBTCORE.stg_users ......................... [[32mOK[0m in 1.85s]
[0m14:47:15.598792 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:47:15.801239 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:47:15.811388 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:47:15.812073 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_mobile_events144713796990')
        
      order by ordinal_position

  
[0m14:47:16.102349 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:16.218519 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:47:16.219269 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_mobile_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:47:16.354127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:16.475904 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:47:16.476538 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_MOBILE_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:47:16.640299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:16.775604 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:47:16.776688 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:47:16.776989 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

      merge  into FAWDBTCORE.stg_mobile_events DBT_INTERNAL_DEST
          using o$pt_stg_mobile_events144713796990 DBT_INTERNAL_SOURCE
          on (
            DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
        )
        when matched then
          update set
          DBT_INTERNAL_DEST.EVENT_TYPE = DBT_INTERNAL_SOURCE.EVENT_TYPE, 
          DBT_INTERNAL_DEST.EVENT_TIMESTAMP = DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
          DBT_INTERNAL_DEST.USER_ID = DBT_INTERNAL_SOURCE.USER_ID, 
          DBT_INTERNAL_DEST.APP_NAME = DBT_INTERNAL_SOURCE.APP_NAME, 
          DBT_INTERNAL_DEST.OPERATING_SYSTEM = DBT_INTERNAL_SOURCE.OPERATING_SYSTEM, 
          DBT_INTERNAL_DEST.COUNTRY = DBT_INTERNAL_SOURCE.COUNTRY, 
          DBT_INTERNAL_DEST.DURATION_SECONDS = DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
          DBT_INTERNAL_DEST.CONVERSION_STATUS = DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
          DBT_INTERNAL_DEST.CREATED_AT = DBT_INTERNAL_SOURCE.CREATED_AT
          when not matched then
          insert(EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, APP_NAME, OPERATING_SYSTEM, COUNTRY, DURATION_SECONDS, CONVERSION_STATUS, CREATED_AT)
          values(
            DBT_INTERNAL_SOURCE.EVENT_ID, 
            DBT_INTERNAL_SOURCE.EVENT_TYPE, 
            DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
            DBT_INTERNAL_SOURCE.USER_ID, 
            DBT_INTERNAL_SOURCE.APP_NAME, 
            DBT_INTERNAL_SOURCE.OPERATING_SYSTEM, 
            DBT_INTERNAL_SOURCE.COUNTRY, 
            DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
            DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
            DBT_INTERNAL_SOURCE.CREATED_AT
            )
  
[0m14:47:16.839234 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:47:16.839736 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzQwMzQsImlhdCI6MTY4NzQ3MDQzNH0.nEFl6Ey9oeGL3Em5pUF9_ryRUxl1GfHZ_CtVcLxGTaCVWHA0xZCOE8HJoFKi83pM62qqA-ycJkcZrgX9O374rkw0eViFjBY__rK2Na6dgT1DaK46lQ1RfL8ihHS2a-hOfdUuX8o1So4kCGjYgyVJjFNUaaxqMrOoWATctht-jHQCiDbJq8teRBeWuw-C_a2akxZ7ZhwUfM_Vgqx7eYhW1Y_UUb20t9S_WB7d6xfvywtyz7KmUxj9VT4XSivE1xFXODY515Dwseb6F26uCzI1xUxhmxkENmwlBskULkS6wtQfIakdnQFbYb892bow4tAOgqv6KrO9Q0bhfkuqHP4jyw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info144713803188"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_214716 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_214716';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:47:16.840185 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:47:16.840447 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:47:17.387621 [debug] [Thread-3 (]: SQL status: OK in 2.0 seconds
[0m14:47:17.394643 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:47:17.395397 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_events144713815739')
        
      order by ordinal_position

  
[0m14:47:17.713686 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:47:17.829524 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:47:17.830062 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:47:18.002594 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:47:18.139614 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:47:18.140258 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:47:18.319661 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:47:18.463978 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:47:18.466033 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:47:18.466589 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

      merge  into FAWDBTCORE.stg_web_events DBT_INTERNAL_DEST
          using o$pt_stg_web_events144713815739 DBT_INTERNAL_SOURCE
          on (
            DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
        )
        when matched then
          update set
          DBT_INTERNAL_DEST.EVENT_TYPE = DBT_INTERNAL_SOURCE.EVENT_TYPE, 
          DBT_INTERNAL_DEST.EVENT_TIMESTAMP = DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
          DBT_INTERNAL_DEST.USER_ID = DBT_INTERNAL_SOURCE.USER_ID, 
          DBT_INTERNAL_DEST.PAGE_URL = DBT_INTERNAL_SOURCE.PAGE_URL, 
          DBT_INTERNAL_DEST.BROWSER = DBT_INTERNAL_SOURCE.BROWSER, 
          DBT_INTERNAL_DEST.DEVICE_TYPE = DBT_INTERNAL_SOURCE.DEVICE_TYPE, 
          DBT_INTERNAL_DEST.COUNTRY = DBT_INTERNAL_SOURCE.COUNTRY, 
          DBT_INTERNAL_DEST.DURATION_SECONDS = DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
          DBT_INTERNAL_DEST.CONVERSION_STATUS = DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
          DBT_INTERNAL_DEST.CREATED_AT = DBT_INTERNAL_SOURCE.CREATED_AT
          when not matched then
          insert(EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, PAGE_URL, BROWSER, DEVICE_TYPE, COUNTRY, DURATION_SECONDS, CONVERSION_STATUS, CREATED_AT)
          values(
            DBT_INTERNAL_SOURCE.EVENT_ID, 
            DBT_INTERNAL_SOURCE.EVENT_TYPE, 
            DBT_INTERNAL_SOURCE.EVENT_TIMESTAMP, 
            DBT_INTERNAL_SOURCE.USER_ID, 
            DBT_INTERNAL_SOURCE.PAGE_URL, 
            DBT_INTERNAL_SOURCE.BROWSER, 
            DBT_INTERNAL_SOURCE.DEVICE_TYPE, 
            DBT_INTERNAL_SOURCE.COUNTRY, 
            DBT_INTERNAL_SOURCE.DURATION_SECONDS, 
            DBT_INTERNAL_SOURCE.CONVERSION_STATUS, 
            DBT_INTERNAL_SOURCE.CREATED_AT
            )
  
[0m14:47:18.793094 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m14:47:18.797186 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m14:47:18.798110 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:47:18.798674 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m14:47:18.923640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:18.934945 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:47:18.935295 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
truncate table o$pt_stg_mobile_events144713796990
[0m14:47:19.068340 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:19.076030 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_mobile_events"
[0m14:47:19.076610 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_mobile_events144713796990 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:47:19.228058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:19.235640 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:47:13.781299 => 14:47:19.235072
[0m14:47:19.236681 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:47:19.352527 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:47:19.472299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104852010>]}
[0m14:47:19.475055 [info ] [Thread-1 (]: 1 of 12 OK created sql incremental model FAWDBTCORE.stg_mobile_events .......... [[32mOK[0m in 5.73s]
[0m14:47:19.476694 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:47:40.002315 [debug] [Thread-3 (]: SQL status: OK in 22.0 seconds
[0m14:47:40.008661 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m14:47:40.009628 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:47:40.010167 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m14:47:40.210773 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:47:40.219948 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:47:40.220574 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
truncate table o$pt_stg_web_events144713815739
[0m14:47:40.327680 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:47:40.337345 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.stg_web_events"
[0m14:47:40.337825 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_events144713815739 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:47:40.473103 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:47:40.479631 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:47:13.814126 => 14:47:40.479085
[0m14:47:40.480626 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:47:40.582244 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:47:40.735160 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104960310>]}
[0m14:47:40.737121 [info ] [Thread-3 (]: 3 of 12 OK created sql incremental model FAWDBTCORE.stg_web_events ............. [[32mOK[0m in 26.99s]
[0m14:47:40.738291 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:47:40.739764 [debug] [Thread-2 (]: Began running node model.oracle_dbt.combined_categorized_events
[0m14:47:40.740486 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:47:40.741061 [debug] [Thread-3 (]: Began running node model.oracle_dbt.most_active_mobile_users
[0m14:47:40.741699 [info ] [Thread-2 (]: 5 of 12 START sql incremental model FAWDBTCORE.combined_categorized_events ..... [RUN]
[0m14:47:40.742317 [info ] [Thread-1 (]: 6 of 12 START sql view model FAWDBTCORE.mobile_event_durations ................. [RUN]
[0m14:47:40.742874 [info ] [Thread-3 (]: 7 of 12 START sql view model FAWDBTCORE.most_active_mobile_users ............... [RUN]
[0m14:47:40.743808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.combined_categorized_events)
[0m14:47:40.744494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m14:47:40.745062 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.most_active_mobile_users)
[0m14:47:40.745412 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.combined_categorized_events
[0m14:47:40.745734 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m14:47:40.746032 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.most_active_mobile_users
[0m14:47:40.751076 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.combined_categorized_events"
[0m14:47:40.753947 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m14:47:40.757443 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.most_active_mobile_users"
[0m14:47:40.758801 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 14:47:40.751462 => 14:47:40.758643
[0m14:47:40.759079 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.most_active_mobile_users (compile): 14:47:40.754223 => 14:47:40.758955
[0m14:47:40.759279 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m14:47:40.759434 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.combined_categorized_events (compile): 14:47:40.746259 => 14:47:40.759364
[0m14:47:40.759576 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.most_active_mobile_users
[0m14:47:40.761037 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m14:47:40.761189 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.combined_categorized_events
[0m14:47:40.762764 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.most_active_mobile_users"
[0m14:47:40.765894 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:47:40.766320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:40.766590 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:47:40.766819 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:47:40.776077 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:47:40.776310 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:47:41.897531 [debug] [Thread-4 (]: SQL status: OK in 25.0 seconds
[0m14:47:41.898427 [info ] [Thread-4 (]: oracle adapter: OK
[0m14:47:41.900594 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:47:41.900976 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info144713803188')
        
      order by ordinal_position

  
[0m14:47:42.137969 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:47:42.138727 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.mobile_event_durations"
[0m14:47:42.139547 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

        
  
    
      create global temporary table o$pt_combined_categorized_events144740765370
      on commit preserve rows
      
      as
        

with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM start_web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM start_mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  created_at,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
)


select * from combined_categorized_events



  -- this filter will only be applied on an incremental run
where created_at >= (select max(created_at) from FAWDBTCORE.combined_categorized_events)


  
      
[0m14:47:42.140317 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m14:47:42.143742 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.most_active_mobile_users"
[0m14:47:42.144029 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_active_mobile_users"} */

  
  create or replace view FAWDBTCORE.most_active_mobile_users as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
),

mobile_users_names as (
    select start_users_cleaned.name, count(start_mobile_events_cleaned.event_id) as num_mobile_events
    from start_users_cleaned
    join start_mobile_events_cleaned on start_mobile_events_cleaned.user_id = start_users_cleaned.user_id
    group by start_users_cleaned.name
    ORDER BY num_mobile_events DESC
)

select * from mobile_users_names


[0m14:47:42.169304 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:47:42.252575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:42.257319 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m14:47:42.257954 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:47:42.258578 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.mobile_event_durations"
[0m14:47:42.260541 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: COMMIT
[0m14:47:42.261010 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m14:47:42.261417 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.most_active_mobile_users"
[0m14:47:42.262064 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: COMMIT
[0m14:47:42.275668 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:47:42.276184 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:47:42.365067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:42.366298 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:47:42.372941 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.mobile_event_durations"
[0m14:47:42.376218 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.most_active_mobile_users"
[0m14:47:42.376617 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:47:42.377024 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_active_mobile_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.most_active_mobile_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:47:42.406391 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:47:42.482770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:42.489689 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 14:47:40.759678 => 14:47:42.489344
[0m14:47:42.490645 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m14:47:42.491157 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:47:42.492739 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.most_active_mobile_users (execute): 14:47:40.761287 => 14:47:42.492599
[0m14:47:42.493031 [debug] [Thread-3 (]: On model.oracle_dbt.most_active_mobile_users: Close
[0m14:47:42.509912 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:47:42.510321 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:47:42.598203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505ba50>]}
[0m14:47:42.599071 [info ] [Thread-1 (]: 6 of 12 OK created sql view model FAWDBTCORE.mobile_event_durations ............ [[32mOK[0m in 1.85s]
[0m14:47:42.601618 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa4490>]}
[0m14:47:42.602266 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:47:42.602845 [info ] [Thread-3 (]: 7 of 12 OK created sql view model FAWDBTCORE.most_active_mobile_users .......... [[32mOK[0m in 1.86s]
[0m14:47:42.603461 [debug] [Thread-1 (]: Began running node model.oracle_dbt.most_frequent_browser
[0m14:47:42.604351 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.most_active_mobile_users
[0m14:47:42.604873 [info ] [Thread-1 (]: 8 of 12 START sql view model FAWDBTCORE.most_frequent_browser .................. [RUN]
[0m14:47:42.605431 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:47:42.606894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.mobile_event_durations, now model.oracle_dbt.most_frequent_browser)
[0m14:47:42.607302 [info ] [Thread-3 (]: 9 of 12 START sql view model FAWDBTCORE.web_events_counts ...................... [RUN]
[0m14:47:42.607722 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.most_frequent_browser
[0m14:47:42.608279 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.most_active_mobile_users, now model.oracle_dbt.web_events_counts)
[0m14:47:42.611378 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.most_frequent_browser"
[0m14:47:42.611652 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m14:47:42.614816 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m14:47:42.615509 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.most_frequent_browser (compile): 14:47:42.608506 => 14:47:42.615308
[0m14:47:42.615845 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.most_frequent_browser
[0m14:47:42.618637 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.most_frequent_browser"
[0m14:47:42.619012 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 14:47:42.611929 => 14:47:42.618833
[0m14:47:42.619375 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_counts
[0m14:47:42.621694 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m14:47:42.622088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:42.622320 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:47:42.631976 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:47:42.632195 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:47:42.639205 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:47:42.742944 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:47:42.744217 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:47:42.744549 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info144713803188
    )
  
[0m14:47:43.335012 [debug] [Thread-4 (]: SQL status: OK in 1.0 seconds
[0m14:47:43.339857 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:47:43.340427 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:47:43.340738 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:47:43.452564 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:47:43.463690 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:47:43.464102 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info144713803188
[0m14:47:43.630608 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:47:43.640258 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:47:43.641050 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info144713803188 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:47:43.789151 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m14:47:43.794319 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:47:13.801897 => 14:47:43.794001
[0m14:47:43.795118 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:47:43.898287 [debug] [Thread-4 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:47:43.919148 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_counts"
[0m14:47:43.920473 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_events_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_events_counts


[0m14:47:43.926907 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.most_frequent_browser"
[0m14:47:43.927787 [debug] [Thread-1 (]: On model.oracle_dbt.most_frequent_browser: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_frequent_browser"} */

  
  create or replace view FAWDBTCORE.most_frequent_browser as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
),

web_users_names as (
      SELECT u.name, w.most_frequent_browser
FROM start_users_cleaned u
JOIN (
  SELECT w.user_id, w.browser AS most_frequent_browser
  FROM (
    SELECT user_id, browser, ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY COUNT(*) DESC) AS rn
    FROM start_web_events_cleaned
    GROUP BY user_id, browser
  ) w
  WHERE rn = 1
) w ON u.user_id = w.user_id
)

select * from web_users_names


[0m14:47:44.010843 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506ba50>]}
[0m14:47:44.013434 [info ] [Thread-4 (]: 4 of 12 OK created python incremental model FAWDBTCORE.stg_web_order_info ...... [[32mOK[0m in 30.26s]
[0m14:47:44.014902 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:47:44.016319 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_python
[0m14:47:44.017166 [info ] [Thread-4 (]: 10 of 12 START python table model FAWDBTCORE.web_events_python ................. [RUN]
[0m14:47:44.018248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_order_info, now model.oracle_dbt.web_events_python)
[0m14:47:44.018714 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:47:44.024479 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:47:44.026079 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:47:44.019007 => 14:47:44.025870
[0m14:47:44.026444 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:47:44.037294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:44.037726 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:47:44.042414 [debug] [Thread-4 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m14:47:44.043534 [debug] [Thread-1 (]: On model.oracle_dbt.most_frequent_browser: COMMIT
[0m14:47:44.044415 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m14:47:44.044661 [debug] [Thread-4 (]: Preexisting backup relation=None
[0m14:47:44.044900 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.most_frequent_browser"
[0m14:47:44.045116 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_counts"
[0m14:47:44.046978 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:47:44.047220 [debug] [Thread-1 (]: On model.oracle_dbt.most_frequent_browser: COMMIT
[0m14:47:44.047432 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m14:47:44.047659 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:47:44.048199 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:47:44.048507 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:47:44.149151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:44.149730 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:47:44.153234 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.most_frequent_browser"
[0m14:47:44.155927 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_counts"
[0m14:47:44.156453 [debug] [Thread-1 (]: On model.oracle_dbt.most_frequent_browser: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.most_frequent_browser"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.most_frequent_browser__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:47:44.156864 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:47:44.260523 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:47:44.266174 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 14:47:42.619547 => 14:47:44.265933
[0m14:47:44.266654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:44.267230 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: Close
[0m14:47:44.270106 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.most_frequent_browser (execute): 14:47:42.616033 => 14:47:44.269925
[0m14:47:44.270620 [debug] [Thread-1 (]: On model.oracle_dbt.most_frequent_browser: Close
[0m14:47:44.382226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad46d0>]}
[0m14:47:44.384601 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3c790>]}
[0m14:47:44.385417 [info ] [Thread-1 (]: 8 of 12 OK created sql view model FAWDBTCORE.most_frequent_browser ............. [[32mOK[0m in 1.78s]
[0m14:47:44.386062 [info ] [Thread-3 (]: 9 of 12 OK created sql view model FAWDBTCORE.web_events_counts ................. [[32mOK[0m in 1.78s]
[0m14:47:44.386713 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.most_frequent_browser
[0m14:47:44.387107 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:47:45.508090 [debug] [Thread-4 (]: SQL status: OK in 1.0 seconds
[0m14:47:45.513871 [info ] [Thread-4 (]: Python model materialization is table
[0m14:47:45.514840 [debug] [Thread-4 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:47:47.994490 [debug] [Thread-4 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:47:47.995805 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzQwNjYsImlhdCI6MTY4NzQ3MDQ2Nn0.lKJLTBR89T0goMjzjoZm4AIABPj_cGEQ_DMvz3DqVRLtoLS7LwDyUU0uQ-Ff9ZeeAzm55sR-qFI76j-JoB08Ew_rfmvoD0GRiBcQ7Ee2iT-W-DRWjGc0SNlEQIimhcVlbFHBF28Mt52Nx6fHB0FAsePDPcVzK9x-RuQKgt2Hqi5ah_0lovbCsQJpNHnPpCCdoBjrFi30tkBCh1P7M86aczQdSmCZWQWDFlhvvS2oOi4D8gFcYOOyQni1wJf5cYB82rvsWaaUhYmRXdm-MO65xTG9UjuZ9uGyPp4UcB1sTY__I3aMhyMSOUFRN5A0GIEcNi5OOsDuclg0pftlnDfG9g!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
        # y_pred = classifier.predict(x)
    
        # df["Shipping_City_Prediction"] = y_pred
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_214747 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_214747';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:48:08.740415 [debug] [Thread-2 (]: SQL status: OK in 27.0 seconds
[0m14:48:08.750624 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:48:08.751938 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_combined_categorized_events144740765370')
        
      order by ordinal_position

  
[0m14:48:09.134728 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:48:09.246938 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:48:09.247803 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('combined_categorized_events')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:48:09.392863 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:48:09.529902 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:48:09.530703 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('COMBINED_CATEGORIZED_EVENTS')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:48:09.679815 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:48:09.791197 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.combined_categorized_events"
[0m14:48:09.792958 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:48:09.793482 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */

      insert  into  FAWDBTCORE.combined_categorized_events (EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, PAGE_URL, BROWSER, DEVICE_TYPE, COUNTRY, DURATION_SECONDS, CREATED_AT, CONVERSION_STATUS, APP_NAME, PLATFORM, WEB_DURATION_SECONDS, MOBILE_DURATION_SECONDS)
    (
       select EVENT_ID, EVENT_TYPE, EVENT_TIMESTAMP, USER_ID, PAGE_URL, BROWSER, DEVICE_TYPE, COUNTRY, DURATION_SECONDS, CREATED_AT, CONVERSION_STATUS, APP_NAME, PLATFORM, WEB_DURATION_SECONDS, MOBILE_DURATION_SECONDS
       from o$pt_combined_categorized_events144740765370
    )
  
[0m14:48:29.410126 [debug] [Thread-2 (]: SQL status: OK in 20.0 seconds
[0m14:48:29.414412 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: COMMIT
[0m14:48:29.415181 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:48:29.415619 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: COMMIT
[0m14:48:29.563187 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:48:29.570060 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:48:29.570520 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */
truncate table o$pt_combined_categorized_events144740765370
[0m14:48:29.692138 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:48:29.699755 [debug] [Thread-2 (]: Using oracle connection "model.oracle_dbt.combined_categorized_events"
[0m14:48:29.700494 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.combined_categorized_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_combined_categorized_events144740765370 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:48:29.839826 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m14:48:29.845676 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.combined_categorized_events (execute): 14:47:40.763044 => 14:48:29.845346
[0m14:48:29.846367 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: ROLLBACK
[0m14:48:29.951525 [debug] [Thread-2 (]: On model.oracle_dbt.combined_categorized_events: Close
[0m14:48:30.104312 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae2e90>]}
[0m14:48:30.107031 [info ] [Thread-2 (]: 5 of 12 OK created sql incremental model FAWDBTCORE.combined_categorized_events  [[32mOK[0m in 49.36s]
[0m14:48:30.108517 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.combined_categorized_events
[0m14:48:30.109275 [debug] [Thread-1 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:48:30.109739 [debug] [Thread-3 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:48:30.110266 [info ] [Thread-1 (]: 11 of 12 START sql view model FAWDBTCORE.average_duration_by_platform_country .. [RUN]
[0m14:48:30.110758 [info ] [Thread-3 (]: 12 of 12 START sql view model FAWDBTCORE.event_counts_by_platform .............. [RUN]
[0m14:48:30.111569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.most_frequent_browser, now model.oracle_dbt.average_duration_by_platform_country)
[0m14:48:30.112176 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.web_events_counts, now model.oracle_dbt.event_counts_by_platform)
[0m14:48:30.112528 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m14:48:30.112832 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m14:48:30.116001 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m14:48:30.119942 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m14:48:30.121809 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 14:48:30.113060 => 14:48:30.121508
[0m14:48:30.122217 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 14:48:30.116383 => 14:48:30.122050
[0m14:48:30.122543 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m14:48:30.122814 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m14:48:30.125545 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m14:48:30.127699 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m14:48:30.128828 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:48:30.129034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:30.129183 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:48:30.129333 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:48:31.636739 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country"
[0m14:48:31.637359 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.event_counts_by_platform"
[0m14:48:31.637553 [debug] [Thread-1 (]: On model.oracle_dbt.average_duration_by_platform_country: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.combined_categorized_events
), 

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  ROUND(AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END), 2) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
ORDER BY platform
)

select * from average_duration_by_platform_country


[0m14:48:31.637759 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with events as (

    select * from FAWDBTCORE.combined_categorized_events
),


event_counts_by_platform as (

    SELECT
  platform,
  COUNT(*) AS event_count
FROM events
GROUP BY platform
)

select * from event_counts_by_platform


[0m14:48:31.749620 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:48:31.751689 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m14:48:31.751976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:31.752248 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.event_counts_by_platform"
[0m14:48:31.753231 [debug] [Thread-1 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m14:48:31.753469 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m14:48:31.753694 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country"
[0m14:48:31.754004 [debug] [Thread-1 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m14:48:31.863651 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:48:31.869921 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.event_counts_by_platform"
[0m14:48:31.870407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:31.870890 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:48:31.874337 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country"
[0m14:48:31.874916 [debug] [Thread-1 (]: On model.oracle_dbt.average_duration_by_platform_country: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:48:31.979420 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:48:31.981054 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:31.986226 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 14:48:30.125777 => 14:48:31.985930
[0m14:48:31.988998 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 14:48:30.122983 => 14:48:31.988818
[0m14:48:31.989444 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m14:48:31.989873 [debug] [Thread-1 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m14:48:32.105943 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b1a90>]}
[0m14:48:32.109681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104953d90>]}
[0m14:48:32.110521 [info ] [Thread-3 (]: 12 of 12 OK created sql view model FAWDBTCORE.event_counts_by_platform ......... [[32mOK[0m in 1.99s]
[0m14:48:32.111206 [info ] [Thread-1 (]: 11 of 12 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 2.00s]
[0m14:48:32.112194 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:48:32.112818 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:48:48.515345 [info ] [Thread-4 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m14:48:48.517941 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_python: Close
[0m14:48:48.630316 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:47:44.026668 => 14:48:48.628429
[0m14:48:48.641622 [debug] [Thread-4 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:48:48.643703 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb69523-6e63-43ad-9f94-d4d7e8553399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5cdd0>]}
[0m14:48:48.644256 [error] [Thread-4 (]: 10 of 12 ERROR creating python table model FAWDBTCORE.web_events_python ........ [[31mERROR[0m in 64.63s]
[0m14:48:48.644734 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:48:48.646473 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:48:48.646746 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:48:50.236662 [debug] [MainThread]: On master: COMMIT
[0m14:48:50.238804 [debug] [MainThread]: Using oracle connection "master"
[0m14:48:50.240720 [debug] [MainThread]: On master: COMMIT
[0m14:48:50.353525 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:48:50.354990 [debug] [MainThread]: On master: Close
[0m14:48:50.480292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:50.481082 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m14:48:50.481377 [debug] [MainThread]: Connection 'model.oracle_dbt.combined_categorized_events' was properly closed.
[0m14:48:50.481634 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m14:48:50.481868 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:48:50.482281 [info ] [MainThread]: 
[0m14:48:50.482694 [info ] [MainThread]: Finished running 7 view models, 4 incremental models, 1 table model in 0 hours 1 minutes and 41.91 seconds (101.91s).
[0m14:48:50.484648 [debug] [MainThread]: Command end result
[0m14:48:50.495758 [info ] [MainThread]: 
[0m14:48:50.496291 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:48:50.496577 [info ] [MainThread]: 
[0m14:48:50.496838 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:48:50.497104 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m14:48:50.497338 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m14:48:50.497617 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m14:48:50.497958 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m14:48:50.498211 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m14:48:50.498450 [error] [MainThread]:   ORA-29276: transfer timeout
[0m14:48:50.498691 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m14:48:50.498923 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m14:48:50.499150 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m14:48:50.499369 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:48:50.499595 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:48:50.499825 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:48:50.500043 [error] [MainThread]:   ORA-06512: at line 107
[0m14:48:50.500262 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:48:50.500515 [info ] [MainThread]: 
[0m14:48:50.500849 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m14:48:50.501593 [debug] [MainThread]: Command `dbt run` failed at 14:48:50.501505 after 102.10 seconds
[0m14:48:50.501915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104146dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104145050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104928190>]}
[0m14:48:50.502206 [debug] [MainThread]: Flushing usage events
[0m14:48:56.969216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107017cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107017f90>]}


============================== 14:48:56.971619 | f6ddbaf2-497a-465a-9349-2be88495e08f ==============================
[0m14:48:56.971619 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:48:56.971930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:48:57.036931 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:48:57.084243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6ddbaf2-497a-465a-9349-2be88495e08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107028910>]}
[0m14:48:57.090744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6ddbaf2-497a-465a-9349-2be88495e08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fca250>]}
[0m14:48:57.123263 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:48:57.155786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:48:57.156120 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:48:57.159546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6ddbaf2-497a-465a-9349-2be88495e08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc6890>]}
[0m14:48:57.164089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6ddbaf2-497a-465a-9349-2be88495e08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff7890>]}
[0m14:48:57.164405 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:48:57.164620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6ddbaf2-497a-465a-9349-2be88495e08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107042e10>]}
[0m14:48:57.165657 [info ] [MainThread]: 
[0m14:48:57.166159 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:48:57.166769 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:48:57.171866 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:48:57.172139 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:48:57.172324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:57.172507 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:48:58.563262 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:48:58.674182 [debug] [ThreadPool]: On list_None: Close
[0m14:48:58.785853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:48:58.790908 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:48:58.791264 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:48:58.791474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:58.791681 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:49:00.189483 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:49:00.199763 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:49:00.200633 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:49:00.333114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:00.453697 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:49:00.555331 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:49:00.691139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6ddbaf2-497a-465a-9349-2be88495e08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ff990>]}
[0m14:49:00.691630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:00.691864 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:49:01.933869 [debug] [MainThread]: On master: COMMIT
[0m14:49:01.934867 [debug] [MainThread]: Using oracle connection "master"
[0m14:49:01.935284 [debug] [MainThread]: On master: COMMIT
[0m14:49:02.074787 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:49:02.075571 [debug] [MainThread]: On master: Close
[0m14:49:02.181719 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:49:02.182323 [info ] [MainThread]: 
[0m14:49:02.187894 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:49:02.188478 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:49:02.189008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:49:02.189255 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:49:02.206237 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:49:02.207252 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:49:02.189427 => 14:49:02.207136
[0m14:49:02.207495 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:49:02.230358 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:49:04.376699 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:49:04.378753 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzQxNDMsImlhdCI6MTY4NzQ3MDU0M30.bXYYMgIHK7csrkKMN1DivxLqmL1X5LY3siFdN4xU-qSIrp0fTcrgJAMP7vIOQ8eYFOJNs6hismyQckjE8n3xL_o-4dQV1zIU9WGp6i6zXvb7Aae7yOggq387tX5nree3M79m81ZGDCUr9TZSV7D-1UCDlL-DKHmUPWWqASLsEVZrcW6lChOYkaYCsXQ-RSXzWxW-TvW63J5hQPTR6OjXCmst3sYXdS1fLAEELpbAGeR3C8m8qurvgNbycU-PCP89vKCwY3PWuxApSgRAcyDJ9la0n_ZMNm0Qxme6D7Rnm2C5muHTWr32YdCPvjS2zffVg2s7X2yowTWcahv_T7NUzg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info144902224469"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_214904 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_214904';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:49:04.380149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:04.380723 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:49:30.349555 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m14:49:30.354309 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:49:30.365477 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:49:30.366500 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info144902224469')
        
      order by ordinal_position

  
[0m14:49:30.635333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:49:30.749677 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:49:30.750463 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:49:30.880723 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:49:31.030753 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:49:31.031816 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:49:31.162142 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:49:31.293735 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:49:31.295875 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:49:31.296288 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info144902224469
    )
  
[0m14:49:32.019012 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:49:32.032416 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:49:32.033252 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:49:32.033634 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:49:32.138624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:49:32.148625 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:49:32.149177 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info144902224469
[0m14:49:32.308877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:49:32.320309 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:49:32.321129 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info144902224469 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:49:32.449873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:49:32.464395 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:49:02.207647 => 14:49:32.464170
[0m14:49:32.465073 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:49:32.566130 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:49:32.680349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ddbaf2-497a-465a-9349-2be88495e08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103b2b50>]}
[0m14:49:32.681226 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.49s]
[0m14:49:32.681598 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:49:32.682574 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:49:32.683098 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:49:32.684091 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:49:32.684492 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:49:32.688436 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:49:32.689665 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:49:32.684762 => 14:49:32.689510
[0m14:49:32.689939 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:49:32.703382 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m14:49:32.703845 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:49:32.705681 [info ] [Thread-3 (]: Python model materialization is table
[0m14:49:32.706058 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:49:34.725153 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:49:34.727264 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzQxNzMsImlhdCI6MTY4NzQ3MDU3M30.D0Z0WZfI1QzFMD3undjELs-YBrjQSzaYUmCTwMOOUSeuP-753AJrkUsoFVLHpxnLlRMMuFkOb_bEAtfuewII5Qe97P-ScsKhaUwyhrvylKlljkovKkGYKf98Ee-ddQvGdJm1TWJLfrHLeCAXJctx9K9BvX9KCQawvwvApcZqJk2SEuPTeHiZTyvaiu462IZs8-3w6l3E3UgSAN5Gy1dbWJ7lwzwcTi7L7Pqq_3PM6UvuSo6nZtDMpUNSF3Mqbi0qlBCSKy_9euRhj0JHFmldgGdJXvfeEECicdJQYwVlI1hD1iXoeN_FyPPlvUpvb0KeGUn7C8PxAfGAlss7b5h3EA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
        # y_pred = classifier.predict(x)
    
        # df["Shipping_City_Prediction"] = y_pred
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_214934 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_214934';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:49:34.729501 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:49:34.730103 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:50:36.649263 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m14:50:36.651922 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:50:36.763812 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:49:32.690087 => 14:50:36.763241
[0m14:50:36.774758 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:50:36.776584 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ddbaf2-497a-465a-9349-2be88495e08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105d5bd0>]}
[0m14:50:36.777017 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 64.09s]
[0m14:50:36.777275 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:50:36.778242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:36.778472 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_high'
[0m14:50:38.173743 [debug] [MainThread]: On master: COMMIT
[0m14:50:38.175432 [debug] [MainThread]: Using oracle connection "master"
[0m14:50:38.176236 [debug] [MainThread]: On master: COMMIT
[0m14:50:38.283817 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:50:38.285804 [debug] [MainThread]: On master: Close
[0m14:50:38.396607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:38.397908 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:50:38.398408 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:50:38.398943 [info ] [MainThread]: 
[0m14:50:38.399335 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 41.23 seconds (101.23s).
[0m14:50:38.400160 [debug] [MainThread]: Command end result
[0m14:50:38.408886 [info ] [MainThread]: 
[0m14:50:38.409405 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:50:38.409722 [info ] [MainThread]: 
[0m14:50:38.410016 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:50:38.410295 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m14:50:38.410569 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m14:50:38.410823 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m14:50:38.411082 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m14:50:38.411334 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m14:50:38.411586 [error] [MainThread]:   ORA-29276: transfer timeout
[0m14:50:38.411841 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m14:50:38.412089 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m14:50:38.412331 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m14:50:38.412579 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:50:38.412806 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:50:38.413016 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:50:38.413222 [error] [MainThread]:   ORA-06512: at line 107
[0m14:50:38.413435 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:50:38.413658 [info ] [MainThread]: 
[0m14:50:38.413910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:50:38.414378 [debug] [MainThread]: Command `dbt run` failed at 14:50:38.414303 after 101.47 seconds
[0m14:50:38.414729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026f2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026f0e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8ac10>]}
[0m14:50:38.415050 [debug] [MainThread]: Flushing usage events
[0m14:51:08.254791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b38990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112217c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112217f90>]}


============================== 14:51:08.259251 | 4a6ff967-c44f-449b-b54d-7bfff65dcde8 ==============================
[0m14:51:08.259251 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:51:08.259579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:51:08.306967 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:51:08.329676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a6ff967-c44f-449b-b54d-7bfff65dcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11225c390>]}
[0m14:51:08.336377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a6ff967-c44f-449b-b54d-7bfff65dcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133cd990>]}
[0m14:51:08.369054 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:51:08.374894 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m14:51:08.375234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a6ff967-c44f-449b-b54d-7bfff65dcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122cac10>]}
[0m14:51:08.713620 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m14:51:08.720107 [debug] [MainThread]: 1603: static parser failed on combined_categorized_events.sql
[0m14:51:08.724971 [debug] [MainThread]: 1602: parser fallback to jinja rendering on combined_categorized_events.sql
[0m14:51:08.726141 [debug] [MainThread]: 1699: static parser successfully parsed event_counts_by_platform.sql
[0m14:51:08.727957 [debug] [MainThread]: 1699: static parser successfully parsed average_duration_by_platform_country.sql
[0m14:51:08.730014 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m14:51:08.732437 [debug] [MainThread]: 1699: static parser successfully parsed most_frequent_browser.sql
[0m14:51:08.734632 [debug] [MainThread]: 1699: static parser successfully parsed most_active_mobile_users.sql
[0m14:51:08.736551 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
[0m14:51:08.738333 [debug] [MainThread]: 1603: static parser failed on staging/stg_web_events.sql
[0m14:51:08.740807 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_web_events.sql
[0m14:51:08.741745 [debug] [MainThread]: 1603: static parser failed on staging/stg_mobile_events.sql
[0m14:51:08.743991 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_mobile_events.sql
[0m14:51:08.786309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a6ff967-c44f-449b-b54d-7bfff65dcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133df190>]}
[0m14:51:08.792028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a6ff967-c44f-449b-b54d-7bfff65dcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113481010>]}
[0m14:51:08.792400 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:51:08.792647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a6ff967-c44f-449b-b54d-7bfff65dcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113481e90>]}
[0m14:51:08.793391 [info ] [MainThread]: 
[0m14:51:08.793750 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:51:08.794240 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:51:08.798867 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:51:08.799068 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:51:08.799231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:08.799397 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:51:10.287914 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:51:10.395332 [debug] [ThreadPool]: On list_None: Close
[0m14:51:10.506955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:51:10.513348 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:51:10.514006 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:51:10.514407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:10.514823 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:51:11.914741 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:51:11.925430 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:51:11.926141 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:51:12.058189 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:51:12.268854 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:51:12.373814 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:51:12.485533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a6ff967-c44f-449b-b54d-7bfff65dcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11364ab90>]}
[0m14:51:12.486276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:12.486774 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:51:13.760726 [debug] [MainThread]: On master: COMMIT
[0m14:51:13.761143 [debug] [MainThread]: Using oracle connection "master"
[0m14:51:13.761373 [debug] [MainThread]: On master: COMMIT
[0m14:51:13.866620 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:51:13.868877 [debug] [MainThread]: On master: Close
[0m14:51:13.980467 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:13.981354 [info ] [MainThread]: 
[0m14:51:13.986762 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:51:13.987413 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:51:13.988059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:51:13.988373 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:51:14.007311 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:51:14.010621 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:51:13.988594 => 14:51:14.010420
[0m14:51:14.011032 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:51:14.039838 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:51:16.348522 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:51:16.349363 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzQyNzUsImlhdCI6MTY4NzQ3MDY3NX0.knHWRKtc4jSaB_9DxYwRwhM2UHgLvr7ZoBnTVlw-yYOqfkIwN3ShOZ0brigO6WgRva79ty2odlVWnsOY1fTAXhNARpFgAISRt66zYKQyxv8XsVy5PV9AY0qx3Jf5C5ovXawjqsdwEQtPwQqCN_z1UuS5wXGc7mztCFrK1KcVNckwttMhB5SOQEd_sh9tTsT0d7uIjVXnor292KvGuAOaSH-UFBQ7bs7tTEnGw_fQnYRDFvcc5u3zkzyNN85m4eJbUxK133jXJSBwmUEeNRwWv9N73SW1PT_tpf07RuPFHaC0jXddKtrVdpBqL0e-vaPzQbNj2X24oeL1X0lDQzwRUg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info145114033096"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_215116 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_215116';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:51:16.350028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:16.350318 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:51:42.371728 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m14:51:42.376609 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:51:42.386060 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:51:42.386844 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info145114033096')
        
      order by ordinal_position

  
[0m14:51:42.689793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:42.811217 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:51:42.811992 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:51:42.948782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:43.067482 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:51:43.068199 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:51:43.203143 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:43.333393 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:51:43.335238 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:51:43.335575 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info145114033096
    )
  
[0m14:51:44.112309 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:51:44.126610 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:51:44.127233 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:51:44.127634 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:51:44.230893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:44.240716 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:51:44.241323 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info145114033096
[0m14:51:44.401832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:44.413045 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:51:44.413745 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info145114033096 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:51:44.539174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:44.555627 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:51:14.011282 => 14:51:44.555425
[0m14:51:44.556116 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:51:44.659081 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:51:44.775719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a6ff967-c44f-449b-b54d-7bfff65dcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138d0210>]}
[0m14:51:44.778469 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.79s]
[0m14:51:44.780227 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:51:44.781642 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:51:44.782508 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:51:44.783584 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:51:44.784123 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:51:44.789163 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:51:44.791061 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:51:44.784479 => 14:51:44.790850
[0m14:51:44.791519 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:51:44.806097 [debug] [Thread-3 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m14:51:44.806526 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:51:44.809554 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:51:44.809913 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:51:44.810216 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:51:44.810506 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:51:47.086050 [debug] [Thread-3 (]: SQL status: OK in 2.0 seconds
[0m14:51:47.092486 [info ] [Thread-3 (]: Python model materialization is table
[0m14:51:47.093468 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:51:49.546198 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:51:49.548183 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzQzMDgsImlhdCI6MTY4NzQ3MDcwOH0.ghj9o46yOZdGU22WTPKK5rqyrbQ-OjS5xRu0spgHpQvPXJF5gpibOjrDHthzyBpTIg6eeGgsacAsOEeKQBgmfEiLsO9FEX0LDblV6BPlydL3IHRLJ59ciReX02caets9xN8YmUyFCZhmCMXJaO8i3ag0xXe6mDX84zQIrGvU8PHKNc5eMdbCbdtZeCDTQtcHvfK39EdqvU9ax3xYcNVloNwEfOKCP4Hmp6BSTXSg9p7oFLZfET0410hb4Bv8kitG8q4sTWnIZET3yQDeLajGWqXKhHpe46LdU2HnfIyz9NRNFomLoiXYwY7m5FwzIhMa_S4ywBsdRT8__GawPQpDhg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
        # y_pred = classifier.predict(x)
    
        # df["Shipping_City_Prediction"] = y_pred
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_215149 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_215149';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:55:33.243481 [info ] [MainThread]: oracle adapter: Cancelling query 'model.oracle_dbt.web_events_python' 
[0m14:55:33.377766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:33.378729 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:55:33.379212 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was left open.
[0m14:55:33.379688 [debug] [MainThread]: On model.oracle_dbt.web_events_python: Close
[0m14:55:33.530533 [error] [MainThread]: Encountered an error:

[0m14:55:33.540158 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 350, in execute_nodes
    self.run_queue(pool)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 277, in run_queue
    self.job_queue.join()
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 404, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 358, in execute_nodes
    self._cancel_connections(pool)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 323, in _cancel_connections
    for conn_name in adapter.cancel_open_connections():
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1099, in cancel_open_connections
    return self.connections.cancel_open()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 43, in cancel_open
    self.cancel(connection)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/oracle/connections.py", line 241, in cancel
    oracledb.Connection.close(oracle_connection)
  File "/opt/homebrew/lib/python3.11/site-packages/oracledb/connection.py", line 309, in close
    self._impl.close()
  File "src/oracledb/impl/thin/connection.pyx", line 303, in oracledb.thin_impl.ThinConnImpl.close
  File "src/oracledb/impl/thin/protocol.pyx", line 86, in oracledb.thin_impl.Protocol._close
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/main.py", line 565, in run
    results = task.run()
              ^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 441, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 407, in execute_with_hooks
    adapter.cleanup_connections()
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 241, in cleanup_connections
    self.connections.cleanup_all()
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/connections.py", line 315, in cleanup_all
    self.close(connection)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/connections.py", line 385, in close
    cls._close_handle(connection)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/connections.py", line 352, in _close_handle
    connection.handle.close()
  File "/opt/homebrew/lib/python3.11/site-packages/oracledb/connection.py", line 309, in close
    self._impl.close()
  File "src/oracledb/impl/thin/connection.pyx", line 303, in oracledb.thin_impl.ThinConnImpl.close
  File "src/oracledb/impl/thin/protocol.pyx", line 86, in oracledb.thin_impl.Protocol._close
KeyboardInterrupt

[0m14:55:33.541544 [debug] [MainThread]: Command `dbt run` failed at 14:55:33.541454 after 181.35 seconds
[0m14:55:33.541834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:33.542038 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:55:33.542217 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was left open.
[0m14:55:33.542429 [debug] [MainThread]: On model.oracle_dbt.web_events_python: Close
[0m14:55:33.669367 [debug] [MainThread]: Flushing usage events
[0m14:55:39.997288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107417cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107417f90>]}


============================== 14:55:40.000054 | 49d4cac3-f806-4560-b5cf-c5e88270b81b ==============================
[0m14:55:40.000054 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:55:40.000397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:55:40.047139 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:55:40.068461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49d4cac3-f806-4560-b5cf-c5e88270b81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107417810>]}
[0m14:55:40.074827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49d4cac3-f806-4560-b5cf-c5e88270b81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106510d0>]}
[0m14:55:40.108513 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:55:40.143554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:40.143830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:40.147396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49d4cac3-f806-4560-b5cf-c5e88270b81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107485450>]}
[0m14:55:40.151863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49d4cac3-f806-4560-b5cf-c5e88270b81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744b8d0>]}
[0m14:55:40.152116 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:55:40.152290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49d4cac3-f806-4560-b5cf-c5e88270b81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110651210>]}
[0m14:55:40.153032 [info ] [MainThread]: 
[0m14:55:40.153428 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:55:40.154167 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m14:55:40.159197 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m14:55:40.159409 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:55:40.159578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:40.159757 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:55:41.683243 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:55:41.783573 [debug] [ThreadPool]: On list_None: Close
[0m14:55:41.879919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m14:55:41.884970 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:55:41.885483 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m14:55:41.885673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:41.885874 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:55:43.448626 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:55:43.460280 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m14:55:43.461031 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:55:43.577591 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:43.771038 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m14:55:43.866692 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m14:55:43.973653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49d4cac3-f806-4560-b5cf-c5e88270b81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110634a10>]}
[0m14:55:43.974472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:43.974815 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:55:45.119214 [debug] [MainThread]: On master: COMMIT
[0m14:55:45.122272 [debug] [MainThread]: Using oracle connection "master"
[0m14:55:45.122956 [debug] [MainThread]: On master: COMMIT
[0m14:55:45.217035 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:55:45.219492 [debug] [MainThread]: On master: Close
[0m14:55:45.319698 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:45.320322 [info ] [MainThread]: 
[0m14:55:45.325148 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m14:55:45.325931 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m14:55:45.326780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m14:55:45.327229 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m14:55:45.345103 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m14:55:45.346296 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 14:55:45.327557 => 14:55:45.346163
[0m14:55:45.346562 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m14:55:45.375172 [info ] [Thread-1 (]: Python model materialization is incremental
[0m14:55:47.976112 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:55:47.977030 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzQ1NDYsImlhdCI6MTY4NzQ3MDk0Nn0.nRoG-tcaeO305e2guvUiy5qZVT1GTW9zSpK4AkeMdVSpgKjyUIt6EzCeb9xWqQcqnUJkTMXAL3zjR0hFzNIwsLyjFws4QueclDAa5x2ImySN7y2SAXQAwrvgehwlyWvQQEl4w-e5gMlYk4DF3C9KBdsg1OQr0elTd9P4UnEf3IlU8C9u8J-Ai40X5DeBg-gRo4njEP6WELiZnM9XdPckDUcIMh41FZd1Pbrocd3nYh-W9dYFhHGyBIlkCZENhTu5ZIwfKd453OdJxIJ_z9-A3XeWLW1oh1vw0tgNLDLadVI3RqQDesd_tdPmtRiGZa1Hxm9l4Zcel4rMwPRvQ5cUyQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info145545368184"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_215547 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_215547';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m14:55:47.978083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:47.978468 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:56:14.033137 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m14:56:14.036733 [info ] [Thread-1 (]: oracle adapter: OK
[0m14:56:14.046890 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:56:14.047839 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info145545368184')
        
      order by ordinal_position

  
[0m14:56:14.310591 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:56:14.424018 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:56:14.425385 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:56:14.558671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:56:14.676321 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:56:14.677374 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m14:56:14.809452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:56:14.934342 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m14:56:14.935511 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:56:14.935896 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info145545368184
    )
  
[0m14:56:15.525671 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:56:15.539921 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:56:15.540530 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:56:15.540731 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m14:56:15.648299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:56:15.659522 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:56:15.660124 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info145545368184
[0m14:56:15.818014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:56:15.833505 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m14:56:15.834401 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info145545368184 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:56:15.962377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:56:15.980534 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 14:55:45.346706 => 14:56:15.980288
[0m14:56:15.981254 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m14:56:16.084928 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m14:56:16.194777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d4cac3-f806-4560-b5cf-c5e88270b81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110690b50>]}
[0m14:56:16.195696 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.87s]
[0m14:56:16.196386 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m14:56:16.197265 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m14:56:16.198075 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m14:56:16.198845 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m14:56:16.199240 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m14:56:16.201733 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m14:56:16.203055 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 14:56:16.199392 => 14:56:16.202821
[0m14:56:16.203491 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m14:56:16.216634 [debug] [Thread-3 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m14:56:16.217009 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m14:56:16.219233 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:56:16.219516 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:56:16.219741 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:56:16.219954 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:56:17.666390 [debug] [Thread-3 (]: SQL status: OK in 1.0 seconds
[0m14:56:17.673190 [info ] [Thread-3 (]: Python model materialization is table
[0m14:56:17.674107 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m14:56:19.921599 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m14:56:19.923069 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzQ1NzgsImlhdCI6MTY4NzQ3MDk3OH0.HKeRRzpWr6oTv527dwvgbN9ovL3SANvdCiWr2ZqzYWFs_BS2yJ4ivtGPORw_nXvyNoQIvHT1rT1W_NEmltu3XxvZgWq4rJemVV0C-pVaI12vuNl4Wg9VAlA1DDKZMjwSohP09bzhOM1gYSgY8WoaseuflqFByCJ9s_XpJl_Njx6qx-kUwxEJvQMCGcTgwQx5TtXnDOxUnriGl2u9ja3ZVL0A7J7dN8Yp9T1JpW6BxWF01JsR3ywnyxMWCIHAn-pf8q8wDpXNvMQdyHmaiWXpK-RFkxULC1fPk98R0mtP0xZAAiVt5Ok8dfVxV9zT8TyzK4umoEBePf9lNoRQhHg11g!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
        # y_pred = classifier.predict(x)
    
        # df["Shipping_City_Prediction"] = y_pred
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_215619 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_215619';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m14:57:20.440527 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m14:57:20.442864 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m14:57:20.553682 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 14:56:16.203741 => 14:57:20.553165
[0m14:57:20.565780 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:57:20.568439 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d4cac3-f806-4560-b5cf-c5e88270b81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ad5650>]}
[0m14:57:20.569179 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 64.37s]
[0m14:57:20.569678 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m14:57:20.571392 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:20.571777 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m14:57:21.949554 [debug] [MainThread]: On master: COMMIT
[0m14:57:21.951879 [debug] [MainThread]: Using oracle connection "master"
[0m14:57:21.952912 [debug] [MainThread]: On master: COMMIT
[0m14:57:22.061835 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:57:22.064281 [debug] [MainThread]: On master: Close
[0m14:57:22.173245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:22.174013 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m14:57:22.174360 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m14:57:22.174754 [info ] [MainThread]: 
[0m14:57:22.175060 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 42.02 seconds (102.02s).
[0m14:57:22.175705 [debug] [MainThread]: Command end result
[0m14:57:22.184121 [info ] [MainThread]: 
[0m14:57:22.184500 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:57:22.184728 [info ] [MainThread]: 
[0m14:57:22.184899 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m14:57:22.185063 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m14:57:22.185207 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m14:57:22.185393 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m14:57:22.185578 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m14:57:22.185926 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m14:57:22.186115 [error] [MainThread]:   ORA-29276: transfer timeout
[0m14:57:22.186259 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m14:57:22.186390 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m14:57:22.186520 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m14:57:22.186646 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m14:57:22.186771 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m14:57:22.186896 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m14:57:22.187016 [error] [MainThread]:   ORA-06512: at line 107
[0m14:57:22.187140 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m14:57:22.187281 [info ] [MainThread]: 
[0m14:57:22.187448 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:57:22.187832 [debug] [MainThread]: Command `dbt run` failed at 14:57:22.187770 after 102.21 seconds
[0m14:57:22.188096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10250ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102508e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063012d0>]}
[0m14:57:22.188354 [debug] [MainThread]: Flushing usage events
[0m15:50:42.145206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f14090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f17fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f175d0>]}


============================== 15:50:42.147782 | 3089e90e-6c1f-4692-b602-6784b3ae1af3 ==============================
[0m15:50:42.147782 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:50:42.148090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:50:42.194252 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:50:42.216061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3089e90e-6c1f-4692-b602-6784b3ae1af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccce50>]}
[0m15:50:42.222565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3089e90e-6c1f-4692-b602-6784b3ae1af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197e5710>]}
[0m15:50:42.255224 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:50:42.287669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:42.287995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:42.291409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3089e90e-6c1f-4692-b602-6784b3ae1af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198d5e90>]}
[0m15:50:42.296306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3089e90e-6c1f-4692-b602-6784b3ae1af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197c6cd0>]}
[0m15:50:42.296607 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m15:50:42.296782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3089e90e-6c1f-4692-b602-6784b3ae1af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f16910>]}
[0m15:50:42.297634 [info ] [MainThread]: 
[0m15:50:42.298105 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:50:42.298733 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m15:50:42.304038 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m15:50:42.304341 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:50:42.304517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:42.304697 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:50:43.956533 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m15:50:44.066369 [debug] [ThreadPool]: On list_None: Close
[0m15:50:44.174234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m15:50:44.181604 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m15:50:44.182170 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m15:50:44.182432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:44.182681 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:50:45.583949 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m15:50:45.593733 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m15:50:45.594186 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:50:45.720883 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:50:45.930900 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m15:50:46.037594 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m15:50:46.153337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3089e90e-6c1f-4692-b602-6784b3ae1af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119832e10>]}
[0m15:50:46.154258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:46.154648 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:50:47.438497 [debug] [MainThread]: On master: COMMIT
[0m15:50:47.440831 [debug] [MainThread]: Using oracle connection "master"
[0m15:50:47.441891 [debug] [MainThread]: On master: COMMIT
[0m15:50:47.550061 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:50:47.552342 [debug] [MainThread]: On master: Close
[0m15:50:47.666064 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:50:47.666983 [info ] [MainThread]: 
[0m15:50:47.673045 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m15:50:47.673935 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m15:50:47.674772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m15:50:47.675202 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m15:50:47.694301 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m15:50:47.695384 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 15:50:47.675494 => 15:50:47.695215
[0m15:50:47.695710 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m15:50:47.722179 [info ] [Thread-1 (]: Python model materialization is incremental
[0m15:50:50.589706 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:50:50.591042 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Nzc4NDksImlhdCI6MTY4NzQ3NDI0OX0.gJZsytr5qaZct2PkT-cXesyVmAt7_ZAvqB9rBXSJ6BRMhPzaDELqhifujeCQ3L0XI55H3qqo913Bee9-zsCLp46XIc5VZBYshSyOSadKAOtMF6PUwDckRmrnAd7-rs75dXNfghryg9o1KC-cBRpDdn2vL1wjOE4jzPO7SZRrvgdOjxOz_fhweACT4cN5YhfNeYcV9nc_tGkd1LYrr9OZqbfZ3KJICBHRKLkfGmRhfDjOaAr4A7h4fuSsnsI8otSclpizFgRb9qNBHM3JfHHCATl93-I6vUY7fAovk2hB363kMgGO4RtlVLsuuEaj76B31xpjpfneBfBh2LDpC0QweA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info155047715629"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_225050 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_225050';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m15:50:50.592373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:50.592944 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:51:21.409925 [debug] [Thread-1 (]: SQL status: OK in 31.0 seconds
[0m15:51:21.415575 [info ] [Thread-1 (]: oracle adapter: OK
[0m15:51:21.426374 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:51:21.427301 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info155047715629')
        
      order by ordinal_position

  
[0m15:51:21.714311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:51:21.830528 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:51:21.831247 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m15:51:22.033274 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:51:22.153740 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:51:22.154827 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m15:51:22.356855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:51:22.481711 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m15:51:22.482851 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:51:22.483168 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info155047715629
    )
  
[0m15:51:23.145278 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m15:51:23.158413 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m15:51:23.159248 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:51:23.159685 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m15:51:23.266850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:51:23.277040 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:51:23.277651 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info155047715629
[0m15:51:23.442023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:51:23.455160 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:51:23.456037 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info155047715629 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:51:23.591002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:51:23.608329 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 15:50:47.695899 => 15:51:23.607945
[0m15:51:23.608961 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m15:51:23.713445 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m15:51:23.827031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3089e90e-6c1f-4692-b602-6784b3ae1af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199dd450>]}
[0m15:51:23.829464 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 36.15s]
[0m15:51:23.830659 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m15:51:23.831860 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m15:51:23.832678 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m15:51:23.833944 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m15:51:23.834507 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m15:51:23.838885 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m15:51:23.841695 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 15:51:23.834968 => 15:51:23.841510
[0m15:51:23.842042 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m15:51:23.858125 [debug] [Thread-3 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m15:51:23.858619 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m15:51:23.861582 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m15:51:23.862063 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:51:23.862409 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:51:23.862708 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:51:25.444100 [debug] [Thread-3 (]: SQL status: OK in 2.0 seconds
[0m15:51:25.450425 [info ] [Thread-3 (]: Python model materialization is table
[0m15:51:25.451557 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m15:51:27.573539 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m15:51:27.574290 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Nzc4ODYsImlhdCI6MTY4NzQ3NDI4Nn0.B610Aowo4RwdiopjKF4pMYFvZTRLBLXiUy9eTKecJwyHjnOPbPWClNrpgLAW6J3PaWzhZmB4D6tNlMHp3t1e7e6VpSxEKFfFpFfiVtyXvBRHajwg0pP4p0MsLZ4bM0O8YzWzy-nOJwpmsvVtIZad6lbKiH8MVAdIfcNrLeay_YigAyC-YAyHqqpJAqTRtM9XUweEaccxZNVTjiuAewRurM-hOPS45j5TaBKYLuvdFvdjFwMPhAyheI7z5AoTaOJtTDO-xAmuP0bL6Hgp4RUMD1fHSpmyH0--M07RhjQOsskft9ddbdcm4WqFQ_XWzi5Z4fplrZuPyiO1dq-2LUnzUA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
        # y_pred = classifier.predict(x)
    
        # df["Shipping_City_Prediction"] = y_pred
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_225127 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_225127';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m15:51:27.575663 [info ] [Thread-3 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m15:51:27.576064 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m15:51:27.685060 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 15:51:23.842267 => 15:51:27.684288
[0m15:51:27.700105 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m15:51:27.702260 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3089e90e-6c1f-4692-b602-6784b3ae1af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ad4cd0>]}
[0m15:51:27.702700 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.87s]
[0m15:51:27.703185 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m15:51:27.704496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:27.704840 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:51:28.971130 [debug] [MainThread]: On master: COMMIT
[0m15:51:28.972128 [debug] [MainThread]: Using oracle connection "master"
[0m15:51:28.972623 [debug] [MainThread]: On master: COMMIT
[0m15:51:29.075650 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:51:29.076387 [debug] [MainThread]: On master: Close
[0m15:51:29.186655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:29.187674 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m15:51:29.188155 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m15:51:29.188671 [info ] [MainThread]: 
[0m15:51:29.189142 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 46.89 seconds (46.89s).
[0m15:51:29.190034 [debug] [MainThread]: Command end result
[0m15:51:29.198612 [info ] [MainThread]: 
[0m15:51:29.198944 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:51:29.199099 [info ] [MainThread]: 
[0m15:51:29.199246 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m15:51:29.199396 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m15:51:29.199532 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m15:51:29.199671 [info ] [MainThread]: 
[0m15:51:29.199828 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:51:29.200305 [debug] [MainThread]: Command `dbt run` failed at 15:51:29.200129 after 47.08 seconds
[0m15:51:29.200878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ef8890>]}
[0m15:51:29.201282 [debug] [MainThread]: Flushing usage events
[0m15:51:36.806477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089abd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b7f90>]}


============================== 15:51:36.808732 | c901a1b1-0111-49ae-bc04-26e7c2ec77de ==============================
[0m15:51:36.808732 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:51:36.809039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:51:36.850336 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:51:36.872634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c901a1b1-0111-49ae-bc04-26e7c2ec77de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e8ed0>]}
[0m15:51:36.878954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c901a1b1-0111-49ae-bc04-26e7c2ec77de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c9290>]}
[0m15:51:36.911924 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:51:36.942819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:36.943128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:36.946776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c901a1b1-0111-49ae-bc04-26e7c2ec77de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ede90>]}
[0m15:51:36.951484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c901a1b1-0111-49ae-bc04-26e7c2ec77de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e7350>]}
[0m15:51:36.951806 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m15:51:36.951995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c901a1b1-0111-49ae-bc04-26e7c2ec77de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10802c610>]}
[0m15:51:36.952933 [info ] [MainThread]: 
[0m15:51:36.953401 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:51:36.953977 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m15:51:36.959185 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m15:51:36.959456 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:51:36.959637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:36.959818 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:51:38.349765 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m15:51:38.462314 [debug] [ThreadPool]: On list_None: Close
[0m15:51:38.574887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m15:51:38.583565 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m15:51:38.584268 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m15:51:38.584680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:38.585099 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:51:39.974247 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m15:51:39.987576 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m15:51:39.988302 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:51:40.116771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:51:40.323374 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m15:51:40.434837 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m15:51:40.559762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c901a1b1-0111-49ae-bc04-26e7c2ec77de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105178e90>]}
[0m15:51:40.560810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:40.561278 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:51:41.855681 [debug] [MainThread]: On master: COMMIT
[0m15:51:41.857953 [debug] [MainThread]: Using oracle connection "master"
[0m15:51:41.859229 [debug] [MainThread]: On master: COMMIT
[0m15:51:41.965116 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:51:41.967672 [debug] [MainThread]: On master: Close
[0m15:51:42.080648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:51:42.081512 [info ] [MainThread]: 
[0m15:51:42.087541 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m15:51:42.088438 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m15:51:42.089266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m15:51:42.089667 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m15:51:42.113360 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m15:51:42.114549 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 15:51:42.089952 => 15:51:42.114371
[0m15:51:42.114857 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m15:51:42.140689 [info ] [Thread-1 (]: Python model materialization is incremental
[0m15:51:44.245269 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:51:44.246612 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Nzc5MDMsImlhdCI6MTY4NzQ3NDMwM30.CB9TpfbGAEpd-WmelGHrJUhsKYHjGWAeWru2B_BetYC7COU9IV0ydDvTSx2iMdoREZqEpeBQtZm7EsE9CIkjN2BssCL8MrRCnvDj2jAQ7sDnUA1xMfByTouv4dBnEkBlFxP8FVlyrByAOpCSYWgY09ci9ojytxBCTvdAfNEMMFgkl5PfUcEBmQAu39LZoDcwIdvJxm9Z6jsCw31oh5ycHZKhZnt1D-s7cShWt-O13918BIgliwca2E36d-1lWxdgm6FtTFckS_i5As0EWbMSfH88yg1STnk7kUh_H2Mu9Jeb5SZM9xQEsu-hhmZN-67Gvo0OPkRF3xQYHOZsa6Gvmw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info155142133826"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_225144 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_225144';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m15:51:44.248040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:44.248708 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:52:10.176822 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m15:52:10.181474 [info ] [Thread-1 (]: oracle adapter: OK
[0m15:52:10.193888 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:52:10.194768 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info155142133826')
        
      order by ordinal_position

  
[0m15:52:10.444503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:52:10.573218 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:52:10.574019 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m15:52:10.693169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:52:10.800887 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:52:10.801993 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m15:52:10.919797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:52:11.035025 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m15:52:11.036866 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:52:11.037266 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info155142133826
    )
  
[0m15:52:11.682207 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m15:52:11.695854 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m15:52:11.696828 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:52:11.697435 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m15:52:11.788316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:52:11.797679 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:52:11.798114 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info155142133826
[0m15:52:11.953325 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:52:11.965554 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:52:11.966448 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info155142133826 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:52:12.078060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:52:12.092896 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 15:51:42.115014 => 15:52:12.092658
[0m15:52:12.093582 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m15:52:12.184218 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m15:52:12.279356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c901a1b1-0111-49ae-bc04-26e7c2ec77de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091aeb10>]}
[0m15:52:12.280565 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.19s]
[0m15:52:12.281238 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m15:52:12.282120 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m15:52:12.282908 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m15:52:12.283819 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m15:52:12.284396 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m15:52:12.288326 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m15:52:12.302408 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 15:52:12.284751 => 15:52:12.302178
[0m15:52:12.302776 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m15:52:12.317216 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m15:52:12.317621 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m15:52:12.319333 [info ] [Thread-3 (]: Python model materialization is table
[0m15:52:12.319645 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m15:52:14.745870 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m15:52:14.747498 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Nzc5MzMsImlhdCI6MTY4NzQ3NDMzM30.JhTuRoKXsLderIEPmUgvxs--ih-x_NfNPtXAlwPgxFu-RE4I-ZegcWbH97kO9bnVCk83RjM9BjZZ9WbHewO9LfoH7MQwBEWPcMjK6jv4zURMFkHNDqQh-eboW4JQH00rXQU1xkf_8x345i2YXzBNc8eW-V4sh2r2AeN08RukDVrBBSiTsNvhwgTvfOrZmhnbiZrVnkrsvOVvP7SNL3a7w8-zPixzmu8M5q3e9LRPMVNeYz3jDvgRVvmiHVYlBsVnOqk-N5kyLJLL56H3PUFJ1eSVBHw_4Ozb8kWzN5_mfp71x0mCFd5XO8QBxr2hESlh98XRLZoMwigsnF01_VGjbg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
        # y_pred = classifier.predict(x)
    
        # df["Shipping_City_Prediction"] = y_pred
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_225214 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_225214';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m15:52:14.748893 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:52:14.749447 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:52:16.015182 [info ] [Thread-3 (]: oracle adapter: Oracle error: DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m15:52:16.017160 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m15:52:16.133882 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 15:52:12.302971 => 15:52:16.132402
[0m15:52:16.145264 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m15:52:16.147281 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c901a1b1-0111-49ae-bc04-26e7c2ec77de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d0610>]}
[0m15:52:16.147829 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 3.86s]
[0m15:52:16.148136 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m15:52:16.149427 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:52:16.149687 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:52:17.248368 [debug] [MainThread]: On master: COMMIT
[0m15:52:17.250605 [debug] [MainThread]: Using oracle connection "master"
[0m15:52:17.251609 [debug] [MainThread]: On master: COMMIT
[0m15:52:17.342509 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:52:17.344676 [debug] [MainThread]: On master: Close
[0m15:52:17.437200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:17.437866 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m15:52:17.438314 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m15:52:17.438781 [info ] [MainThread]: 
[0m15:52:17.439126 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 40.49 seconds (40.49s).
[0m15:52:17.440147 [debug] [MainThread]: Command end result
[0m15:52:17.447534 [info ] [MainThread]: 
[0m15:52:17.448053 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:52:17.448629 [info ] [MainThread]: 
[0m15:52:17.448991 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m15:52:17.449150 [error] [MainThread]:   DPY-4010: a bind variable replacement value for placeholder ":IMPORT" was not provided
[0m15:52:17.449304 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m15:52:17.449454 [info ] [MainThread]: 
[0m15:52:17.449624 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:52:17.449956 [debug] [MainThread]: Command `dbt run` failed at 15:52:17.449906 after 40.66 seconds
[0m15:52:17.450208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b2ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052eec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107786c10>]}
[0m15:52:17.450427 [debug] [MainThread]: Flushing usage events
[0m15:52:35.474457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106917b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106917f90>]}


============================== 15:52:35.476835 | 3dd66308-ed35-4c70-abfa-41d9a3a8e9d0 ==============================
[0m15:52:35.476835 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:52:35.477147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:52:35.519392 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:52:35.541735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dd66308-ed35-4c70-abfa-41d9a3a8e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106917bd0>]}
[0m15:52:35.547916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3dd66308-ed35-4c70-abfa-41d9a3a8e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107040e10>]}
[0m15:52:35.579863 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:52:35.615969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:35.616282 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:35.619773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dd66308-ed35-4c70-abfa-41d9a3a8e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e9e90>]}
[0m15:52:35.624457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dd66308-ed35-4c70-abfa-41d9a3a8e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107044290>]}
[0m15:52:35.624768 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m15:52:35.624944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dd66308-ed35-4c70-abfa-41d9a3a8e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106928f50>]}
[0m15:52:35.625689 [info ] [MainThread]: 
[0m15:52:35.626073 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:52:35.626709 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m15:52:35.631791 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m15:52:35.632069 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:52:35.632232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:35.632395 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:52:36.894844 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m15:52:36.986109 [debug] [ThreadPool]: On list_None: Close
[0m15:52:37.078603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m15:52:37.085588 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m15:52:37.086216 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m15:52:37.086576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:37.086938 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:52:38.274659 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m15:52:38.286177 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m15:52:38.286740 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:52:38.398875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:52:38.513572 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m15:52:38.610093 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m15:52:38.713532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dd66308-ed35-4c70-abfa-41d9a3a8e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107058590>]}
[0m15:52:38.714455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:38.714864 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:52:39.843756 [debug] [MainThread]: On master: COMMIT
[0m15:52:39.846025 [debug] [MainThread]: Using oracle connection "master"
[0m15:52:39.846756 [debug] [MainThread]: On master: COMMIT
[0m15:52:39.936834 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:52:39.939288 [debug] [MainThread]: On master: Close
[0m15:52:40.035736 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:52:40.036550 [info ] [MainThread]: 
[0m15:52:40.041993 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m15:52:40.042717 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m15:52:40.043443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m15:52:40.043790 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m15:52:40.066003 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m15:52:40.067695 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 15:52:40.044033 => 15:52:40.067480
[0m15:52:40.068103 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m15:52:40.095802 [info ] [Thread-1 (]: Python model materialization is incremental
[0m15:52:42.176370 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:52:42.177383 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Nzc5NjEsImlhdCI6MTY4NzQ3NDM2MX0.ojPJZIdloWwIHyAtzEncZSj51R6awTv-DQT-Nq0auhXz9y9xrLF1KR5fiEG7GtHA7F63-cv4V9MVkRdnUV5cqEvzgIUKAr4X_rm6_rUm3CKzGEoCHwvRuzFdOSmD_XxCJ1-xnKS-QMeALwCRYJeDgCHz9KBuvI4R1e5RTG2-T5yKRTWA6VGxO6ELDiMKx1za2Q7hol1NrXnhglplTKPZWrh5NreuETLn3-TCy8YJZMyJycUTA9JKF__rCSTMtF_ZsU_ANYWvlmowOgrzuXOvNorJN_UFIwT9os_FIdnjUEg6vsFvJqpnEgQo7_LrOvYqhUWwi8r8NK9ULzhdGpQndQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info155240089345"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_225242 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_225242';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m15:52:42.178637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:42.179193 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:53:07.457085 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m15:53:07.461831 [info ] [Thread-1 (]: oracle adapter: OK
[0m15:53:07.472044 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:53:07.472815 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info155240089345')
        
      order by ordinal_position

  
[0m15:53:07.814036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:53:07.979276 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:53:07.980363 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m15:53:08.165455 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:53:08.321882 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:53:08.322650 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m15:53:08.491636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:53:08.674078 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m15:53:08.675216 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:53:08.675518 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info155240089345
    )
  
[0m15:53:09.434881 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m15:53:09.450262 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m15:53:09.451115 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:53:09.451553 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m15:53:09.621193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:53:09.632832 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:53:09.633646 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info155240089345
[0m15:53:09.846285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:53:09.859400 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:53:09.860069 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info155240089345 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:53:10.045867 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:53:10.068122 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 15:52:40.068313 => 15:53:10.067828
[0m15:53:10.068875 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m15:53:10.219417 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m15:53:10.405764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd66308-ed35-4c70-abfa-41d9a3a8e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107280ad0>]}
[0m15:53:10.408752 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.36s]
[0m15:53:10.409930 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m15:53:10.411741 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m15:53:10.412714 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m15:53:10.413904 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m15:53:10.414514 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m15:53:10.420051 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m15:53:10.422116 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 15:53:10.414938 => 15:53:10.421819
[0m15:53:10.422603 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m15:53:10.437774 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m15:53:10.438253 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m15:53:10.440166 [info ] [Thread-3 (]: Python model materialization is table
[0m15:53:10.440518 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m15:53:12.900161 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m15:53:12.901910 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0Nzc5OTEsImlhdCI6MTY4NzQ3NDM5MX0.P7i_ZzJ-EXGfeHNFtY2uSuOykRdS7y1IC-4nI3gXsea0Qymtwf7v0m2fBEIpYiVQX_odChBP3HMp0E3gIJey6gmH6aKggmPZhsOf8faBAYHxcYCQwtnr2orkLf9fbsTLJ4s8yEAzScE5vYRb_X39L9dAnEgKnSexLbLEgiKAFjD5M2J2WDcGhnYn__bdJTm8795xzQZdSEKgEebhEw8amKwwJRdsSDN4p6_x_89KmAA094rqMe2mMc-_E5gz1DQKbPJd0pPL8Nz3MFMSNFgNzVCXE67huc1QbTWVVrgcRm9xQofmFb31YZZ9DcOA9gde1E9nKKaKfv7_CaEbXHMzaA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
        # y_pred = classifier.predict(x)
    
        # df["Shipping_City_Prediction"] = y_pred
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_225312 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_225312';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m15:53:12.903267 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:53:12.903812 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:54:15.038389 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m15:54:15.041099 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m15:54:15.134974 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 15:53:10.422891 => 15:54:15.134466
[0m15:54:15.143246 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m15:54:15.145102 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd66308-ed35-4c70-abfa-41d9a3a8e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f5210>]}
[0m15:54:15.145466 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 64.73s]
[0m15:54:15.145734 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m15:54:15.146690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:54:15.146940 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:54:16.347510 [debug] [MainThread]: On master: COMMIT
[0m15:54:16.349719 [debug] [MainThread]: Using oracle connection "master"
[0m15:54:16.350864 [debug] [MainThread]: On master: COMMIT
[0m15:54:16.441121 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:54:16.443578 [debug] [MainThread]: On master: Close
[0m15:54:16.542868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:16.543855 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m15:54:16.544324 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m15:54:16.544847 [info ] [MainThread]: 
[0m15:54:16.545360 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 40.92 seconds (100.92s).
[0m15:54:16.546274 [debug] [MainThread]: Command end result
[0m15:54:16.556501 [info ] [MainThread]: 
[0m15:54:16.556864 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:54:16.557019 [info ] [MainThread]: 
[0m15:54:16.557171 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m15:54:16.557322 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m15:54:16.557463 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m15:54:16.557598 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m15:54:16.557737 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m15:54:16.557865 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m15:54:16.557991 [error] [MainThread]:   ORA-29276: transfer timeout
[0m15:54:16.558114 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m15:54:16.558241 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m15:54:16.558372 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m15:54:16.558580 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m15:54:16.558769 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m15:54:16.558917 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m15:54:16.559082 [error] [MainThread]:   ORA-06512: at line 107
[0m15:54:16.559213 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m15:54:16.559355 [info ] [MainThread]: 
[0m15:54:16.559514 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:54:16.559845 [debug] [MainThread]: Command `dbt run` failed at 15:54:16.559796 after 101.10 seconds
[0m15:54:16.560090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100600e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100603910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ea3b50>]}
[0m15:54:16.560326 [debug] [MainThread]: Flushing usage events
[0m15:54:24.070627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d0be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d17d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d17f90>]}


============================== 15:54:24.073313 | 1ec08c0d-bae4-49bd-bb7e-cf3b892dc39b ==============================
[0m15:54:24.073313 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:54:24.073627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:54:24.115956 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:54:24.139447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ec08c0d-bae4-49bd-bb7e-cf3b892dc39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111446450>]}
[0m15:54:24.145707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ec08c0d-bae4-49bd-bb7e-cf3b892dc39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114296d0>]}
[0m15:54:24.178341 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:54:24.209792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:54:24.210140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:54:24.213719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ec08c0d-bae4-49bd-bb7e-cf3b892dc39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dcac90>]}
[0m15:54:24.218247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ec08c0d-bae4-49bd-bb7e-cf3b892dc39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111463ed0>]}
[0m15:54:24.218511 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m15:54:24.218691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ec08c0d-bae4-49bd-bb7e-cf3b892dc39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d09c90>]}
[0m15:54:24.219572 [info ] [MainThread]: 
[0m15:54:24.219992 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:54:24.220645 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m15:54:24.226027 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m15:54:24.226301 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:54:24.226466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:24.226632 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:54:25.448194 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m15:54:25.543388 [debug] [ThreadPool]: On list_None: Close
[0m15:54:25.639817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m15:54:25.647623 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m15:54:25.647992 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m15:54:25.648214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:25.648508 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:54:26.915067 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m15:54:26.936653 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m15:54:26.938356 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:54:27.051836 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:54:27.253172 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m15:54:27.350257 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m15:54:27.464922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ec08c0d-bae4-49bd-bb7e-cf3b892dc39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113f7910>]}
[0m15:54:27.467402 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:54:27.469066 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:54:28.604607 [debug] [MainThread]: On master: COMMIT
[0m15:54:28.607095 [debug] [MainThread]: Using oracle connection "master"
[0m15:54:28.608036 [debug] [MainThread]: On master: COMMIT
[0m15:54:28.698238 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:54:28.699687 [debug] [MainThread]: On master: Close
[0m15:54:28.797062 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:54:28.798328 [info ] [MainThread]: 
[0m15:54:28.819590 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m15:54:28.820752 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m15:54:28.821764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m15:54:28.822317 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m15:54:28.850846 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m15:54:28.853439 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 15:54:28.822716 => 15:54:28.853077
[0m15:54:28.853966 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m15:54:28.883318 [info ] [Thread-1 (]: Python model materialization is incremental
[0m15:54:31.149770 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:54:31.150536 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzgwNzAsImlhdCI6MTY4NzQ3NDQ3MH0.VwN8OLtjaEA4pnaHypGhR6Rkl2Dn8sWDn7GTiIk_JAK_B30luK2UHeqwS3EUvZeXitSIKEnYppxXL8tuVhqUvYhe8SDkf1oWYSOZGloj_cTHOdLhp2rxE8Q5SQCwFwWBz8p0hSamWT_Z3QwiGyC9x-dZy7u2wJgKXNFi21QLseAvWpcn-B5G8IEUFY8FTRybO9tWUtObu3lEFkdtT4IMHCoEjb5AiLi3O7xlpcK8LoAnhiBhFtB4Fcuo0MjO4hz0KiqGGd2AQECOHTdNH3mKhdIn2q6bRt0ltHlXJJ2a_zFoQZH5aXB-kI9Zqut9lKi3wMq7DoVFnIYanHDnNKCIZQ!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info155428876666"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_225431 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_225431';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m15:54:31.151214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:31.151522 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:54:56.033946 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m15:54:56.038177 [info ] [Thread-1 (]: oracle adapter: OK
[0m15:54:56.048638 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:54:56.049600 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info155428876666')
        
      order by ordinal_position

  
[0m15:54:56.342697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:54:56.446397 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:54:56.447456 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m15:54:56.565885 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:54:56.670235 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:54:56.671016 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m15:54:56.794235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:54:56.915084 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m15:54:56.917171 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:54:56.917582 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info155428876666
    )
  
[0m15:54:57.567738 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m15:54:57.581874 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m15:54:57.582752 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:54:57.583142 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m15:54:57.675458 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:54:57.685400 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:54:57.685881 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info155428876666
[0m15:54:57.834934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:54:57.844969 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:54:57.845518 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info155428876666 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:54:57.957848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:54:57.976067 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 15:54:28.854205 => 15:54:57.975823
[0m15:54:57.976757 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m15:54:58.068458 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m15:54:58.161218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec08c0d-bae4-49bd-bb7e-cf3b892dc39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129cb3d0>]}
[0m15:54:58.162925 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 29.34s]
[0m15:54:58.163895 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m15:54:58.165079 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m15:54:58.165857 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m15:54:58.166798 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m15:54:58.167047 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m15:54:58.169339 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m15:54:58.170557 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 15:54:58.167210 => 15:54:58.170447
[0m15:54:58.170786 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m15:54:58.181848 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m15:54:58.182261 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m15:54:58.183737 [info ] [Thread-3 (]: Python model materialization is table
[0m15:54:58.184021 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m15:55:00.235949 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m15:55:00.237404 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzgwOTksImlhdCI6MTY4NzQ3NDQ5OX0.n1TGqzOw-T6W8gyutDx3yysDOw8jhrt45vK7gJe1u2TR-BGhzrQF1xIwK9OVV6TyzuKr26_yvMy011zRLT8tKFO1H3dVc24Ynw1nTTBVrdfYmhSsnW8H8r3Ec3tAvTYzVUzBQMoKfMyA6rFMV7cqwMTEtX860OtvSfEwI9R28TMVfrPTgq-djgiqoMPXQJDDYq6gjJKufZkLpWDGoWKKxo1b7kEx7fNB4QMi322EMhxF9LVh_uEaFguc6Rd4YC35UpAIitkY8ndXHPHRO4DXsUm9jlI-VG4pZeUQcWiRX0BxWBbBFmMUOPE6ktXRuhtIU37nEOxAOvPMtwrdQZ9N9w!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
        # y_pred = classifier.predict(x)
    
        # df["Shipping_City_Prediction"] = y_pred
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_225500 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_225500';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m15:55:00.238870 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:55:00.239409 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:56:01.935145 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 107
[0m15:56:01.937824 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m15:56:02.032282 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 15:54:58.170937 => 15:56:02.031700
[0m15:56:02.044067 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 107
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m15:56:02.046237 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec08c0d-bae4-49bd-bb7e-cf3b892dc39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112d9710>]}
[0m15:56:02.046706 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 63.88s]
[0m15:56:02.047002 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m15:56:02.048295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:02.048541 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:56:03.240134 [debug] [MainThread]: On master: COMMIT
[0m15:56:03.242115 [debug] [MainThread]: Using oracle connection "master"
[0m15:56:03.242862 [debug] [MainThread]: On master: COMMIT
[0m15:56:03.338926 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:56:03.341320 [debug] [MainThread]: On master: Close
[0m15:56:03.439338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:03.440253 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m15:56:03.440629 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m15:56:03.441060 [info ] [MainThread]: 
[0m15:56:03.441460 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 39.22 seconds (99.22s).
[0m15:56:03.442260 [debug] [MainThread]: Command end result
[0m15:56:03.451211 [info ] [MainThread]: 
[0m15:56:03.451615 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:56:03.451775 [info ] [MainThread]: 
[0m15:56:03.451930 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m15:56:03.452080 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m15:56:03.452219 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m15:56:03.452355 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m15:56:03.452486 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m15:56:03.452613 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m15:56:03.452738 [error] [MainThread]:   ORA-29276: transfer timeout
[0m15:56:03.452865 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m15:56:03.453407 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m15:56:03.453688 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m15:56:03.453927 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m15:56:03.454162 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m15:56:03.454385 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m15:56:03.454603 [error] [MainThread]:   ORA-06512: at line 107
[0m15:56:03.454776 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m15:56:03.454926 [info ] [MainThread]: 
[0m15:56:03.455097 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:56:03.455405 [debug] [MainThread]: Command `dbt run` failed at 15:56:03.455358 after 99.41 seconds
[0m15:56:03.455624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029eec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029ece10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112da1d0>]}
[0m15:56:03.455821 [debug] [MainThread]: Flushing usage events
[0m15:58:15.089355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108967c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108973d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108973f90>]}


============================== 15:58:15.091654 | 535e44f6-a090-4157-8d6b-edb2bf91cf50 ==============================
[0m15:58:15.091654 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:58:15.091989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:58:15.137721 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:58:15.159113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '535e44f6-a090-4157-8d6b-edb2bf91cf50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107238e50>]}
[0m15:58:15.164986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '535e44f6-a090-4157-8d6b-edb2bf91cf50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109095f90>]}
[0m15:58:15.197806 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:58:15.236114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:58:15.236556 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_python.py
[0m15:58:15.258357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '535e44f6-a090-4157-8d6b-edb2bf91cf50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109153b90>]}
[0m15:58:15.264410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '535e44f6-a090-4157-8d6b-edb2bf91cf50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109235c50>]}
[0m15:58:15.264742 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m15:58:15.264921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '535e44f6-a090-4157-8d6b-edb2bf91cf50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c5310>]}
[0m15:58:15.265709 [info ] [MainThread]: 
[0m15:58:15.266134 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:58:15.266749 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m15:58:15.271718 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m15:58:15.271990 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:58:15.272157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:15.272329 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:58:16.705721 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m15:58:16.810296 [debug] [ThreadPool]: On list_None: Close
[0m15:58:16.913182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m15:58:16.920966 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m15:58:16.921422 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m15:58:16.921651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:16.921875 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:58:18.230509 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m15:58:18.244869 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m15:58:18.245736 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:58:18.364979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:58:18.690132 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m15:58:18.789726 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m15:58:18.898874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '535e44f6-a090-4157-8d6b-edb2bf91cf50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fc110>]}
[0m15:58:18.900030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:18.900542 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:58:20.101327 [debug] [MainThread]: On master: COMMIT
[0m15:58:20.103453 [debug] [MainThread]: Using oracle connection "master"
[0m15:58:20.104052 [debug] [MainThread]: On master: COMMIT
[0m15:58:20.202412 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:58:20.203880 [debug] [MainThread]: On master: Close
[0m15:58:20.309819 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:20.310933 [info ] [MainThread]: 
[0m15:58:20.317568 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m15:58:20.318007 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m15:58:20.318475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m15:58:20.318678 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m15:58:20.334145 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m15:58:20.335114 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 15:58:20.318827 => 15:58:20.335015
[0m15:58:20.335347 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m15:58:20.366733 [info ] [Thread-1 (]: Python model materialization is incremental
[0m15:58:22.442177 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:58:22.443316 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzgzMDEsImlhdCI6MTY4NzQ3NDcwMX0.kMbQRFqWP0gHXHOM46DjnnNBABUjdbPDE7MVlld5-lDuAAt-n5AYU6kJaiZW3JgWSksnx1h-ZPNa2b7kHgQrCY05HFnY4y7LCLRSGNwYjrZyxO8yzO-7RaG_d7WKJvPBJzpZ_GNoGPBJTg7GCTSFPVYHFzpYIp4XPNICONS7CzL947YYdFvA-8rqSwXA1-yVrwabKgpM1bNUgj-pWvHbITW5XFIM3m_uTk5bpVP2rJ328DXBMwn_-DbrbLQqtEDm-kyH812bYyzwuh-megbBub74Bxhf-H8lSTMDGQhX9LtewBBiNrZNQoEOJo13OUbJnCoqDq04lGbTiVJMePfHAg!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info155820356821"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_225822 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_225822';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m15:58:22.444477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:22.445031 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:58:47.960976 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m15:58:47.965289 [info ] [Thread-1 (]: oracle adapter: OK
[0m15:58:47.975273 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:58:47.976145 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info155820356821')
        
      order by ordinal_position

  
[0m15:58:48.243501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:58:48.346807 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:58:48.347181 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m15:58:48.530364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:58:48.634138 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:58:48.634509 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m15:58:48.815617 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:58:48.927473 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m15:58:48.928349 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:58:48.928576 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info155820356821
    )
  
[0m15:58:49.601110 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m15:58:49.610364 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m15:58:49.610691 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:58:49.610882 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m15:58:49.773975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:58:49.783680 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:58:49.784277 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info155820356821
[0m15:58:50.032878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:58:50.042246 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m15:58:50.042918 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info155820356821 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:58:50.206086 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:58:50.217966 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 15:58:20.335496 => 15:58:50.217804
[0m15:58:50.218388 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m15:58:50.313512 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m15:58:50.414914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '535e44f6-a090-4157-8d6b-edb2bf91cf50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109245f90>]}
[0m15:58:50.416156 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 30.10s]
[0m15:58:50.417032 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m15:58:50.418212 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m15:58:50.418959 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m15:58:50.419667 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m15:58:50.419906 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m15:58:50.422280 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m15:58:50.423179 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 15:58:50.420052 => 15:58:50.423034
[0m15:58:50.423445 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m15:58:50.431186 [debug] [Thread-3 (]: Preexisting intermediate relation=None
[0m15:58:50.431526 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m15:58:50.432727 [info ] [Thread-3 (]: Python model materialization is table
[0m15:58:50.432941 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m15:58:52.560782 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m15:58:52.562154 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc0NzgzMzEsImlhdCI6MTY4NzQ3NDczMX0.SaogUBTkr82nfYTrgrTY8Nvyk-y-g_fK2VjvyBQrL1H9Thzjsi7fhVp-WGPRZCkxFetKYScNDTS8wbamBG77VuLWM3TY-zpET_vLl6WPWWldoXltXC2yVcuku2LSTmrrZxbI3S0cm25tfGutN4g7oVzeIe_PwvYQwHS04PHCWPLIA7uiIlZxlm3p14Hu_q9DUdRg5k4CJkn4szqloKnpIBAh7GW6NYVvDy6aNDW4ub_gi8AVw-OXNpqEfBg_rAQZqPwIn_IeA1GkaEQJsDOhbs81I_ki0ax66xAllZkQFT_2CUaveJ6z36BEPfgs2aOiavFimPFafuOC71rnfs7wPA!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
    
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_225852 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_225852';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m15:58:52.563665 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:58:52.564356 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:59:54.511953 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
ORA-06512: at "SYS.DBMS_LOB", line 835
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
ORA-29273: HTTP request failed
ORA-06512: at "SYS.UTL_HTTP", line 1378
ORA-29276: transfer timeout
ORA-06512: at "SYS.UTL_HTTP", line 712
ORA-06512: at "SYS.UTL_HTTP", line 1368
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 105
[0m15:59:54.514757 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m15:59:54.617391 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 15:58:50.423599 => 15:59:54.616878
[0m15:59:54.628663 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
  ORA-06512: at "SYS.DBMS_LOB", line 835
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
  ORA-29273: HTTP request failed
  ORA-06512: at "SYS.UTL_HTTP", line 1378
  ORA-29276: transfer timeout
  ORA-06512: at "SYS.UTL_HTTP", line 712
  ORA-06512: at "SYS.UTL_HTTP", line 1368
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 105
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m15:59:54.630684 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '535e44f6-a090-4157-8d6b-edb2bf91cf50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109298dd0>]}
[0m15:59:54.631250 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 64.21s]
[0m15:59:54.631694 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m15:59:54.632979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:54.633328 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m15:59:55.937515 [debug] [MainThread]: On master: COMMIT
[0m15:59:55.939668 [debug] [MainThread]: Using oracle connection "master"
[0m15:59:55.940685 [debug] [MainThread]: On master: COMMIT
[0m15:59:56.042092 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:59:56.044544 [debug] [MainThread]: On master: Close
[0m15:59:56.150936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:56.151868 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m15:59:56.152326 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m15:59:56.152852 [info ] [MainThread]: 
[0m15:59:56.153334 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 1 minutes and 40.89 seconds (100.89s).
[0m15:59:56.154315 [debug] [MainThread]: Command end result
[0m15:59:56.164859 [info ] [MainThread]: 
[0m15:59:56.165275 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:59:56.165561 [info ] [MainThread]: 
[0m15:59:56.165847 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m15:59:56.166127 [error] [MainThread]:   ORA-06502: PL/SQL: numeric or value error: invalid LOB locator specified: ORA-22275
[0m15:59:56.166391 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_LOB", line 835
[0m15:59:56.166651 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 336
[0m15:59:56.166915 [error] [MainThread]:   ORA-29273: HTTP request failed
[0m15:59:56.167167 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1378
[0m15:59:56.167421 [error] [MainThread]:   ORA-29276: transfer timeout
[0m15:59:56.167694 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 712
[0m15:59:56.167944 [error] [MainThread]:   ORA-06512: at "SYS.UTL_HTTP", line 1368
[0m15:59:56.168196 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 113
[0m15:59:56.168439 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m15:59:56.168657 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m15:59:56.168872 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m15:59:56.169083 [error] [MainThread]:   ORA-06512: at line 105
[0m15:59:56.169296 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m15:59:56.169523 [info ] [MainThread]: 
[0m15:59:56.169781 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:59:56.170265 [debug] [MainThread]: Command `dbt run` failed at 15:59:56.170191 after 101.10 seconds
[0m15:59:56.170606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10899d410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f620d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052aac50>]}
[0m15:59:56.170836 [debug] [MainThread]: Flushing usage events
[0m13:02:22.920293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234f7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235175d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123517fd0>]}


============================== 13:02:22.945131 | f87fbfa5-4429-479e-bd55-8387b722841e ==============================
[0m13:02:22.945131 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:02:22.945754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Desktop/oracle-dbt', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:02:23.840352 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:02:23.929687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f87fbfa5-4429-479e-bd55-8387b722841e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123529a90>]}
[0m13:02:23.939407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f87fbfa5-4429-479e-bd55-8387b722841e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c28f90>]}
[0m13:02:24.003409 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:02:26.573793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:02:26.574399 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:02:26.581666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f87fbfa5-4429-479e-bd55-8387b722841e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12354a690>]}
[0m13:02:26.794319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f87fbfa5-4429-479e-bd55-8387b722841e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c581d0>]}
[0m13:02:26.796947 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 351 macros, 0 operations, 1 seed file, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:02:26.797462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f87fbfa5-4429-479e-bd55-8387b722841e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123543d10>]}
[0m13:02:26.799009 [info ] [MainThread]: 
[0m13:02:26.799738 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:02:26.800783 [debug] [ThreadPool]: Acquiring new oracle connection 'list_None'
[0m13:02:26.809186 [debug] [ThreadPool]: Using oracle connection "list_None"
[0m13:02:26.809702 [debug] [ThreadPool]: On list_None: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:02:26.810007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:26.810317 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m13:02:28.471136 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m13:02:28.566657 [debug] [ThreadPool]: On list_None: Close
[0m13:02:28.665169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_None, now list_None_FAWDBTCORE)
[0m13:02:28.671390 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:02:28.671958 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */

    select SYS_CONTEXT('userenv', 'DB_NAME') FROM DUAL
  
[0m13:02:28.672258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:28.672562 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m13:02:29.881175 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m13:02:29.890440 [debug] [ThreadPool]: Using oracle connection "list_None_FAWDBTCORE"
[0m13:02:29.891471 [debug] [ThreadPool]: On list_None_FAWDBTCORE: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_None_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:02:30.642279 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m13:02:30.777222 [debug] [ThreadPool]: On list_None_FAWDBTCORE: ROLLBACK
[0m13:02:30.866086 [debug] [ThreadPool]: On list_None_FAWDBTCORE: Close
[0m13:02:30.968826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f87fbfa5-4429-479e-bd55-8387b722841e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c0d950>]}
[0m13:02:30.969895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:30.970287 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m13:02:33.260571 [debug] [MainThread]: On master: COMMIT
[0m13:02:33.261779 [debug] [MainThread]: Using oracle connection "master"
[0m13:02:33.263213 [debug] [MainThread]: On master: COMMIT
[0m13:02:33.359341 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:02:33.360755 [debug] [MainThread]: On master: Close
[0m13:02:33.478477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:02:33.479640 [info ] [MainThread]: 
[0m13:02:33.513405 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_web_order_info
[0m13:02:33.514342 [info ] [Thread-1 (]: 1 of 2 START python incremental model FAWDBTCORE.stg_web_order_info ............ [RUN]
[0m13:02:33.515432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_FAWDBTCORE, now model.oracle_dbt.stg_web_order_info)
[0m13:02:33.515833 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_web_order_info
[0m13:02:33.540709 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_order_info"
[0m13:02:33.579513 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (compile): 13:02:33.516064 => 13:02:33.579192
[0m13:02:33.579977 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_web_order_info
[0m13:02:33.609968 [info ] [Thread-1 (]: Python model materialization is incremental
[0m13:02:36.519755 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:02:36.520615 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc1NTQxNTUsImlhdCI6MTY4NzU1MDU1NX0.AreWNH5BiLOHaoAKvxrlWnmT1BVzvYvOKIq-aukDv7SuJzIJlytFbmgBy8QDzOd_ruK7OU2KlqyYGCuVmAHVx4hUSPtriw_lYSDnDdvRhub36ea3v9nkhZZ7uy5GhNU0a_0kLiGK3qtzIy_4PiMYA1FfDDxdgYnTRHXB1vTxj4OoyXu9kffbZ4I-h9Awb4rGX1QqScCsZtREF4yLG8xyx3lUd30nkT_rR7hKzMZ6EGs63v1iuHJWmefeyZ72cTL-tHvd9hDkRfqg7_PBpSNh0j-6iTJ3f0j7fSdmUSRdijufh_QII4g9K6kyuHkn4KWHfQmYv7CmjaBC8zhNaqwALw!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('stg_web_order_info_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {"FAWDBTCORE.web_order_info": "FAWDBTCORE.web_order_info"}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "stg_web_order_info"
        def __repr__(self):
            return "FAWDBTCORE.stg_web_order_info"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = True

    def model(dbt, session):
    
        dbt.config(materialized="incremental")
    
        s_df = dbt.source("FAWDBTCORE", "web_order_info")
    
        df = s_df.pull()
    
        return df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    # incremental materialization
    
    table_name = "o$pt_stg_web_order_info130233602752"
    
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_200236 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''stg_web_order_info_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_stg_web_order_info_tmp_200236';
                   sys.pyqScriptDrop('stg_web_order_info_dbt_py_script');
                END;
        
[0m13:02:36.521536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:36.521927 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m13:03:03.035665 [debug] [Thread-1 (]: SQL status: OK in 27.0 seconds
[0m13:03:03.037925 [info ] [Thread-1 (]: oracle adapter: OK
[0m13:03:03.064175 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:03:03.065632 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('o$pt_stg_web_order_info130233602752')
        
      order by ordinal_position

  
[0m13:03:03.340110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:03:03.442359 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:03:03.444806 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('stg_web_order_info')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:03:03.649891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:03:03.768789 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:03:03.770450 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      with columns as (
        select
            SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
            owner table_schema,
            table_name,
            column_name,
            data_type,
            data_type_mod,
            decode(data_type_owner, null, TO_CHAR(null), SYS_CONTEXT('userenv', 'DB_NAME')) domain_catalog,
            data_type_owner domain_schema,
            data_length character_maximum_length,
            data_length character_octet_length,
            data_length,
            data_precision numeric_precision,
            data_scale numeric_scale,
            nullable is_nullable,
            column_id ordinal_position,
            default_length,
            data_default column_default,
            num_distinct,
            low_value,
            high_value,
            density,
            num_nulls,
            num_buckets,
            last_analyzed,
            sample_size,
            SYS_CONTEXT('userenv', 'DB_NAME') character_set_catalog,
            'SYS' character_set_schema,
            SYS_CONTEXT('userenv', 'DB_NAME') collation_catalog,
            'SYS' collation_schema,
            character_set_name,
            char_col_decl_length,
            global_stats,
            user_stats,
            avg_col_len,
            char_length,
            char_used,
            v80_fmt_image,
            data_upgraded,
            histogram
          from sys.all_tab_columns
      )
      select
          column_name as "name",
          data_type as "type",
          char_length as "character_maximum_length",
          numeric_precision as "numeric_precision",
          numeric_scale as "numeric_scale"
      from columns
      where upper(table_name) = upper('STG_WEB_ORDER_INFO')
        
        and upper(table_schema) = upper('FAWDBTCORE')
        
      order by ordinal_position

  
[0m13:03:03.963387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:03:04.099376 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_order_info"
[0m13:03:04.106926 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:03:04.107439 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */

      insert  into  FAWDBTCORE.stg_web_order_info (ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE)
    (
       select ORDER_ID, PRODUCT, PRODUCT_ID, PRICE, QUANTITY, SHIPPING_CITY, ORDER_DATE, CUSTOMER_ID, CATEGORY, PAYMENT_TYPE
       from o$pt_stg_web_order_info130233602752
    )
  
[0m13:03:04.750030 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:03:04.769614 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:03:04.770609 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:03:04.771104 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: COMMIT
[0m13:03:04.875901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:03:04.887113 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:03:04.888504 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
truncate table o$pt_stg_web_order_info130233602752
[0m13:03:05.071719 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:03:05.084437 [debug] [Thread-1 (]: Using oracle connection "model.oracle_dbt.stg_web_order_info"
[0m13:03:05.085461 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_order_info"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table o$pt_stg_web_order_info130233602752 cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:03:05.284822 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:03:05.310442 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_web_order_info (execute): 13:02:33.580206 => 13:03:05.310138
[0m13:03:05.311015 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: ROLLBACK
[0m13:03:05.401729 [debug] [Thread-1 (]: On model.oracle_dbt.stg_web_order_info: Close
[0m13:03:05.501126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87fbfa5-4429-479e-bd55-8387b722841e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ecfbd0>]}
[0m13:03:05.504202 [info ] [Thread-1 (]: 1 of 2 OK created python incremental model FAWDBTCORE.stg_web_order_info ....... [[32mOK[0m in 31.99s]
[0m13:03:05.506084 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_web_order_info
[0m13:03:05.509939 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_python
[0m13:03:05.511875 [info ] [Thread-3 (]: 2 of 2 START python table model FAWDBTCORE.web_events_python ................... [RUN]
[0m13:03:05.514143 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.web_events_python'
[0m13:03:05.515003 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_python
[0m13:03:05.519163 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_python"
[0m13:03:05.534683 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (compile): 13:03:05.515479 => 13:03:05.534429
[0m13:03:05.535122 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_python
[0m13:03:05.548926 [debug] [Thread-3 (]: Preexisting intermediate relation=FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP
[0m13:03:05.549394 [debug] [Thread-3 (]: Preexisting backup relation=None
[0m13:03:05.552264 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:03:05.552639 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP table FAWDBTCORE.WEB_EVENTS_PYTHON__DBT_TMP cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m13:03:05.552973 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:03:05.553291 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m13:03:06.987893 [debug] [Thread-3 (]: SQL status: OK in 1.0 seconds
[0m13:03:06.992623 [info ] [Thread-3 (]: Python model materialization is table
[0m13:03:07.002124 [debug] [Thread-3 (]: Writing runtime python for node "model.oracle_dbt.web_events_python"
[0m13:03:09.363731 [debug] [Thread-3 (]: Using oracle connection "model.oracle_dbt.web_events_python"
[0m13:03:09.366783 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_python"} */
 
                BEGIN
                   sys.pyqSetAuthToken('eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJGQVdEQlRDT1JFIiwidGVuYW50X25hbWUiOiJPQ0lEMS5URU5BTkNZLk9DMS4uQUFBQUFBQUE3TlRLRVRQS0lFQVBMVlpXVU5SWkdSNlNYRFc2Mk5ZTjVGUktVSjRHSFYzQlBaWUJHTDJRIiwiZGF0YWJhc2VfbmFtZSI6IkNGRzU3QURXIiwicGh5c2ljYWxfZGF0YWJhc2VfbmFtZSI6IlRWMUxHOFBEVVQ0TjhWQ19DRkc1N0FEVyIsImNsb3VkX2RhdGFiYXNlX25hbWUiOiJPQ0lEMS5BVVRPTk9NT1VTREFUQUJBU0UuT0MxLklBRC5BTlVXQ0xKVEdHVkNWUUFBTE9TTlNGQUFMRlFUMkpVSjRJQ0lMSTJGTlFXQUZaM1I1SlZUUktTRDY3M1EiLCJyb2xlcyI6Ilt7XCJyb2xlXCI6XCJPTUxfREVWRUxPUEVSXCIsXCJjb21tb25cIjpmYWxzZX1dIiwiaXNzIjoiRkUwRTk1NjcwMzk3MTExMEUwNTM5MjEzMDAwQUU2QjQiLCJleHAiOjE2ODc1NTQxODcsImlhdCI6MTY4NzU1MDU4N30.NbB3dvKkuDHuxAUdvEKBe-8swLJHydw5QbW8Jl7gNv89gP7M_RN2ld6xNLkVTSLNtm4fBJy_uspxAjO7nZo7HlHBMnX2x_edqQOAWez-faSCj3uTcpn0ST8WdrQ5y9vhpXPQPsekXx0Sr6DmRvrzCdLud8GIMnjH6W3IOt-_0PD19Lx4mI9FZ1fz1a6kaxKPWYqj7rtRLojrDYVBhJkID8obEhL1ihJOLf_2LQ36x5JYdcixXnF2MOC7TdpAuWk94m22Y9ZxaYhP7eyAbA1rfIZqIOIyUAY9bCHaRGfgz7fomSND1Cdw02T86nLPXD69rnxzhPevrBMbRs_Ph5aZ9A!5qrdm/3ASaE49piUv7qwXg==');
                   sys.pyqScriptCreate('web_events_python_dbt_py_script', 'def main():
    import oml
    import pandas as pd
    def ref(*args, **kwargs):
        refs = {"stg_web_order_info": "FAWDBTCORE.stg_web_order_info"}
        key = ".".join(args)
        version = kwargs.get("v") or kwargs.get("version")
        if version:
            key += f".v{version}"
        schema, table = refs[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        dbt_load_df_function = kwargs.get("dbt_load_df_function")
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    def source(*args, dbt_load_df_function):
        sources = {}
        key = ".".join(args)
        schema, table = sources[key].split(".")
        # Use oml.sync(schema=schema, table=table)
        return dbt_load_df_function(schema=schema.upper(), table=table.upper())


    config_dict = {}


    class config:
        def __init__(self, *args, **kwargs):
            pass

        @staticmethod
        def get(key, default=None):
            return config_dict.get(key, default)

    class this:
        """dbt.this() or dbt.this.identifier"""
        database = "None"
        schema = "FAWDBTCORE"
        identifier = "web_events_python"
        def __repr__(self):
            return "FAWDBTCORE.web_events_python"


    class dbtObj:
        def __init__(self, load_df_function) -> None:
            self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
            self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
            self.config = config
            self.this = this()
            self.is_incremental = False

    from sklearn.model_selection import train_test_split
    from sklearn.preprocessing import LabelEncoder
    from sklearn.tree import DecisionTreeClassifier
    def model(dbt, session):
    
        dbt.config(materialized="table")
    
        s_df = dbt.ref( "stg_web_order_info")
        df = s_df.pull()
    
        x = df[["ORDER_ID", "PRODUCT_ID", "PRICE" , "QUANTITY", "CUSTOMER_ID"]]  
        y = df["SHIPPING_CITY"]  
    
        label_encoder = LabelEncoder()
        y_encoded = label_encoder.fit_transform(y)
    
        X_train, X_test, y_train, y_test = train_test_split(x, y_encoded, test_size=0.2, random_state=42)
        classifier = DecisionTreeClassifier()
        classifier.fit(X_train, y_train)
    
        y_pred = classifier.predict(X_test)
    
        y_pred_decoded = label_encoder.inverse_transform(y_pred)
    
        accuracy = classifier.score(X_test, y_test)
        res_df  = pd.DataFrame(data={"Shipping_City_Prediction": y_pred_decoded, "Shipping_City_actual": y_test,  "Accuracy": accuracy})
    
        
        return res_df





    def materialize(df, table, session):
        if isinstance(df, pd.core.frame.DataFrame):
           oml.create(df, table=table)
        elif isinstance(df, oml.core.frame.DataFrame):
           df.materialize(table=table)

    dbt = dbtObj(load_df_function=oml.sync)
    final_df = model(dbt, session=oml)

    
    
    table_name = f"{dbt.this.identifier}__dbt_tmp"
    
    materialize(final_df, table=table_name.upper(), session=oml)
    return pd.DataFrame.from_dict({"result": [1]})', FALSE, TRUE);
                   EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE o$pt_dbt_pyqeval_web_events_python_tmp_200309 
                                AS SELECT * FROM TABLE(pyqEval(par_lst => NULL, 
                                                               out_fmt => ''{"result":"number"}'',
                                                               scr_name => ''web_events_python_dbt_py_script'', 
                                                               scr_owner => NULL))';
                   EXECUTE IMMEDIATE 'DROP TABLE o$pt_dbt_pyqeval_web_events_python_tmp_200309';
                   sys.pyqScriptDrop('web_events_python_dbt_py_script');
                END;
        
[0m13:03:12.976764 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-20100: HTTP response status code 500, 'errorMessage' check http doc for error code
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 198
ORA-06512: at "SYS.DBMS_SQL", line 1726
ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
ORA-06512: at line 105
[0m13:03:12.978157 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_python: Close
[0m13:03:13.074912 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_python (execute): 13:03:05.535862 => 13:03:13.074428
[0m13:03:13.220665 [debug] [Thread-3 (]: Database Error in model web_events_python (models/web_events_python.py)
  ORA-20100: HTTP response status code 500, 'errorMessage' check http doc for error code
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
  ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 198
  ORA-06512: at "SYS.DBMS_SQL", line 1726
  ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
  ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
  ORA-06512: at line 105
  compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:03:13.224037 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87fbfa5-4429-479e-bd55-8387b722841e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f47d90>]}
[0m13:03:13.225702 [error] [Thread-3 (]: 2 of 2 ERROR creating python table model FAWDBTCORE.web_events_python .......... [[31mERROR[0m in 7.71s]
[0m13:03:13.226556 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_python
[0m13:03:13.231237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:03:13.232010 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_medium'
[0m13:03:14.392909 [debug] [MainThread]: On master: COMMIT
[0m13:03:14.395136 [debug] [MainThread]: Using oracle connection "master"
[0m13:03:14.397759 [debug] [MainThread]: On master: COMMIT
[0m13:03:14.492243 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:03:14.496678 [debug] [MainThread]: On master: Close
[0m13:03:14.608574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:14.610130 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_order_info' was properly closed.
[0m13:03:14.610576 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_python' was properly closed.
[0m13:03:14.611758 [info ] [MainThread]: 
[0m13:03:14.612350 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 47.81 seconds (47.81s).
[0m13:03:14.614194 [debug] [MainThread]: Command end result
[0m13:03:14.661269 [info ] [MainThread]: 
[0m13:03:14.665016 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:03:14.666251 [info ] [MainThread]: 
[0m13:03:14.666801 [error] [MainThread]: [33mDatabase Error in model web_events_python (models/web_events_python.py)[0m
[0m13:03:14.667506 [error] [MainThread]:   ORA-20100: HTTP response status code 500, 'errorMessage' check http doc for error code
[0m13:03:14.668084 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 337
[0m13:03:14.668331 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$FETCHAPI", line 198
[0m13:03:14.668548 [error] [MainThread]:   ORA-06512: at "SYS.DBMS_SQL", line 1726
[0m13:03:14.668753 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQ$ETFETCH", line 75
[0m13:03:14.668956 [error] [MainThread]:   ORA-06512: at "PYQSYS.PYQEVALIMPL", line 73
[0m13:03:14.669160 [error] [MainThread]:   ORA-06512: at line 105
[0m13:03:14.669357 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_python.py
[0m13:03:14.669590 [info ] [MainThread]: 
[0m13:03:14.669849 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:03:14.670451 [debug] [MainThread]: Command `dbt run` failed at 13:03:14.670361 after 51.99 seconds
[0m13:03:14.670854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12352b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122201b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105338e10>]}
[0m13:03:14.671220 [debug] [MainThread]: Flushing usage events
