[0m13:21:39.372673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb3c10>]}


============================== 13:21:39.386591 | 006b260a-2eca-4338-bc46-e40bafd267c4 ==============================
[0m13:21:39.386591 [info ] [MainThread]: Running with dbt=1.5.0
[0m13:21:39.387084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:21:39.387589 [info ] [MainThread]: dbt version: 1.5.0
[0m13:21:39.388114 [info ] [MainThread]: python version: 3.11.3
[0m13:21:39.388495 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m13:21:39.388723 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m13:21:39.388942 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/.dbt/profiles.yml
[0m13:21:39.389156 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m13:21:39.389349 [info ] [MainThread]: Configuration:
[0m13:21:39.392892 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m13:21:39.405839 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:21:39.406187 [info ] [MainThread]: Required dependencies:
[0m13:21:39.406454 [debug] [MainThread]: Executing "git --help"
[0m13:21:39.416874 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:21:39.417417 [debug] [MainThread]: STDERR: "b''"
[0m13:21:39.417595 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:21:39.417772 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:21:39.417904 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'oracle_dbt'


[0m13:21:39.418436 [debug] [MainThread]: Command `dbt debug` failed at 13:21:39.418366 after 0.18 seconds
[0m13:21:39.418718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633bc10>]}
[0m13:21:39.418995 [debug] [MainThread]: Flushing usage events
[0m13:49:13.574406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bd8d0>]}


============================== 13:49:13.576823 | c08dd2b1-d085-45d8-b74f-c0cc81c46002 ==============================
[0m13:49:13.576823 [info ] [MainThread]: Running with dbt=1.5.0
[0m13:49:13.577161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sathishs/Downloads/profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:49:13.577433 [info ] [MainThread]: dbt version: 1.5.0
[0m13:49:13.577609 [info ] [MainThread]: python version: 3.11.3
[0m13:49:13.577784 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m13:49:13.577932 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m13:49:13.578146 [info ] [MainThread]: Using profiles.yml file at /Users/sathishs/Downloads/profiles/profiles.yml
[0m13:49:13.578415 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m13:49:13.578572 [info ] [MainThread]: Configuration:
[0m13:49:13.578736 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m13:49:13.597902 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:49:13.598182 [info ] [MainThread]: Required dependencies:
[0m13:49:13.598400 [debug] [MainThread]: Executing "git --help"
[0m13:49:13.607177 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:49:13.607849 [debug] [MainThread]: STDERR: "b''"
[0m13:49:13.608020 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:49:13.608215 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:49:13.608367 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/sathishs/Downloads/profiles/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m13:49:13.608894 [debug] [MainThread]: Command `dbt debug` failed at 13:49:13.608822 after 0.06 seconds
[0m13:49:13.609183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10320aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b3fd0>]}
[0m13:49:13.609460 [debug] [MainThread]: Flushing usage events
[0m13:49:49.215329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196f54d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119700e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197014d0>]}


============================== 13:49:49.217930 | 164e0f02-61ef-423a-bd6a-96068c8f5798 ==============================
[0m13:49:49.217930 [info ] [MainThread]: Running with dbt=1.5.0
[0m13:49:49.218300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:49:49.218601 [info ] [MainThread]: dbt version: 1.5.0
[0m13:49:49.218797 [info ] [MainThread]: python version: 3.11.3
[0m13:49:49.218993 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m13:49:49.219165 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m13:49:49.219431 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/Downloads/profiles/profiles.yml
[0m13:49:49.219708 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m13:49:49.219877 [info ] [MainThread]: Configuration:
[0m13:49:49.220055 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m13:49:49.242808 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:49:49.243113 [info ] [MainThread]: Required dependencies:
[0m13:49:49.243339 [debug] [MainThread]: Executing "git --help"
[0m13:49:49.254290 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:49:49.254859 [debug] [MainThread]: STDERR: "b''"
[0m13:49:49.255058 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:49:49.255236 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:49:49.255383 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/rosreen/Downloads/profiles/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m13:49:49.255925 [debug] [MainThread]: Command `dbt debug` failed at 13:49:49.255861 after 0.06 seconds
[0m13:49:49.256183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196f7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196f7cd0>]}
[0m13:49:49.256432 [debug] [MainThread]: Flushing usage events
[0m13:50:26.780800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102992250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d174d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d17ad0>]}


============================== 13:50:26.783552 | f39878f3-8f3b-4634-bb6e-27112bebfe12 ==============================
[0m13:50:26.783552 [info ] [MainThread]: Running with dbt=1.5.0
[0m13:50:26.783942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:50:26.784276 [info ] [MainThread]: dbt version: 1.5.0
[0m13:50:26.784519 [info ] [MainThread]: python version: 3.11.3
[0m13:50:26.784719 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m13:50:26.784892 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m13:50:26.785234 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/Downloads/profiles.yml
[0m13:50:26.785463 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m13:50:26.785634 [info ] [MainThread]: Configuration:
[0m13:50:30.423621 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:50:30.566810 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:50:30.582478 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:50:30.582912 [info ] [MainThread]: Required dependencies:
[0m13:50:30.583266 [debug] [MainThread]: Executing "git --help"
[0m13:50:30.595100 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:50:30.595810 [debug] [MainThread]: STDERR: "b''"
[0m13:50:30.596001 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:50:30.596218 [info ] [MainThread]: Connection:
[0m13:50:30.596446 [info ] [MainThread]:   user: FAWDBTCORE
[0m13:50:30.596621 [info ] [MainThread]:   database: FAWDBTCORE
[0m13:50:30.596784 [info ] [MainThread]:   schema: FAWDBTCORE
[0m13:50:30.596948 [info ] [MainThread]:   protocol: None
[0m13:50:30.597110 [info ] [MainThread]:   host: None
[0m13:50:30.597268 [info ] [MainThread]:   port: None
[0m13:50:30.597426 [info ] [MainThread]:   tns_name: cfg57adw_low
[0m13:50:30.597589 [info ] [MainThread]:   service: None
[0m13:50:30.597746 [info ] [MainThread]:   connection_string: None
[0m13:50:30.597906 [info ] [MainThread]:   shardingkey: []
[0m13:50:30.598064 [info ] [MainThread]:   supershardingkey: []
[0m13:50:30.598220 [info ] [MainThread]:   cclass: None
[0m13:50:30.598378 [info ] [MainThread]:   purity: None
[0m13:50:30.598531 [info ] [MainThread]:   retry_count: 1
[0m13:50:30.598694 [info ] [MainThread]:   retry_delay: 3
[0m13:50:30.629252 [debug] [MainThread]: Acquiring new oracle connection 'debug'
[0m13:50:30.629994 [debug] [MainThread]: oracle adapter: Using oracle connection "debug".
[0m13:50:30.630157 [debug] [MainThread]: oracle adapter: On debug: fselect 1 as id from dual
[0m13:50:30.630322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:30.630490 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:32.710907 [debug] [MainThread]: oracle adapter: SQL status: OK in 2.077510118484497 seconds
[0m13:50:32.714004 [debug] [MainThread]: On debug: Close
[0m13:50:32.816003 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:50:32.817148 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:50:32.818473 [debug] [MainThread]: Command `dbt debug` succeeded at 13:50:32.818199 after 6.08 seconds
[0m13:50:32.819074 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:50:32.819629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021a2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100cd8d50>]}
[0m13:50:32.820483 [debug] [MainThread]: Flushing usage events
[0m13:50:39.916105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ffe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045fffd0>]}


============================== 13:50:39.918686 | dd1edfca-6920-4006-86e6-f72464f8c539 ==============================
[0m13:50:39.918686 [info ] [MainThread]: Running with dbt=1.5.0
[0m13:50:39.919012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Downloads/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:50:39.993391 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m13:50:40.017459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd1edfca-6920-4006-86e6-f72464f8c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f2650>]}
[0m13:50:40.042557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd1edfca-6920-4006-86e6-f72464f8c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ce410>]}
[0m13:50:40.062064 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m13:50:40.062604 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:50:40.062843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd1edfca-6920-4006-86e6-f72464f8c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104109e50>]}
[0m13:50:44.207285 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m13:50:44.213697 [debug] [MainThread]: 1699: static parser successfully parsed event_counts_by_platform.sql
[0m13:50:44.215574 [debug] [MainThread]: 1699: static parser successfully parsed average_duration_by_platform_country.sql
[0m13:50:44.217425 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m13:50:44.219181 [debug] [MainThread]: 1699: static parser successfully parsed ranked_web_events.sql
[0m13:50:44.221039 [debug] [MainThread]: 1699: static parser successfully parsed frequent_web_users.sql
[0m13:50:44.223203 [debug] [MainThread]: 1699: static parser successfully parsed frequent_mobile_users.sql
[0m13:50:44.225088 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
[0m13:50:44.226698 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_web_events.sql
[0m13:50:44.228253 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m13:50:44.255641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd1edfca-6920-4006-86e6-f72464f8c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d79550>]}
[0m13:50:44.259589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd1edfca-6920-4006-86e6-f72464f8c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f067d0>]}
[0m13:50:44.259816 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:50:44.259993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd1edfca-6920-4006-86e6-f72464f8c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10462e9d0>]}
[0m13:50:44.261089 [info ] [MainThread]: 
[0m13:50:44.261558 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m13:50:44.262309 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m13:50:44.267618 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m13:50:44.267910 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m13:50:44.268055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:44.268184 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:45.677667 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.4095101356506348 seconds
[0m13:50:45.781783 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m13:50:45.886163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m13:50:45.893389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:45.893889 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:47.135140 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m13:50:47.136668 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m13:50:47.763291 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.6256179809570312 seconds
[0m13:50:47.909665 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m13:50:48.011480 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m13:50:48.132198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd1edfca-6920-4006-86e6-f72464f8c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dac090>]}
[0m13:50:48.133010 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:48.133431 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:49.376838 [debug] [MainThread]: On master: COMMIT
[0m13:50:49.378280 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m13:50:49.378774 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m13:50:49.480913 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10090422630310059 seconds
[0m13:50:49.482635 [debug] [MainThread]: On master: Close
[0m13:50:49.595533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:50:49.596206 [info ] [MainThread]: 
[0m13:50:49.660434 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m13:50:49.660766 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m13:50:49.661004 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m13:50:49.661377 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m13:50:49.661783 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m13:50:49.662295 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m13:50:49.663025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m13:50:49.663533 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m13:50:49.664154 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m13:50:49.664490 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m13:50:49.664753 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m13:50:49.665008 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m13:50:49.668560 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m13:50:49.670881 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m13:50:49.671994 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m13:50:49.673044 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 13:50:49.665196 => 13:50:49.672854
[0m13:50:49.673324 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 13:50:49.668941 => 13:50:49.673201
[0m13:50:49.673605 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 13:50:49.671166 => 13:50:49.673495
[0m13:50:49.673834 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m13:50:49.674153 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m13:50:49.674465 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m13:50:49.687967 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m13:50:49.689669 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m13:50:49.690968 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m13:50:49.691935 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:50:49.692226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:49.692483 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:50:49.692827 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:49.693099 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:49.693332 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:50:50.906252 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m13:50:50.907299 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m13:50:50.922835 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m13:50:50.924973 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events;
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted;
)

select * from mobile_events_cleaned


[0m13:50:50.928442 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m13:50:50.929093 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m13:50:51.115033 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m13:50:51.115761 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m13:50:51.134914 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m13:50:51.135421 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m13:50:51.136277 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m13:50:51.136739 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m13:50:51.217461 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m13:50:51.236485 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m13:50:51.240168 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m13:50:51.321476 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 13:50:49.689834 => 13:50:51.320455
[0m13:50:51.339229 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 13:50:49.674666 => 13:50:51.338525
[0m13:50:51.352167 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 13:50:49.688202 => 13:50:51.351668
[0m13:50:59.559560 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m13:50:59.561866 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m13:50:59.563419 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m13:50:59.566015 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1edfca-6920-4006-86e6-f72464f8c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb4250>]}
[0m13:50:59.568130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1edfca-6920-4006-86e6-f72464f8c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2e3d0>]}
[0m13:50:59.570491 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1edfca-6920-4006-86e6-f72464f8c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f70050>]}
[0m13:50:59.571187 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 9.90s]
[0m13:50:59.572162 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 9.91s]
[0m13:50:59.572877 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 9.91s]
[0m13:50:59.573570 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m13:50:59.573972 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m13:50:59.574297 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m13:50:59.575271 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m13:50:59.576029 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m13:50:59.576465 [debug] [Thread-1 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m13:50:59.576801 [debug] [Thread-2 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m13:50:59.577112 [debug] [Thread-3 (]: Began running node model.oracle_dbt.frequent_web_users
[0m13:50:59.577429 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m13:50:59.577800 [info ] [Thread-1 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m13:50:59.578378 [info ] [Thread-2 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m13:50:59.578863 [info ] [Thread-3 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m13:50:59.579318 [debug] [Thread-4 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m13:50:59.579932 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m13:50:59.580225 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m13:50:59.580503 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m13:50:59.580790 [info ] [Thread-4 (]: 8 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m13:50:59.581167 [debug] [Thread-1 (]: Began running node model.oracle_dbt.ranked_web_events
[0m13:50:59.581684 [debug] [Thread-2 (]: Began running node model.oracle_dbt.web_events_counts
[0m13:50:59.582394 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m13:50:59.582751 [info ] [Thread-1 (]: 9 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m13:50:59.583163 [info ] [Thread-2 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m13:50:59.583640 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m13:50:59.583906 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.web_events_counts
[0m13:50:59.585440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:59.585816 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m13:51:01.244294 [debug] [MainThread]: On master: COMMIT
[0m13:51:01.246437 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m13:51:01.247066 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m13:51:01.352732 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10480594635009766 seconds
[0m13:51:01.354358 [debug] [MainThread]: On master: Close
[0m13:51:01.469692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:01.470919 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m13:51:01.471474 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m13:51:01.471729 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m13:51:01.472122 [info ] [MainThread]: 
[0m13:51:01.472608 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 17.21 seconds (17.21s).
[0m13:51:01.473150 [debug] [MainThread]: Command end result
[0m13:51:02.046008 [info ] [MainThread]: 
[0m13:51:02.048315 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:51:02.048967 [info ] [MainThread]: 
[0m13:51:02.049409 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m13:51:02.049833 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m13:51:02.050138 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m13:51:02.050473 [info ] [MainThread]: 
[0m13:51:02.050797 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m13:51:02.051105 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m13:51:02.051400 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m13:51:02.051698 [info ] [MainThread]: 
[0m13:51:02.051995 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m13:51:02.052298 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m13:51:02.052615 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m13:51:02.052932 [info ] [MainThread]: 
[0m13:51:02.053319 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m13:51:02.054279 [debug] [MainThread]: Command `dbt run` failed at 13:51:02.054109 after 22.16 seconds
[0m13:51:02.054961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104617b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046149d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f34d50>]}
[0m13:51:02.055720 [debug] [MainThread]: Flushing usage events
[0m14:13:09.454942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054141d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540a050>]}


============================== 14:13:09.457977 | 0b0d6ae5-558c-4427-8427-4dde7ceae26c ==============================
[0m14:13:09.457977 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:13:09.458307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:13:09.532632 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:13:09.560582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b0d6ae5-558c-4427-8427-4dde7ceae26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105417850>]}
[0m14:13:09.585699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b0d6ae5-558c-4427-8427-4dde7ceae26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d2410>]}
[0m14:13:09.601439 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:13:09.652420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:13:09.652654 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:13:09.655762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b0d6ae5-558c-4427-8427-4dde7ceae26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd6ed0>]}
[0m14:13:09.661934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b0d6ae5-558c-4427-8427-4dde7ceae26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b2be10>]}
[0m14:13:09.662153 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:13:09.662339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0d6ae5-558c-4427-8427-4dde7ceae26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8aa50>]}
[0m14:13:09.663355 [info ] [MainThread]: 
[0m14:13:09.663856 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:13:09.664678 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:13:09.670028 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:13:09.670260 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:13:09.670389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:09.670508 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:13:11.186783 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.5159578323364258 seconds
[0m14:13:11.290315 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:13:11.391004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:13:11.397893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:11.398436 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:13:12.628228 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:13:12.630186 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:13:12.954590 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.3235461711883545 seconds
[0m14:13:13.153744 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:13:13.249089 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:13:13.364134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0d6ae5-558c-4427-8427-4dde7ceae26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b6c0d0>]}
[0m14:13:13.364980 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:13.365342 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:13:14.570414 [debug] [MainThread]: On master: COMMIT
[0m14:13:14.571792 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:13:14.572188 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:13:14.667791 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09420394897460938 seconds
[0m14:13:14.669382 [debug] [MainThread]: On master: Close
[0m14:13:14.771561 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:13:14.772518 [info ] [MainThread]: 
[0m14:13:14.785623 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:13:14.786107 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:13:14.786470 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:13:14.786991 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:13:14.787633 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:13:14.788185 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:13:14.788993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:13:14.789537 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:13:14.790059 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:13:14.790328 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:13:14.790575 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:13:14.790806 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:13:14.792553 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:13:14.794833 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:13:14.796164 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:13:14.806060 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:13:14.790968 => 14:13:14.805822
[0m14:13:14.806344 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:13:14.792742 => 14:13:14.806241
[0m14:13:14.806514 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:13:14.795037 => 14:13:14.806440
[0m14:13:14.806717 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:13:14.806934 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:13:14.807150 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:13:14.824025 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:13:14.825908 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:13:14.827418 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:13:14.833097 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:13:14.833346 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:13:14.833575 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:13:14.833773 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:13:14.839785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:14.840000 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:13:16.050486 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:13:16.051149 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:13:16.051744 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:13:16.052275 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:13:16.054267 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:13:16.054688 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events;
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted;
)

select * from mobile_events_cleaned


[0m14:13:16.247291 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:13:16.250119 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:13:16.248392 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:13:16.248813 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:13:16.251313 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:13:16.251548 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:13:16.347789 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:13:16.348203 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:13:16.348462 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:13:16.450450 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:13:14.826083 => 14:13:16.449439
[0m14:13:16.458128 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:13:14.824297 => 14:13:16.457835
[0m14:13:16.458740 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:13:14.807389 => 14:13:16.458523
[0m14:13:16.476352 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:13:16.477799 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:13:16.480166 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0d6ae5-558c-4427-8427-4dde7ceae26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3b190>]}
[0m14:13:16.481466 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:13:16.483221 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0d6ae5-558c-4427-8427-4dde7ceae26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb23d0>]}
[0m14:13:16.483934 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.69s]
[0m14:13:16.486002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0d6ae5-558c-4427-8427-4dde7ceae26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b60b10>]}
[0m14:13:16.486480 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.69s]
[0m14:13:16.486895 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:13:16.487285 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.70s]
[0m14:13:16.487642 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:13:16.488377 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:13:16.488853 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:13:16.489405 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:13:16.490171 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:13:16.490530 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:13:16.490834 [debug] [Thread-2 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:13:16.491114 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:13:16.491406 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:13:16.491770 [info ] [Thread-3 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:13:16.492241 [info ] [Thread-2 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:13:16.492608 [info ] [Thread-4 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:13:16.492935 [info ] [Thread-1 (]: 8 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m14:13:16.493265 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:13:16.493506 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:13:16.493738 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:13:16.493961 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:13:16.494215 [debug] [Thread-3 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:13:16.494528 [debug] [Thread-2 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:13:16.495032 [info ] [Thread-3 (]: 9 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:13:16.495367 [info ] [Thread-2 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m14:13:16.495675 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:13:16.495909 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:13:16.497010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:16.497233 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:13:17.688396 [debug] [MainThread]: On master: COMMIT
[0m14:13:17.689786 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:13:17.690456 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:13:17.791545 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10018610954284668 seconds
[0m14:13:17.792834 [debug] [MainThread]: On master: Close
[0m14:13:17.897143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:17.897892 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:13:17.898331 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:13:17.898646 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:13:17.899069 [info ] [MainThread]: 
[0m14:13:17.899542 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.24 seconds (8.24s).
[0m14:13:17.900524 [debug] [MainThread]: Command end result
[0m14:13:17.909621 [info ] [MainThread]: 
[0m14:13:17.909962 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:13:17.910288 [info ] [MainThread]: 
[0m14:13:17.910552 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:13:17.910729 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:13:17.910888 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:13:17.911042 [info ] [MainThread]: 
[0m14:13:17.911193 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:13:17.911430 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:13:17.911678 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:13:17.911930 [info ] [MainThread]: 
[0m14:13:17.912186 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:13:17.912438 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:13:17.912686 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:13:17.912948 [info ] [MainThread]: 
[0m14:13:17.913242 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:13:17.913791 [debug] [MainThread]: Command `dbt run` failed at 14:13:17.913708 after 8.49 seconds
[0m14:13:17.914118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101a5a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1003a8cd0>]}
[0m14:13:17.914421 [debug] [MainThread]: Flushing usage events
[0m14:14:07.011631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b42c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b63fd0>]}


============================== 14:14:07.014333 | bbb33b9c-accf-4892-a425-115c36a0b013 ==============================
[0m14:14:07.014333 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:14:07.014684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:14:07.093453 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:14:07.133110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbb33b9c-accf-4892-a425-115c36a0b013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b63c90>]}
[0m14:14:07.157506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbb33b9c-accf-4892-a425-115c36a0b013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a8110>]}
[0m14:14:07.175599 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:14:07.219953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:14:07.220302 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:14:07.229481 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:14:07.234938 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.oracle_dbt.stg_mobile_events' (models/staging/stg_mobile_events.sql) depends on a node named 'mobile_events' which was not found
[0m14:14:07.235340 [debug] [MainThread]: Command `dbt run` failed at 14:14:07.235269 after 0.25 seconds
[0m14:14:07.235568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102498d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106285cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106352bd0>]}
[0m14:14:07.235780 [debug] [MainThread]: Flushing usage events
[0m14:16:29.761679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10413fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414bf90>]}


============================== 14:16:29.769379 | 9e36104d-c6cb-4462-9805-fe106e94673e ==============================
[0m14:16:29.769379 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:16:29.769762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:16:29.830011 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:16:29.860136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e36104d-c6cb-4462-9805-fe106e94673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10413e3d0>]}
[0m14:16:29.884438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e36104d-c6cb-4462-9805-fe106e94673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032d39d0>]}
[0m14:16:29.918548 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:16:29.981718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:29.981968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:29.985413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e36104d-c6cb-4462-9805-fe106e94673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104962010>]}
[0m14:16:29.990655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e36104d-c6cb-4462-9805-fe106e94673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486ce90>]}
[0m14:16:29.990875 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:16:29.991072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e36104d-c6cb-4462-9805-fe106e94673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104899890>]}
[0m14:16:29.992099 [info ] [MainThread]: 
[0m14:16:29.992531 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:16:29.993233 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:16:29.998439 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:16:29.998674 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:16:29.998808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:29.998930 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:16:31.586891 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.587524175643921 seconds
[0m14:16:31.688382 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:16:31.789930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:16:31.797552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:31.797997 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:16:33.012942 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:16:33.013898 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:16:33.130694 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11598515510559082 seconds
[0m14:16:33.312499 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:16:33.409821 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:16:33.522068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e36104d-c6cb-4462-9805-fe106e94673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b1a50>]}
[0m14:16:33.522871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:33.523198 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:16:34.717900 [debug] [MainThread]: On master: COMMIT
[0m14:16:34.719214 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:16:34.719633 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:16:34.816755 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09626483917236328 seconds
[0m14:16:34.818446 [debug] [MainThread]: On master: Close
[0m14:16:34.929123 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:34.929775 [info ] [MainThread]: 
[0m14:16:34.958089 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:16:34.958458 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:16:34.958764 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:16:34.959191 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:16:34.959672 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:16:34.960014 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:16:34.960569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:16:34.960997 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:16:34.961378 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:16:34.961573 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:16:34.961745 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:16:34.961905 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:16:34.963411 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:16:34.965316 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:16:34.968114 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:16:34.972853 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:16:34.962109 => 14:16:34.972659
[0m14:16:34.973118 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:16:34.965544 => 14:16:34.973002
[0m14:16:34.973342 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:16:34.963644 => 14:16:34.973230
[0m14:16:34.973638 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:16:34.973874 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:16:34.974102 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:16:34.985890 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:16:34.987441 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:16:34.988696 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:16:35.010583 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:16:35.010851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:35.011042 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:16:35.011252 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:16:35.011457 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:16:35.011643 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:16:36.170292 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:16:36.172302 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:16:36.173158 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:16:36.173721 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:16:36.174608 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:16:36.175310 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events;
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted;
)

select * from mobile_events_cleaned


[0m14:16:36.366928 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:16:36.367575 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:16:36.367958 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:16:36.368900 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:16:36.369357 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:16:36.369713 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:16:36.463932 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:16:36.464446 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:16:36.466651 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:16:36.561181 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:16:34.987585 => 14:16:36.560833
[0m14:16:36.571341 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:16:34.986142 => 14:16:36.571104
[0m14:16:36.571877 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:16:34.974247 => 14:16:36.571678
[0m14:16:36.674488 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:16:36.676421 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:16:36.678028 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:16:36.681028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e36104d-c6cb-4462-9805-fe106e94673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac91d0>]}
[0m14:16:36.683268 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e36104d-c6cb-4462-9805-fe106e94673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10485e210>]}
[0m14:16:36.685453 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e36104d-c6cb-4462-9805-fe106e94673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a9d5d0>]}
[0m14:16:36.686148 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.72s]
[0m14:16:36.686763 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.72s]
[0m14:16:36.687406 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.72s]
[0m14:16:36.688086 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:16:36.688622 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:16:36.688989 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:16:36.690057 [debug] [Thread-4 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:16:36.690438 [debug] [Thread-1 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:16:36.690764 [debug] [Thread-2 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:16:36.690994 [debug] [Thread-3 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:16:36.691432 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:16:36.691812 [info ] [Thread-1 (]: 5 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:16:36.692173 [info ] [Thread-2 (]: 6 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:16:36.692518 [info ] [Thread-3 (]: 7 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:16:36.692909 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:16:36.693213 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:16:36.693483 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:16:36.693744 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:16:36.694025 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:16:36.694366 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:16:36.694963 [debug] [Thread-2 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:16:36.695573 [info ] [Thread-4 (]: 8 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................. [[33mSKIP[0m]
[0m14:16:36.696099 [info ] [Thread-1 (]: 9 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:16:36.696613 [info ] [Thread-2 (]: 10 of 10 SKIP relation FAWDBTCORE.frequent_web_users ........................... [[33mSKIP[0m]
[0m14:16:36.697030 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:16:36.697319 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:16:36.697573 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:16:36.699078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:36.699336 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:16:37.882637 [debug] [MainThread]: On master: COMMIT
[0m14:16:37.883431 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:16:37.883763 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:16:37.982531 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09783387184143066 seconds
[0m14:16:37.986135 [debug] [MainThread]: On master: Close
[0m14:16:38.091286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:38.092231 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:16:38.092596 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:16:38.092904 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:16:38.093371 [info ] [MainThread]: 
[0m14:16:38.093913 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.10 seconds (8.10s).
[0m14:16:38.094962 [debug] [MainThread]: Command end result
[0m14:16:38.116202 [info ] [MainThread]: 
[0m14:16:38.117026 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:16:38.117474 [info ] [MainThread]: 
[0m14:16:38.117752 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:16:38.118023 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:16:38.118265 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:16:38.118510 [info ] [MainThread]: 
[0m14:16:38.118745 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:16:38.118973 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:16:38.119259 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:16:38.119509 [info ] [MainThread]: 
[0m14:16:38.119745 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:16:38.119970 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:16:38.120191 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:16:38.120450 [info ] [MainThread]: 
[0m14:16:38.120969 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:16:38.121723 [debug] [MainThread]: Command `dbt run` failed at 14:16:38.121624 after 8.39 seconds
[0m14:16:38.122115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104160990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a80cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104876b10>]}
[0m14:16:38.122456 [debug] [MainThread]: Flushing usage events
[0m14:45:11.256947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105517250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055178d0>]}


============================== 14:45:11.268088 | 951d53fc-d652-468b-80d5-8773a9c9fdd0 ==============================
[0m14:45:11.268088 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:45:11.268486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:45:11.268819 [info ] [MainThread]: dbt version: 1.5.0
[0m14:45:11.269023 [info ] [MainThread]: python version: 3.11.3
[0m14:45:11.269444 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m14:45:11.269642 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m14:45:11.269810 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/Downloads/profiles.yml
[0m14:45:11.269991 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m14:45:11.270144 [info ] [MainThread]: Configuration:
[0m14:45:11.362329 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:45:11.381015 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:45:11.389982 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:45:11.390303 [info ] [MainThread]: Required dependencies:
[0m14:45:11.390547 [debug] [MainThread]: Executing "git --help"
[0m14:45:11.402541 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:45:11.403174 [debug] [MainThread]: STDERR: "b''"
[0m14:45:11.403326 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:45:11.403505 [info ] [MainThread]: Connection:
[0m14:45:11.403698 [info ] [MainThread]:   user: FAWDBTCORE
[0m14:45:11.403843 [info ] [MainThread]:   database: FAWDBTCORE
[0m14:45:11.403977 [info ] [MainThread]:   schema: FAWDBTCORE
[0m14:45:11.404112 [info ] [MainThread]:   protocol: None
[0m14:45:11.404241 [info ] [MainThread]:   host: None
[0m14:45:11.404369 [info ] [MainThread]:   port: None
[0m14:45:11.404498 [info ] [MainThread]:   tns_name: cfg57adw_low
[0m14:45:11.404626 [info ] [MainThread]:   service: None
[0m14:45:11.404766 [info ] [MainThread]:   connection_string: None
[0m14:45:11.404899 [info ] [MainThread]:   shardingkey: []
[0m14:45:11.405044 [info ] [MainThread]:   supershardingkey: []
[0m14:45:11.405173 [info ] [MainThread]:   cclass: None
[0m14:45:11.405308 [info ] [MainThread]:   purity: None
[0m14:45:11.405427 [info ] [MainThread]:   retry_count: 1
[0m14:45:11.405554 [info ] [MainThread]:   retry_delay: 3
[0m14:45:11.409641 [debug] [MainThread]: Acquiring new oracle connection 'debug'
[0m14:45:11.410335 [debug] [MainThread]: oracle adapter: Using oracle connection "debug".
[0m14:45:11.410463 [debug] [MainThread]: oracle adapter: On debug: fselect 1 as id from dual
[0m14:45:11.410581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:11.410733 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:45:14.203274 [debug] [MainThread]: oracle adapter: SQL status: OK in 2.792052984237671 seconds
[0m14:45:14.205633 [debug] [MainThread]: On debug: Close
[0m14:45:14.329326 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:45:14.330089 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:45:14.330717 [debug] [MainThread]: Command `dbt debug` succeeded at 14:45:14.330618 after 3.11 seconds
[0m14:45:14.331016 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:45:14.331298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100dbead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100dbf790>]}
[0m14:45:14.331662 [debug] [MainThread]: Flushing usage events
[0m14:49:25.511512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbffd0>]}


============================== 14:49:25.515308 | 6b2e5834-5ac3-4afe-b31f-ea6239f00550 ==============================
[0m14:49:25.515308 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:49:25.515667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:49:25.515967 [info ] [MainThread]: dbt version: 1.5.0
[0m14:49:25.516175 [info ] [MainThread]: python version: 3.11.3
[0m14:49:25.516371 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m14:49:25.516550 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m14:49:25.516716 [info ] [MainThread]: Using profiles.yml file at /Users/rosreen/Downloads/profiles.yml
[0m14:49:25.516893 [info ] [MainThread]: Using dbt_project.yml file at /Users/rosreen/Desktop/oracle-dbt/dbt_project.yml
[0m14:49:25.517049 [info ] [MainThread]: Configuration:
[0m14:49:25.623967 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:49:25.656828 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:49:25.666287 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:49:25.666603 [info ] [MainThread]: Required dependencies:
[0m14:49:25.666848 [debug] [MainThread]: Executing "git --help"
[0m14:49:25.676568 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:49:25.677224 [debug] [MainThread]: STDERR: "b''"
[0m14:49:25.677416 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:49:25.677767 [info ] [MainThread]: Connection:
[0m14:49:25.677974 [info ] [MainThread]:   user: FAWDBTCORE
[0m14:49:25.678114 [info ] [MainThread]:   database: FAWDBTCORE
[0m14:49:25.678245 [info ] [MainThread]:   schema: FAWDBTCORE
[0m14:49:25.678377 [info ] [MainThread]:   protocol: None
[0m14:49:25.678506 [info ] [MainThread]:   host: None
[0m14:49:25.678636 [info ] [MainThread]:   port: None
[0m14:49:25.678767 [info ] [MainThread]:   tns_name: cfg57adw_low
[0m14:49:25.678901 [info ] [MainThread]:   service: None
[0m14:49:25.679027 [info ] [MainThread]:   connection_string: None
[0m14:49:25.679154 [info ] [MainThread]:   shardingkey: []
[0m14:49:25.679279 [info ] [MainThread]:   supershardingkey: []
[0m14:49:25.679406 [info ] [MainThread]:   cclass: None
[0m14:49:25.679533 [info ] [MainThread]:   purity: None
[0m14:49:25.679656 [info ] [MainThread]:   retry_count: 1
[0m14:49:25.679791 [info ] [MainThread]:   retry_delay: 3
[0m14:49:25.686832 [debug] [MainThread]: Acquiring new oracle connection 'debug'
[0m14:49:25.687598 [debug] [MainThread]: oracle adapter: Using oracle connection "debug".
[0m14:49:25.687886 [debug] [MainThread]: oracle adapter: On debug: fselect 1 as id from dual
[0m14:49:25.688097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:25.688231 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:49:27.281827 [debug] [MainThread]: oracle adapter: SQL status: OK in 1.5902869701385498 seconds
[0m14:49:27.285270 [debug] [MainThread]: On debug: Close
[0m14:49:27.389134 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:49:27.390261 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:49:27.391551 [debug] [MainThread]: Command `dbt debug` succeeded at 14:49:27.391311 after 1.91 seconds
[0m14:49:27.392142 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:49:27.392630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c9990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102392750>]}
[0m14:49:27.393208 [debug] [MainThread]: Flushing usage events
[0m14:49:32.496183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12400ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123995cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124017fd0>]}


============================== 14:49:32.504953 | 78ed638f-db50-49c7-bba6-8b9baf98ece9 ==============================
[0m14:49:32.504953 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:49:32.505304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:49:32.608679 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:49:32.638262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78ed638f-db50-49c7-bba6-8b9baf98ece9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124089d10>]}
[0m14:49:32.664009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78ed638f-db50-49c7-bba6-8b9baf98ece9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245b4690>]}
[0m14:49:32.682840 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:49:32.755346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:49:32.755760 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:49:32.765995 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:49:32.776075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78ed638f-db50-49c7-bba6-8b9baf98ece9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124909ad0>]}
[0m14:49:32.786686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78ed638f-db50-49c7-bba6-8b9baf98ece9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124736810>]}
[0m14:49:32.786914 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:49:32.787094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78ed638f-db50-49c7-bba6-8b9baf98ece9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12409e7d0>]}
[0m14:49:32.788098 [info ] [MainThread]: 
[0m14:49:32.788511 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:49:32.789247 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:49:32.794492 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:49:32.794745 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:49:32.794876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:32.795001 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:49:34.206734 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.4112308025360107 seconds
[0m14:49:34.309318 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:49:34.412423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:49:34.422167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:34.422750 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:49:35.607690 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:49:35.609174 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:49:35.726766 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11661911010742188 seconds
[0m14:49:35.912551 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:49:36.017320 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:49:36.127953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78ed638f-db50-49c7-bba6-8b9baf98ece9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124990050>]}
[0m14:49:36.128663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:36.129066 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:49:37.326506 [debug] [MainThread]: On master: COMMIT
[0m14:49:37.327148 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:49:37.327350 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:49:37.422646 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09456419944763184 seconds
[0m14:49:37.424151 [debug] [MainThread]: On master: Close
[0m14:49:37.528556 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:49:37.529276 [info ] [MainThread]: 
[0m14:49:37.545277 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:49:37.545779 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:49:37.546132 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:49:37.546775 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:49:37.547739 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:49:37.548394 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:49:37.549416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:49:37.550116 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:49:37.550692 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:49:37.551010 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:49:37.551251 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:49:37.551480 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:49:37.553315 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:49:37.555551 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:49:37.556691 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:49:37.563201 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:49:37.553506 => 14:49:37.562954
[0m14:49:37.563532 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:49:37.551653 => 14:49:37.563389
[0m14:49:37.563766 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:49:37.555772 => 14:49:37.563662
[0m14:49:37.564046 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:49:37.564290 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:49:37.564559 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:49:37.578711 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:49:37.580632 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:49:37.582196 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:49:37.586592 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:49:37.586864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:37.587052 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:49:37.587245 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:49:37.587425 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:49:37.587587 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:49:38.768875 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:49:38.770291 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:49:38.789127 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:49:38.790393 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:49:38.791173 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:49:38.791771 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    select * from mobile_events


[0m14:49:38.961420 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:49:38.963250 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:49:38.984159 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:49:38.984796 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:49:39.060797 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:49:39.080963 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:49:39.158116 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:49:37.564799 => 14:49:39.157496
[0m14:49:39.171564 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:49:39.173391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed638f-db50-49c7-bba6-8b9baf98ece9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1240fc310>]}
[0m14:49:39.173973 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.62s]
[0m14:49:39.174402 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:49:39.177107 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.38425397872924805 seconds
[0m14:49:39.178171 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:49:37.580827 => 14:49:39.177951
[0m14:49:39.185770 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m14:49:39.187439 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:49:39.187713 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m14:49:39.189129 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:49:39.190651 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed638f-db50-49c7-bba6-8b9baf98ece9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a6ac90>]}
[0m14:49:39.191062 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.64s]
[0m14:49:39.191407 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:49:39.191832 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:49:39.192091 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:49:39.192384 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:49:39.282593 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09445619583129883 seconds
[0m14:49:39.287000 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:49:39.287315 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:49:39.409078 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.12079381942749023 seconds
[0m14:49:39.426567 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:49:37.578971 => 14:49:39.426366
[0m14:49:39.427025 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:49:39.545066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed638f-db50-49c7-bba6-8b9baf98ece9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124b888d0>]}
[0m14:49:39.545610 [info ] [Thread-1 (]: 1 of 10 OK created sql view model FAWDBTCORE.stg_mobile_events ................. [[32mOK[0m in 2.00s]
[0m14:49:39.546024 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:49:39.546966 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:49:39.547366 [debug] [Thread-2 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:49:39.547630 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:49:39.547867 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:49:39.548183 [info ] [Thread-3 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:49:39.548505 [info ] [Thread-2 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:49:39.548999 [info ] [Thread-4 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:49:39.549321 [info ] [Thread-1 (]: 8 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m14:49:39.549602 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:49:39.549808 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:49:39.549999 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:49:39.550183 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:49:39.550393 [debug] [Thread-3 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:49:39.550719 [debug] [Thread-2 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:49:39.551236 [info ] [Thread-3 (]: 9 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:49:39.551523 [info ] [Thread-2 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m14:49:39.551823 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:49:39.552085 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:49:39.553233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:39.553490 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:49:40.747377 [debug] [MainThread]: On master: COMMIT
[0m14:49:40.748802 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:49:40.749447 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:49:40.844084 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09377264976501465 seconds
[0m14:49:40.845509 [debug] [MainThread]: On master: Close
[0m14:49:40.952616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:40.954065 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:49:40.954580 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:49:40.954916 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:49:40.955409 [info ] [MainThread]: 
[0m14:49:40.956021 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.17 seconds (8.17s).
[0m14:49:40.957447 [debug] [MainThread]: Command end result
[0m14:49:40.969491 [info ] [MainThread]: 
[0m14:49:40.970078 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:49:40.970400 [info ] [MainThread]: 
[0m14:49:40.970708 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:49:40.970987 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:49:40.971259 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:49:40.971488 [info ] [MainThread]: 
[0m14:49:40.971710 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:49:40.971933 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:49:40.972145 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:49:40.972388 [info ] [MainThread]: 
[0m14:49:40.972657 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=7 TOTAL=10
[0m14:49:40.973290 [debug] [MainThread]: Command `dbt run` failed at 14:49:40.973196 after 8.50 seconds
[0m14:49:40.973652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12402c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c42ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124592b10>]}
[0m14:49:40.973972 [debug] [MainThread]: Flushing usage events
[0m14:50:16.409190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067bfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cbfd0>]}


============================== 14:50:16.412644 | 6c87470b-bbf0-4373-ab2c-081702b48e40 ==============================
[0m14:50:16.412644 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:50:16.413037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:50:16.508412 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:50:16.539041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c87470b-bbf0-4373-ab2c-081702b48e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f8cd0>]}
[0m14:50:16.563469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c87470b-bbf0-4373-ab2c-081702b48e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3e910>]}
[0m14:50:16.580276 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:50:16.636392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:50:16.636762 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:50:16.646168 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:50:16.655730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c87470b-bbf0-4373-ab2c-081702b48e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e0510>]}
[0m14:50:16.663504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c87470b-bbf0-4373-ab2c-081702b48e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fecf10>]}
[0m14:50:16.663755 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:50:16.663943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c87470b-bbf0-4373-ab2c-081702b48e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebe710>]}
[0m14:50:16.664953 [info ] [MainThread]: 
[0m14:50:16.665399 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:50:16.666164 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:50:16.671402 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:50:16.671649 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:50:16.671793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:16.671926 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:50:18.102786 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.4304561614990234 seconds
[0m14:50:18.207730 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:50:18.307891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:50:18.314114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:18.314654 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:50:19.512592 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:50:19.513355 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:50:19.631772 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.1174471378326416 seconds
[0m14:50:19.824077 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:50:19.923831 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:50:20.034375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c87470b-bbf0-4373-ab2c-081702b48e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057cdd90>]}
[0m14:50:20.035205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:20.035614 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:50:21.302531 [debug] [MainThread]: On master: COMMIT
[0m14:50:21.303999 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:50:21.304462 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:50:21.402762 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09723496437072754 seconds
[0m14:50:21.404556 [debug] [MainThread]: On master: Close
[0m14:50:21.506945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:21.507910 [info ] [MainThread]: 
[0m14:50:21.526967 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:50:21.527423 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:50:21.527792 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:50:21.528243 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:50:21.528689 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:50:21.529246 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:50:21.529974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:50:21.530512 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:50:21.531001 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:50:21.531273 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:50:21.531521 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:50:21.531981 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:50:21.533901 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:50:21.535883 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:50:21.536970 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:50:21.541706 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:50:21.532346 => 14:50:21.541544
[0m14:50:21.542067 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:50:21.536075 => 14:50:21.541852
[0m14:50:21.542376 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:50:21.534115 => 14:50:21.542265
[0m14:50:21.542596 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:50:21.542882 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:50:21.543114 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:50:21.556888 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:50:21.558644 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:50:21.560083 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:50:21.568323 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:50:21.568636 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:21.568845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:21.569080 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:50:21.569304 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:50:21.569514 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:50:22.771477 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:50:22.773617 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:50:22.774325 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:50:22.775124 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:50:22.775650 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events;
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted;
)

select * from mobile_events_extracted


[0m14:50:22.776154 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:50:22.986447 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:50:22.987874 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:50:22.988501 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:50:22.990101 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:50:22.990787 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:50:22.991291 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:50:23.085954 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:50:23.087537 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:50:23.088662 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:50:23.184528 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:50:21.558814 => 14:50:23.183334
[0m14:50:23.192213 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:50:21.543270 => 14:50:23.191780
[0m14:50:23.195342 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:50:21.557114 => 14:50:23.194991
[0m14:50:23.258947 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:50:23.261772 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c87470b-bbf0-4373-ab2c-081702b48e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c9d10>]}
[0m14:50:23.263606 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:50:23.262654 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.73s]
[0m14:50:23.264587 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:50:23.265976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c87470b-bbf0-4373-ab2c-081702b48e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe0c50>]}
[0m14:50:23.266312 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:50:23.267677 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c87470b-bbf0-4373-ab2c-081702b48e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067bcb10>]}
[0m14:50:23.268075 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.74s]
[0m14:50:23.268842 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:50:23.269385 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.74s]
[0m14:50:23.269894 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:50:23.270268 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:50:23.270743 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:50:23.271361 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:50:23.271632 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:50:23.271860 [debug] [Thread-1 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:50:23.272145 [debug] [Thread-2 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:50:23.272572 [info ] [Thread-3 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:50:23.273067 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:50:23.273412 [info ] [Thread-1 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:50:23.273780 [info ] [Thread-2 (]: 7 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:50:23.274129 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:50:23.274440 [info ] [Thread-4 (]: 8 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................. [[33mSKIP[0m]
[0m14:50:23.274960 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:50:23.275389 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:50:23.275770 [debug] [Thread-3 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:50:23.276134 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:50:23.276599 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:50:23.277109 [info ] [Thread-3 (]: 9 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:50:23.277625 [info ] [Thread-1 (]: 10 of 10 SKIP relation FAWDBTCORE.frequent_web_users ........................... [[33mSKIP[0m]
[0m14:50:23.278143 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:50:23.278589 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:50:23.280006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:23.280259 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:50:24.452009 [debug] [MainThread]: On master: COMMIT
[0m14:50:24.453712 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:50:24.454158 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:50:24.553412 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09827685356140137 seconds
[0m14:50:24.554973 [debug] [MainThread]: On master: Close
[0m14:50:24.665614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:24.666036 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:50:24.666172 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:50:24.666293 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:50:24.666518 [info ] [MainThread]: 
[0m14:50:24.666770 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m14:50:24.667223 [debug] [MainThread]: Command end result
[0m14:50:24.679243 [info ] [MainThread]: 
[0m14:50:24.679801 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:50:24.680122 [info ] [MainThread]: 
[0m14:50:24.680417 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:50:24.680704 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:50:24.680973 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:50:24.681247 [info ] [MainThread]: 
[0m14:50:24.681504 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:50:24.681761 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:50:24.682010 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:50:24.682264 [info ] [MainThread]: 
[0m14:50:24.682522 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:50:24.682768 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:50:24.683016 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:50:24.683271 [info ] [MainThread]: 
[0m14:50:24.683571 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:50:24.684068 [debug] [MainThread]: Command `dbt run` failed at 14:50:24.684011 after 8.31 seconds
[0m14:50:24.684288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103100cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103100d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067aa710>]}
[0m14:50:24.684486 [debug] [MainThread]: Flushing usage events
[0m14:50:52.195032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12040bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120417ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120417f90>]}


============================== 14:50:52.204751 | c20b11f9-5f23-4486-882b-2a8609b87cb1 ==============================
[0m14:50:52.204751 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:50:52.205141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:50:52.311446 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:50:52.339869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c20b11f9-5f23-4486-882b-2a8609b87cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204d1990>]}
[0m14:50:52.346082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c20b11f9-5f23-4486-882b-2a8609b87cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204cb190>]}
[0m14:50:52.395382 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:50:52.434930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:50:52.435255 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:50:52.444147 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:50:52.453960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c20b11f9-5f23-4486-882b-2a8609b87cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d4fa50>]}
[0m14:50:52.464837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c20b11f9-5f23-4486-882b-2a8609b87cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ddce50>]}
[0m14:50:52.465066 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:50:52.465251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c20b11f9-5f23-4486-882b-2a8609b87cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e73590>]}
[0m14:50:52.466137 [info ] [MainThread]: 
[0m14:50:52.466536 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:50:52.467270 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:50:52.472078 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:50:52.472253 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:50:52.472383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:52.472507 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:50:53.930210 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.4570248126983643 seconds
[0m14:50:54.032275 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:50:54.147343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:50:54.154031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:54.154558 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:50:55.410672 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:50:55.412654 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:50:55.529452 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11577987670898438 seconds
[0m14:50:55.725129 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:50:55.822562 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:50:55.928158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c20b11f9-5f23-4486-882b-2a8609b87cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202c6410>]}
[0m14:50:55.929002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:55.929403 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:50:57.127758 [debug] [MainThread]: On master: COMMIT
[0m14:50:57.129045 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:50:57.129606 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:50:57.223994 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09351181983947754 seconds
[0m14:50:57.225825 [debug] [MainThread]: On master: Close
[0m14:50:57.327289 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:57.328573 [info ] [MainThread]: 
[0m14:50:57.336891 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:50:57.337399 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:50:57.337981 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:50:57.339132 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:50:57.340128 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:50:57.340785 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:50:57.341671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:50:57.342304 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:50:57.342862 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:50:57.343168 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:50:57.343450 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:50:57.343710 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:50:57.345727 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:50:57.348029 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:50:57.349252 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:50:57.350869 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:50:57.343905 => 14:50:57.350662
[0m14:50:57.351310 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:50:57.348243 => 14:50:57.351074
[0m14:50:57.351674 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:50:57.352144 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:50:57.345944 => 14:50:57.351829
[0m14:50:57.352445 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:50:57.367843 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:50:57.368207 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:50:57.370071 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:50:57.372013 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:50:57.382562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:57.382890 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:50:57.386595 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:50:57.386823 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:57.387035 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:50:57.387267 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:50:58.574920 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:50:58.577491 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:50:58.577986 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:50:58.578549 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:50:58.579005 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events;
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted;
)

select * from mobile_events_cleaned


[0m14:50:58.579392 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:50:58.772519 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m14:50:58.775345 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:50:58.790203 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:50:58.791047 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:50:58.803577 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:50:58.804137 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:50:58.876353 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:50:58.894043 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:50:58.905176 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:50:58.973853 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:50:57.352619 => 14:50:58.972567
[0m14:50:58.990180 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:50:57.370416 => 14:50:58.989857
[0m14:50:58.997199 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:50:58.998180 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:50:58.999795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c20b11f9-5f23-4486-882b-2a8609b87cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ccd350>]}
[0m14:50:59.001187 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c20b11f9-5f23-4486-882b-2a8609b87cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f99a90>]}
[0m14:50:59.001772 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.66s]
[0m14:50:59.002234 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.66s]
[0m14:50:59.002763 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:50:59.003552 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:50:57.368393 => 14:50:59.003194
[0m14:50:59.004004 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:50:59.006090 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:50:59.006662 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:50:59.007146 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:50:59.008319 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:50:59.010189 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c20b11f9-5f23-4486-882b-2a8609b87cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fb8890>]}
[0m14:50:59.010874 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.67s]
[0m14:50:59.011355 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:50:59.012168 [debug] [Thread-2 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:50:59.012517 [debug] [Thread-1 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:50:59.012899 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:50:59.013162 [info ] [Thread-2 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:50:59.013596 [debug] [Thread-3 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:50:59.013921 [info ] [Thread-1 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:50:59.014362 [info ] [Thread-4 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m14:50:59.014820 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:50:59.015136 [info ] [Thread-3 (]: 8 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:50:59.015483 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:50:59.015744 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:50:59.016019 [debug] [Thread-2 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:50:59.016456 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:50:59.016829 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:50:59.017320 [info ] [Thread-2 (]: 9 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:50:59.017889 [info ] [Thread-1 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m14:50:59.018208 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:50:59.018419 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:50:59.019482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:59.019703 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:51:00.240352 [debug] [MainThread]: On master: COMMIT
[0m14:51:00.242280 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:51:00.242743 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:51:00.343559 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10001206398010254 seconds
[0m14:51:00.344958 [debug] [MainThread]: On master: Close
[0m14:51:00.446066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:00.446637 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:51:00.446796 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:51:00.446933 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:51:00.447209 [info ] [MainThread]: 
[0m14:51:00.447466 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m14:51:00.447990 [debug] [MainThread]: Command end result
[0m14:51:00.466991 [info ] [MainThread]: 
[0m14:51:00.467409 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:51:00.467944 [info ] [MainThread]: 
[0m14:51:00.468390 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:51:00.468745 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m14:51:00.469063 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:51:00.469329 [info ] [MainThread]: 
[0m14:51:00.469590 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:51:00.469853 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:51:00.470104 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:51:00.470359 [info ] [MainThread]: 
[0m14:51:00.470613 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:51:00.470866 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:51:00.471117 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:51:00.471386 [info ] [MainThread]: 
[0m14:51:00.471668 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:51:00.472208 [debug] [MainThread]: Command `dbt run` failed at 14:51:00.472123 after 8.31 seconds
[0m14:51:00.472538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103284d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103284e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120417c50>]}
[0m14:51:00.472841 [debug] [MainThread]: Flushing usage events
[0m14:51:24.576982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797fc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10798bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10798bf90>]}


============================== 14:51:24.585364 | 60e884e4-28c9-4222-bfb3-479078ffa522 ==============================
[0m14:51:24.585364 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:51:24.585746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:51:24.685195 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:51:24.717316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60e884e4-28c9-4222-bfb3-479078ffa522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797e590>]}
[0m14:51:24.742599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60e884e4-28c9-4222-bfb3-479078ffa522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a05dd0>]}
[0m14:51:24.764138 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:51:24.814173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:51:24.814558 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:51:24.824180 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:51:24.833888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60e884e4-28c9-4222-bfb3-479078ffa522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a7c610>]}
[0m14:51:24.845177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60e884e4-28c9-4222-bfb3-479078ffa522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109ab350>]}
[0m14:51:24.845406 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:51:24.845594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e884e4-28c9-4222-bfb3-479078ffa522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797d190>]}
[0m14:51:24.846611 [info ] [MainThread]: 
[0m14:51:24.847083 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:51:24.847793 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:51:24.852812 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:51:24.853045 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:51:24.853181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:24.853306 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:51:26.282578 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.4287700653076172 seconds
[0m14:51:26.388611 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:51:26.490088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:51:26.497333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:26.497772 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:51:28.024195 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:51:28.025186 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:51:28.152868 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12662220001220703 seconds
[0m14:51:28.347173 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:51:28.463896 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:51:28.564235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e884e4-28c9-4222-bfb3-479078ffa522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c3290>]}
[0m14:51:28.564718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:28.564973 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:51:29.747002 [debug] [MainThread]: On master: COMMIT
[0m14:51:29.748430 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:51:29.748890 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:51:29.846795 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09679794311523438 seconds
[0m14:51:29.848682 [debug] [MainThread]: On master: Close
[0m14:51:29.949811 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:29.950747 [info ] [MainThread]: 
[0m14:51:29.971270 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:51:29.971800 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:51:29.972220 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:51:29.972913 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:51:29.973436 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:51:29.973931 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:51:29.974744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:51:29.975308 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:51:29.975737 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:51:29.975966 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:51:29.976175 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:51:29.976369 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:51:29.977811 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:51:29.979794 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:51:29.980913 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:51:29.982297 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:51:29.976510 => 14:51:29.982108
[0m14:51:29.982650 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:51:29.977975 => 14:51:29.982510
[0m14:51:29.982868 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:51:29.980028 => 14:51:29.982778
[0m14:51:29.983162 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:51:29.983501 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:51:29.983788 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:51:29.997371 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:51:29.999149 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:51:30.000637 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:51:30.004549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:30.004847 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:51:30.005071 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:51:30.005290 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:51:30.005557 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:51:30.005817 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:51:31.202967 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:51:31.204724 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:51:31.206963 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:51:31.207412 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:51:31.208644 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:51:31.209458 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events;
)

select * from mobile_events_extracted


[0m14:51:31.402944 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:51:31.404824 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:51:31.405932 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:51:31.406698 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:51:31.407541 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:51:31.408009 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:51:31.502571 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:51:31.502896 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:51:31.503116 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:51:31.606301 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:51:29.984137 => 14:51:31.605669
[0m14:51:31.609966 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:51:29.997650 => 14:51:31.609758
[0m14:51:31.611899 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:51:29.999323 => 14:51:31.611708
[0m14:51:31.628777 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:51:31.632089 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e884e4-28c9-4222-bfb3-479078ffa522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c91150>]}
[0m14:51:31.633466 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:51:31.634923 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:51:31.635661 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.66s]
[0m14:51:31.637822 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e884e4-28c9-4222-bfb3-479078ffa522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a772d0>]}
[0m14:51:31.639806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e884e4-28c9-4222-bfb3-479078ffa522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a75bd0>]}
[0m14:51:31.640234 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:51:31.640706 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.66s]
[0m14:51:31.641223 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.67s]
[0m14:51:31.642186 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:51:31.642700 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:51:31.643018 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:51:31.643338 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:51:31.644090 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:51:31.644851 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:51:31.645235 [debug] [Thread-2 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:51:31.645583 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:51:31.645919 [info ] [Thread-3 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:51:31.646370 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:51:31.646723 [info ] [Thread-2 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:51:31.647096 [info ] [Thread-1 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:51:31.647467 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:51:31.647858 [info ] [Thread-4 (]: 8 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m14:51:31.648320 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:51:31.648608 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:51:31.648912 [debug] [Thread-3 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:51:31.649328 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:51:31.649763 [debug] [Thread-2 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:51:31.650287 [info ] [Thread-3 (]: 9 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:51:31.650764 [info ] [Thread-2 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m14:51:31.651194 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:51:31.651464 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:51:31.652680 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:31.652937 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:51:32.864450 [debug] [MainThread]: On master: COMMIT
[0m14:51:32.865246 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:51:32.865637 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:51:32.961257 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09516191482543945 seconds
[0m14:51:32.961896 [debug] [MainThread]: On master: Close
[0m14:51:33.063393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:33.063944 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:51:33.064067 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:51:33.064180 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:51:33.064404 [info ] [MainThread]: 
[0m14:51:33.064626 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.22 seconds (8.22s).
[0m14:51:33.065065 [debug] [MainThread]: Command end result
[0m14:51:33.089123 [info ] [MainThread]: 
[0m14:51:33.089438 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:51:33.089598 [info ] [MainThread]: 
[0m14:51:33.089754 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:51:33.089903 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:51:33.090042 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:51:33.090175 [info ] [MainThread]: 
[0m14:51:33.090307 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:51:33.090445 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:51:33.090902 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:51:33.091202 [info ] [MainThread]: 
[0m14:51:33.091484 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:51:33.091742 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:51:33.091964 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:51:33.092194 [info ] [MainThread]: 
[0m14:51:33.092449 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:51:33.092930 [debug] [MainThread]: Command `dbt run` failed at 14:51:33.092856 after 8.55 seconds
[0m14:51:33.093214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107495c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10796c4d0>]}
[0m14:51:33.093494 [debug] [MainThread]: Flushing usage events
[0m14:52:41.665115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104717e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104717fd0>]}


============================== 14:52:41.667997 | f3cf573d-72c9-48ae-966b-a2a24652eb33 ==============================
[0m14:52:41.667997 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:52:41.668379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:41.754630 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:52:41.783769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3cf573d-72c9-48ae-966b-a2a24652eb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470bb90>]}
[0m14:52:41.809006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3cf573d-72c9-48ae-966b-a2a24652eb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb87d0>]}
[0m14:52:41.834375 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:52:41.889180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:52:41.889580 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:52:41.899133 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:52:41.908878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3cf573d-72c9-48ae-966b-a2a24652eb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477e450>]}
[0m14:52:41.922466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3cf573d-72c9-48ae-966b-a2a24652eb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e9050>]}
[0m14:52:41.922704 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:52:41.922901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3cf573d-72c9-48ae-966b-a2a24652eb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2a490>]}
[0m14:52:41.923948 [info ] [MainThread]: 
[0m14:52:41.924400 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:52:41.925173 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:52:41.930681 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:52:41.930946 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:52:41.931101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:41.931235 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:52:43.488730 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.5574719905853271 seconds
[0m14:52:43.593446 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:52:43.707040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:52:43.714160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:43.714745 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:52:44.900303 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:52:44.900779 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:52:45.020124 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11903524398803711 seconds
[0m14:52:45.312237 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:52:45.407069 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:52:45.510549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3cf573d-72c9-48ae-966b-a2a24652eb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105056910>]}
[0m14:52:45.511059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:45.511308 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:52:46.704166 [debug] [MainThread]: On master: COMMIT
[0m14:52:46.704525 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:52:46.704688 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:52:46.806299 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10139703750610352 seconds
[0m14:52:46.806617 [debug] [MainThread]: On master: Close
[0m14:52:46.903761 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:46.904248 [info ] [MainThread]: 
[0m14:52:46.910133 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:52:46.910515 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:52:46.910776 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:52:46.911160 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:52:46.911493 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:52:46.911792 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:52:46.912294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:52:46.912712 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:52:46.913100 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:52:46.913299 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:52:46.913486 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:52:46.913661 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:52:46.914945 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:52:46.916884 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:52:46.918039 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:52:46.923017 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:52:46.913794 => 14:52:46.922773
[0m14:52:46.923351 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:52:46.917123 => 14:52:46.923201
[0m14:52:46.923637 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:52:46.915139 => 14:52:46.923510
[0m14:52:46.923835 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:52:46.924036 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:52:46.924253 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:52:46.937347 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:52:46.939327 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:52:46.940778 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:52:46.947858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:46.948082 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:46.948254 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:52:46.948453 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:52:46.948638 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:52:46.948886 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:52:48.104067 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:52:48.105592 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    SELECT DISTICT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
  
FROM mobile_events;


[0m14:52:48.111990 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:52:48.112836 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:52:48.135148 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:52:48.144258 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:52:48.296056 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00933: SQL command not properly ended
[0m14:52:48.297843 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:52:48.300683 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:52:48.301254 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:52:48.334576 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:52:48.335635 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:52:48.393351 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:52:48.400036 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:52:48.430144 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:52:48.488052 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:52:46.924409 => 14:52:48.487729
[0m14:52:48.496641 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:52:46.937655 => 14:52:48.496406
[0m14:52:48.526918 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:52:46.939514 => 14:52:48.526311
[0m14:52:48.554083 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00933: SQL command not properly ended
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:52:48.555240 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:52:48.556480 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:52:48.558230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3cf573d-72c9-48ae-966b-a2a24652eb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105277650>]}
[0m14:52:48.559875 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3cf573d-72c9-48ae-966b-a2a24652eb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527ab50>]}
[0m14:52:48.561579 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3cf573d-72c9-48ae-966b-a2a24652eb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105275950>]}
[0m14:52:48.562183 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.65s]
[0m14:52:48.562668 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.65s]
[0m14:52:48.563409 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.65s]
[0m14:52:48.564190 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:52:48.564565 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:52:48.565037 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:52:48.566414 [debug] [Thread-2 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:52:48.566767 [debug] [Thread-4 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:52:48.567158 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:52:48.567464 [info ] [Thread-2 (]: 4 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:52:48.567867 [debug] [Thread-3 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:52:48.568336 [info ] [Thread-4 (]: 5 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:52:48.569207 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:52:48.568779 [info ] [Thread-1 (]: 6 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:52:48.569679 [info ] [Thread-3 (]: 7 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:52:48.570074 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:52:48.570382 [debug] [Thread-2 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:52:48.570755 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:52:48.571096 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:52:48.571400 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:52:48.571891 [info ] [Thread-2 (]: 8 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................. [[33mSKIP[0m]
[0m14:52:48.572420 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:52:48.572947 [info ] [Thread-4 (]: 9 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:52:48.573446 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:52:48.573796 [info ] [Thread-1 (]: 10 of 10 SKIP relation FAWDBTCORE.frequent_web_users ........................... [[33mSKIP[0m]
[0m14:52:48.574195 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:52:48.574673 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:52:48.576034 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:48.576310 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:52:49.746865 [debug] [MainThread]: On master: COMMIT
[0m14:52:49.749223 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:52:49.750041 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:52:49.845662 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09456896781921387 seconds
[0m14:52:49.847324 [debug] [MainThread]: On master: Close
[0m14:52:49.950444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:49.951277 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:52:49.951624 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:52:49.951930 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:52:49.952379 [info ] [MainThread]: 
[0m14:52:49.952763 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.03 seconds (8.03s).
[0m14:52:49.953510 [debug] [MainThread]: Command end result
[0m14:52:49.965204 [info ] [MainThread]: 
[0m14:52:49.965843 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:52:49.966159 [info ] [MainThread]: 
[0m14:52:49.966459 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:52:49.967007 [error] [MainThread]:   ORA-00933: SQL command not properly ended
[0m14:52:49.967321 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:52:49.967687 [info ] [MainThread]: 
[0m14:52:49.968010 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:52:49.968252 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:52:49.968486 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:52:49.968712 [info ] [MainThread]: 
[0m14:52:49.968957 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:52:49.969210 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:52:49.969442 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:52:49.969692 [info ] [MainThread]: 
[0m14:52:49.969988 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:52:49.970563 [debug] [MainThread]: Command `dbt run` failed at 14:52:49.970468 after 8.34 seconds
[0m14:52:49.970894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c83d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c83d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052686d0>]}
[0m14:52:49.971338 [debug] [MainThread]: Flushing usage events
[0m14:53:00.907920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111008b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11102c150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11102c7d0>]}


============================== 14:53:00.910743 | 947b7bb0-0441-459a-a696-a3f8244d6b20 ==============================
[0m14:53:00.910743 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:53:00.911084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Downloads/', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:53:01.010958 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:53:01.041094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '947b7bb0-0441-459a-a696-a3f8244d6b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110d1d10>]}
[0m14:53:01.066166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '947b7bb0-0441-459a-a696-a3f8244d6b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116f3d90>]}
[0m14:53:01.093761 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:53:01.160081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:53:01.160484 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:53:01.170445 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:53:01.180392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '947b7bb0-0441-459a-a696-a3f8244d6b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111737590>]}
[0m14:53:01.193475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '947b7bb0-0441-459a-a696-a3f8244d6b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111990290>]}
[0m14:53:01.193711 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:53:01.193894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '947b7bb0-0441-459a-a696-a3f8244d6b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111749690>]}
[0m14:53:01.194913 [info ] [MainThread]: 
[0m14:53:01.195336 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:53:01.196054 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:53:01.201580 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:53:01.201837 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:53:01.201984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:01.202113 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:53:02.960771 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.75826096534729 seconds
[0m14:53:03.070869 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:53:03.187497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:53:03.193647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:03.194123 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:53:04.389778 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:53:04.390518 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:53:04.507098 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11607813835144043 seconds
[0m14:53:04.690111 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:53:04.785932 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:53:04.892051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '947b7bb0-0441-459a-a696-a3f8244d6b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108be890>]}
[0m14:53:04.892832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:04.893142 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:53:06.092975 [debug] [MainThread]: On master: COMMIT
[0m14:53:06.094453 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:53:06.094998 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:53:06.191658 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09579706192016602 seconds
[0m14:53:06.193373 [debug] [MainThread]: On master: Close
[0m14:53:06.298980 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:53:06.300187 [info ] [MainThread]: 
[0m14:53:06.313850 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:53:06.314363 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:53:06.314697 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:53:06.315150 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:53:06.315540 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:53:06.315877 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:53:06.316474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:53:06.317256 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:53:06.317853 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:53:06.318153 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:53:06.318586 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:53:06.319029 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:53:06.320937 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:53:06.323275 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:53:06.324542 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:53:06.327887 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:53:06.319309 => 14:53:06.327646
[0m14:53:06.328216 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:53:06.321183 => 14:53:06.328067
[0m14:53:06.328460 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:53:06.323509 => 14:53:06.328354
[0m14:53:06.328746 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:53:06.328981 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:53:06.329248 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:53:06.343556 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:53:06.345069 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:53:06.346577 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:53:06.354252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:06.354577 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:53:06.354855 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:53:06.355164 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:53:06.355577 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:53:06.356086 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:53:07.600962 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:53:07.602860 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:53:07.603540 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:53:07.604747 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:53:07.795871 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:53:07.797494 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:53:07.798385 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:53:07.799217 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:53:07.894393 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:53:07.894980 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:53:07.966963 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:53:07.967910 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    SELECT DISTICT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status

FROM mobile_events


[0m14:53:07.999485 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:53:06.345243 => 14:53:07.998574
[0m14:53:08.009845 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:53:06.343776 => 14:53:08.009522
[0m14:53:08.021130 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:53:08.022466 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:53:08.024986 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947b7bb0-0441-459a-a696-a3f8244d6b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a649d0>]}
[0m14:53:08.027573 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947b7bb0-0441-459a-a696-a3f8244d6b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b94910>]}
[0m14:53:08.028372 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.71s]
[0m14:53:08.029055 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.71s]
[0m14:53:08.029710 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:53:08.030152 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:53:08.031057 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:53:08.031502 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:53:08.031950 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:53:08.163989 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00904: "DISTICT": invalid identifier
[0m14:53:08.164782 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:53:08.260657 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:53:08.367918 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:53:06.329421 => 14:53:08.366976
[0m14:53:08.372474 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00904: "DISTICT": invalid identifier
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:53:08.374281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947b7bb0-0441-459a-a696-a3f8244d6b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a73810>]}
[0m14:53:08.374823 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 2.06s]
[0m14:53:08.375220 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:53:08.376186 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:53:08.376460 [debug] [Thread-2 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:53:08.376786 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:53:08.377030 [info ] [Thread-3 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:53:08.377372 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:53:08.377682 [info ] [Thread-2 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:53:08.378334 [info ] [Thread-4 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:53:08.379197 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:53:08.379705 [info ] [Thread-1 (]: 8 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m14:53:08.380259 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:53:08.380651 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:53:08.381098 [debug] [Thread-3 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:53:08.381570 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:53:08.381894 [debug] [Thread-2 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:53:08.382288 [info ] [Thread-3 (]: 9 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:53:08.382785 [info ] [Thread-2 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m14:53:08.383181 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:53:08.383448 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:53:08.385649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:08.386083 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:53:09.550795 [debug] [MainThread]: On master: COMMIT
[0m14:53:09.551134 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:53:09.551301 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:53:09.644639 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09308433532714844 seconds
[0m14:53:09.645046 [debug] [MainThread]: On master: Close
[0m14:53:09.745293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:09.745973 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:53:09.746315 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:53:09.746622 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:53:09.747070 [info ] [MainThread]: 
[0m14:53:09.747572 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m14:53:09.748613 [debug] [MainThread]: Command end result
[0m14:53:09.784075 [info ] [MainThread]: 
[0m14:53:09.784794 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:53:09.785124 [info ] [MainThread]: 
[0m14:53:09.785436 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:53:09.785728 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:53:09.785995 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:53:09.786253 [info ] [MainThread]: 
[0m14:53:09.786517 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:53:09.786769 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:53:09.787024 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:53:09.787286 [info ] [MainThread]: 
[0m14:53:09.787571 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:53:09.787816 [error] [MainThread]:   ORA-00904: "DISTICT": invalid identifier
[0m14:53:09.788037 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:53:09.788269 [info ] [MainThread]: 
[0m14:53:09.788548 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:53:09.789107 [debug] [MainThread]: Command `dbt run` failed at 14:53:09.789028 after 8.91 seconds
[0m14:53:09.789438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b0d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111752490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa7a90>]}
[0m14:53:09.789727 [debug] [MainThread]: Flushing usage events
[0m14:53:52.238661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e3f90>]}


============================== 14:53:52.241591 | 2b88568b-9fa7-476a-b17c-1ac34f9a9204 ==============================
[0m14:53:52.241591 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:53:52.241942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:53:52.338551 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:53:52.365453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b88568b-9fa7-476a-b17c-1ac34f9a9204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d6550>]}
[0m14:53:52.391473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b88568b-9fa7-476a-b17c-1ac34f9a9204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664a410>]}
[0m14:53:52.416836 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:53:52.469313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:53:52.469714 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:53:52.479284 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:53:52.489575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b88568b-9fa7-476a-b17c-1ac34f9a9204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105738c90>]}
[0m14:53:52.497091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b88568b-9fa7-476a-b17c-1ac34f9a9204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd2ed0>]}
[0m14:53:52.497323 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:53:52.497511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b88568b-9fa7-476a-b17c-1ac34f9a9204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd4990>]}
[0m14:53:52.498553 [info ] [MainThread]: 
[0m14:53:52.498983 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:53:52.499604 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:53:52.505246 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:53:52.505521 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:53:52.505667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:52.505796 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:53:57.074118 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 4.566832780838013 seconds
[0m14:53:57.174566 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:53:57.282685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:53:57.290012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:57.290539 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:53:58.526800 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:53:58.528523 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:53:58.648381 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11878108978271484 seconds
[0m14:53:58.836835 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:53:58.932303 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:53:59.040233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b88568b-9fa7-476a-b17c-1ac34f9a9204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f9550>]}
[0m14:53:59.041217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:59.041654 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:54:00.246298 [debug] [MainThread]: On master: COMMIT
[0m14:54:00.248218 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:54:00.248768 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:54:00.348314 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09856700897216797 seconds
[0m14:54:00.349956 [debug] [MainThread]: On master: Close
[0m14:54:00.453610 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:00.454317 [info ] [MainThread]: 
[0m14:54:00.471918 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:54:00.472342 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:54:00.472621 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:54:00.473318 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:54:00.473993 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:54:00.474492 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:54:00.475247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:54:00.475791 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:54:00.476495 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:54:00.476871 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:54:00.477205 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:54:00.477498 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:54:00.479345 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:54:00.481446 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:54:00.482841 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:54:00.486265 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:54:00.477721 => 14:54:00.486039
[0m14:54:00.486612 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:54:00.479606 => 14:54:00.486468
[0m14:54:00.486950 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:54:00.481667 => 14:54:00.486748
[0m14:54:00.487336 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:54:00.487605 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:54:00.487829 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:54:00.501168 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:54:00.503257 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:54:00.505097 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:54:00.527641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:00.528035 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:54:00.528451 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:54:00.528660 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:54:00.528862 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:54:00.529048 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:54:01.699726 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:54:01.700148 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:54:01.701518 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:54:01.701766 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    SELECT DISTINCT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status

FROM mobile_events


[0m14:54:01.724702 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:54:01.724998 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:54:01.892299 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:54:01.893363 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:54:01.915554 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:54:01.916353 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:54:01.988985 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:54:02.012544 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:54:02.087477 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:54:00.503513 => 14:54:02.087058
[0m14:54:02.110779 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:54:00.501451 => 14:54:02.110479
[0m14:54:02.128006 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.42589306831359863 seconds
[0m14:54:02.139226 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m14:54:02.140113 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:54:02.140417 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m14:54:02.194076 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:54:02.196414 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:54:02.198863 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b88568b-9fa7-476a-b17c-1ac34f9a9204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2dad0>]}
[0m14:54:02.200856 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b88568b-9fa7-476a-b17c-1ac34f9a9204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa5710>]}
[0m14:54:02.201547 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.72s]
[0m14:54:02.202581 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.72s]
[0m14:54:02.203488 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:54:02.204107 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:54:02.205219 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:54:02.205717 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:54:02.206281 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:54:02.236995 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.0962531566619873 seconds
[0m14:54:02.241093 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:54:02.241470 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m14:54:02.342419 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10060691833496094 seconds
[0m14:54:02.349774 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:54:00.487989 => 14:54:02.349661
[0m14:54:02.350018 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:54:02.454600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b88568b-9fa7-476a-b17c-1ac34f9a9204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d98950>]}
[0m14:54:02.456158 [info ] [Thread-1 (]: 1 of 10 OK created sql view model FAWDBTCORE.stg_mobile_events ................. [[32mOK[0m in 1.98s]
[0m14:54:02.456822 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:54:02.457835 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:54:02.458327 [debug] [Thread-2 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:54:02.458873 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:54:02.459239 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:54:02.459633 [info ] [Thread-3 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:54:02.460063 [info ] [Thread-2 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:54:02.460455 [info ] [Thread-4 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:54:02.461015 [info ] [Thread-1 (]: 8 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m14:54:02.461711 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:54:02.462150 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:54:02.462538 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:54:02.462903 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:54:02.463317 [debug] [Thread-3 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:54:02.463914 [debug] [Thread-2 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:54:02.464661 [info ] [Thread-3 (]: 9 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:54:02.465045 [info ] [Thread-2 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m14:54:02.465480 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:54:02.465857 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:54:02.468106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:02.468573 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:54:03.653681 [debug] [MainThread]: On master: COMMIT
[0m14:54:03.655078 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:54:03.655670 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:54:03.750867 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.0941469669342041 seconds
[0m14:54:03.752151 [debug] [MainThread]: On master: Close
[0m14:54:03.855549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:03.856252 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:54:03.856592 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:54:03.856886 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:54:03.857292 [info ] [MainThread]: 
[0m14:54:03.857752 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 11.36 seconds (11.36s).
[0m14:54:03.858847 [debug] [MainThread]: Command end result
[0m14:54:03.873857 [info ] [MainThread]: 
[0m14:54:03.874574 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:54:03.874894 [info ] [MainThread]: 
[0m14:54:03.875175 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:54:03.875441 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:54:03.875695 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:54:03.875931 [info ] [MainThread]: 
[0m14:54:03.876171 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:54:03.876404 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:54:03.876637 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:54:03.876899 [info ] [MainThread]: 
[0m14:54:03.877190 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=7 TOTAL=10
[0m14:54:03.877885 [debug] [MainThread]: Command `dbt run` failed at 14:54:03.877792 after 11.66 seconds
[0m14:54:03.878261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f18cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f1b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c0610>]}
[0m14:54:03.878592 [debug] [MainThread]: Flushing usage events
[0m14:55:18.878497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b17e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b17fd0>]}


============================== 14:55:18.886003 | 4868c3ee-0008-4500-9764-23f0a02e755a ==============================
[0m14:55:18.886003 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:55:18.886369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:55:18.997407 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:55:19.024837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4868c3ee-0008-4500-9764-23f0a02e755a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2c4d0>]}
[0m14:55:19.050115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4868c3ee-0008-4500-9764-23f0a02e755a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044128d0>]}
[0m14:55:19.071430 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:55:19.130912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:55:19.131308 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:55:19.141157 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:55:19.150952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4868c3ee-0008-4500-9764-23f0a02e755a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b58b90>]}
[0m14:55:19.158323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4868c3ee-0008-4500-9764-23f0a02e755a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10533aa10>]}
[0m14:55:19.158548 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:55:19.158728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4868c3ee-0008-4500-9764-23f0a02e755a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105345110>]}
[0m14:55:19.159694 [info ] [MainThread]: 
[0m14:55:19.160209 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:55:19.160958 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:55:19.166098 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:55:19.166356 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:55:19.166503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:19.166647 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:20.734984 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.5679149627685547 seconds
[0m14:55:20.846731 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:55:20.954972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:55:20.962768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:20.963206 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:22.229355 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:55:22.231072 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:55:22.356167 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12417483329772949 seconds
[0m14:55:22.551836 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:55:22.655235 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:55:22.766543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4868c3ee-0008-4500-9764-23f0a02e755a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b58c50>]}
[0m14:55:22.767386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:22.767757 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:24.056053 [debug] [MainThread]: On master: COMMIT
[0m14:55:24.058049 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:55:24.058688 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:55:24.172859 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10556435585021973 seconds
[0m14:55:24.174666 [debug] [MainThread]: On master: Close
[0m14:55:24.289083 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:24.289814 [info ] [MainThread]: 
[0m14:55:24.301475 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:55:24.301939 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:55:24.302271 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:55:24.302854 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:55:24.303321 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:55:24.303805 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:55:24.304994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:55:24.305638 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:55:24.306415 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:55:24.306803 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:55:24.307089 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:55:24.307343 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:55:24.309202 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:55:24.311434 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:55:24.312758 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:55:24.314029 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:55:24.309420 => 14:55:24.313826
[0m14:55:24.314404 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:55:24.311685 => 14:55:24.314255
[0m14:55:24.314635 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:55:24.314870 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:55:24.307540 => 14:55:24.314760
[0m14:55:24.315127 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:55:24.329863 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:55:24.330220 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:55:24.331943 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:55:24.333959 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:55:24.337825 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:55:24.338157 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:24.351800 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:55:24.352238 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:24.352709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:24.352946 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:25.636727 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:55:25.637893 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:55:25.639897 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:55:25.638877 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_cleaned as ( 
  
  SELECT DISTINCT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status 

FROM mobile_events
)


[0m14:55:25.644504 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:55:25.645544 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:55:25.874245 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:55:25.876077 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:55:25.877041 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:55:25.877934 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:55:25.878601 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m14:55:25.879560 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:55:25.990204 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:55:25.993957 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:55:25.994304 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:55:26.096106 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:55:24.315285 => 14:55:26.095723
[0m14:55:26.098816 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:55:24.330401 => 14:55:26.098509
[0m14:55:26.099362 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:55:24.332252 => 14:55:26.099174
[0m14:55:26.115293 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:55:26.116374 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:55:26.118032 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4868c3ee-0008-4500-9764-23f0a02e755a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055148d0>]}
[0m14:55:26.118930 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:55:26.120275 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4868c3ee-0008-4500-9764-23f0a02e755a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd00d0>]}
[0m14:55:26.120769 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.81s]
[0m14:55:26.122170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4868c3ee-0008-4500-9764-23f0a02e755a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b09a90>]}
[0m14:55:26.122547 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.81s]
[0m14:55:26.123055 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:55:26.123550 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.82s]
[0m14:55:26.123905 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:55:26.124222 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:55:26.124763 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:55:26.125288 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:55:26.125650 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:55:26.125879 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:55:26.126095 [debug] [Thread-4 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:55:26.126281 [debug] [Thread-2 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:55:26.126599 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:55:26.126951 [info ] [Thread-3 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:55:26.127309 [info ] [Thread-4 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:55:26.127755 [info ] [Thread-2 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:55:26.128087 [info ] [Thread-1 (]: 8 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m14:55:26.128458 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:55:26.128821 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:55:26.129045 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:55:26.129255 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:55:26.129487 [debug] [Thread-3 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:55:26.129932 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:55:26.130494 [info ] [Thread-3 (]: 9 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:55:26.130820 [info ] [Thread-4 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m14:55:26.131113 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:55:26.131364 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:55:26.132569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:26.132752 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:27.425872 [debug] [MainThread]: On master: COMMIT
[0m14:55:27.426597 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:55:27.427000 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:55:27.535747 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.1080467700958252 seconds
[0m14:55:27.536887 [debug] [MainThread]: On master: Close
[0m14:55:27.648601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:27.649594 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:55:27.649982 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:55:27.650291 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:55:27.650787 [info ] [MainThread]: 
[0m14:55:27.651352 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.49 seconds (8.49s).
[0m14:55:27.652418 [debug] [MainThread]: Command end result
[0m14:55:27.671359 [info ] [MainThread]: 
[0m14:55:27.672016 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:55:27.672281 [info ] [MainThread]: 
[0m14:55:27.672555 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:55:27.672825 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:55:27.673055 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:55:27.673278 [info ] [MainThread]: 
[0m14:55:27.673531 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:55:27.673775 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:55:27.674008 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:55:27.674224 [info ] [MainThread]: 
[0m14:55:27.674448 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:55:27.674669 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m14:55:27.674884 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:55:27.675117 [info ] [MainThread]: 
[0m14:55:27.675416 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:55:27.676095 [debug] [MainThread]: Command `dbt run` failed at 14:55:27.675997 after 8.83 seconds
[0m14:55:27.676548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100494cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100494d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2c910>]}
[0m14:55:27.676837 [debug] [MainThread]: Flushing usage events
[0m14:55:48.473084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100e0b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a17f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a17fd0>]}


============================== 14:55:48.486010 | bc0a42a5-6720-411b-a36c-47aeadbb343b ==============================
[0m14:55:48.486010 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:55:48.486391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:55:48.592831 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:55:48.622850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc0a42a5-6720-411b-a36c-47aeadbb343b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a2c490>]}
[0m14:55:48.648006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc0a42a5-6720-411b-a36c-47aeadbb343b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11282de10>]}
[0m14:55:48.670757 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:55:48.716339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:55:48.716730 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:55:48.725998 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:55:48.735625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc0a42a5-6720-411b-a36c-47aeadbb343b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10712ddd0>]}
[0m14:55:48.747047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc0a42a5-6720-411b-a36c-47aeadbb343b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ac410>]}
[0m14:55:48.747294 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:55:48.747492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc0a42a5-6720-411b-a36c-47aeadbb343b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072949d0>]}
[0m14:55:48.748509 [info ] [MainThread]: 
[0m14:55:48.748956 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:55:48.749661 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:55:48.754842 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:55:48.755086 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:55:48.755227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:48.755356 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:50.458557 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.7025959491729736 seconds
[0m14:55:50.570175 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:55:50.681933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:55:50.688187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:50.688569 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:51.955751 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:55:51.956531 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:55:52.081353 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12429690361022949 seconds
[0m14:55:52.271332 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:55:52.432800 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:55:52.540696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc0a42a5-6720-411b-a36c-47aeadbb343b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129d3890>]}
[0m14:55:52.541751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:52.542364 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:53.805006 [debug] [MainThread]: On master: COMMIT
[0m14:55:53.805869 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:55:53.806265 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:55:53.909235 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10234713554382324 seconds
[0m14:55:53.910362 [debug] [MainThread]: On master: Close
[0m14:55:54.026521 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:54.027375 [info ] [MainThread]: 
[0m14:55:54.049135 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:55:54.049676 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:55:54.049961 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:55:54.050439 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:55:54.050976 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:55:54.051410 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:55:54.052362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:55:54.052992 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:55:54.053471 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:55:54.053759 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:55:54.054002 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:55:54.054209 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:55:54.055689 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:55:54.057652 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:55:54.058444 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:55:54.066862 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:55:54.055889 => 14:55:54.066673
[0m14:55:54.067240 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:55:54.054362 => 14:55:54.067022
[0m14:55:54.067604 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:55:54.067971 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:55:54.057790 => 14:55:54.067824
[0m14:55:54.068242 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:55:54.080924 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:55:54.081356 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:55:54.083112 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:55:54.084835 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:55:54.115889 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:55:54.116259 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:55:54.116466 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:54.116667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:54.116921 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:54.117307 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:55.432191 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:55:55.432957 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:55:55.450531 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:55:55.451632 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    mobile_events_cleaned as ( 
  
  SELECT DISTINCT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status 

FROM mobile_events
)


[0m14:55:55.452985 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:55:55.453515 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:55:55.651971 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:55:55.652883 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:55:55.661431 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m14:55:55.662127 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:55:55.669826 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:55:55.670478 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:55:55.755219 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:55:55.766794 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:55:55.775101 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:55:55.858986 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:55:54.068481 => 14:55:55.858546
[0m14:55:55.875363 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:55:54.081563 => 14:55:55.875021
[0m14:55:55.885467 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:55:54.083362 => 14:55:55.885058
[0m14:55:56.020642 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:55:56.022219 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:55:56.023693 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:55:56.025823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0a42a5-6720-411b-a36c-47aeadbb343b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112909350>]}
[0m14:55:56.027681 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0a42a5-6720-411b-a36c-47aeadbb343b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d3b610>]}
[0m14:55:56.029491 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0a42a5-6720-411b-a36c-47aeadbb343b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112904650>]}
[0m14:55:56.030174 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.97s]
[0m14:55:56.030734 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.97s]
[0m14:55:56.031233 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.98s]
[0m14:55:56.031711 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:55:56.032051 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:55:56.032368 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:55:56.033595 [debug] [Thread-4 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:55:56.034165 [debug] [Thread-1 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:55:56.034667 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:55:56.035165 [debug] [Thread-3 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:55:56.035605 [debug] [Thread-2 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:55:56.035944 [info ] [Thread-1 (]: 5 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:55:56.036447 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:55:56.036778 [info ] [Thread-3 (]: 6 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:55:56.037174 [info ] [Thread-2 (]: 7 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:55:56.037767 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:55:56.038227 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:55:56.038600 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:55:56.038899 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:55:56.039213 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:55:56.039684 [info ] [Thread-4 (]: 8 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................. [[33mSKIP[0m]
[0m14:55:56.040145 [debug] [Thread-3 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:55:56.040727 [info ] [Thread-1 (]: 9 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:55:56.041178 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:55:56.041458 [info ] [Thread-3 (]: 10 of 10 SKIP relation FAWDBTCORE.frequent_web_users ........................... [[33mSKIP[0m]
[0m14:55:56.041845 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:55:56.042384 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:55:56.043952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:56.044393 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:55:57.307868 [debug] [MainThread]: On master: COMMIT
[0m14:55:57.309236 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:55:57.309618 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:55:57.412682 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10218310356140137 seconds
[0m14:55:57.414299 [debug] [MainThread]: On master: Close
[0m14:55:57.524834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:57.525590 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:55:57.525929 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:55:57.526237 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:55:57.526710 [info ] [MainThread]: 
[0m14:55:57.527525 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.78 seconds (8.78s).
[0m14:55:57.528778 [debug] [MainThread]: Command end result
[0m14:55:57.573836 [info ] [MainThread]: 
[0m14:55:57.574546 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:55:57.574940 [info ] [MainThread]: 
[0m14:55:57.575431 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:55:57.575889 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m14:55:57.576231 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:55:57.576546 [info ] [MainThread]: 
[0m14:55:57.576829 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:55:57.577099 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:55:57.577358 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:55:57.577628 [info ] [MainThread]: 
[0m14:55:57.577882 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:55:57.578129 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:55:57.578371 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:55:57.578596 [info ] [MainThread]: 
[0m14:55:57.578858 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:55:57.579427 [debug] [MainThread]: Command `dbt run` failed at 14:55:57.579345 after 9.15 seconds
[0m14:55:57.579743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ef0d0>]}
[0m14:55:57.580008 [debug] [MainThread]: Flushing usage events
[0m14:57:11.635942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106187b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106193b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106193f90>]}


============================== 14:57:11.642952 | 88d03c92-51c4-4765-b804-0dd36acdbd11 ==============================
[0m14:57:11.642952 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:57:11.643289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:57:11.734150 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:57:11.764184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88d03c92-51c4-4765-b804-0dd36acdbd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c00d0>]}
[0m14:57:11.788362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88d03c92-51c4-4765-b804-0dd36acdbd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a9bd0>]}
[0m14:57:11.809414 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:57:11.857993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:57:11.858368 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:57:11.867446 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:57:11.876929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88d03c92-51c4-4765-b804-0dd36acdbd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4c250>]}
[0m14:57:11.889045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88d03c92-51c4-4765-b804-0dd36acdbd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069aa510>]}
[0m14:57:11.889277 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:57:11.889458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88d03c92-51c4-4765-b804-0dd36acdbd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106888e10>]}
[0m14:57:11.890460 [info ] [MainThread]: 
[0m14:57:11.890885 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:57:11.891615 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:57:11.897038 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:57:11.897288 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:57:11.897419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:11.897548 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:13.515134 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.6170580387115479 seconds
[0m14:57:13.630921 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:57:13.745056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:57:13.751220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:13.751600 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:15.016195 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:57:15.017150 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:57:15.142957 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12485504150390625 seconds
[0m14:57:15.354404 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:57:15.457302 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:57:15.572451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88d03c92-51c4-4765-b804-0dd36acdbd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621a850>]}
[0m14:57:15.573216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:15.573559 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:16.845342 [debug] [MainThread]: On master: COMMIT
[0m14:57:16.846788 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:57:16.847189 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:57:16.954935 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10653185844421387 seconds
[0m14:57:16.956796 [debug] [MainThread]: On master: Close
[0m14:57:17.070581 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:57:17.071294 [info ] [MainThread]: 
[0m14:57:17.093225 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:57:17.093946 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:57:17.094486 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:57:17.095014 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:57:17.095536 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:57:17.095936 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:57:17.096819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:57:17.097386 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:57:17.097855 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:57:17.098116 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:57:17.098338 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:57:17.098759 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:57:17.100734 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:57:17.103176 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:57:17.104407 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:57:17.105807 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:57:17.099096 => 14:57:17.105590
[0m14:57:17.106130 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:57:17.106499 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:57:17.103420 => 14:57:17.106251
[0m14:57:17.119919 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:57:17.100996 => 14:57:17.119710
[0m14:57:17.120125 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:57:17.120384 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:57:17.120709 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:57:17.122652 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:57:17.124203 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:57:17.125954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:17.126171 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:17.132839 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:57:17.133085 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:57:17.133303 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:17.133510 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:18.361969 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:57:18.362761 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    mobile_events_cleaned as ( 
  
  SELECT DISTINCT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status 

FROM mobile_events;

)

SELECT * from mobile_events_cleaned


[0m14:57:18.386364 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:57:18.387008 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:57:18.388185 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:57:18.388667 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:57:18.568474 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m14:57:18.569262 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:57:18.635429 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:57:18.637221 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:57:18.641758 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:57:18.642471 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:57:18.672533 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:57:18.744164 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:57:18.745420 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:57:18.783471 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:57:17.106839 => 14:57:18.782748
[0m14:57:18.794455 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:57:18.796992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88d03c92-51c4-4765-b804-0dd36acdbd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069329d0>]}
[0m14:57:18.797697 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.70s]
[0m14:57:18.798264 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:57:18.846972 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:57:17.120997 => 14:57:18.846684
[0m14:57:18.849636 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:57:18.851196 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88d03c92-51c4-4765-b804-0dd36acdbd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688ad10>]}
[0m14:57:18.851653 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.75s]
[0m14:57:18.852507 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:57:17.122838 => 14:57:18.852250
[0m14:57:18.852848 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:57:18.854994 [debug] [Thread-4 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:57:18.856194 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:57:18.856901 [debug] [Thread-1 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:57:18.856615 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:57:18.857300 [debug] [Thread-3 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:57:18.858732 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88d03c92-51c4-4765-b804-0dd36acdbd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106888390>]}
[0m14:57:18.859042 [info ] [Thread-1 (]: 5 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:57:18.859459 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:57:18.859762 [info ] [Thread-3 (]: 6 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:57:18.860251 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.76s]
[0m14:57:18.860744 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:57:18.861110 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:57:18.861458 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:57:18.861790 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:57:18.862080 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:57:18.862428 [info ] [Thread-4 (]: 7 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:57:18.863199 [debug] [Thread-3 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:57:18.863456 [info ] [Thread-1 (]: 8 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................. [[33mSKIP[0m]
[0m14:57:18.863792 [debug] [Thread-2 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:57:18.864083 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:57:18.864375 [info ] [Thread-3 (]: 9 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:57:18.864730 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:57:18.864954 [info ] [Thread-2 (]: 10 of 10 SKIP relation FAWDBTCORE.frequent_web_users ........................... [[33mSKIP[0m]
[0m14:57:18.865420 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:57:18.865803 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:57:18.867095 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:18.867397 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:20.108673 [debug] [MainThread]: On master: COMMIT
[0m14:57:20.110433 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:57:20.110899 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:57:20.212867 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10107707977294922 seconds
[0m14:57:20.215430 [debug] [MainThread]: On master: Close
[0m14:57:20.331323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:20.332085 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:57:20.332365 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:57:20.332612 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:57:20.333014 [info ] [MainThread]: 
[0m14:57:20.333447 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.44 seconds (8.44s).
[0m14:57:20.334329 [debug] [MainThread]: Command end result
[0m14:57:20.349565 [info ] [MainThread]: 
[0m14:57:20.350395 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:57:20.350932 [info ] [MainThread]: 
[0m14:57:20.351304 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:57:20.351588 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m14:57:20.351837 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:57:20.352081 [info ] [MainThread]: 
[0m14:57:20.352324 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:57:20.352555 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:57:20.352778 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:57:20.353070 [info ] [MainThread]: 
[0m14:57:20.353325 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:57:20.353554 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:57:20.353794 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:57:20.354058 [info ] [MainThread]: 
[0m14:57:20.354342 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:57:20.354891 [debug] [MainThread]: Command `dbt run` failed at 14:57:20.354812 after 8.74 seconds
[0m14:57:20.355196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ac8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ac8d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061cc5d0>]}
[0m14:57:20.355462 [debug] [MainThread]: Flushing usage events
[0m14:57:39.226683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bbfcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bbff90>]}


============================== 14:57:39.229994 | b7e5e4e5-2afc-4372-b5ba-9575af0f8d5b ==============================
[0m14:57:39.229994 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:57:39.230340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:57:39.315661 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:57:39.354613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7e5e4e5-2afc-4372-b5ba-9575af0f8d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107becd90>]}
[0m14:57:39.379471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7e5e4e5-2afc-4372-b5ba-9575af0f8d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108217350>]}
[0m14:57:39.410587 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:57:39.471025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:57:39.471403 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:57:39.480936 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:57:39.490467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7e5e4e5-2afc-4372-b5ba-9575af0f8d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830d750>]}
[0m14:57:39.501103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7e5e4e5-2afc-4372-b5ba-9575af0f8d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d5d90>]}
[0m14:57:39.501409 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:57:39.501603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7e5e4e5-2afc-4372-b5ba-9575af0f8d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10847ca10>]}
[0m14:57:39.502814 [info ] [MainThread]: 
[0m14:57:39.503331 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:57:39.504101 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:57:39.509808 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:57:39.510102 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:57:39.510246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:39.510383 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:41.090479 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.5796000957489014 seconds
[0m14:57:41.208603 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:57:41.326491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:57:41.332289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:41.332706 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:42.590015 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:57:42.591771 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:57:42.715749 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12280082702636719 seconds
[0m14:57:42.908448 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:57:43.010994 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:57:43.120159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7e5e4e5-2afc-4372-b5ba-9575af0f8d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830c790>]}
[0m14:57:43.120506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:43.120656 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:44.399034 [debug] [MainThread]: On master: COMMIT
[0m14:57:44.403206 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:57:44.403835 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:57:44.508579 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10371088981628418 seconds
[0m14:57:44.510337 [debug] [MainThread]: On master: Close
[0m14:57:44.622115 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:57:44.623106 [info ] [MainThread]: 
[0m14:57:48.547242 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:57:48.547668 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:57:48.547989 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:57:48.548437 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:57:48.548853 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:57:48.549225 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:57:48.549890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:57:48.550415 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:57:48.550903 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:57:48.551156 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:57:48.551383 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:57:48.551596 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:57:48.553291 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:57:48.555431 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:57:48.556570 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:57:48.564672 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:57:48.551754 => 14:57:48.564437
[0m14:57:48.565058 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:57:48.555641 => 14:57:48.564851
[0m14:57:48.565336 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:57:48.553540 => 14:57:48.565235
[0m14:57:48.565603 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:57:48.565867 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:57:48.566101 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:57:48.579703 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:57:48.581451 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:57:48.583214 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:57:51.638890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:51.643174 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:51.664119 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:57:51.665382 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:51.674858 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:57:51.675629 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:52.904310 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:57:52.905906 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_cleaned as ( 
  
  SELECT DISTINCT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status 

FROM mobile_events;

)

SELECT * from mobile_events_cleaned


[0m14:57:52.942833 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:57:52.943883 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:57:52.944598 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:57:52.945126 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:57:53.126156 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:57:53.127898 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:57:53.173921 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:57:53.174291 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:57:53.174802 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:57:53.175005 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:57:53.231199 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:57:53.279201 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:57:53.279691 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:57:53.343200 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:57:48.566242 => 14:57:53.342456
[0m14:57:53.382414 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:57:48.579945 => 14:57:53.382042
[0m14:57:53.384432 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:57:48.581687 => 14:57:53.384235
[0m14:57:55.091982 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:57:55.095097 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:57:55.096749 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:57:55.099316 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e5e4e5-2afc-4372-b5ba-9575af0f8d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108589490>]}
[0m14:57:55.101560 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e5e4e5-2afc-4372-b5ba-9575af0f8d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108589610>]}
[0m14:57:55.103795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e5e4e5-2afc-4372-b5ba-9575af0f8d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10843e750>]}
[0m14:57:55.104570 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 6.55s]
[0m14:57:55.105234 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 6.55s]
[0m14:57:55.106146 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 6.55s]
[0m14:57:55.106816 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:57:55.107188 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:57:55.107512 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:57:55.108554 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:57:55.109401 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:57:55.109870 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:57:55.110243 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:57:55.110558 [debug] [Thread-2 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:57:55.110870 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:57:55.111144 [info ] [Thread-3 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:57:55.111631 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:57:55.112015 [info ] [Thread-2 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:57:55.112393 [info ] [Thread-1 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:57:55.112759 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:57:55.113084 [info ] [Thread-4 (]: 8 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m14:57:55.113513 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:57:55.113878 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:57:55.114208 [debug] [Thread-3 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:57:55.114773 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:57:55.115181 [debug] [Thread-2 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:57:55.115693 [info ] [Thread-3 (]: 9 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:57:55.116314 [info ] [Thread-2 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m14:57:55.116693 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:57:55.117005 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:57:55.118478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:55.118784 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:57:56.483272 [debug] [MainThread]: On master: COMMIT
[0m14:57:56.484806 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:57:56.485247 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:57:56.592991 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10685110092163086 seconds
[0m14:57:56.594704 [debug] [MainThread]: On master: Close
[0m14:57:56.706221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:56.706994 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:57:56.707325 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:57:56.707615 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:57:56.708079 [info ] [MainThread]: 
[0m14:57:56.708600 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 17.20 seconds (17.20s).
[0m14:57:56.709854 [debug] [MainThread]: Command end result
[0m14:57:58.285389 [info ] [MainThread]: 
[0m14:57:58.286448 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:57:58.287097 [info ] [MainThread]: 
[0m14:57:58.287461 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:57:58.287768 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:57:58.288038 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:57:58.288303 [info ] [MainThread]: 
[0m14:57:58.288560 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:57:58.288818 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:57:58.289083 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:57:58.289338 [info ] [MainThread]: 
[0m14:57:58.289600 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:57:58.289857 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:57:58.290143 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:57:58.290457 [info ] [MainThread]: 
[0m14:57:58.290817 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:57:58.291509 [debug] [MainThread]: Command `dbt run` failed at 14:57:58.291408 after 19.10 seconds
[0m14:57:58.291899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9ef90>]}
[0m14:57:58.292251 [debug] [MainThread]: Flushing usage events
[0m14:58:38.963572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d17ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d17f90>]}


============================== 14:58:38.966679 | 06a813d1-1390-4ff6-870b-3f2e8b6e652c ==============================
[0m14:58:38.966679 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:58:38.967053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:58:39.086256 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:58:39.113962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06a813d1-1390-4ff6-870b-3f2e8b6e652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9f910>]}
[0m14:58:39.120496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06a813d1-1390-4ff6-870b-3f2e8b6e652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9ecd0>]}
[0m14:58:39.153316 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:58:39.226048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:58:39.226474 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:58:39.236252 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:58:39.246189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06a813d1-1390-4ff6-870b-3f2e8b6e652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110616c50>]}
[0m14:58:39.260637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06a813d1-1390-4ff6-870b-3f2e8b6e652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106d8d90>]}
[0m14:58:39.260879 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:58:39.261067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06a813d1-1390-4ff6-870b-3f2e8b6e652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102ddfd0>]}
[0m14:58:39.262148 [info ] [MainThread]: 
[0m14:58:39.262619 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:58:39.263288 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:58:39.268357 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:58:39.268585 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:58:39.268722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:39.268853 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:58:40.909282 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.6399579048156738 seconds
[0m14:58:41.016930 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:58:41.128144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:58:41.135204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:41.135594 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:58:42.387864 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:58:42.389678 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:58:42.514067 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.1231989860534668 seconds
[0m14:58:42.816700 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:58:42.921689 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:58:43.032328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06a813d1-1390-4ff6-870b-3f2e8b6e652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11080f850>]}
[0m14:58:43.033091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:43.033457 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:58:44.293006 [debug] [MainThread]: On master: COMMIT
[0m14:58:44.294786 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:58:44.295403 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:58:44.402565 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10633397102355957 seconds
[0m14:58:44.403208 [debug] [MainThread]: On master: Close
[0m14:58:44.508176 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:58:44.508753 [info ] [MainThread]: 
[0m14:58:44.515339 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:58:44.515840 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:58:44.516218 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:58:44.516731 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:58:44.517257 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:58:44.517781 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:58:44.518431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:58:44.518909 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:58:44.519372 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:58:44.519609 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:58:44.519821 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:58:44.520023 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:58:44.522268 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:58:44.524702 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:58:44.526523 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:58:44.547239 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:58:44.522678 => 14:58:44.547030
[0m14:58:44.547520 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:58:44.520694 => 14:58:44.547405
[0m14:58:44.547854 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:58:44.525494 => 14:58:44.547645
[0m14:58:44.548120 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:58:44.548410 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:58:44.548624 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:58:44.560209 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:58:44.561665 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:58:44.562799 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:58:44.566681 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:58:44.566898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:44.567059 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:58:44.567258 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:58:44.567468 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:58:44.567648 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:58:45.808026 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:58:45.808630 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:58:45.809102 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    mobile_events_cleaned as ( 
  
  SELECT DISTINCT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status 

FROM mobile_events

)

SELECT * from mobile_events_cleaned


[0m14:58:45.809502 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:58:45.810199 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:58:45.810526 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:58:46.020756 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:58:46.021818 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:58:46.027472 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m14:58:46.028097 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:58:46.028856 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:58:46.029293 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:58:46.129646 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:58:46.130635 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:58:46.132350 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:58:46.241018 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:58:44.548749 => 14:58:46.234358
[0m14:58:46.245566 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:58:44.560466 => 14:58:46.245313
[0m14:58:46.246048 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:58:44.561799 => 14:58:46.245863
[0m14:58:46.264030 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:58:46.265676 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:58:46.266921 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:58:46.268764 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06a813d1-1390-4ff6-870b-3f2e8b6e652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110873790>]}
[0m14:58:46.270518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06a813d1-1390-4ff6-870b-3f2e8b6e652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110891310>]}
[0m14:58:46.272516 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06a813d1-1390-4ff6-870b-3f2e8b6e652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102d9850>]}
[0m14:58:46.273130 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.75s]
[0m14:58:46.273824 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.75s]
[0m14:58:46.274380 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.75s]
[0m14:58:46.274816 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:58:46.275111 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:58:46.275393 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:58:46.275983 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:58:46.276589 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:58:46.276992 [debug] [Thread-1 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:58:46.277426 [debug] [Thread-2 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:58:46.276808 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:58:46.277955 [info ] [Thread-3 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:58:46.278450 [info ] [Thread-1 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:58:46.278715 [info ] [Thread-2 (]: 7 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:58:46.279078 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:58:46.279397 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:58:46.279651 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:58:46.279888 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:58:46.280158 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:58:46.280470 [debug] [Thread-3 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:58:46.280874 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:58:46.281238 [info ] [Thread-4 (]: 8 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................. [[33mSKIP[0m]
[0m14:58:46.281518 [info ] [Thread-3 (]: 9 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:58:46.281779 [info ] [Thread-1 (]: 10 of 10 SKIP relation FAWDBTCORE.frequent_web_users ........................... [[33mSKIP[0m]
[0m14:58:46.282094 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:58:46.282306 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:58:46.282515 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:58:46.283797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:46.284027 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:58:47.520929 [debug] [MainThread]: On master: COMMIT
[0m14:58:47.522447 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:58:47.523082 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:58:47.626186 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10223507881164551 seconds
[0m14:58:47.627560 [debug] [MainThread]: On master: Close
[0m14:58:47.743196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:47.744393 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:58:47.744839 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:58:47.745169 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:58:47.745671 [info ] [MainThread]: 
[0m14:58:47.746080 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m14:58:47.746783 [debug] [MainThread]: Command end result
[0m14:58:47.761092 [info ] [MainThread]: 
[0m14:58:47.761796 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:58:47.762106 [info ] [MainThread]: 
[0m14:58:47.762397 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:58:47.762692 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:58:47.762961 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:58:47.763364 [info ] [MainThread]: 
[0m14:58:47.763849 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:58:47.764120 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m14:58:47.764366 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:58:47.764604 [info ] [MainThread]: 
[0m14:58:47.764846 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:58:47.765078 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:58:47.765302 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:58:47.765541 [info ] [MainThread]: 
[0m14:58:47.765801 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:58:47.766322 [debug] [MainThread]: Command `dbt run` failed at 14:58:47.766247 after 8.86 seconds
[0m14:58:47.766620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d28190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10257fd50>]}
[0m14:58:47.766885 [debug] [MainThread]: Flushing usage events
[0m14:58:57.185808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104873c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104873c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487ffd0>]}


============================== 14:58:57.188540 | a4a5a089-020d-454e-84b1-c694ed4810a4 ==============================
[0m14:58:57.188540 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:58:57.188926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:58:57.252915 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:58:57.281065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4a5a089-020d-454e-84b1-c694ed4810a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ae210>]}
[0m14:58:57.305261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4a5a089-020d-454e-84b1-c694ed4810a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104894810>]}
[0m14:58:57.319634 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:58:57.367393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:58:57.367768 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:58:57.376986 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:58:57.386723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4a5a089-020d-454e-84b1-c694ed4810a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e6510>]}
[0m14:58:57.403531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4a5a089-020d-454e-84b1-c694ed4810a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f94dd0>]}
[0m14:58:57.403778 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:58:57.403970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4a5a089-020d-454e-84b1-c694ed4810a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104870810>]}
[0m14:58:57.404988 [info ] [MainThread]: 
[0m14:58:57.405408 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:58:57.406145 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:58:57.411272 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:58:57.411518 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:58:57.411658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:57.411785 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:58:59.190975 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.778656005859375 seconds
[0m14:58:59.306022 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:58:59.411720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:58:59.415854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:59.416086 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:59:00.662293 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:59:00.664110 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:59:00.791823 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12661194801330566 seconds
[0m14:59:00.987888 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:59:01.093623 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:59:01.204875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4a5a089-020d-454e-84b1-c694ed4810a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f1550>]}
[0m14:59:01.205655 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:01.206011 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:59:02.451403 [debug] [MainThread]: On master: COMMIT
[0m14:59:02.454056 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:59:02.454643 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:59:02.562366 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10681533813476562 seconds
[0m14:59:02.563767 [debug] [MainThread]: On master: Close
[0m14:59:02.673417 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:59:02.674338 [info ] [MainThread]: 
[0m14:59:02.705669 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:59:02.706025 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:59:02.706378 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:59:02.706709 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:59:02.707108 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:59:02.707627 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:59:02.708319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:59:02.708809 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:59:02.709249 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:59:02.709489 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:59:02.709708 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:59:02.709910 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:59:02.711317 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:59:02.713266 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:59:02.714630 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:59:02.716655 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:59:02.711485 => 14:59:02.716414
[0m14:59:02.716972 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:59:02.710057 => 14:59:02.716842
[0m14:59:02.717314 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:59:02.713543 => 14:59:02.717181
[0m14:59:02.717541 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:59:02.717868 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:59:02.718304 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:59:02.731065 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:59:02.732703 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:59:02.734052 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:59:02.756388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:02.756708 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:59:02.756944 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:59:02.757186 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:59:02.757388 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:59:02.757557 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:59:04.063542 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:59:04.065159 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    mobile_events_cleaned as ( 
  
  SELECT DISTINCT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status 

FROM mobile_events

)

SELECT * from mobile_events_cleaned;


[0m14:59:04.065826 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:59:04.067247 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:59:04.067928 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:59:04.068685 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:59:04.271011 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m14:59:04.272698 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:59:04.274170 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:59:04.275910 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:59:04.277607 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:59:04.278182 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:59:04.379769 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:59:04.381511 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:59:04.383315 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:59:04.483505 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:59:02.731308 => 14:59:04.483235
[0m14:59:04.488737 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:59:02.718607 => 14:59:04.488573
[0m14:59:04.490534 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:59:02.732857 => 14:59:04.490352
[0m14:59:04.506200 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:59:04.507278 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:59:04.508245 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:59:04.509765 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a5a089-020d-454e-84b1-c694ed4810a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105219b10>]}
[0m14:59:04.511173 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a5a089-020d-454e-84b1-c694ed4810a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104389a10>]}
[0m14:59:04.512509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a5a089-020d-454e-84b1-c694ed4810a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513cb10>]}
[0m14:59:04.512953 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.80s]
[0m14:59:04.513450 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.80s]
[0m14:59:04.513923 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.80s]
[0m14:59:04.514318 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:59:04.514580 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:59:04.514829 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:59:04.515342 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:59:04.515900 [debug] [Thread-2 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:59:04.516144 [debug] [Thread-3 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:59:04.516363 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:59:04.516619 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:59:04.516857 [info ] [Thread-2 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:59:04.517142 [info ] [Thread-3 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:59:04.517432 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:59:04.517663 [info ] [Thread-1 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:59:04.517995 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:59:04.518213 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:59:04.518443 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:59:04.518695 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:59:04.518923 [debug] [Thread-2 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:59:04.519230 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:59:04.519505 [info ] [Thread-4 (]: 8 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m14:59:04.520040 [info ] [Thread-2 (]: 9 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:59:04.520411 [info ] [Thread-3 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m14:59:04.520736 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:59:04.521059 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:59:04.521352 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:59:04.522541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:59:04.522782 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:59:05.765301 [debug] [MainThread]: On master: COMMIT
[0m14:59:05.766839 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:59:05.767716 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:59:05.870298 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10177993774414062 seconds
[0m14:59:05.871585 [debug] [MainThread]: On master: Close
[0m14:59:05.988235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:05.988924 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:59:05.989081 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:59:05.989231 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:59:05.989506 [info ] [MainThread]: 
[0m14:59:05.989786 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.58 seconds (8.58s).
[0m14:59:05.990326 [debug] [MainThread]: Command end result
[0m14:59:05.999962 [info ] [MainThread]: 
[0m14:59:06.000520 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:59:06.000805 [info ] [MainThread]: 
[0m14:59:06.001018 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:59:06.001209 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:59:06.001382 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:59:06.001549 [info ] [MainThread]: 
[0m14:59:06.001718 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:59:06.001906 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:59:06.002094 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:59:06.002266 [info ] [MainThread]: 
[0m14:59:06.002431 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:59:06.002597 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m14:59:06.002755 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:59:06.002927 [info ] [MainThread]: 
[0m14:59:06.003132 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:59:06.003545 [debug] [MainThread]: Command `dbt run` failed at 14:59:06.003487 after 8.85 seconds
[0m14:59:06.003857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048947d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1011b4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104389a10>]}
[0m14:59:06.004161 [debug] [MainThread]: Flushing usage events
[0m14:59:38.984525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472c850>]}


============================== 14:59:38.987341 | 5a0a8acd-3d85-42e8-a901-f089e6a113f5 ==============================
[0m14:59:38.987341 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:59:38.987722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Downloads/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:59:39.075456 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:59:39.099864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a0a8acd-3d85-42e8-a901-f089e6a113f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472e250>]}
[0m14:59:39.124388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a0a8acd-3d85-42e8-a901-f089e6a113f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046facd0>]}
[0m14:59:39.155018 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:59:39.221944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:59:39.222377 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:59:39.232626 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:59:39.242975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a0a8acd-3d85-42e8-a901-f089e6a113f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573cb50>]}
[0m14:59:39.252717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a0a8acd-3d85-42e8-a901-f089e6a113f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e8810>]}
[0m14:59:39.252954 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:59:39.253147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a0a8acd-3d85-42e8-a901-f089e6a113f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688d7d0>]}
[0m14:59:39.254205 [info ] [MainThread]: 
[0m14:59:39.254619 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:59:39.255370 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:59:39.260634 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:59:39.260904 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:59:39.261046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:39.261170 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:59:40.886192 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.6245110034942627 seconds
[0m14:59:40.996627 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m14:59:41.108489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m14:59:41.115928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:41.116360 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:59:42.376384 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m14:59:42.383092 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m14:59:42.526952 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.14270901679992676 seconds
[0m14:59:42.724852 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m14:59:42.827504 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m14:59:42.940777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a0a8acd-3d85-42e8-a901-f089e6a113f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571f290>]}
[0m14:59:42.941611 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:42.942106 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:59:44.192886 [debug] [MainThread]: On master: COMMIT
[0m14:59:44.195051 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:59:44.195957 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:59:44.308710 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.11178708076477051 seconds
[0m14:59:44.310653 [debug] [MainThread]: On master: Close
[0m14:59:44.426444 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:59:44.427316 [info ] [MainThread]: 
[0m14:59:44.441919 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m14:59:44.442584 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m14:59:44.443051 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m14:59:44.443664 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m14:59:44.444156 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m14:59:44.444570 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m14:59:44.445812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m14:59:44.446628 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m14:59:44.447281 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m14:59:44.447577 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m14:59:44.447834 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m14:59:44.448069 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m14:59:44.449686 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m14:59:44.452017 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m14:59:44.452916 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m14:59:44.459510 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 14:59:44.450055 => 14:59:44.459356
[0m14:59:44.459749 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 14:59:44.452224 => 14:59:44.459635
[0m14:59:44.459934 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 14:59:44.448242 => 14:59:44.459850
[0m14:59:44.460124 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m14:59:44.460281 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m14:59:44.460425 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m14:59:44.473902 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m14:59:44.475824 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m14:59:44.477348 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m14:59:44.486517 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:59:44.486793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:44.486963 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:59:44.487250 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:59:44.487459 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:59:44.487645 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:59:45.750716 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m14:59:45.752567 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m14:59:45.753584 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m14:59:45.754887 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m14:59:45.755644 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    SELECT * from mobile_events_cleaned as ( 
  
  SELECT DISTINCT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status 

FROM mobile_events;

);


[0m14:59:45.756399 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m14:59:45.966983 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:59:45.969900 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m14:59:45.968238 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m14:59:45.968831 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00933: SQL command not properly ended
[0m14:59:45.971393 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m14:59:45.972023 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m14:59:46.074331 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m14:59:46.075780 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m14:59:46.076306 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m14:59:46.183394 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 14:59:44.476008 => 14:59:46.182459
[0m14:59:46.187910 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 14:59:44.474171 => 14:59:46.187557
[0m14:59:46.188635 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 14:59:44.460526 => 14:59:46.188393
[0m14:59:46.210416 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00933: SQL command not properly ended
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:59:46.211697 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:59:46.212842 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:59:46.215223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a0a8acd-3d85-42e8-a901-f089e6a113f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b93050>]}
[0m14:59:46.216995 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a0a8acd-3d85-42e8-a901-f089e6a113f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b04510>]}
[0m14:59:46.218586 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a0a8acd-3d85-42e8-a901-f089e6a113f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475cd50>]}
[0m14:59:46.219179 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.77s]
[0m14:59:46.219660 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.77s]
[0m14:59:46.220080 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.77s]
[0m14:59:46.220518 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m14:59:46.220835 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m14:59:46.221153 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m14:59:46.221808 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m14:59:46.223071 [debug] [Thread-2 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m14:59:46.223823 [debug] [Thread-1 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m14:59:46.224190 [debug] [Thread-3 (]: Began running node model.oracle_dbt.frequent_web_users
[0m14:59:46.222588 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m14:59:46.223551 [info ] [Thread-2 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m14:59:46.224670 [info ] [Thread-1 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m14:59:46.225257 [info ] [Thread-3 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m14:59:46.225659 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m14:59:46.225936 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m14:59:46.226188 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m14:59:46.226445 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m14:59:46.226750 [debug] [Thread-4 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m14:59:46.227172 [debug] [Thread-2 (]: Began running node model.oracle_dbt.ranked_web_events
[0m14:59:46.227505 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_counts
[0m14:59:46.227884 [info ] [Thread-4 (]: 8 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m14:59:46.228317 [info ] [Thread-2 (]: 9 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m14:59:46.228708 [info ] [Thread-1 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m14:59:46.229059 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m14:59:46.229296 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m14:59:46.229527 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_counts
[0m14:59:46.230868 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:59:46.231150 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m14:59:47.482494 [debug] [MainThread]: On master: COMMIT
[0m14:59:47.484085 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m14:59:47.484498 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m14:59:47.586931 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10156488418579102 seconds
[0m14:59:47.588580 [debug] [MainThread]: On master: Close
[0m14:59:47.703449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:47.704418 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m14:59:47.704707 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m14:59:47.704937 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m14:59:47.705310 [info ] [MainThread]: 
[0m14:59:47.705715 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.45 seconds (8.45s).
[0m14:59:47.707140 [debug] [MainThread]: Command end result
[0m14:59:47.720057 [info ] [MainThread]: 
[0m14:59:47.720776 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:59:47.721251 [info ] [MainThread]: 
[0m14:59:47.721581 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m14:59:47.721891 [error] [MainThread]:   ORA-00933: SQL command not properly ended
[0m14:59:47.722166 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m14:59:47.722439 [info ] [MainThread]: 
[0m14:59:47.722707 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m14:59:47.722966 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:59:47.723231 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m14:59:47.723499 [info ] [MainThread]: 
[0m14:59:47.723758 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m14:59:47.724015 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m14:59:47.724258 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m14:59:47.724524 [info ] [MainThread]: 
[0m14:59:47.724833 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m14:59:47.725467 [debug] [MainThread]: Command `dbt run` failed at 14:59:47.725372 after 8.77 seconds
[0m14:59:47.725830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b20d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100de2ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f6fd0>]}
[0m14:59:47.726172 [debug] [MainThread]: Flushing usage events
[0m14:59:59.629202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11030bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110317f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110317fd0>]}


============================== 14:59:59.632060 | 2d22ca74-d7d5-449e-8905-ba69783013c0 ==============================
[0m14:59:59.632060 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:59:59.632418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Downloads/', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:59:59.710228 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m14:59:59.745223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d22ca74-d7d5-449e-8905-ba69783013c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3a510>]}
[0m14:59:59.769670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d22ca74-d7d5-449e-8905-ba69783013c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11098b390>]}
[0m14:59:59.786978 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:59:59.845001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:59:59.845412 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m14:59:59.855187 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m14:59:59.865475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d22ca74-d7d5-449e-8905-ba69783013c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5a010>]}
[0m14:59:59.872789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d22ca74-d7d5-449e-8905-ba69783013c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b44cd0>]}
[0m14:59:59.873077 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:59:59.873272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d22ca74-d7d5-449e-8905-ba69783013c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a4a050>]}
[0m14:59:59.874291 [info ] [MainThread]: 
[0m14:59:59.874798 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m14:59:59.875506 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m14:59:59.880627 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m14:59:59.880895 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m14:59:59.881043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:59.881171 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:01.705334 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.8228390216827393 seconds
[0m15:00:01.819675 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:00:01.933068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:00:01.941373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:01.941940 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:03.644101 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:00:03.646003 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:00:03.780677 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.13351702690124512 seconds
[0m15:00:03.969977 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:00:04.075228 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:00:04.195360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d22ca74-d7d5-449e-8905-ba69783013c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a36750>]}
[0m15:00:04.196243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:04.196648 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:05.505355 [debug] [MainThread]: On master: COMMIT
[0m15:00:05.506855 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:00:05.507348 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:00:05.613499 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10495305061340332 seconds
[0m15:00:05.616116 [debug] [MainThread]: On master: Close
[0m15:00:05.727160 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:05.728002 [info ] [MainThread]: 
[0m15:00:05.744200 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:00:05.744799 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m15:00:05.745172 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:00:05.745774 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m15:00:05.746252 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m15:00:05.746660 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m15:00:05.747538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:00:05.748087 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m15:00:05.748565 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:00:05.748827 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:00:05.749074 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m15:00:05.749312 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:00:05.751124 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:00:05.752801 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m15:00:05.753815 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:00:05.767469 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 15:00:05.751283 => 15:00:05.767201
[0m15:00:05.767809 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m15:00:05.768127 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:00:05.749503 => 15:00:05.767958
[0m15:00:05.768434 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:00:05.752948 => 15:00:05.768300
[0m15:00:05.780291 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:00:05.782716 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m15:00:05.782949 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:00:05.784649 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:00:05.786330 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:00:05.800162 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:00:05.800385 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:05.804675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:05.804895 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:05.805284 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:00:05.805495 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:07.106275 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:00:07.107797 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    SELECT * from mobile_events_cleaned as ( 
  
  SELECT DISTINCT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status 

FROM mobile_events;

)


[0m15:00:07.334519 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00933: SQL command not properly ended
[0m15:00:07.336034 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m15:00:07.339969 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:00:07.341009 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m15:00:07.442794 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:00:07.444314 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m15:00:07.445541 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:00:07.551247 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:00:07.553234 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m15:00:07.563881 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:00:05.783086 => 15:00:07.563689
[0m15:00:07.569861 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00933: SQL command not properly ended
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m15:00:07.571787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d22ca74-d7d5-449e-8905-ba69783013c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a2a690>]}
[0m15:00:07.572487 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.82s]
[0m15:00:07.572974 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:00:07.653919 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:00:07.656661 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m15:00:07.666461 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m15:00:07.761873 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:00:07.773431 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 15:00:05.768572 => 15:00:07.772893
[0m15:00:07.784338 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:00:07.786384 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d22ca74-d7d5-449e-8905-ba69783013c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c6d210>]}
[0m15:00:07.787009 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 2.04s]
[0m15:00:07.787487 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m15:00:07.788095 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m15:00:07.788398 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m15:00:07.788741 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m15:00:07.866883 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:00:05.784889 => 15:00:07.866429
[0m15:00:07.870160 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m15:00:07.872181 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d22ca74-d7d5-449e-8905-ba69783013c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b4db50>]}
[0m15:00:07.872758 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 2.12s]
[0m15:00:07.873184 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:00:07.874430 [debug] [Thread-2 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:00:07.874942 [debug] [Thread-1 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:00:07.875313 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_web_users
[0m15:00:07.875630 [debug] [Thread-3 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:00:07.875958 [info ] [Thread-2 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m15:00:07.876451 [info ] [Thread-1 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m15:00:07.877072 [info ] [Thread-4 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m15:00:07.877586 [info ] [Thread-3 (]: 8 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m15:00:07.878014 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:00:07.878311 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:00:07.878590 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m15:00:07.878842 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:00:07.879128 [debug] [Thread-2 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:00:07.879657 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:00:07.880467 [info ] [Thread-2 (]: 9 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m15:00:07.880924 [info ] [Thread-1 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m15:00:07.881398 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:00:07.881760 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:00:07.883194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:00:07.883473 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:10.503189 [debug] [MainThread]: On master: COMMIT
[0m15:00:10.504569 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:00:10.505014 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:00:10.616208 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.11019301414489746 seconds
[0m15:00:10.619869 [debug] [MainThread]: On master: Close
[0m15:00:10.728527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:10.728849 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m15:00:10.729081 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m15:00:10.729293 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m15:00:10.729686 [info ] [MainThread]: 
[0m15:00:10.730199 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 10.85 seconds (10.85s).
[0m15:00:10.731237 [debug] [MainThread]: Command end result
[0m15:00:10.750462 [info ] [MainThread]: 
[0m15:00:10.751014 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:00:10.751260 [info ] [MainThread]: 
[0m15:00:10.751828 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m15:00:10.752266 [error] [MainThread]:   ORA-00933: SQL command not properly ended
[0m15:00:10.752653 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m15:00:10.752853 [info ] [MainThread]: 
[0m15:00:10.753019 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m15:00:10.753227 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:00:10.753440 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:00:10.753653 [info ] [MainThread]: 
[0m15:00:10.753860 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m15:00:10.754058 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:00:10.754531 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m15:00:10.754934 [info ] [MainThread]: 
[0m15:00:10.755303 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m15:00:10.755959 [debug] [MainThread]: Command `dbt run` failed at 15:00:10.755857 after 11.15 seconds
[0m15:00:10.756376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11032fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10282aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f71d0>]}
[0m15:00:10.756701 [debug] [MainThread]: Flushing usage events
[0m15:00:21.646157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110717d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110717f90>]}


============================== 15:00:21.648884 | 421b9423-99c6-41ea-8d29-821f89f39084 ==============================
[0m15:00:21.648884 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:00:21.649224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:00:21.746911 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:00:21.771059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '421b9423-99c6-41ea-8d29-821f89f39084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107caf90>]}
[0m15:00:21.796683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '421b9423-99c6-41ea-8d29-821f89f39084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b2e650>]}
[0m15:00:21.815620 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:00:21.856310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:00:21.856656 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m15:00:21.866161 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m15:00:21.876343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '421b9423-99c6-41ea-8d29-821f89f39084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11118f790>]}
[0m15:00:21.887302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '421b9423-99c6-41ea-8d29-821f89f39084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111e8ed0>]}
[0m15:00:21.887558 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:00:21.887755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421b9423-99c6-41ea-8d29-821f89f39084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111e8050>]}
[0m15:00:21.888819 [info ] [MainThread]: 
[0m15:00:21.889230 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:00:21.889899 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:00:21.895000 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:00:21.895254 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:00:21.895390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:21.895513 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:23.475668 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.5795960426330566 seconds
[0m15:00:23.592363 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:00:23.705928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:00:23.712130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:23.712526 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:24.988624 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:00:24.989945 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:00:25.114915 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12348508834838867 seconds
[0m15:00:25.310019 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:00:25.414973 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:00:25.523421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421b9423-99c6-41ea-8d29-821f89f39084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11079fa90>]}
[0m15:00:25.523783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:25.523954 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:26.771843 [debug] [MainThread]: On master: COMMIT
[0m15:00:26.773895 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:00:26.775109 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:00:26.881216 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10490894317626953 seconds
[0m15:00:26.882921 [debug] [MainThread]: On master: Close
[0m15:00:26.991091 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:26.991862 [info ] [MainThread]: 
[0m15:00:27.007800 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:00:27.008296 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m15:00:27.008862 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:00:27.009641 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m15:00:27.010314 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m15:00:27.010849 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m15:00:27.011708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:00:27.012370 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m15:00:27.012913 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:00:27.013195 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:00:27.013450 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m15:00:27.013680 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:00:27.015790 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:00:27.018238 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m15:00:27.019555 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:00:27.020709 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:00:27.013895 => 15:00:27.020557
[0m15:00:27.020940 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:00:27.021221 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 15:00:27.016139 => 15:00:27.021037
[0m15:00:27.033544 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:00:27.033956 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m15:00:27.034292 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:00:27.018511 => 15:00:27.034147
[0m15:00:27.036118 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m15:00:27.036299 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:00:27.037930 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:00:27.044686 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:00:27.044964 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:00:27.045150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:27.045416 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:27.045616 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:27.045793 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:28.340049 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:00:28.341511 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:00:28.342352 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:00:28.342784 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m15:00:28.343206 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    SELECT * from mobile_events_cleaned as ( 
  
  SELECT DISTINCT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status 

FROM mobile_events

);


[0m15:00:28.343552 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m15:00:28.550389 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:00:28.553531 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m15:00:28.551691 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:00:28.552349 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00933: SQL command not properly ended
[0m15:00:28.554785 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m15:00:28.555283 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: ROLLBACK
[0m15:00:28.655648 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:00:28.656711 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:00:28.663909 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m15:00:28.764034 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:00:27.036456 => 15:00:28.762644
[0m15:00:28.770468 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:00:27.021404 => 15:00:28.770199
[0m15:00:28.773255 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 15:00:27.034530 => 15:00:28.773096
[0m15:00:28.814768 [debug] [Thread-1 (]: Database Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)
  ORA-00933: SQL command not properly ended
  compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m15:00:28.816438 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:00:28.818314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421b9423-99c6-41ea-8d29-821f89f39084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f81d0>]}
[0m15:00:28.819375 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m15:00:28.821152 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421b9423-99c6-41ea-8d29-821f89f39084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11139ec50>]}
[0m15:00:28.821821 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model FAWDBTCORE.stg_mobile_events ............. [[31mERROR[0m in 1.81s]
[0m15:00:28.823595 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421b9423-99c6-41ea-8d29-821f89f39084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11132fc50>]}
[0m15:00:28.824028 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.81s]
[0m15:00:28.824456 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:00:28.825213 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.81s]
[0m15:00:28.825898 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m15:00:28.826634 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:00:28.827411 [debug] [Thread-4 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m15:00:28.828288 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m15:00:28.828796 [debug] [Thread-2 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:00:28.829264 [debug] [Thread-1 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:00:28.829553 [debug] [Thread-3 (]: Began running node model.oracle_dbt.frequent_web_users
[0m15:00:28.829816 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m15:00:28.830160 [info ] [Thread-2 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m15:00:28.830546 [info ] [Thread-1 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m15:00:28.830953 [info ] [Thread-3 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m15:00:28.831618 [debug] [Thread-4 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:00:28.832089 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:00:28.832415 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:00:28.832788 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m15:00:28.833094 [info ] [Thread-4 (]: 8 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m15:00:28.833471 [debug] [Thread-2 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:00:28.833859 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:00:28.834279 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:00:28.834538 [info ] [Thread-2 (]: 9 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m15:00:28.834870 [info ] [Thread-1 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m15:00:28.835307 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:00:28.835559 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:00:28.836822 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:00:28.837152 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:00:30.081513 [debug] [MainThread]: On master: COMMIT
[0m15:00:30.083199 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:00:30.083690 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:00:30.185441 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.1008749008178711 seconds
[0m15:00:30.187069 [debug] [MainThread]: On master: Close
[0m15:00:30.301921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:30.303338 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m15:00:30.303635 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m15:00:30.303789 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m15:00:30.304066 [info ] [MainThread]: 
[0m15:00:30.304363 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.41 seconds (8.41s).
[0m15:00:30.304942 [debug] [MainThread]: Command end result
[0m15:00:30.311344 [info ] [MainThread]: 
[0m15:00:30.311771 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:00:30.312101 [info ] [MainThread]: 
[0m15:00:30.312309 [error] [MainThread]: [33mDatabase Error in model stg_mobile_events (models/staging/stg_mobile_events.sql)[0m
[0m15:00:30.312499 [error] [MainThread]:   ORA-00933: SQL command not properly ended
[0m15:00:30.312674 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_mobile_events.sql
[0m15:00:30.312841 [info ] [MainThread]: 
[0m15:00:30.313010 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m15:00:30.313175 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:00:30.313337 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:00:30.313502 [info ] [MainThread]: 
[0m15:00:30.313662 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m15:00:30.313822 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:00:30.313974 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m15:00:30.314137 [info ] [MainThread]: 
[0m15:00:30.314335 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m15:00:30.314727 [debug] [MainThread]: Command `dbt run` failed at 15:00:30.314670 after 8.70 seconds
[0m15:00:30.314948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10266ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10266cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f80d0>]}
[0m15:00:30.315149 [debug] [MainThread]: Flushing usage events
[0m15:01:18.887973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109417f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109417fd0>]}


============================== 15:01:18.890625 | 1b5bba2e-2ff1-431a-901c-895730b8d41e ==============================
[0m15:01:18.890625 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:01:18.891004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:01:18.985491 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:01:19.021183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b5bba2e-2ff1-431a-901c-895730b8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949f910>]}
[0m15:01:19.045511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b5bba2e-2ff1-431a-901c-895730b8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10444c710>]}
[0m15:01:19.073826 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:01:19.130175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:01:19.130599 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m15:01:19.140392 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m15:01:19.150196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b5bba2e-2ff1-431a-901c-895730b8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ddc290>]}
[0m15:01:19.162452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b5bba2e-2ff1-431a-901c-895730b8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e04450>]}
[0m15:01:19.162701 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:01:19.162892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b5bba2e-2ff1-431a-901c-895730b8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ddef10>]}
[0m15:01:19.163966 [info ] [MainThread]: 
[0m15:01:19.164457 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:01:19.165116 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:01:19.170427 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:01:19.170653 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:01:19.170790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:19.171030 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:01:20.758364 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.5844111442565918 seconds
[0m15:01:20.882383 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:01:20.991413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:01:20.999149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:20.999584 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:01:22.324895 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:01:22.326497 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:01:22.452046 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12454104423522949 seconds
[0m15:01:22.660697 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:01:22.763902 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:01:22.887916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b5bba2e-2ff1-431a-901c-895730b8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094cb650>]}
[0m15:01:22.888709 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:22.889057 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:01:24.174716 [debug] [MainThread]: On master: COMMIT
[0m15:01:24.179051 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:01:24.179505 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:01:24.284696 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10455894470214844 seconds
[0m15:01:24.285721 [debug] [MainThread]: On master: Close
[0m15:01:24.398567 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:01:24.400364 [info ] [MainThread]: 
[0m15:01:24.412475 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:01:24.412894 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m15:01:24.413384 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:01:24.414144 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m15:01:24.414970 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m15:01:24.415500 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m15:01:24.416359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:01:24.416993 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m15:01:24.417971 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:01:24.418581 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:01:24.419094 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m15:01:24.419552 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:01:24.421777 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:01:24.424527 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m15:01:24.425991 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:01:24.429881 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:01:24.419826 => 15:01:24.429486
[0m15:01:24.430370 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 15:01:24.422029 => 15:01:24.430150
[0m15:01:24.430767 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:01:24.431065 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:01:24.424803 => 15:01:24.430933
[0m15:01:24.431331 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m15:01:24.446073 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:01:24.446407 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:01:24.448332 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m15:01:24.450136 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:01:24.452587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:24.452837 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:01:24.472971 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:01:24.473270 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:01:24.473557 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:01:24.473801 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:01:25.729705 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:01:25.731015 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:01:25.732098 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m15:01:25.732864 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    SELECT DISTINCT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status 

FROM mobile_events


[0m15:01:25.738707 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:01:25.740005 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m15:01:25.941907 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:01:25.942790 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m15:01:25.951371 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:01:25.952143 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m15:01:25.962567 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.2285149097442627 seconds
[0m15:01:25.969952 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:01:25.970430 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:01:25.970724 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:01:26.046418 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m15:01:26.059238 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:01:26.082529 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.11105775833129883 seconds
[0m15:01:26.091583 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:01:26.092175 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:01:26.161022 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 15:01:24.446611 => 15:01:26.159830
[0m15:01:26.165108 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:01:24.448639 => 15:01:26.164882
[0m15:01:26.181861 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m15:01:26.184244 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:01:26.186856 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b5bba2e-2ff1-431a-901c-895730b8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a077190>]}
[0m15:01:26.189112 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b5bba2e-2ff1-431a-901c-895730b8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a073850>]}
[0m15:01:26.189940 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 1.77s]
[0m15:01:26.190760 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 1.77s]
[0m15:01:26.191424 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:01:26.191850 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m15:01:26.192699 [debug] [Thread-2 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:01:26.193379 [info ] [Thread-2 (]: 4 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m15:01:26.194080 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:01:26.199176 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10651397705078125 seconds
[0m15:01:26.208338 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:01:24.431500 => 15:01:26.208195
[0m15:01:26.208627 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:01:26.320549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b5bba2e-2ff1-431a-901c-895730b8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a060890>]}
[0m15:01:26.321809 [info ] [Thread-1 (]: 1 of 10 OK created sql view model FAWDBTCORE.stg_mobile_events ................. [[32mOK[0m in 1.90s]
[0m15:01:26.322666 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:01:26.323864 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:01:26.324353 [debug] [Thread-4 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:01:26.324938 [debug] [Thread-2 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m15:01:26.325575 [info ] [Thread-3 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m15:01:26.326269 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_web_users
[0m15:01:26.326655 [info ] [Thread-4 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m15:01:26.327174 [info ] [Thread-2 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m15:01:26.327689 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:01:26.328296 [info ] [Thread-1 (]: 8 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m15:01:26.329013 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:01:26.329435 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m15:01:26.329855 [debug] [Thread-3 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:01:26.330399 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m15:01:26.330904 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:01:26.331737 [info ] [Thread-3 (]: 9 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m15:01:26.332490 [info ] [Thread-4 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m15:01:26.332995 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:01:26.333306 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:01:26.335057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:01:26.335410 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:01:27.591163 [debug] [MainThread]: On master: COMMIT
[0m15:01:27.592562 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:01:27.598975 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:01:27.703217 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10236477851867676 seconds
[0m15:01:27.704593 [debug] [MainThread]: On master: Close
[0m15:01:27.822596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:27.823494 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m15:01:27.823860 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m15:01:27.824147 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m15:01:27.824602 [info ] [MainThread]: 
[0m15:01:27.825148 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 8.66 seconds (8.66s).
[0m15:01:27.826342 [debug] [MainThread]: Command end result
[0m15:01:27.839492 [info ] [MainThread]: 
[0m15:01:27.840242 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:01:27.840622 [info ] [MainThread]: 
[0m15:01:27.840990 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m15:01:27.841331 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:01:27.841609 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m15:01:27.841875 [info ] [MainThread]: 
[0m15:01:27.842139 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m15:01:27.842395 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:01:27.842657 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:01:27.842939 [info ] [MainThread]: 
[0m15:01:27.843359 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=7 TOTAL=10
[0m15:01:27.844190 [debug] [MainThread]: Command `dbt run` failed at 15:01:27.844068 after 8.98 seconds
[0m15:01:27.844846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109417bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942c510>]}
[0m15:01:27.845314 [debug] [MainThread]: Flushing usage events
[0m15:02:36.804227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b0ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b17fd0>]}


============================== 15:02:36.806906 | def7c816-d213-4d85-9909-f76b0861ab68 ==============================
[0m15:02:36.806906 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:02:36.807280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:02:36.903323 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:02:36.930135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'def7c816-d213-4d85-9909-f76b0861ab68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b4c9d0>]}
[0m15:02:36.954708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'def7c816-d213-4d85-9909-f76b0861ab68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083a190>]}
[0m15:02:36.969435 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:02:37.022269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:02:37.022640 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_users.sql
[0m15:02:37.031974 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
[0m15:02:37.041554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'def7c816-d213-4d85-9909-f76b0861ab68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140bbbd0>]}
[0m15:02:37.060300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'def7c816-d213-4d85-9909-f76b0861ab68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115e9290>]}
[0m15:02:37.060566 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:02:37.060794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'def7c816-d213-4d85-9909-f76b0861ab68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11403b610>]}
[0m15:02:37.061838 [info ] [MainThread]: 
[0m15:02:37.062415 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:02:37.063189 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:02:37.068691 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:02:37.068935 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:02:37.069077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:37.069205 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:02:38.748435 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.6784930229187012 seconds
[0m15:02:38.860655 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:02:39.007124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:02:39.015183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:39.015641 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:02:40.386413 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:02:40.388170 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:02:40.518019 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12883210182189941 seconds
[0m15:02:40.732478 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:02:40.838700 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:02:41.003397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'def7c816-d213-4d85-9909-f76b0861ab68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b43fd0>]}
[0m15:02:41.004266 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:02:41.004704 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:02:42.304276 [debug] [MainThread]: On master: COMMIT
[0m15:02:42.305740 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:02:42.306158 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:02:42.408809 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10175108909606934 seconds
[0m15:02:42.410729 [debug] [MainThread]: On master: Close
[0m15:02:42.589332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:02:42.590609 [info ] [MainThread]: 
[0m15:02:42.629486 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:02:42.629932 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m15:02:42.630263 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:02:42.630767 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m15:02:42.631260 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m15:02:42.631700 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m15:02:42.632553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:02:42.633315 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m15:02:42.633913 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:02:42.634215 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:02:42.634489 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m15:02:42.634790 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:02:42.636532 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:02:42.639027 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m15:02:42.640604 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:02:42.644449 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:02:42.639382 => 15:02:42.644182
[0m15:02:42.644791 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:02:42.635004 => 15:02:42.644670
[0m15:02:42.645029 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 15:02:42.636789 => 15:02:42.644924
[0m15:02:42.645299 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:02:42.645577 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:02:42.645805 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m15:02:42.660864 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:02:42.662616 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:02:42.664116 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m15:02:42.681029 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:02:42.681333 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:02:42.681605 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:02:42.681846 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:02:42.686695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:42.686928 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:02:44.098537 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:02:44.100300 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:02:44.101263 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    SELECT DISTINCT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status 

FROM mobile_events


[0m15:02:44.101891 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events;
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted;
)

select * from web_events_cleaned


[0m15:02:44.160326 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:02:44.161532 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users
)

select * from users_cleaned


[0m15:02:44.319024 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.21578502655029297 seconds
[0m15:02:44.337206 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:02:44.334558 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:02:44.337760 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:02:44.337978 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: ROLLBACK
[0m15:02:44.338160 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:02:44.427081 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00942: table or view does not exist
[0m15:02:44.427998 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m15:02:44.441034 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:02:44.441765 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10323715209960938 seconds
[0m15:02:44.448092 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:02:44.448662 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:02:44.533511 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m15:02:44.558500 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10904693603515625 seconds
[0m15:02:44.568772 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:02:42.661096 => 15:02:44.568633
[0m15:02:44.569084 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:02:44.572913 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:02:42.645964 => 15:02:44.572694
[0m15:02:44.638761 [debug] [Thread-3 (]: Database Error in model stg_web_events (models/staging/stg_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m15:02:44.640989 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'def7c816-d213-4d85-9909-f76b0861ab68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11156d1d0>]}
[0m15:02:44.641619 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model FAWDBTCORE.stg_web_events ................ [[31mERROR[0m in 2.01s]
[0m15:02:44.642117 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:02:44.643070 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:02:44.643825 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 15:02:42.662787 => 15:02:44.643500
[0m15:02:44.644309 [info ] [Thread-4 (]: 4 of 10 SKIP relation FAWDBTCORE.ranked_web_events ............................. [[33mSKIP[0m]
[0m15:02:44.646329 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:02:44.648034 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00942: table or view does not exist
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:02:44.649692 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'def7c816-d213-4d85-9909-f76b0861ab68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115f2010>]}
[0m15:02:44.650182 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model FAWDBTCORE.stg_users ..................... [[31mERROR[0m in 2.02s]
[0m15:02:44.650585 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m15:02:44.726082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'def7c816-d213-4d85-9909-f76b0861ab68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114065c10>]}
[0m15:02:44.726889 [info ] [Thread-1 (]: 1 of 10 OK created sql view model FAWDBTCORE.stg_mobile_events ................. [[32mOK[0m in 2.09s]
[0m15:02:44.727751 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:02:44.728652 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:02:44.729030 [debug] [Thread-4 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:02:44.729363 [debug] [Thread-2 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m15:02:44.729633 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_web_users
[0m15:02:44.729905 [info ] [Thread-3 (]: 5 of 10 SKIP relation FAWDBTCORE.average_duration_by_platform_country .......... [[33mSKIP[0m]
[0m15:02:44.730289 [info ] [Thread-4 (]: 6 of 10 SKIP relation FAWDBTCORE.event_counts_by_platform ...................... [[33mSKIP[0m]
[0m15:02:44.730595 [info ] [Thread-2 (]: 7 of 10 SKIP relation FAWDBTCORE.frequent_mobile_users ......................... [[33mSKIP[0m]
[0m15:02:44.730895 [info ] [Thread-1 (]: 8 of 10 SKIP relation FAWDBTCORE.frequent_web_users ............................ [[33mSKIP[0m]
[0m15:02:44.731211 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:02:44.731453 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:02:44.731681 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m15:02:44.731911 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m15:02:44.732170 [debug] [Thread-3 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:02:44.732591 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:02:44.733266 [info ] [Thread-3 (]: 9 of 10 SKIP relation FAWDBTCORE.mobile_event_durations ........................ [[33mSKIP[0m]
[0m15:02:44.733696 [info ] [Thread-4 (]: 10 of 10 SKIP relation FAWDBTCORE.web_events_counts ............................ [[33mSKIP[0m]
[0m15:02:44.734096 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:02:44.734368 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:02:44.735868 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:02:44.736174 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:02:46.099445 [debug] [MainThread]: On master: COMMIT
[0m15:02:46.101143 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:02:46.101706 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:02:46.204430 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10178613662719727 seconds
[0m15:02:46.205935 [debug] [MainThread]: On master: Close
[0m15:02:46.312625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:46.314416 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_mobile_events' was properly closed.
[0m15:02:46.315085 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_users' was properly closed.
[0m15:02:46.315464 [debug] [MainThread]: Connection 'model.oracle_dbt.stg_web_events' was properly closed.
[0m15:02:46.315898 [info ] [MainThread]: 
[0m15:02:46.316562 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 9.25 seconds (9.25s).
[0m15:02:46.317802 [debug] [MainThread]: Command end result
[0m15:02:46.331211 [info ] [MainThread]: 
[0m15:02:46.331862 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:02:46.332184 [info ] [MainThread]: 
[0m15:02:46.332498 [error] [MainThread]: [33mDatabase Error in model stg_web_events (models/staging/stg_web_events.sql)[0m
[0m15:02:46.332796 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:02:46.333077 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_web_events.sql
[0m15:02:46.333343 [info ] [MainThread]: 
[0m15:02:46.333603 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m15:02:46.333857 [error] [MainThread]:   ORA-00942: table or view does not exist
[0m15:02:46.334111 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:02:46.334381 [info ] [MainThread]: 
[0m15:02:46.334696 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=7 TOTAL=10
[0m15:02:46.335374 [debug] [MainThread]: Command `dbt run` failed at 15:02:46.335275 after 9.56 seconds
[0m15:02:46.335795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b0a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b2c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5ead0>]}
[0m15:02:46.336147 [debug] [MainThread]: Flushing usage events
[0m15:03:59.111500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086dfe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086dffd0>]}


============================== 15:03:59.121324 | 872884c1-a120-43b7-a8a0-3b9234e16d35 ==============================
[0m15:03:59.121324 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:03:59.121722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:03:59.217118 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:03:59.250900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '872884c1-a120-43b7-a8a0-3b9234e16d35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d3310>]}
[0m15:03:59.276440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '872884c1-a120-43b7-a8a0-3b9234e16d35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbf710>]}
[0m15:03:59.290728 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:03:59.343225 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m15:03:59.343642 [debug] [MainThread]: Partial parsing: deleted file: oracle_dbt://models/staging/stg_users.sql
[0m15:03:59.343835 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_web_events.sql
[0m15:03:59.353405 [debug] [MainThread]: 1699: static parser successfully parsed frequent_mobile_users.sql
[0m15:03:59.359702 [debug] [MainThread]: 1699: static parser successfully parsed frequent_web_users.sql
[0m15:03:59.361548 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_web_events.sql
[0m15:03:59.362612 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.oracle_dbt.frequent_mobile_users' (models/frequent_mobile_users.sql) depends on a node named 'stg_users' which was not found
[0m15:03:59.363011 [debug] [MainThread]: Command `dbt run` failed at 15:03:59.362956 after 0.28 seconds
[0m15:03:59.363239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105014cd0>]}
[0m15:03:59.363460 [debug] [MainThread]: Flushing usage events
[0m15:04:30.597550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083cbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d7f90>]}


============================== 15:04:30.600524 | b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b ==============================
[0m15:04:30.600524 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:04:30.600948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:04:30.723252 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:04:30.763122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108495b10>]}
[0m15:04:30.788017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10845f850>]}
[0m15:04:30.818917 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:04:30.886366 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 1 files changed.
[0m15:04:30.886756 [debug] [MainThread]: Partial parsing: deleted file: oracle_dbt://models/frequent_web_users.sql
[0m15:04:30.886915 [debug] [MainThread]: Partial parsing: deleted file: oracle_dbt://models/frequent_mobile_users.sql
[0m15:04:30.887055 [debug] [MainThread]: Partial parsing: deleted file: oracle_dbt://models/staging/stg_users.sql
[0m15:04:30.887284 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_web_events.sql
[0m15:04:30.898145 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_web_events.sql
[0m15:04:30.908483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108407790>]}
[0m15:04:30.918447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108add4d0>]}
[0m15:04:30.918716 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:04:30.918915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5ad10>]}
[0m15:04:30.919898 [info ] [MainThread]: 
[0m15:04:30.920480 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:04:30.921340 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:04:30.926775 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:04:30.926994 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:04:30.927132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:30.927262 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:04:32.717315 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.7895500659942627 seconds
[0m15:04:32.826585 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:04:32.938547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:04:32.945719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:32.946164 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:04:34.240462 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:04:34.242412 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:04:34.361801 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11827802658081055 seconds
[0m15:04:34.537953 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:04:34.635997 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:04:34.743030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a6250>]}
[0m15:04:34.743847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:34.744249 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:04:35.917728 [debug] [MainThread]: On master: COMMIT
[0m15:04:35.919652 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:04:35.920243 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:04:36.016485 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09527301788330078 seconds
[0m15:04:36.018071 [debug] [MainThread]: On master: Close
[0m15:04:36.118952 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:04:36.120274 [info ] [MainThread]: 
[0m15:04:36.144087 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:04:36.144553 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:04:36.145152 [info ] [Thread-1 (]: 1 of 7 START sql view model FAWDBTCORE.stg_mobile_events ....................... [RUN]
[0m15:04:36.145605 [info ] [Thread-2 (]: 2 of 7 START sql view model FAWDBTCORE.stg_web_events .......................... [RUN]
[0m15:04:36.146328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:04:36.146881 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:04:36.147285 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:04:36.147827 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:04:36.149599 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:04:36.150818 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:04:36.155533 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:04:36.148048 => 15:04:36.155319
[0m15:04:36.155868 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:04:36.163307 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:04:36.149820 => 15:04:36.163064
[0m15:04:36.169957 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:04:36.170281 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:04:36.172185 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:04:36.187144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:36.187399 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:04:36.187624 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:04:36.187820 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:04:37.352991 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:04:37.353965 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    SELECT DISTINCT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status 

FROM mobile_events


[0m15:04:37.360178 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:04:37.360670 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m15:04:37.456492 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.1015007495880127 seconds
[0m15:04:37.467286 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:04:37.467869 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:04:37.468155 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:04:37.468749 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10764122009277344 seconds
[0m15:04:37.470040 [debug] [Thread-2 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m15:04:37.470338 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:04:37.470588 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m15:04:37.562471 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09347724914550781 seconds
[0m15:04:37.569812 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:04:37.570269 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09938311576843262 seconds
[0m15:04:37.570678 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:04:37.572981 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:04:37.573781 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:04:37.674632 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09825706481933594 seconds
[0m15:04:37.676080 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10170888900756836 seconds
[0m15:04:37.689249 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:04:36.156004 => 15:04:37.689006
[0m15:04:37.691146 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:04:36.170528 => 15:04:37.690993
[0m15:04:37.691537 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:04:37.691848 [debug] [Thread-2 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:04:37.799867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d25c10>]}
[0m15:04:37.802459 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d651d0>]}
[0m15:04:37.800829 [info ] [Thread-1 (]: 1 of 7 OK created sql view model FAWDBTCORE.stg_mobile_events .................. [[32mOK[0m in 1.65s]
[0m15:04:37.803119 [info ] [Thread-2 (]: 2 of 7 OK created sql view model FAWDBTCORE.stg_web_events ..................... [[32mOK[0m in 1.66s]
[0m15:04:37.803673 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:04:37.804161 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:04:37.805288 [debug] [Thread-4 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:04:37.805590 [debug] [Thread-3 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:04:37.805820 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:04:37.806053 [debug] [Thread-2 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:04:37.806350 [info ] [Thread-4 (]: 3 of 7 START sql view model FAWDBTCORE.average_duration_by_platform_country .... [RUN]
[0m15:04:37.806665 [info ] [Thread-3 (]: 4 of 7 START sql view model FAWDBTCORE.event_counts_by_platform ................ [RUN]
[0m15:04:37.807056 [info ] [Thread-1 (]: 5 of 7 START sql view model FAWDBTCORE.mobile_event_durations .................. [RUN]
[0m15:04:37.807545 [info ] [Thread-2 (]: 6 of 7 START sql view model FAWDBTCORE.ranked_web_events ....................... [RUN]
[0m15:04:37.808531 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.average_duration_by_platform_country'
[0m15:04:37.809231 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.event_counts_by_platform'
[0m15:04:37.809778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m15:04:37.810404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.ranked_web_events)
[0m15:04:37.810780 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m15:04:37.811124 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m15:04:37.811483 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m15:04:37.811780 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m15:04:37.815144 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:04:37.818131 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m15:04:37.822168 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m15:04:37.824204 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m15:04:37.825185 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 15:04:37.811974 => 15:04:37.824956
[0m15:04:37.825607 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m15:04:37.826011 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 15:04:37.818446 => 15:04:37.825876
[0m15:04:37.826319 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 15:04:37.815461 => 15:04:37.826154
[0m15:04:37.828533 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:04:37.828832 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 15:04:37.822438 => 15:04:37.828693
[0m15:04:37.829114 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m15:04:37.829369 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m15:04:37.829644 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m15:04:37.831697 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m15:04:37.833536 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m15:04:37.833766 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:04:37.835415 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m15:04:37.835898 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:04:37.836174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:37.836438 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:04:37.836839 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:37.837061 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:04:37.837282 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:04:37.837487 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:04:39.035650 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:04:39.036878 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:04:39.037369 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:04:39.037833 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:04:39.038626 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events;

)

select * from ranked_web_events


[0m15:04:39.039411 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned;


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned;
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events;
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform;
)

select * from event_counts_by_platform


[0m15:04:39.040301 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
)

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id;

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system;
)

select * from mobile_event_durations


[0m15:04:39.041086 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned;


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned;
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events;
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country;
)

select * from average_duration_by_platform_country


[0m15:04:39.255303 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:04:39.257676 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: ROLLBACK
[0m15:04:39.258705 [info ] [Thread-4 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:04:39.259646 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: ROLLBACK
[0m15:04:39.260233 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:04:39.260867 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m15:04:39.261885 [debug] [Thread-2 (]: On model.oracle_dbt.ranked_web_events: ROLLBACK
[0m15:04:39.262262 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: ROLLBACK
[0m15:04:39.354173 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m15:04:39.356596 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m15:04:39.358277 [debug] [Thread-2 (]: On model.oracle_dbt.ranked_web_events: Close
[0m15:04:39.358727 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m15:04:39.451285 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 15:04:37.831887 => 15:04:39.450929
[0m15:04:39.456405 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 15:04:37.826475 => 15:04:39.456260
[0m15:04:39.457587 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 15:04:37.833914 => 15:04:39.457452
[0m15:04:39.458667 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 15:04:37.829833 => 15:04:39.458567
[0m15:04:39.468822 [debug] [Thread-4 (]: Database Error in model average_duration_by_platform_country (models/average_duration_by_platform_country.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/average_duration_by_platform_country.sql
[0m15:04:39.469649 [debug] [Thread-3 (]: Database Error in model event_counts_by_platform (models/event_counts_by_platform.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/event_counts_by_platform.sql
[0m15:04:39.470963 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d64650>]}
[0m15:04:39.471929 [debug] [Thread-1 (]: Database Error in model mobile_event_durations (models/mobile_event_durations.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/mobile_event_durations.sql
[0m15:04:39.473138 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d36c90>]}
[0m15:04:39.473851 [debug] [Thread-2 (]: Database Error in model ranked_web_events (models/ranked_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/ranked_web_events.sql
[0m15:04:39.474228 [error] [Thread-4 (]: 3 of 7 ERROR creating sql view model FAWDBTCORE.average_duration_by_platform_country  [[31mERROR[0m in 1.66s]
[0m15:04:39.475365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d675d0>]}
[0m15:04:39.475683 [error] [Thread-3 (]: 4 of 7 ERROR creating sql view model FAWDBTCORE.event_counts_by_platform ....... [[31mERROR[0m in 1.66s]
[0m15:04:39.476814 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7f650>]}
[0m15:04:39.477082 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:04:39.477364 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model FAWDBTCORE.mobile_event_durations ......... [[31mERROR[0m in 1.67s]
[0m15:04:39.477625 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:04:39.478056 [error] [Thread-2 (]: 6 of 7 ERROR creating sql view model FAWDBTCORE.ranked_web_events .............. [[31mERROR[0m in 1.67s]
[0m15:04:39.478395 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:04:39.478699 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:04:39.478991 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:04:39.479192 [info ] [Thread-4 (]: 7 of 7 START sql view model FAWDBTCORE.web_events_counts ....................... [RUN]
[0m15:04:39.479805 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.average_duration_by_platform_country, now model.oracle_dbt.web_events_counts)
[0m15:04:39.479978 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m15:04:39.481615 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m15:04:39.482085 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 15:04:39.480077 => 15:04:39.481990
[0m15:04:39.482242 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.web_events_counts
[0m15:04:39.483733 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m15:04:39.484039 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:39.484197 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:04:40.668296 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:04:40.670829 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
)

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id;

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type;
)

select * from web_event_counts


[0m15:04:40.876695 [info ] [Thread-4 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m15:04:40.879889 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_counts: ROLLBACK
[0m15:04:40.977131 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_counts: Close
[0m15:04:41.081313 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 15:04:39.482337 => 15:04:41.080213
[0m15:04:41.086681 [debug] [Thread-4 (]: Database Error in model web_events_counts (models/web_events_counts.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/web_events_counts.sql
[0m15:04:41.089564 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fcdfb4-25e7-44c3-b2c2-e08d7c62663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0cad0>]}
[0m15:04:41.090279 [error] [Thread-4 (]: 7 of 7 ERROR creating sql view model FAWDBTCORE.web_events_counts .............. [[31mERROR[0m in 1.61s]
[0m15:04:41.090849 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:04:41.093145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:04:41.093756 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:04:42.323976 [debug] [MainThread]: On master: COMMIT
[0m15:04:42.326165 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:04:42.326637 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:04:42.421388 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09401488304138184 seconds
[0m15:04:42.422300 [debug] [MainThread]: On master: Close
[0m15:04:42.523025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:42.523778 [debug] [MainThread]: Connection 'model.oracle_dbt.mobile_event_durations' was properly closed.
[0m15:04:42.524125 [debug] [MainThread]: Connection 'model.oracle_dbt.ranked_web_events' was properly closed.
[0m15:04:42.524417 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m15:04:42.524688 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m15:04:42.525105 [info ] [MainThread]: 
[0m15:04:42.525612 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 11.60 seconds (11.60s).
[0m15:04:42.526832 [debug] [MainThread]: Command end result
[0m15:04:42.565715 [info ] [MainThread]: 
[0m15:04:42.566436 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m15:04:42.566748 [info ] [MainThread]: 
[0m15:04:42.567048 [error] [MainThread]: [33mDatabase Error in model average_duration_by_platform_country (models/average_duration_by_platform_country.sql)[0m
[0m15:04:42.567338 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:04:42.567596 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/average_duration_by_platform_country.sql
[0m15:04:42.567943 [info ] [MainThread]: 
[0m15:04:42.568321 [error] [MainThread]: [33mDatabase Error in model event_counts_by_platform (models/event_counts_by_platform.sql)[0m
[0m15:04:42.568646 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:04:42.568921 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/event_counts_by_platform.sql
[0m15:04:42.569183 [info ] [MainThread]: 
[0m15:04:42.569460 [error] [MainThread]: [33mDatabase Error in model mobile_event_durations (models/mobile_event_durations.sql)[0m
[0m15:04:42.569709 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m15:04:42.570416 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/mobile_event_durations.sql
[0m15:04:42.571207 [info ] [MainThread]: 
[0m15:04:42.571721 [error] [MainThread]: [33mDatabase Error in model ranked_web_events (models/ranked_web_events.sql)[0m
[0m15:04:42.572077 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:04:42.572390 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/ranked_web_events.sql
[0m15:04:42.572701 [info ] [MainThread]: 
[0m15:04:42.573005 [error] [MainThread]: [33mDatabase Error in model web_events_counts (models/web_events_counts.sql)[0m
[0m15:04:42.573306 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m15:04:42.573604 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_counts.sql
[0m15:04:42.573920 [info ] [MainThread]: 
[0m15:04:42.574268 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=5 SKIP=0 TOTAL=7
[0m15:04:42.574951 [debug] [MainThread]: Command `dbt run` failed at 15:04:42.574848 after 12.01 seconds
[0m15:04:42.575502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108286150>]}
[0m15:04:42.576150 [debug] [MainThread]: Flushing usage events
[0m15:05:29.461614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107114150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10712c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10712c810>]}


============================== 15:05:29.466145 | e1324dcc-6f91-463d-b3ea-de8c43d9301d ==============================
[0m15:05:29.466145 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:05:29.466549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Downloads/', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:05:29.588503 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:05:29.634407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1324dcc-6f91-463d-b3ea-de8c43d9301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d1d10>]}
[0m15:05:29.660347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1324dcc-6f91-463d-b3ea-de8c43d9301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b4410>]}
[0m15:05:29.682738 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:05:29.725593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:29.725963 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_mobile_events.sql
[0m15:05:29.735461 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m15:05:29.745210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1324dcc-6f91-463d-b3ea-de8c43d9301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079df050>]}
[0m15:05:29.756836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1324dcc-6f91-463d-b3ea-de8c43d9301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae1f10>]}
[0m15:05:29.757058 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:05:29.757244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1324dcc-6f91-463d-b3ea-de8c43d9301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079def10>]}
[0m15:05:29.758170 [info ] [MainThread]: 
[0m15:05:29.758583 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:05:29.759205 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:05:29.764174 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:05:29.764416 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:05:29.764555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:29.764686 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:05:31.480841 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.7160210609436035 seconds
[0m15:05:31.581193 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:05:31.682470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:05:31.688000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:31.688374 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:05:32.882247 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:05:32.883773 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:05:33.004314 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11913394927978516 seconds
[0m15:05:33.188686 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:05:33.296736 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:05:33.409466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1324dcc-6f91-463d-b3ea-de8c43d9301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719fd10>]}
[0m15:05:33.410371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:33.410782 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:05:34.619132 [debug] [MainThread]: On master: COMMIT
[0m15:05:34.620786 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:05:34.621233 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:05:34.716467 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09420490264892578 seconds
[0m15:05:34.718116 [debug] [MainThread]: On master: Close
[0m15:05:34.819154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:34.820139 [info ] [MainThread]: 
[0m15:05:34.928947 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:05:34.929499 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:05:34.930107 [info ] [Thread-1 (]: 1 of 7 START sql view model FAWDBTCORE.stg_mobile_events ....................... [RUN]
[0m15:05:34.931214 [info ] [Thread-2 (]: 2 of 7 START sql view model FAWDBTCORE.stg_web_events .......................... [RUN]
[0m15:05:34.932309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:05:34.932962 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:05:34.933279 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:05:34.933534 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:05:34.935612 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:05:34.937374 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:05:34.992001 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:05:34.935895 => 15:05:34.991350
[0m15:05:34.992638 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:05:34.933719 => 15:05:34.992369
[0m15:05:34.993228 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:05:34.993614 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:05:35.014887 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:05:35.017515 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:05:35.046761 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:35.047216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:35.047582 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:05:35.047863 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:05:36.242749 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:05:36.243558 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m15:05:36.260551 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:05:36.261233 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m15:05:36.343960 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09942770004272461 seconds
[0m15:05:36.360348 [debug] [Thread-2 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m15:05:36.360973 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:05:36.361324 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m15:05:36.366849 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10515904426574707 seconds
[0m15:05:36.368348 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:05:36.368689 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:05:36.368998 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:05:36.458497 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09667420387268066 seconds
[0m15:05:36.466262 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:05:36.466678 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09733819961547852 seconds
[0m15:05:36.467123 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:05:36.469748 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:05:36.470410 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:05:36.566260 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09597206115722656 seconds
[0m15:05:36.573034 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10213828086853027 seconds
[0m15:05:36.576253 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:05:34.993875 => 15:05:36.576103
[0m15:05:36.578953 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:05:35.015217 => 15:05:36.578795
[0m15:05:36.579394 [debug] [Thread-2 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:05:36.579654 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:05:36.685155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1324dcc-6f91-463d-b3ea-de8c43d9301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b86050>]}
[0m15:05:36.687452 [info ] [Thread-1 (]: 1 of 7 OK created sql view model FAWDBTCORE.stg_mobile_events .................. [[32mOK[0m in 1.75s]
[0m15:05:36.688456 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:05:36.690723 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1324dcc-6f91-463d-b3ea-de8c43d9301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfe5d0>]}
[0m15:05:36.691541 [info ] [Thread-2 (]: 2 of 7 OK created sql view model FAWDBTCORE.stg_web_events ..................... [[32mOK[0m in 1.76s]
[0m15:05:36.692165 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:05:36.693109 [debug] [Thread-4 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:05:36.693619 [debug] [Thread-3 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:05:36.694006 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:05:36.694469 [debug] [Thread-2 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:05:36.694865 [info ] [Thread-4 (]: 3 of 7 START sql view model FAWDBTCORE.average_duration_by_platform_country .... [RUN]
[0m15:05:36.695423 [info ] [Thread-3 (]: 4 of 7 START sql view model FAWDBTCORE.event_counts_by_platform ................ [RUN]
[0m15:05:36.695936 [info ] [Thread-1 (]: 5 of 7 START sql view model FAWDBTCORE.mobile_event_durations .................. [RUN]
[0m15:05:36.696593 [info ] [Thread-2 (]: 6 of 7 START sql view model FAWDBTCORE.ranked_web_events ....................... [RUN]
[0m15:05:36.697786 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.average_duration_by_platform_country'
[0m15:05:36.698653 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.event_counts_by_platform'
[0m15:05:36.699253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m15:05:36.699771 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.ranked_web_events)
[0m15:05:36.700094 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m15:05:36.700381 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m15:05:36.700650 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m15:05:36.700917 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m15:05:36.703905 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:05:36.706548 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m15:05:36.711109 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m15:05:36.713412 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m15:05:36.721626 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 15:05:36.711465 => 15:05:36.721421
[0m15:05:36.722031 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 15:05:36.704104 => 15:05:36.721828
[0m15:05:36.722342 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 15:05:36.701108 => 15:05:36.722207
[0m15:05:36.722635 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 15:05:36.706896 => 15:05:36.722510
[0m15:05:36.722897 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m15:05:36.723205 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m15:05:36.723466 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m15:05:36.723718 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m15:05:36.725962 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m15:05:36.727970 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m15:05:36.729436 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:05:36.730648 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m15:05:36.761796 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:36.762122 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:36.762412 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:05:36.762722 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:05:36.762972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:36.763264 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:05:36.763560 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:05:36.764033 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:05:38.036909 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:05:38.038068 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:05:38.038962 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
)

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id;

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system;
)

select * from mobile_event_durations


[0m15:05:38.040425 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:05:38.040878 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:05:38.041373 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned;


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned;
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events;
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform;
)

select * from event_counts_by_platform


[0m15:05:38.042062 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events;

)

select * from ranked_web_events


[0m15:05:38.042491 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned;


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned;
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events;
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country;
)

select * from average_duration_by_platform_country


[0m15:05:38.236920 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m15:05:38.239003 [info ] [Thread-4 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:05:38.239682 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:05:38.240251 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:05:38.241269 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: ROLLBACK
[0m15:05:38.241938 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: ROLLBACK
[0m15:05:38.242387 [debug] [Thread-2 (]: On model.oracle_dbt.ranked_web_events: ROLLBACK
[0m15:05:38.242820 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: ROLLBACK
[0m15:05:38.338899 [debug] [Thread-2 (]: On model.oracle_dbt.ranked_web_events: Close
[0m15:05:38.339972 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m15:05:38.340495 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m15:05:38.361502 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m15:05:38.482839 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 15:05:36.723888 => 15:05:38.481857
[0m15:05:38.484550 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 15:05:36.729542 => 15:05:38.483933
[0m15:05:38.488417 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 15:05:36.726170 => 15:05:38.488040
[0m15:05:38.489077 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 15:05:36.728161 => 15:05:38.488855
[0m15:05:38.506001 [debug] [Thread-2 (]: Database Error in model ranked_web_events (models/ranked_web_events.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/ranked_web_events.sql
[0m15:05:38.507700 [debug] [Thread-1 (]: Database Error in model mobile_event_durations (models/mobile_event_durations.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/mobile_event_durations.sql
[0m15:05:38.508813 [debug] [Thread-3 (]: Database Error in model event_counts_by_platform (models/event_counts_by_platform.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/event_counts_by_platform.sql
[0m15:05:38.509911 [debug] [Thread-4 (]: Database Error in model average_duration_by_platform_country (models/average_duration_by_platform_country.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/average_duration_by_platform_country.sql
[0m15:05:38.512046 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1324dcc-6f91-463d-b3ea-de8c43d9301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8b8d0>]}
[0m15:05:38.513774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1324dcc-6f91-463d-b3ea-de8c43d9301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c53a10>]}
[0m15:05:38.515453 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1324dcc-6f91-463d-b3ea-de8c43d9301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c88cd0>]}
[0m15:05:38.517048 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1324dcc-6f91-463d-b3ea-de8c43d9301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c88550>]}
[0m15:05:38.517565 [error] [Thread-2 (]: 6 of 7 ERROR creating sql view model FAWDBTCORE.ranked_web_events .............. [[31mERROR[0m in 1.81s]
[0m15:05:38.518015 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model FAWDBTCORE.mobile_event_durations ......... [[31mERROR[0m in 1.81s]
[0m15:05:38.518475 [error] [Thread-3 (]: 4 of 7 ERROR creating sql view model FAWDBTCORE.event_counts_by_platform ....... [[31mERROR[0m in 1.82s]
[0m15:05:38.518934 [error] [Thread-4 (]: 3 of 7 ERROR creating sql view model FAWDBTCORE.average_duration_by_platform_country  [[31mERROR[0m in 1.82s]
[0m15:05:38.519335 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:05:38.519606 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:05:38.519856 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:05:38.520110 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:05:38.520410 [debug] [Thread-2 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:05:38.521421 [info ] [Thread-2 (]: 7 of 7 START sql view model FAWDBTCORE.web_events_counts ....................... [RUN]
[0m15:05:38.522031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.ranked_web_events, now model.oracle_dbt.web_events_counts)
[0m15:05:38.522282 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m15:05:38.524714 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m15:05:38.526428 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 15:05:38.522451 => 15:05:38.526249
[0m15:05:38.526707 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.web_events_counts
[0m15:05:38.528831 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m15:05:38.541069 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:38.541431 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:05:39.720490 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:05:39.721938 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
)

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id;

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type;
)

select * from web_event_counts


[0m15:05:39.916884 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m15:05:39.918641 [debug] [Thread-2 (]: On model.oracle_dbt.web_events_counts: ROLLBACK
[0m15:05:40.016263 [debug] [Thread-2 (]: On model.oracle_dbt.web_events_counts: Close
[0m15:05:40.116048 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 15:05:38.526841 => 15:05:40.115133
[0m15:05:40.120618 [debug] [Thread-2 (]: Database Error in model web_events_counts (models/web_events_counts.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/web_events_counts.sql
[0m15:05:40.123098 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1324dcc-6f91-463d-b3ea-de8c43d9301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c72690>]}
[0m15:05:40.123911 [error] [Thread-2 (]: 7 of 7 ERROR creating sql view model FAWDBTCORE.web_events_counts .............. [[31mERROR[0m in 1.60s]
[0m15:05:40.124514 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:05:40.126797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:40.127389 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:05:41.306043 [debug] [MainThread]: On master: COMMIT
[0m15:05:41.307469 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:05:41.307880 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:05:41.405268 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09652876853942871 seconds
[0m15:05:41.406930 [debug] [MainThread]: On master: Close
[0m15:05:41.507357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:41.508661 [debug] [MainThread]: Connection 'model.oracle_dbt.mobile_event_durations' was properly closed.
[0m15:05:41.509051 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m15:05:41.509457 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m15:05:41.509875 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m15:05:41.510250 [info ] [MainThread]: 
[0m15:05:41.510763 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 11.75 seconds (11.75s).
[0m15:05:41.512158 [debug] [MainThread]: Command end result
[0m15:05:41.537749 [info ] [MainThread]: 
[0m15:05:41.538238 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m15:05:41.538478 [info ] [MainThread]: 
[0m15:05:41.538711 [error] [MainThread]: [33mDatabase Error in model ranked_web_events (models/ranked_web_events.sql)[0m
[0m15:05:41.538954 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:05:41.539164 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/ranked_web_events.sql
[0m15:05:41.539355 [info ] [MainThread]: 
[0m15:05:41.539543 [error] [MainThread]: [33mDatabase Error in model mobile_event_durations (models/mobile_event_durations.sql)[0m
[0m15:05:41.539772 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m15:05:41.540075 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/mobile_event_durations.sql
[0m15:05:41.540332 [info ] [MainThread]: 
[0m15:05:41.540540 [error] [MainThread]: [33mDatabase Error in model event_counts_by_platform (models/event_counts_by_platform.sql)[0m
[0m15:05:41.540778 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:05:41.541194 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/event_counts_by_platform.sql
[0m15:05:41.541577 [info ] [MainThread]: 
[0m15:05:41.541871 [error] [MainThread]: [33mDatabase Error in model average_duration_by_platform_country (models/average_duration_by_platform_country.sql)[0m
[0m15:05:41.542133 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:05:41.542376 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/average_duration_by_platform_country.sql
[0m15:05:41.542609 [info ] [MainThread]: 
[0m15:05:41.542843 [error] [MainThread]: [33mDatabase Error in model web_events_counts (models/web_events_counts.sql)[0m
[0m15:05:41.543070 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m15:05:41.543294 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_counts.sql
[0m15:05:41.543641 [info ] [MainThread]: 
[0m15:05:41.543974 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=5 SKIP=0 TOTAL=7
[0m15:05:41.544519 [debug] [MainThread]: Command `dbt run` failed at 15:05:41.544438 after 12.12 seconds
[0m15:05:41.544833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102960cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102960d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f7250>]}
[0m15:05:41.545114 [debug] [MainThread]: Flushing usage events
[0m15:07:38.804147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089bfc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089bff90>]}


============================== 15:07:38.807687 | de6fd465-9e40-4aae-a1f2-f8f3b6109bf0 ==============================
[0m15:07:38.807687 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:07:38.808133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:07:38.896775 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:07:38.924451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de6fd465-9e40-4aae-a1f2-f8f3b6109bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a7dd10>]}
[0m15:07:38.949039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de6fd465-9e40-4aae-a1f2-f8f3b6109bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d49d0>]}
[0m15:07:38.966794 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:07:39.016781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m15:07:39.017157 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/average_duration_by_platform_country.sql
[0m15:07:39.017343 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/ranked_web_events.sql
[0m15:07:39.017519 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/mobile_event_durations.sql
[0m15:07:39.017682 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/event_counts_by_platform.sql
[0m15:07:39.027826 [debug] [MainThread]: 1699: static parser successfully parsed average_duration_by_platform_country.sql
[0m15:07:39.034053 [debug] [MainThread]: 1699: static parser successfully parsed ranked_web_events.sql
[0m15:07:39.036025 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m15:07:39.038051 [debug] [MainThread]: 1699: static parser successfully parsed event_counts_by_platform.sql
[0m15:07:39.043648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de6fd465-9e40-4aae-a1f2-f8f3b6109bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a00b90>]}
[0m15:07:39.061778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de6fd465-9e40-4aae-a1f2-f8f3b6109bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b2150>]}
[0m15:07:39.062042 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:07:39.062241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de6fd465-9e40-4aae-a1f2-f8f3b6109bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d6250>]}
[0m15:07:39.063190 [info ] [MainThread]: 
[0m15:07:39.063591 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:07:39.064220 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:07:39.069405 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:07:39.069670 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:07:39.069807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:39.069937 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:07:40.832409 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.7595851421356201 seconds
[0m15:07:40.935385 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:07:41.037954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:07:41.045335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:41.045783 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:07:42.238391 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:07:42.238733 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:07:42.355208 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11618494987487793 seconds
[0m15:07:42.538305 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:07:42.632698 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:07:42.737699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de6fd465-9e40-4aae-a1f2-f8f3b6109bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f2910>]}
[0m15:07:42.738516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:42.738920 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:07:43.913210 [debug] [MainThread]: On master: COMMIT
[0m15:07:43.914474 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:07:43.914928 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:07:44.012989 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09412193298339844 seconds
[0m15:07:44.014296 [debug] [MainThread]: On master: Close
[0m15:07:44.117828 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:07:44.118527 [info ] [MainThread]: 
[0m15:07:44.136794 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:07:44.137275 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:07:44.137849 [info ] [Thread-1 (]: 1 of 7 START sql view model FAWDBTCORE.stg_mobile_events ....................... [RUN]
[0m15:07:44.138296 [info ] [Thread-2 (]: 2 of 7 START sql view model FAWDBTCORE.stg_web_events .......................... [RUN]
[0m15:07:44.139049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:07:44.139588 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:07:44.139856 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:07:44.140093 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:07:44.141924 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:07:44.143140 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:07:44.144373 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:07:44.142122 => 15:07:44.144268
[0m15:07:44.144544 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:07:44.144773 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:07:44.140265 => 15:07:44.144692
[0m15:07:44.158945 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:07:44.159274 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:07:44.161342 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:07:44.166260 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:07:44.166523 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:07:44.178121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:44.178375 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:07:45.346558 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:07:45.349516 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m15:07:45.353030 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:07:45.353672 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m15:07:45.466441 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.11628103256225586 seconds
[0m15:07:45.475161 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.12087464332580566 seconds
[0m15:07:45.477698 [debug] [Thread-2 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m15:07:45.479316 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:07:45.479810 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:07:45.480125 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:07:45.480409 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m15:07:45.480680 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:07:45.575113 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09409213066101074 seconds
[0m15:07:45.575434 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09432411193847656 seconds
[0m15:07:45.579131 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:07:45.580618 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:07:45.580943 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:07:45.581195 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:07:45.677843 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09630918502807617 seconds
[0m15:07:45.678258 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09663581848144531 seconds
[0m15:07:45.689478 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:07:44.144906 => 15:07:45.689315
[0m15:07:45.691011 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:07:44.159536 => 15:07:45.690879
[0m15:07:45.691306 [debug] [Thread-2 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:07:45.691555 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:07:45.795818 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6fd465-9e40-4aae-a1f2-f8f3b6109bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109357b50>]}
[0m15:07:45.796341 [info ] [Thread-2 (]: 2 of 7 OK created sql view model FAWDBTCORE.stg_web_events ..................... [[32mOK[0m in 1.66s]
[0m15:07:45.796941 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:07:45.799490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6fd465-9e40-4aae-a1f2-f8f3b6109bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109366350>]}
[0m15:07:45.800095 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:07:45.800655 [info ] [Thread-1 (]: 1 of 7 OK created sql view model FAWDBTCORE.stg_mobile_events .................. [[32mOK[0m in 1.66s]
[0m15:07:45.801158 [info ] [Thread-4 (]: 3 of 7 START sql view model FAWDBTCORE.ranked_web_events ....................... [RUN]
[0m15:07:45.801677 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:07:45.802282 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.ranked_web_events'
[0m15:07:45.802882 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m15:07:45.803339 [debug] [Thread-2 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:07:45.803722 [debug] [Thread-3 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:07:45.808198 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m15:07:45.808529 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:07:45.808903 [info ] [Thread-2 (]: 4 of 7 START sql view model FAWDBTCORE.average_duration_by_platform_country .... [RUN]
[0m15:07:45.809296 [info ] [Thread-3 (]: 5 of 7 START sql view model FAWDBTCORE.event_counts_by_platform ................ [RUN]
[0m15:07:45.809878 [info ] [Thread-1 (]: 6 of 7 START sql view model FAWDBTCORE.mobile_event_durations .................. [RUN]
[0m15:07:45.810708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.average_duration_by_platform_country)
[0m15:07:45.811311 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.event_counts_by_platform'
[0m15:07:45.811776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m15:07:45.812106 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m15:07:45.812479 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m15:07:45.812732 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m15:07:45.815292 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:07:45.817636 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m15:07:45.819424 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m15:07:45.820151 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 15:07:45.803928 => 15:07:45.819987
[0m15:07:45.820362 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m15:07:45.821824 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m15:07:45.824900 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 15:07:45.812905 => 15:07:45.824775
[0m15:07:45.825149 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 15:07:45.815542 => 15:07:45.825018
[0m15:07:45.825361 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m15:07:45.825608 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m15:07:45.825804 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:07:45.826030 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 15:07:45.817898 => 15:07:45.825912
[0m15:07:45.828031 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:07:45.829762 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m15:07:45.830146 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:07:45.830481 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m15:07:45.832848 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m15:07:45.848163 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:45.848454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:45.848717 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:07:45.848970 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:07:45.849178 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:07:45.849411 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:07:47.036625 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:07:47.038033 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m15:07:47.054522 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:07:47.055521 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
)

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m15:07:47.063774 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:07:47.064645 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m15:07:47.070828 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:07:47.071986 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m15:07:47.234064 [info ] [Thread-4 (]: oracle adapter: Oracle error: ORA-00955: name is already used by an existing object
[0m15:07:47.234449 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: ROLLBACK
[0m15:07:47.246085 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m15:07:47.246450 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: ROLLBACK
[0m15:07:47.273634 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00955: name is already used by an existing object
[0m15:07:47.274041 [debug] [Thread-2 (]: On model.oracle_dbt.average_duration_by_platform_country: ROLLBACK
[0m15:07:47.275733 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00955: name is already used by an existing object
[0m15:07:47.276058 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: ROLLBACK
[0m15:07:47.330731 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: Close
[0m15:07:47.341487 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m15:07:47.369369 [debug] [Thread-2 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m15:07:47.370578 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m15:07:47.429864 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 15:07:45.820468 => 15:07:47.429581
[0m15:07:47.439083 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 15:07:45.831003 => 15:07:47.438812
[0m15:07:47.462959 [debug] [Thread-4 (]: Database Error in model ranked_web_events (models/ranked_web_events.sql)
  ORA-00955: name is already used by an existing object
  compiled Code at target/run/oracle_dbt/models/ranked_web_events.sql
[0m15:07:47.464434 [debug] [Thread-1 (]: Database Error in model mobile_event_durations (models/mobile_event_durations.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/mobile_event_durations.sql
[0m15:07:47.466788 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6fd465-9e40-4aae-a1f2-f8f3b6109bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d6b50>]}
[0m15:07:47.467524 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 15:07:45.826176 => 15:07:47.467311
[0m15:07:47.468124 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 15:07:45.828221 => 15:07:47.467955
[0m15:07:47.470793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6fd465-9e40-4aae-a1f2-f8f3b6109bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093000d0>]}
[0m15:07:47.471502 [error] [Thread-4 (]: 3 of 7 ERROR creating sql view model FAWDBTCORE.ranked_web_events .............. [[31mERROR[0m in 1.66s]
[0m15:07:47.476394 [debug] [Thread-2 (]: Database Error in model average_duration_by_platform_country (models/average_duration_by_platform_country.sql)
  ORA-00955: name is already used by an existing object
  compiled Code at target/run/oracle_dbt/models/average_duration_by_platform_country.sql
[0m15:07:47.478176 [debug] [Thread-3 (]: Database Error in model event_counts_by_platform (models/event_counts_by_platform.sql)
  ORA-00955: name is already used by an existing object
  compiled Code at target/run/oracle_dbt/models/event_counts_by_platform.sql
[0m15:07:47.478890 [error] [Thread-1 (]: 6 of 7 ERROR creating sql view model FAWDBTCORE.mobile_event_durations ......... [[31mERROR[0m in 1.66s]
[0m15:07:47.479473 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:07:47.481542 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6fd465-9e40-4aae-a1f2-f8f3b6109bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109303850>]}
[0m15:07:47.483386 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6fd465-9e40-4aae-a1f2-f8f3b6109bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b0b90>]}
[0m15:07:47.483791 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:07:47.484369 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:07:47.485353 [error] [Thread-2 (]: 4 of 7 ERROR creating sql view model FAWDBTCORE.average_duration_by_platform_country  [[31mERROR[0m in 1.67s]
[0m15:07:47.485907 [error] [Thread-3 (]: 5 of 7 ERROR creating sql view model FAWDBTCORE.event_counts_by_platform ....... [[31mERROR[0m in 1.67s]
[0m15:07:47.486514 [info ] [Thread-4 (]: 7 of 7 START sql view model FAWDBTCORE.web_events_counts ....................... [RUN]
[0m15:07:47.487055 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:07:47.487417 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:07:47.488010 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.ranked_web_events, now model.oracle_dbt.web_events_counts)
[0m15:07:47.488611 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m15:07:47.491564 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m15:07:47.495970 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 15:07:47.488806 => 15:07:47.495683
[0m15:07:47.496295 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.web_events_counts
[0m15:07:47.498830 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m15:07:47.500317 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:07:47.500663 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:07:48.693603 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:07:48.694753 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
)

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id;

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type;
)

select * from web_event_counts


[0m15:07:48.888153 [info ] [Thread-4 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m15:07:48.892097 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_counts: ROLLBACK
[0m15:07:48.992651 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_counts: Close
[0m15:07:49.088838 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 15:07:47.496463 => 15:07:49.087914
[0m15:07:49.095492 [debug] [Thread-4 (]: Database Error in model web_events_counts (models/web_events_counts.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/web_events_counts.sql
[0m15:07:49.097588 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6fd465-9e40-4aae-a1f2-f8f3b6109bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109302dd0>]}
[0m15:07:49.098157 [error] [Thread-4 (]: 7 of 7 ERROR creating sql view model FAWDBTCORE.web_events_counts .............. [[31mERROR[0m in 1.61s]
[0m15:07:49.098637 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:07:49.100821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:49.101364 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:07:50.276493 [debug] [MainThread]: On master: COMMIT
[0m15:07:50.278243 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:07:50.278880 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:07:50.376816 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09701204299926758 seconds
[0m15:07:50.378447 [debug] [MainThread]: On master: Close
[0m15:07:50.479875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:50.480680 [debug] [MainThread]: Connection 'model.oracle_dbt.mobile_event_durations' was properly closed.
[0m15:07:50.481030 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m15:07:50.481335 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m15:07:50.481621 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m15:07:50.482071 [info ] [MainThread]: 
[0m15:07:50.482585 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 11.42 seconds (11.42s).
[0m15:07:50.483836 [debug] [MainThread]: Command end result
[0m15:07:50.497091 [info ] [MainThread]: 
[0m15:07:50.497799 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m15:07:50.498117 [info ] [MainThread]: 
[0m15:07:50.498401 [error] [MainThread]: [33mDatabase Error in model ranked_web_events (models/ranked_web_events.sql)[0m
[0m15:07:50.498696 [error] [MainThread]:   ORA-00955: name is already used by an existing object
[0m15:07:50.498966 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/ranked_web_events.sql
[0m15:07:50.499236 [info ] [MainThread]: 
[0m15:07:50.499498 [error] [MainThread]: [33mDatabase Error in model mobile_event_durations (models/mobile_event_durations.sql)[0m
[0m15:07:50.499760 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m15:07:50.500011 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/mobile_event_durations.sql
[0m15:07:50.500272 [info ] [MainThread]: 
[0m15:07:50.500534 [error] [MainThread]: [33mDatabase Error in model average_duration_by_platform_country (models/average_duration_by_platform_country.sql)[0m
[0m15:07:50.500788 [error] [MainThread]:   ORA-00955: name is already used by an existing object
[0m15:07:50.501039 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/average_duration_by_platform_country.sql
[0m15:07:50.501301 [info ] [MainThread]: 
[0m15:07:50.501556 [error] [MainThread]: [33mDatabase Error in model event_counts_by_platform (models/event_counts_by_platform.sql)[0m
[0m15:07:50.501816 [error] [MainThread]:   ORA-00955: name is already used by an existing object
[0m15:07:50.502283 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/event_counts_by_platform.sql
[0m15:07:50.502633 [info ] [MainThread]: 
[0m15:07:50.502927 [error] [MainThread]: [33mDatabase Error in model web_events_counts (models/web_events_counts.sql)[0m
[0m15:07:50.503208 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m15:07:50.503479 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_counts.sql
[0m15:07:50.503752 [info ] [MainThread]: 
[0m15:07:50.504054 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=5 SKIP=0 TOTAL=7
[0m15:07:50.504677 [debug] [MainThread]: Command `dbt run` failed at 15:07:50.504587 after 11.74 seconds
[0m15:07:50.505020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089bf0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089bffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f4d50>]}
[0m15:07:50.505318 [debug] [MainThread]: Flushing usage events
[0m15:14:21.621158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e17e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e17fd0>]}


============================== 15:14:21.624620 | 6d43d554-2016-4716-998f-a74d97b4969b ==============================
[0m15:14:21.624620 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:14:21.624989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:14:21.741995 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:14:21.774568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d43d554-2016-4716-998f-a74d97b4969b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116bebd0>]}
[0m15:14:21.799249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d43d554-2016-4716-998f-a74d97b4969b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e7e410>]}
[0m15:14:21.827047 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:14:21.886033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:21.886293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:21.889609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d43d554-2016-4716-998f-a74d97b4969b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124fbc90>]}
[0m15:14:21.895018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d43d554-2016-4716-998f-a74d97b4969b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eca750>]}
[0m15:14:21.895251 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:14:21.895440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d43d554-2016-4716-998f-a74d97b4969b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11258a8d0>]}
[0m15:14:21.896547 [info ] [MainThread]: 
[0m15:14:21.896956 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:14:21.897566 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:14:21.902885 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:14:21.903142 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:14:21.903282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:21.903409 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:14:23.538150 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.6342542171478271 seconds
[0m15:14:23.633881 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:14:23.728279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:14:23.733780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:23.734270 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:14:24.917875 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:14:24.919304 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:14:25.033072 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11279726028442383 seconds
[0m15:14:25.230242 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:14:25.333225 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:14:25.428639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d43d554-2016-4716-998f-a74d97b4969b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ecb250>]}
[0m15:14:25.429095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:25.429316 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:14:26.565239 [debug] [MainThread]: On master: COMMIT
[0m15:14:26.567173 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:14:26.568115 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:14:26.659948 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09134817123413086 seconds
[0m15:14:26.660350 [debug] [MainThread]: On master: Close
[0m15:14:26.758239 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:14:26.759343 [info ] [MainThread]: 
[0m15:14:26.775219 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:14:26.775741 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:14:26.776383 [info ] [Thread-1 (]: 1 of 7 START sql view model FAWDBTCORE.stg_mobile_events ....................... [RUN]
[0m15:14:26.776961 [info ] [Thread-2 (]: 2 of 7 START sql view model FAWDBTCORE.stg_web_events .......................... [RUN]
[0m15:14:26.777906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:14:26.778516 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:14:26.778822 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:14:26.779091 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:14:26.780891 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:14:26.783016 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:14:26.784746 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:14:26.781330 => 15:14:26.784502
[0m15:14:26.785211 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:14:26.779286 => 15:14:26.784959
[0m15:14:26.785785 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:14:26.786206 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:14:26.804738 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:14:26.806522 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:14:26.812013 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:14:26.812331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:26.812610 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:14:26.812843 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:14:27.984764 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:14:27.985119 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m15:14:27.997179 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:14:27.997643 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m15:14:28.082114 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09666895866394043 seconds
[0m15:14:28.088362 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:14:28.088687 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:14:28.088922 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:14:28.097035 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09901285171508789 seconds
[0m15:14:28.098299 [debug] [Thread-2 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m15:14:28.098575 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:14:28.098781 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m15:14:28.190006 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10070419311523438 seconds
[0m15:14:28.195238 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:14:28.195621 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09656500816345215 seconds
[0m15:14:28.196056 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:14:28.198165 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:14:28.198700 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:14:28.295701 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09713292121887207 seconds
[0m15:14:28.296042 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09696102142333984 seconds
[0m15:14:28.304282 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:14:26.804949 => 15:14:28.304144
[0m15:14:28.305618 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:14:26.786493 => 15:14:28.305509
[0m15:14:28.305896 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:14:28.306102 [debug] [Thread-2 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:14:28.401112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d43d554-2016-4716-998f-a74d97b4969b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112687490>]}
[0m15:14:28.403157 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d43d554-2016-4716-998f-a74d97b4969b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112615b50>]}
[0m15:14:28.403827 [info ] [Thread-1 (]: 1 of 7 OK created sql view model FAWDBTCORE.stg_mobile_events .................. [[32mOK[0m in 1.62s]
[0m15:14:28.404451 [info ] [Thread-2 (]: 2 of 7 OK created sql view model FAWDBTCORE.stg_web_events ..................... [[32mOK[0m in 1.62s]
[0m15:14:28.405087 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:14:28.405484 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:14:28.406438 [debug] [Thread-4 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:14:28.406788 [debug] [Thread-3 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:14:28.407058 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:14:28.407330 [debug] [Thread-2 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:14:28.407622 [info ] [Thread-4 (]: 3 of 7 START sql view model FAWDBTCORE.average_duration_by_platform_country .... [RUN]
[0m15:14:28.407921 [info ] [Thread-3 (]: 4 of 7 START sql view model FAWDBTCORE.event_counts_by_platform ................ [RUN]
[0m15:14:28.408334 [info ] [Thread-1 (]: 5 of 7 START sql view model FAWDBTCORE.mobile_event_durations .................. [RUN]
[0m15:14:28.408649 [info ] [Thread-2 (]: 6 of 7 START sql view model FAWDBTCORE.ranked_web_events ....................... [RUN]
[0m15:14:28.409304 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.average_duration_by_platform_country'
[0m15:14:28.409737 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.event_counts_by_platform'
[0m15:14:28.410121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m15:14:28.410468 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.ranked_web_events)
[0m15:14:28.410677 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m15:14:28.410864 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m15:14:28.411046 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m15:14:28.411222 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m15:14:28.413975 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:14:28.415909 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m15:14:28.417573 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m15:14:28.419104 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m15:14:28.430693 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 15:14:28.411354 => 15:14:28.430482
[0m15:14:28.431041 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 15:14:28.414204 => 15:14:28.430865
[0m15:14:28.431375 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 15:14:28.416055 => 15:14:28.431242
[0m15:14:28.431641 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 15:14:28.417730 => 15:14:28.431548
[0m15:14:28.431851 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m15:14:28.432055 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m15:14:28.432223 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m15:14:28.432396 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m15:14:28.434129 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:14:28.435777 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m15:14:28.437271 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m15:14:28.438689 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m15:14:28.457422 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:14:28.457735 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:14:28.457977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:28.458204 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:14:28.458408 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:14:28.458595 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:14:28.482180 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:14:28.482561 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:14:29.579436 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:14:29.580290 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m15:14:29.592960 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:14:29.593582 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m15:14:29.594164 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:14:29.595097 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
)

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m15:14:29.600349 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:14:29.600999 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m15:14:29.686499 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10554695129394531 seconds
[0m15:14:29.687992 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m15:14:29.688269 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:14:29.688494 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: fCOMMIT
[0m15:14:29.784334 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09553194046020508 seconds
[0m15:14:29.786248 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:14:29.786486 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m15:14:29.786812 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:14:29.787055 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: ROLLBACK
[0m15:14:29.799290 [info ] [Thread-4 (]: oracle adapter: Oracle error: ORA-00955: name is already used by an existing object
[0m15:14:29.799853 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: ROLLBACK
[0m15:14:29.819434 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.22469615936279297 seconds
[0m15:14:29.820508 [debug] [Thread-2 (]: On model.oracle_dbt.ranked_web_events: COMMIT
[0m15:14:29.820726 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:14:29.820912 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: fCOMMIT
[0m15:14:29.880534 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m15:14:29.883195 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09591102600097656 seconds
[0m15:14:29.884500 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 15:14:28.434328 => 15:14:29.884386
[0m15:14:29.884724 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m15:14:29.891432 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m15:14:29.912033 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09087896347045898 seconds
[0m15:14:29.915311 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:14:29.915598 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.ranked_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:14:29.974350 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 15:14:28.435970 => 15:14:29.974071
[0m15:14:29.979039 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d43d554-2016-4716-998f-a74d97b4969b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112911610>]}
[0m15:14:29.979498 [info ] [Thread-3 (]: 4 of 7 OK created sql view model FAWDBTCORE.event_counts_by_platform ........... [[32mOK[0m in 1.57s]
[0m15:14:29.979922 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:14:29.980192 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:14:29.980549 [info ] [Thread-3 (]: 7 of 7 START sql view model FAWDBTCORE.web_events_counts ....................... [RUN]
[0m15:14:29.981088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.event_counts_by_platform, now model.oracle_dbt.web_events_counts)
[0m15:14:29.981329 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m15:14:29.983735 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m15:14:29.984239 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 15:14:28.432555 => 15:14:29.984115
[0m15:14:30.015028 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09909200668334961 seconds
[0m15:14:30.016622 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 15:14:28.437432 => 15:14:30.016493
[0m15:14:30.016894 [debug] [Thread-2 (]: On model.oracle_dbt.ranked_web_events: Close
[0m15:14:30.033608 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 15:14:29.981481 => 15:14:30.033389
[0m15:14:30.033918 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_counts
[0m15:14:30.036277 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m15:14:30.073802 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:14:30.074239 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:14:30.114507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d43d554-2016-4716-998f-a74d97b4969b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128d8f10>]}
[0m15:14:30.115336 [info ] [Thread-2 (]: 6 of 7 OK created sql view model FAWDBTCORE.ranked_web_events .................. [[32mOK[0m in 1.70s]
[0m15:14:30.115892 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:14:30.184742 [debug] [Thread-4 (]: Database Error in model average_duration_by_platform_country (models/average_duration_by_platform_country.sql)
  ORA-00955: name is already used by an existing object
  compiled Code at target/run/oracle_dbt/models/average_duration_by_platform_country.sql
[0m15:14:30.185470 [debug] [Thread-1 (]: Database Error in model mobile_event_durations (models/mobile_event_durations.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/mobile_event_durations.sql
[0m15:14:30.186501 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d43d554-2016-4716-998f-a74d97b4969b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e46c90>]}
[0m15:14:30.187625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d43d554-2016-4716-998f-a74d97b4969b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128d3390>]}
[0m15:14:30.187931 [error] [Thread-4 (]: 3 of 7 ERROR creating sql view model FAWDBTCORE.average_duration_by_platform_country  [[31mERROR[0m in 1.78s]
[0m15:14:30.188234 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model FAWDBTCORE.mobile_event_durations ......... [[31mERROR[0m in 1.78s]
[0m15:14:30.188471 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:14:30.188643 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:14:31.206309 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:14:31.206981 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
)

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id;

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type;
)

select * from web_event_counts


[0m15:14:31.406031 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m15:14:31.407541 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: ROLLBACK
[0m15:14:31.500070 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: Close
[0m15:14:31.595399 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 15:14:30.034071 => 15:14:31.594182
[0m15:14:31.600999 [debug] [Thread-3 (]: Database Error in model web_events_counts (models/web_events_counts.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/web_events_counts.sql
[0m15:14:31.603856 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d43d554-2016-4716-998f-a74d97b4969b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112629cd0>]}
[0m15:14:31.604801 [error] [Thread-3 (]: 7 of 7 ERROR creating sql view model FAWDBTCORE.web_events_counts .............. [[31mERROR[0m in 1.62s]
[0m15:14:31.605692 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:14:31.607912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:31.608386 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:14:32.752319 [debug] [MainThread]: On master: COMMIT
[0m15:14:32.752673 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:14:32.752843 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:14:32.843998 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09085202217102051 seconds
[0m15:14:32.844531 [debug] [MainThread]: On master: Close
[0m15:14:32.942208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:32.942945 [debug] [MainThread]: Connection 'model.oracle_dbt.mobile_event_durations' was properly closed.
[0m15:14:32.943226 [debug] [MainThread]: Connection 'model.oracle_dbt.ranked_web_events' was properly closed.
[0m15:14:32.943477 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m15:14:32.943715 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m15:14:32.944097 [info ] [MainThread]: 
[0m15:14:32.944575 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 11.05 seconds (11.05s).
[0m15:14:32.945799 [debug] [MainThread]: Command end result
[0m15:14:32.963639 [info ] [MainThread]: 
[0m15:14:32.964083 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:14:32.964250 [info ] [MainThread]: 
[0m15:14:32.964404 [error] [MainThread]: [33mDatabase Error in model average_duration_by_platform_country (models/average_duration_by_platform_country.sql)[0m
[0m15:14:32.964551 [error] [MainThread]:   ORA-00955: name is already used by an existing object
[0m15:14:32.964703 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/average_duration_by_platform_country.sql
[0m15:14:32.964854 [info ] [MainThread]: 
[0m15:14:32.964997 [error] [MainThread]: [33mDatabase Error in model mobile_event_durations (models/mobile_event_durations.sql)[0m
[0m15:14:32.965146 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m15:14:32.965276 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/mobile_event_durations.sql
[0m15:14:32.965432 [info ] [MainThread]: 
[0m15:14:32.965689 [error] [MainThread]: [33mDatabase Error in model web_events_counts (models/web_events_counts.sql)[0m
[0m15:14:32.965936 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m15:14:32.966181 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_counts.sql
[0m15:14:32.966441 [info ] [MainThread]: 
[0m15:14:32.966729 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
[0m15:14:32.967293 [debug] [MainThread]: Command `dbt run` failed at 15:14:32.967209 after 11.39 seconds
[0m15:14:32.967626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130b410>]}
[0m15:14:32.967921 [debug] [MainThread]: Flushing usage events
[0m15:18:00.129515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106217fd0>]}


============================== 15:18:00.134856 | a8dc6e76-092d-43b8-a2ef-1a99686b9274 ==============================
[0m15:18:00.134856 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:18:00.135239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:18:00.563881 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:18:00.601920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8dc6e76-092d-43b8-a2ef-1a99686b9274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106244a90>]}
[0m15:18:00.627556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8dc6e76-092d-43b8-a2ef-1a99686b9274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106289690>]}
[0m15:18:00.649150 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:18:00.703754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:00.704198 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_counts.sql
[0m15:18:00.714645 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m15:18:00.724815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8dc6e76-092d-43b8-a2ef-1a99686b9274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062093d0>]}
[0m15:18:00.737367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8dc6e76-092d-43b8-a2ef-1a99686b9274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a385d0>]}
[0m15:18:00.737706 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:18:00.737902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8dc6e76-092d-43b8-a2ef-1a99686b9274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106936d50>]}
[0m15:18:00.738883 [info ] [MainThread]: 
[0m15:18:00.739384 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:18:00.740131 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:18:00.745484 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:18:00.745726 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:18:00.745861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:00.745991 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:18:02.204883 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.4584519863128662 seconds
[0m15:18:02.302924 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:18:02.455397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:18:02.463341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:02.463974 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:18:03.609340 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:18:03.611385 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:18:03.726821 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11485624313354492 seconds
[0m15:18:03.904277 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:18:03.998402 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:18:04.100285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8dc6e76-092d-43b8-a2ef-1a99686b9274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a855d0>]}
[0m15:18:04.101141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:04.101478 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:18:05.264980 [debug] [MainThread]: On master: COMMIT
[0m15:18:05.265717 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:18:05.266072 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:18:05.359020 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09247112274169922 seconds
[0m15:18:05.359735 [debug] [MainThread]: On master: Close
[0m15:18:05.456226 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:18:05.456975 [info ] [MainThread]: 
[0m15:18:05.467371 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:18:05.467614 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:18:05.468015 [info ] [Thread-1 (]: 1 of 7 START sql view model FAWDBTCORE.stg_mobile_events ....................... [RUN]
[0m15:18:05.468429 [info ] [Thread-2 (]: 2 of 7 START sql view model FAWDBTCORE.stg_web_events .......................... [RUN]
[0m15:18:05.468920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:18:05.469272 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:18:05.469438 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:18:05.469582 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:18:05.470544 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:18:05.471496 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:18:05.472454 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:18:05.470705 => 15:18:05.472333
[0m15:18:05.472747 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:18:05.469685 => 15:18:05.472669
[0m15:18:05.472886 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:18:05.473028 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:18:05.483649 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:18:05.485032 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:18:05.492495 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:18:05.492749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:05.492967 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:18:05.493245 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:18:06.663429 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:18:06.666707 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m15:18:06.671189 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:18:06.672010 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m15:18:06.766818 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.0990149974822998 seconds
[0m15:18:06.774194 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10132908821105957 seconds
[0m15:18:06.780781 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:18:06.782405 [debug] [Thread-2 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m15:18:06.782820 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:18:06.783154 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:18:06.783447 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:18:06.783723 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m15:18:06.880235 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09541916847229004 seconds
[0m15:18:06.881882 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09756207466125488 seconds
[0m15:18:06.893098 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:18:06.895511 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:18:06.896075 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:18:06.896466 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:18:06.990119 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.0923929214477539 seconds
[0m15:18:06.991231 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09432697296142578 seconds
[0m15:18:07.006553 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:18:05.483872 => 15:18:07.006280
[0m15:18:07.008471 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:18:05.473124 => 15:18:07.008316
[0m15:18:07.008878 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:18:07.009173 [debug] [Thread-2 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:18:07.109552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dc6e76-092d-43b8-a2ef-1a99686b9274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ae290>]}
[0m15:18:07.110774 [info ] [Thread-1 (]: 1 of 7 OK created sql view model FAWDBTCORE.stg_mobile_events .................. [[32mOK[0m in 1.64s]
[0m15:18:07.111526 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:18:07.118289 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dc6e76-092d-43b8-a2ef-1a99686b9274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba0890>]}
[0m15:18:07.119273 [info ] [Thread-2 (]: 2 of 7 OK created sql view model FAWDBTCORE.stg_web_events ..................... [[32mOK[0m in 1.65s]
[0m15:18:07.120065 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:18:07.120974 [debug] [Thread-4 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:18:07.121443 [debug] [Thread-3 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:18:07.121995 [info ] [Thread-4 (]: 3 of 7 START sql view model FAWDBTCORE.average_duration_by_platform_country .... [RUN]
[0m15:18:07.122525 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:18:07.122975 [info ] [Thread-3 (]: 4 of 7 START sql view model FAWDBTCORE.event_counts_by_platform ................ [RUN]
[0m15:18:07.123549 [debug] [Thread-2 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:18:07.124310 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.average_duration_by_platform_country'
[0m15:18:07.124745 [info ] [Thread-1 (]: 5 of 7 START sql view model FAWDBTCORE.mobile_event_durations .................. [RUN]
[0m15:18:07.125436 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.event_counts_by_platform'
[0m15:18:07.125794 [info ] [Thread-2 (]: 6 of 7 START sql view model FAWDBTCORE.ranked_web_events ....................... [RUN]
[0m15:18:07.126573 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m15:18:07.127299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m15:18:07.127669 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m15:18:07.128129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.ranked_web_events)
[0m15:18:07.131106 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:18:07.131406 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m15:18:07.133730 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m15:18:07.134045 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m15:18:07.137941 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m15:18:07.140503 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m15:18:07.140998 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 15:18:07.128331 => 15:18:07.140798
[0m15:18:07.141519 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m15:18:07.143649 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:18:07.144074 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 15:18:07.131593 => 15:18:07.143913
[0m15:18:07.144335 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m15:18:07.146208 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m15:18:07.154462 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 15:18:07.138408 => 15:18:07.154260
[0m15:18:07.154767 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 15:18:07.134415 => 15:18:07.154624
[0m15:18:07.155096 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m15:18:07.155341 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:18:07.155560 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:18:07.155768 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m15:18:07.157696 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m15:18:07.157969 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:18:07.158196 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:18:07.159909 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m15:18:07.178315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:07.178612 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:18:07.180808 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:18:07.182052 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:18:08.356614 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:18:08.358758 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m15:18:08.359629 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:18:08.360749 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:18:08.361179 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:18:08.361967 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
)

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m15:18:08.362729 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m15:18:08.363412 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m15:18:08.460882 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10010910034179688 seconds
[0m15:18:08.465222 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m15:18:08.465737 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:18:08.466008 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: fCOMMIT
[0m15:18:08.468366 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10410189628601074 seconds
[0m15:18:08.469363 [debug] [Thread-2 (]: On model.oracle_dbt.ranked_web_events: COMMIT
[0m15:18:08.469592 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:18:08.469796 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: fCOMMIT
[0m15:18:08.562646 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m15:18:08.565442 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: ROLLBACK
[0m15:18:08.567304 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10091972351074219 seconds
[0m15:18:08.571503 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:18:08.571976 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10193800926208496 seconds
[0m15:18:08.572484 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:18:08.575196 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:18:08.576203 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.ranked_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:18:08.606495 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.24194788932800293 seconds
[0m15:18:08.607883 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m15:18:08.608180 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:18:08.608436 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: fCOMMIT
[0m15:18:08.663459 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m15:18:08.667935 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09222292900085449 seconds
[0m15:18:08.668383 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09162092208862305 seconds
[0m15:18:08.670178 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 15:18:07.144477 => 15:18:08.670028
[0m15:18:08.671547 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 15:18:07.155930 => 15:18:08.671413
[0m15:18:08.671859 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m15:18:08.672119 [debug] [Thread-2 (]: On model.oracle_dbt.ranked_web_events: Close
[0m15:18:08.699532 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.0907900333404541 seconds
[0m15:18:08.701227 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:18:08.701457 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:18:08.757110 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 15:18:07.158340 => 15:18:08.756947
[0m15:18:08.767518 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dc6e76-092d-43b8-a2ef-1a99686b9274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bce1d0>]}
[0m15:18:08.767980 [info ] [Thread-3 (]: 4 of 7 OK created sql view model FAWDBTCORE.event_counts_by_platform ........... [[32mOK[0m in 1.64s]
[0m15:18:08.768538 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:18:08.770358 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dc6e76-092d-43b8-a2ef-1a99686b9274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c00090>]}
[0m15:18:08.770697 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:18:08.771352 [info ] [Thread-2 (]: 6 of 7 OK created sql view model FAWDBTCORE.ranked_web_events .................. [[32mOK[0m in 1.64s]
[0m15:18:08.771893 [info ] [Thread-3 (]: 7 of 7 START sql view model FAWDBTCORE.web_events_counts ....................... [RUN]
[0m15:18:08.772334 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:18:08.772764 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.event_counts_by_platform, now model.oracle_dbt.web_events_counts)
[0m15:18:08.773108 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m15:18:08.775236 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m15:18:08.778065 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 15:18:08.773276 => 15:18:08.777853
[0m15:18:08.778509 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_counts
[0m15:18:08.780683 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m15:18:08.784057 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:18:08.784358 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:18:08.795401 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09365010261535645 seconds
[0m15:18:08.796880 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 15:18:07.141745 => 15:18:08.796758
[0m15:18:08.797215 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m15:18:08.800231 [debug] [Thread-1 (]: Database Error in model mobile_event_durations (models/mobile_event_durations.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/mobile_event_durations.sql
[0m15:18:08.801755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dc6e76-092d-43b8-a2ef-1a99686b9274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb9110>]}
[0m15:18:08.802158 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model FAWDBTCORE.mobile_event_durations ......... [[31mERROR[0m in 1.67s]
[0m15:18:08.802476 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:18:08.892005 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dc6e76-092d-43b8-a2ef-1a99686b9274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab0690>]}
[0m15:18:08.892640 [info ] [Thread-4 (]: 3 of 7 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 1.77s]
[0m15:18:08.893086 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:18:10.010214 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:18:10.011670 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
)

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_event_counts


[0m15:18:10.199453 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m15:18:10.200309 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: ROLLBACK
[0m15:18:10.315558 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: Close
[0m15:18:10.413486 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 15:18:08.778697 => 15:18:10.413016
[0m15:18:10.417714 [debug] [Thread-3 (]: Database Error in model web_events_counts (models/web_events_counts.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/web_events_counts.sql
[0m15:18:10.419469 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dc6e76-092d-43b8-a2ef-1a99686b9274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0ab90>]}
[0m15:18:10.419930 [error] [Thread-3 (]: 7 of 7 ERROR creating sql view model FAWDBTCORE.web_events_counts .............. [[31mERROR[0m in 1.65s]
[0m15:18:10.420288 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:18:10.421500 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:10.421869 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:18:11.561356 [debug] [MainThread]: On master: COMMIT
[0m15:18:11.563432 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:18:11.565702 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:18:11.669710 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10236597061157227 seconds
[0m15:18:11.670413 [debug] [MainThread]: On master: Close
[0m15:18:11.770554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:11.771265 [debug] [MainThread]: Connection 'model.oracle_dbt.mobile_event_durations' was properly closed.
[0m15:18:11.771556 [debug] [MainThread]: Connection 'model.oracle_dbt.ranked_web_events' was properly closed.
[0m15:18:11.771816 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m15:18:11.772053 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m15:18:11.772433 [info ] [MainThread]: 
[0m15:18:11.772860 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 11.03 seconds (11.03s).
[0m15:18:11.774204 [debug] [MainThread]: Command end result
[0m15:18:11.812226 [info ] [MainThread]: 
[0m15:18:11.812936 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:18:11.813279 [info ] [MainThread]: 
[0m15:18:11.813654 [error] [MainThread]: [33mDatabase Error in model mobile_event_durations (models/mobile_event_durations.sql)[0m
[0m15:18:11.814327 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m15:18:11.814654 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/mobile_event_durations.sql
[0m15:18:11.814962 [info ] [MainThread]: 
[0m15:18:11.815257 [error] [MainThread]: [33mDatabase Error in model web_events_counts (models/web_events_counts.sql)[0m
[0m15:18:11.815535 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m15:18:11.815797 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/web_events_counts.sql
[0m15:18:11.816089 [info ] [MainThread]: 
[0m15:18:11.816400 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m15:18:11.817169 [debug] [MainThread]: Command `dbt run` failed at 15:18:11.817059 after 11.88 seconds
[0m15:18:11.817626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028eccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028ecd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694c5d0>]}
[0m15:18:11.818004 [debug] [MainThread]: Flushing usage events
[0m15:20:42.774121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c14210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2c950>]}


============================== 15:20:42.789268 | f9f9e75b-c932-4822-bbb2-cd2c12b24f88 ==============================
[0m15:20:42.789268 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:20:42.789676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:20:42.903118 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:20:42.935958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9f9e75b-c932-4822-bbb2-cd2c12b24f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0a090>]}
[0m15:20:42.961028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9f9e75b-c932-4822-bbb2-cd2c12b24f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8c4d0>]}
[0m15:20:42.976909 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:20:43.036302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:20:43.036716 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/mobile_event_durations.sql
[0m15:20:43.036918 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/web_events_counts.sql
[0m15:20:43.046877 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m15:20:43.053425 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m15:20:43.059012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9f9e75b-c932-4822-bbb2-cd2c12b24f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c1a90>]}
[0m15:20:43.067770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9f9e75b-c932-4822-bbb2-cd2c12b24f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943c210>]}
[0m15:20:43.068054 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:20:43.068247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9f9e75b-c932-4822-bbb2-cd2c12b24f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce5c50>]}
[0m15:20:43.069187 [info ] [MainThread]: 
[0m15:20:43.069612 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:20:43.070302 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:20:43.075327 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:20:43.075574 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:20:43.075703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:43.075823 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:20:44.603014 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.526745080947876 seconds
[0m15:20:44.710585 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:20:44.817783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:20:44.823467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:44.823916 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:20:46.046464 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:20:46.048210 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:20:46.176507 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12719202041625977 seconds
[0m15:20:46.298603 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:20:46.405389 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:20:46.511392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9f9e75b-c932-4822-bbb2-cd2c12b24f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931cdd0>]}
[0m15:20:46.512060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:46.512358 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:20:47.733465 [debug] [MainThread]: On master: COMMIT
[0m15:20:47.735169 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:20:47.735687 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:20:47.839288 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10244178771972656 seconds
[0m15:20:47.840839 [debug] [MainThread]: On master: Close
[0m15:20:47.947189 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:20:47.948005 [info ] [MainThread]: 
[0m15:20:47.959001 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:20:47.959541 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:20:47.960216 [info ] [Thread-1 (]: 1 of 7 START sql view model FAWDBTCORE.stg_mobile_events ....................... [RUN]
[0m15:20:47.960860 [info ] [Thread-2 (]: 2 of 7 START sql view model FAWDBTCORE.stg_web_events .......................... [RUN]
[0m15:20:47.961694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:20:47.962303 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:20:47.962620 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:20:47.962905 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:20:47.964897 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:20:47.966503 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:20:47.968745 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:20:47.963109 => 15:20:47.968477
[0m15:20:47.969227 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:20:47.965125 => 15:20:47.968979
[0m15:20:47.969594 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:20:47.969879 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:20:47.984580 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:20:47.986348 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:20:47.991068 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:20:47.991392 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:20:47.991648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:47.992064 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:20:49.264681 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:20:49.266163 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m15:20:49.269038 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:20:49.270366 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m15:20:49.382735 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.11131811141967773 seconds
[0m15:20:49.384108 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.11727309226989746 seconds
[0m15:20:49.393931 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:20:49.395426 [debug] [Thread-2 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m15:20:49.395844 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:20:49.396218 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:20:49.396532 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:20:49.396824 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m15:20:49.499909 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10181021690368652 seconds
[0m15:20:49.510019 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:20:49.510480 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.11332511901855469 seconds
[0m15:20:49.510952 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:20:49.513611 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:20:49.514273 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:20:49.624412 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10929512977600098 seconds
[0m15:20:49.636399 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.12161993980407715 seconds
[0m15:20:49.640526 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:20:47.984822 => 15:20:49.640333
[0m15:20:49.642354 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:20:47.970067 => 15:20:49.642198
[0m15:20:49.642850 [debug] [Thread-2 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:20:49.643262 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:20:49.765002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f9e75b-c932-4822-bbb2-cd2c12b24f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109592210>]}
[0m15:20:49.768134 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f9e75b-c932-4822-bbb2-cd2c12b24f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109591a90>]}
[0m15:20:49.768751 [info ] [Thread-1 (]: 1 of 7 OK created sql view model FAWDBTCORE.stg_mobile_events .................. [[32mOK[0m in 1.80s]
[0m15:20:49.769702 [info ] [Thread-2 (]: 2 of 7 OK created sql view model FAWDBTCORE.stg_web_events ..................... [[32mOK[0m in 1.81s]
[0m15:20:49.770618 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:20:49.771208 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:20:49.772597 [debug] [Thread-4 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:20:49.773104 [debug] [Thread-3 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:20:49.773436 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:20:49.773779 [debug] [Thread-2 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:20:49.774214 [info ] [Thread-4 (]: 3 of 7 START sql view model FAWDBTCORE.average_duration_by_platform_country .... [RUN]
[0m15:20:49.775020 [info ] [Thread-3 (]: 4 of 7 START sql view model FAWDBTCORE.event_counts_by_platform ................ [RUN]
[0m15:20:49.775598 [info ] [Thread-1 (]: 5 of 7 START sql view model FAWDBTCORE.mobile_event_durations .................. [RUN]
[0m15:20:49.776067 [info ] [Thread-2 (]: 6 of 7 START sql view model FAWDBTCORE.ranked_web_events ....................... [RUN]
[0m15:20:49.776958 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.average_duration_by_platform_country'
[0m15:20:49.777589 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.event_counts_by_platform'
[0m15:20:49.778144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m15:20:49.778654 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.ranked_web_events)
[0m15:20:49.778953 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m15:20:49.779230 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m15:20:49.779700 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m15:20:49.780101 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m15:20:49.783590 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:20:49.786251 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m15:20:49.789985 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m15:20:49.791825 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m15:20:49.795210 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 15:20:49.780368 => 15:20:49.794990
[0m15:20:49.795545 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 15:20:49.783862 => 15:20:49.795398
[0m15:20:49.795868 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 15:20:49.786455 => 15:20:49.795687
[0m15:20:49.796182 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 15:20:49.790203 => 15:20:49.796053
[0m15:20:49.796411 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m15:20:49.796697 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m15:20:49.797005 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m15:20:49.797320 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m15:20:49.799543 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:20:49.801698 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m15:20:49.803377 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m15:20:49.805343 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m15:20:49.811074 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:20:49.811369 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:20:49.811655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:49.811848 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:20:49.812090 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:20:49.812315 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:20:49.812517 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:20:49.812715 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:20:51.103797 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:20:51.105105 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:20:51.105736 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:20:51.106452 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:20:51.107376 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m15:20:51.108354 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m15:20:51.108855 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m15:20:51.109341 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m15:20:51.226046 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.11490488052368164 seconds
[0m15:20:51.227028 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.11720395088195801 seconds
[0m15:20:51.227674 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.1175239086151123 seconds
[0m15:20:51.229531 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m15:20:51.230049 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.1194298267364502 seconds
[0m15:20:51.232292 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m15:20:51.233882 [debug] [Thread-2 (]: On model.oracle_dbt.ranked_web_events: COMMIT
[0m15:20:51.234271 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:20:51.235543 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m15:20:51.235904 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:20:51.236246 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:20:51.236576 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: fCOMMIT
[0m15:20:51.237023 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:20:51.237427 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: fCOMMIT
[0m15:20:51.237872 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: fCOMMIT
[0m15:20:51.238571 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: fCOMMIT
[0m15:20:51.345836 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10686206817626953 seconds
[0m15:20:51.347153 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10763382911682129 seconds
[0m15:20:51.347877 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10834789276123047 seconds
[0m15:20:51.348370 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10912179946899414 seconds
[0m15:20:51.352214 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:20:51.354616 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:20:51.356813 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:20:51.358936 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:20:51.359283 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:20:51.359647 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.ranked_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:20:51.360004 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:20:51.360347 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:20:51.471307 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10999798774719238 seconds
[0m15:20:51.472283 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.11110186576843262 seconds
[0m15:20:51.472816 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.11180424690246582 seconds
[0m15:20:51.476619 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 15:20:49.799850 => 15:20:51.476379
[0m15:20:51.477045 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.11596894264221191 seconds
[0m15:20:51.479180 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 15:20:49.797569 => 15:20:51.478990
[0m15:20:51.480987 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 15:20:49.803616 => 15:20:51.480814
[0m15:20:51.481627 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m15:20:51.483747 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 15:20:49.801900 => 15:20:51.483555
[0m15:20:51.484142 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m15:20:51.484499 [debug] [Thread-2 (]: On model.oracle_dbt.ranked_web_events: Close
[0m15:20:51.485037 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m15:20:51.591556 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f9e75b-c932-4822-bbb2-cd2c12b24f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d0290>]}
[0m15:20:51.592552 [info ] [Thread-3 (]: 4 of 7 OK created sql view model FAWDBTCORE.event_counts_by_platform ........... [[32mOK[0m in 1.81s]
[0m15:20:51.593250 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:20:51.593690 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:20:51.594218 [info ] [Thread-3 (]: 7 of 7 START sql view model FAWDBTCORE.web_events_counts ....................... [RUN]
[0m15:20:51.594988 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.event_counts_by_platform, now model.oracle_dbt.web_events_counts)
[0m15:20:51.595330 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m15:20:51.599139 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m15:20:51.602042 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f9e75b-c932-4822-bbb2-cd2c12b24f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109654690>]}
[0m15:20:51.604002 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f9e75b-c932-4822-bbb2-cd2c12b24f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943c490>]}
[0m15:20:51.606145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f9e75b-c932-4822-bbb2-cd2c12b24f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109593610>]}
[0m15:20:51.606845 [info ] [Thread-2 (]: 6 of 7 OK created sql view model FAWDBTCORE.ranked_web_events .................. [[32mOK[0m in 1.82s]
[0m15:20:51.607651 [info ] [Thread-4 (]: 3 of 7 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 1.83s]
[0m15:20:51.608244 [info ] [Thread-1 (]: 5 of 7 OK created sql view model FAWDBTCORE.mobile_event_durations ............. [[32mOK[0m in 1.83s]
[0m15:20:51.608776 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:20:51.609136 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:20:51.609553 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:20:51.610222 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 15:20:51.595546 => 15:20:51.610053
[0m15:20:51.610752 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_counts
[0m15:20:51.613545 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m15:20:51.615774 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:20:51.616066 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:20:52.909501 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:20:52.911024 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_event_counts


[0m15:20:53.025569 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.11381983757019043 seconds
[0m15:20:53.027439 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m15:20:53.027785 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:20:53.028077 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: fCOMMIT
[0m15:20:53.128361 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09929275512695312 seconds
[0m15:20:53.134340 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:20:53.134867 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:20:53.248226 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.11241388320922852 seconds
[0m15:20:53.253278 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 15:20:51.611028 => 15:20:53.253079
[0m15:20:53.253716 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: Close
[0m15:20:53.367530 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f9e75b-c932-4822-bbb2-cd2c12b24f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d8d50>]}
[0m15:20:53.368536 [info ] [Thread-3 (]: 7 of 7 OK created sql view model FAWDBTCORE.web_events_counts .................. [[32mOK[0m in 1.77s]
[0m15:20:53.369194 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:20:53.371394 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:53.371877 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:20:55.505069 [debug] [MainThread]: On master: COMMIT
[0m15:20:55.505791 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:20:55.506113 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:20:55.605280 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09883427619934082 seconds
[0m15:20:55.605634 [debug] [MainThread]: On master: Close
[0m15:20:55.708877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:55.709509 [debug] [MainThread]: Connection 'model.oracle_dbt.mobile_event_durations' was properly closed.
[0m15:20:55.709779 [debug] [MainThread]: Connection 'model.oracle_dbt.ranked_web_events' was properly closed.
[0m15:20:55.710016 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m15:20:55.710244 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m15:20:55.710567 [info ] [MainThread]: 
[0m15:20:55.710946 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 12.64 seconds (12.64s).
[0m15:20:55.712117 [debug] [MainThread]: Command end result
[0m15:20:55.726479 [info ] [MainThread]: 
[0m15:20:55.727236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:55.727759 [info ] [MainThread]: 
[0m15:20:55.728076 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m15:20:55.728600 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:55.728525 after 12.98 seconds
[0m15:20:55.728879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104596750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104596350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f8cd0>]}
[0m15:20:55.729129 [debug] [MainThread]: Flushing usage events
[0m15:37:01.560981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b50bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119284450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b517e10>]}


============================== 15:37:01.563593 | f0877965-15be-4ac3-ab56-f44d4751c90f ==============================
[0m15:37:01.563593 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:37:01.563918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:37:01.619848 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:37:01.644574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b5cafd0>]}
[0m15:37:01.669049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b292210>]}
[0m15:37:01.684383 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:37:01.722851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:37:01.723200 [debug] [MainThread]: Partial parsing: added file: oracle_dbt://models/staging/stg_users.sql
[0m15:37:01.732684 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
[0m15:37:01.742461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b508750>]}
[0m15:37:01.746402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd09a50>]}
[0m15:37:01.746666 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:37:01.746863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bcadbd0>]}
[0m15:37:01.747851 [info ] [MainThread]: 
[0m15:37:01.748287 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:37:01.748947 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:37:01.753766 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:37:01.753982 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:37:01.754144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:01.754287 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:37:03.195907 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.4415359497070312 seconds
[0m15:37:03.293370 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:37:03.389323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:37:03.392465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:03.392674 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:37:04.538002 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:37:04.539759 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:37:04.661036 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12007594108581543 seconds
[0m15:37:04.775518 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:37:04.872772 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:37:04.979068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b509cd0>]}
[0m15:37:04.979849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:04.980206 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:37:06.151568 [debug] [MainThread]: On master: COMMIT
[0m15:37:06.153521 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:37:06.154367 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:37:06.250629 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09520721435546875 seconds
[0m15:37:06.252071 [debug] [MainThread]: On master: Close
[0m15:37:06.354987 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:37:06.356904 [info ] [MainThread]: 
[0m15:37:06.365568 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:37:06.366067 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m15:37:06.366340 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:37:06.366736 [info ] [Thread-1 (]: 1 of 8 START sql view model FAWDBTCORE.stg_mobile_events ....................... [RUN]
[0m15:37:06.367079 [info ] [Thread-2 (]: 2 of 8 START sql view model FAWDBTCORE.stg_users ............................... [RUN]
[0m15:37:06.367390 [info ] [Thread-3 (]: 3 of 8 START sql view model FAWDBTCORE.stg_web_events .......................... [RUN]
[0m15:37:06.368028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:37:06.368605 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m15:37:06.369030 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:37:06.369257 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:37:06.369451 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m15:37:06.369626 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:37:06.370812 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:37:06.372451 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m15:37:06.373408 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:37:06.374357 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 15:37:06.370949 => 15:37:06.374209
[0m15:37:06.374626 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:37:06.369749 => 15:37:06.374494
[0m15:37:06.374838 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:37:06.372636 => 15:37:06.374750
[0m15:37:06.375058 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m15:37:06.375233 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:37:06.375401 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:37:06.387237 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m15:37:06.388836 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:37:06.390196 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:37:06.391045 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:37:06.391301 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:37:06.391446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:06.391590 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:37:06.391747 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:37:06.391901 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:37:07.570175 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:37:07.571767 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users
)

select * from users_cleaned


[0m15:37:07.573673 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:37:07.574389 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:37:07.575017 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m15:37:07.575567 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m15:37:07.675117 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09831905364990234 seconds
[0m15:37:07.676855 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10059976577758789 seconds
[0m15:37:07.690695 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:37:07.692254 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m15:37:07.692675 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:37:07.693035 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:37:07.693368 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:37:07.693678 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m15:37:07.765056 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00942: table or view does not exist
[0m15:37:07.767859 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m15:37:07.794256 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.0999460220336914 seconds
[0m15:37:07.794897 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10083413124084473 seconds
[0m15:37:07.803801 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:37:07.806568 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:37:07.807132 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:37:07.807530 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:37:07.868585 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m15:37:07.904549 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09630298614501953 seconds
[0m15:37:07.912887 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.1045830249786377 seconds
[0m15:37:07.921001 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:37:06.388987 => 15:37:07.920811
[0m15:37:07.922729 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:37:06.387482 => 15:37:07.922579
[0m15:37:07.923096 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:37:07.923402 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:37:07.966230 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 15:37:06.375537 => 15:37:07.965945
[0m15:37:07.980221 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00942: table or view does not exist
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:37:07.982536 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd0bdd0>]}
[0m15:37:07.983272 [error] [Thread-2 (]: 2 of 8 ERROR creating sql view model FAWDBTCORE.stg_users ...................... [[31mERROR[0m in 1.61s]
[0m15:37:07.983866 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m15:37:08.023096 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d091910>]}
[0m15:37:08.025590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc49f50>]}
[0m15:37:08.026230 [info ] [Thread-3 (]: 3 of 8 OK created sql view model FAWDBTCORE.stg_web_events ..................... [[32mOK[0m in 1.65s]
[0m15:37:08.026802 [info ] [Thread-1 (]: 1 of 8 OK created sql view model FAWDBTCORE.stg_mobile_events .................. [[32mOK[0m in 1.66s]
[0m15:37:08.027404 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:37:08.027826 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:37:08.028545 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:37:08.029189 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:37:08.029543 [info ] [Thread-4 (]: 4 of 8 START sql view model FAWDBTCORE.ranked_web_events ....................... [RUN]
[0m15:37:08.030183 [debug] [Thread-1 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:37:08.030727 [info ] [Thread-3 (]: 5 of 8 START sql view model FAWDBTCORE.average_duration_by_platform_country .... [RUN]
[0m15:37:08.031179 [debug] [Thread-2 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:37:08.031839 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.ranked_web_events'
[0m15:37:08.032197 [info ] [Thread-1 (]: 6 of 8 START sql view model FAWDBTCORE.event_counts_by_platform ................ [RUN]
[0m15:37:08.032779 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.average_duration_by_platform_country)
[0m15:37:08.033151 [info ] [Thread-2 (]: 7 of 8 START sql view model FAWDBTCORE.mobile_event_durations .................. [RUN]
[0m15:37:08.033643 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m15:37:08.034344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.event_counts_by_platform)
[0m15:37:08.034665 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m15:37:08.035134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.mobile_event_durations)
[0m15:37:08.038068 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m15:37:08.038340 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m15:37:08.040576 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:37:08.040872 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m15:37:08.043716 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m15:37:08.045958 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m15:37:08.046259 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 15:37:08.035330 => 15:37:08.046122
[0m15:37:08.046835 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m15:37:08.047197 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 15:37:08.041201 => 15:37:08.047046
[0m15:37:08.047451 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 15:37:08.038545 => 15:37:08.047348
[0m15:37:08.049304 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m15:37:08.049611 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 15:37:08.044126 => 15:37:08.049506
[0m15:37:08.049798 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m15:37:08.050025 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m15:37:08.050286 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m15:37:08.052019 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m15:37:08.053593 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:37:08.053810 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:37:08.055388 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m15:37:08.055810 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:37:08.056146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:08.056386 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:37:08.056818 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:37:08.057119 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:37:08.057334 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:37:08.057668 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:37:09.226854 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:37:09.228304 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:37:09.228899 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:37:09.229908 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m15:37:09.230590 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:37:09.231490 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m15:37:09.232184 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m15:37:09.233251 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m15:37:09.336268 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10130810737609863 seconds
[0m15:37:09.337131 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10439515113830566 seconds
[0m15:37:09.337706 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10327696800231934 seconds
[0m15:37:09.338193 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10419082641601562 seconds
[0m15:37:09.341530 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m15:37:09.343261 [debug] [Thread-2 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m15:37:09.344860 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: COMMIT
[0m15:37:09.346316 [debug] [Thread-1 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m15:37:09.346690 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:37:09.347045 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:37:09.347379 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:37:09.347724 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:37:09.348054 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: fCOMMIT
[0m15:37:09.348366 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: fCOMMIT
[0m15:37:09.348674 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: fCOMMIT
[0m15:37:09.348981 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: fCOMMIT
[0m15:37:09.443902 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09386992454528809 seconds
[0m15:37:09.445332 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09559798240661621 seconds
[0m15:37:09.445973 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09632611274719238 seconds
[0m15:37:09.446407 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09695005416870117 seconds
[0m15:37:09.451013 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:37:09.453651 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:37:09.456066 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:37:09.460333 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:37:09.460703 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:37:09.461067 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.ranked_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:37:09.461425 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:37:09.461777 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:37:09.558905 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09557986259460449 seconds
[0m15:37:09.560209 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.0979461669921875 seconds
[0m15:37:09.560830 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09838485717773438 seconds
[0m15:37:09.561329 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09877610206604004 seconds
[0m15:37:09.564861 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 15:37:08.047570 => 15:37:09.564609
[0m15:37:09.567118 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 15:37:08.052177 => 15:37:09.566901
[0m15:37:09.569060 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 15:37:08.050443 => 15:37:09.568891
[0m15:37:09.570713 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 15:37:08.054030 => 15:37:09.570549
[0m15:37:09.571103 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: Close
[0m15:37:09.571460 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m15:37:09.571784 [debug] [Thread-1 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m15:37:09.572095 [debug] [Thread-2 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m15:37:09.671922 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6b8050>]}
[0m15:37:09.675055 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6c1590>]}
[0m15:37:09.675878 [info ] [Thread-3 (]: 5 of 8 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 1.64s]
[0m15:37:09.676671 [info ] [Thread-4 (]: 4 of 8 OK created sql view model FAWDBTCORE.ranked_web_events .................. [[32mOK[0m in 1.64s]
[0m15:37:09.677976 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:37:09.680678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d658d10>]}
[0m15:37:09.683140 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d68ae90>]}
[0m15:37:09.683697 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:37:09.684099 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:37:09.684704 [info ] [Thread-1 (]: 6 of 8 OK created sql view model FAWDBTCORE.event_counts_by_platform ........... [[32mOK[0m in 1.65s]
[0m15:37:09.685225 [info ] [Thread-2 (]: 7 of 8 OK created sql view model FAWDBTCORE.mobile_event_durations ............. [[32mOK[0m in 1.65s]
[0m15:37:09.686126 [info ] [Thread-3 (]: 8 of 8 START sql view model FAWDBTCORE.web_events_counts ....................... [RUN]
[0m15:37:09.686702 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:37:09.687140 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:37:09.687759 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.average_duration_by_platform_country, now model.oracle_dbt.web_events_counts)
[0m15:37:09.688614 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m15:37:09.691570 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m15:37:09.692466 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 15:37:09.688895 => 15:37:09.692311
[0m15:37:09.692733 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_counts
[0m15:37:09.695523 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m15:37:09.696165 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:37:09.696451 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:37:10.852757 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:37:10.855126 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_event_counts


[0m15:37:10.958115 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.1014106273651123 seconds
[0m15:37:10.963194 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m15:37:10.963879 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:37:10.964320 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: fCOMMIT
[0m15:37:11.058171 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09293913841247559 seconds
[0m15:37:11.063395 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:37:11.063629 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:37:11.160543 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09614276885986328 seconds
[0m15:37:11.166225 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 15:37:09.692898 => 15:37:11.165848
[0m15:37:11.166712 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: Close
[0m15:37:11.270877 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0877965-15be-4ac3-ab56-f44d4751c90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d0ad450>]}
[0m15:37:11.271468 [info ] [Thread-3 (]: 8 of 8 OK created sql view model FAWDBTCORE.web_events_counts .................. [[32mOK[0m in 1.58s]
[0m15:37:11.272050 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:37:11.274141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:37:11.274472 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:37:12.433162 [debug] [MainThread]: On master: COMMIT
[0m15:37:12.434988 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:37:12.435508 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:37:12.532132 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09578323364257812 seconds
[0m15:37:12.533652 [debug] [MainThread]: On master: Close
[0m15:37:12.636354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:12.637501 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m15:37:12.637907 [debug] [MainThread]: Connection 'model.oracle_dbt.mobile_event_durations' was properly closed.
[0m15:37:12.638207 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m15:37:12.638479 [debug] [MainThread]: Connection 'model.oracle_dbt.ranked_web_events' was properly closed.
[0m15:37:12.638924 [info ] [MainThread]: 
[0m15:37:12.639438 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 10.89 seconds (10.89s).
[0m15:37:12.641137 [debug] [MainThread]: Command end result
[0m15:37:12.651460 [info ] [MainThread]: 
[0m15:37:12.652046 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:37:12.652360 [info ] [MainThread]: 
[0m15:37:12.652657 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m15:37:12.653366 [error] [MainThread]:   ORA-00942: table or view does not exist
[0m15:37:12.653752 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:37:12.654216 [info ] [MainThread]: 
[0m15:37:12.654578 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m15:37:12.655258 [debug] [MainThread]: Command `dbt run` failed at 15:37:12.655165 after 11.14 seconds
[0m15:37:12.655637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b52ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b52fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105468e10>]}
[0m15:37:12.655956 [debug] [MainThread]: Flushing usage events
[0m15:52:07.675766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10420bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104217fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104217f90>]}


============================== 15:52:07.686411 | 923d78bc-81eb-4789-82f2-3ceeeae002bb ==============================
[0m15:52:07.686411 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:52:07.687005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:52:07.828254 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:52:07.862176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104217fd0>]}
[0m15:52:07.888437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406b250>]}
[0m15:52:07.912707 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:52:07.992672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:52:07.993154 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_users.sql
[0m15:52:08.003511 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
[0m15:52:08.013242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2cbd0>]}
[0m15:52:08.024602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104908290>]}
[0m15:52:08.024826 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:52:08.025016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aab010>]}
[0m15:52:08.026008 [info ] [MainThread]: 
[0m15:52:08.026493 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:52:08.027264 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:52:08.032336 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:52:08.032548 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:52:08.032682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:08.032806 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:52:09.462190 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.4293110370635986 seconds
[0m15:52:09.574609 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:52:09.675228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:52:09.689568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:09.690261 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:52:10.886860 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:52:10.888269 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:52:11.004489 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11519384384155273 seconds
[0m15:52:11.195437 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:52:11.290201 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:52:11.408450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104929590>]}
[0m15:52:11.409303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:11.409626 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:52:12.616447 [debug] [MainThread]: On master: COMMIT
[0m15:52:12.618399 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:52:12.619210 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:52:12.716406 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09662795066833496 seconds
[0m15:52:12.717257 [debug] [MainThread]: On master: Close
[0m15:52:12.831333 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:52:12.833095 [info ] [MainThread]: 
[0m15:52:12.894577 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:52:12.895124 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m15:52:12.895531 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:52:12.896149 [info ] [Thread-1 (]: 1 of 8 START sql view model FAWDBTCORE.stg_mobile_events ....................... [RUN]
[0m15:52:12.896717 [info ] [Thread-2 (]: 2 of 8 START sql view model FAWDBTCORE.stg_users ............................... [RUN]
[0m15:52:12.897227 [info ] [Thread-3 (]: 3 of 8 START sql view model FAWDBTCORE.stg_web_events .......................... [RUN]
[0m15:52:12.898030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:52:12.898680 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m15:52:12.899233 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:52:12.899531 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:52:12.899800 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m15:52:12.900045 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:52:12.902011 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:52:12.904511 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m15:52:12.906172 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:52:12.909673 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 15:52:12.902241 => 15:52:12.909459
[0m15:52:12.910065 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:52:12.900237 => 15:52:12.909869
[0m15:52:12.910363 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:52:12.904869 => 15:52:12.910233
[0m15:52:12.910674 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m15:52:12.910967 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:52:12.911215 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:52:12.928345 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m15:52:12.930345 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:52:12.932014 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:52:12.942212 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:52:12.942544 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:52:12.942777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:12.943026 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:52:12.943247 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:52:12.943502 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:52:14.203238 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:52:14.204778 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m15:52:14.205436 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:52:14.205815 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:52:14.206744 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m15:52:14.207362 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    select * from FAWDBTCORE.raw_users


[0m15:52:14.321780 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.1149439811706543 seconds
[0m15:52:14.330185 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.12225222587585449 seconds
[0m15:52:14.351851 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m15:52:14.354036 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:52:14.354813 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m15:52:14.355183 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:52:14.356773 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:52:14.361698 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:52:14.417980 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00942: table or view does not exist
[0m15:52:14.420837 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m15:52:14.452208 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09587407112121582 seconds
[0m15:52:14.461249 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:52:14.461887 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:52:14.469361 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10688900947570801 seconds
[0m15:52:14.471913 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:52:14.472355 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:52:14.519211 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m15:52:14.565923 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10262084007263184 seconds
[0m15:52:14.579683 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10670804977416992 seconds
[0m15:52:14.598337 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:52:12.928647 => 15:52:14.598076
[0m15:52:14.601201 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:52:12.930538 => 15:52:14.601008
[0m15:52:14.601677 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:52:14.602050 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:52:14.616969 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 15:52:12.911383 => 15:52:14.616777
[0m15:52:14.634084 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00942: table or view does not exist
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:52:14.636804 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b098d0>]}
[0m15:52:14.637676 [error] [Thread-2 (]: 2 of 8 ERROR creating sql view model FAWDBTCORE.stg_users ...................... [[31mERROR[0m in 1.74s]
[0m15:52:14.638367 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m15:52:14.700314 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104245fd0>]}
[0m15:52:14.702708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a0ddd0>]}
[0m15:52:14.703438 [info ] [Thread-3 (]: 3 of 8 OK created sql view model FAWDBTCORE.stg_web_events ..................... [[32mOK[0m in 1.80s]
[0m15:52:14.704103 [info ] [Thread-1 (]: 1 of 8 OK created sql view model FAWDBTCORE.stg_mobile_events .................. [[32mOK[0m in 1.81s]
[0m15:52:14.704560 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:52:14.704801 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:52:14.705586 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:52:14.706521 [info ] [Thread-4 (]: 4 of 8 START sql view model FAWDBTCORE.ranked_web_events ....................... [RUN]
[0m15:52:14.707028 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:52:14.707368 [debug] [Thread-2 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:52:14.707815 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:52:14.708632 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.ranked_web_events'
[0m15:52:14.709097 [info ] [Thread-3 (]: 5 of 8 START sql view model FAWDBTCORE.average_duration_by_platform_country .... [RUN]
[0m15:52:14.709548 [info ] [Thread-2 (]: 6 of 8 START sql view model FAWDBTCORE.event_counts_by_platform ................ [RUN]
[0m15:52:14.709964 [info ] [Thread-1 (]: 7 of 8 START sql view model FAWDBTCORE.mobile_event_durations .................. [RUN]
[0m15:52:14.710344 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m15:52:14.710890 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.average_duration_by_platform_country)
[0m15:52:14.711399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.event_counts_by_platform)
[0m15:52:14.712204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m15:52:14.715591 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m15:52:14.716123 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m15:52:14.716595 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m15:52:14.716935 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m15:52:14.719879 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:52:14.722599 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m15:52:14.725620 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m15:52:14.726213 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 15:52:14.712524 => 15:52:14.726053
[0m15:52:14.726812 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m15:52:14.729095 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m15:52:14.729625 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 15:52:14.717244 => 15:52:14.729442
[0m15:52:14.729912 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m15:52:14.732039 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:52:14.732616 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 15:52:14.720197 => 15:52:14.732425
[0m15:52:14.733042 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 15:52:14.722937 => 15:52:14.732804
[0m15:52:14.733468 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:52:14.733792 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m15:52:14.734152 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m15:52:14.734488 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:52:14.736423 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m15:52:14.738199 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m15:52:14.744040 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:52:14.744277 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:52:14.753469 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:52:14.753753 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:52:14.756637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:14.756879 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:52:15.967066 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:52:15.968437 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:52:15.969410 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:52:15.974301 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m15:52:15.970455 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:52:15.972655 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m15:52:15.971679 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m15:52:15.976237 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m15:52:16.084665 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10652589797973633 seconds
[0m15:52:16.089436 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: COMMIT
[0m15:52:16.092236 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:52:16.090094 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.11483621597290039 seconds
[0m15:52:16.091134 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.11261105537414551 seconds
[0m15:52:16.095028 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: fCOMMIT
[0m15:52:16.090535 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.11244487762451172 seconds
[0m15:52:16.099311 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m15:52:16.104535 [debug] [Thread-2 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m15:52:16.108465 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m15:52:16.109517 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:52:16.110002 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:52:16.110792 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:52:16.111278 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: fCOMMIT
[0m15:52:16.111607 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: fCOMMIT
[0m15:52:16.111902 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: fCOMMIT
[0m15:52:16.206037 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09869718551635742 seconds
[0m15:52:16.211196 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:52:16.211973 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09913516044616699 seconds
[0m15:52:16.216773 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09977316856384277 seconds
[0m15:52:16.217951 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.ranked_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:52:16.218506 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.1062459945678711 seconds
[0m15:52:16.222443 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:52:16.225615 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:52:16.230319 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:52:16.230757 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:52:16.231069 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:52:16.231341 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:52:16.325210 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09860897064208984 seconds
[0m15:52:16.329825 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 15:52:14.727042 => 15:52:16.329445
[0m15:52:16.339493 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: Close
[0m15:52:16.331473 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09860706329345703 seconds
[0m15:52:16.332641 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10062193870544434 seconds
[0m15:52:16.344990 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 15:52:14.734699 => 15:52:16.344701
[0m15:52:16.345572 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.11359620094299316 seconds
[0m15:52:16.359460 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 15:52:14.736626 => 15:52:16.359189
[0m15:52:16.360139 [debug] [Thread-2 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m15:52:16.362384 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 15:52:14.730084 => 15:52:16.362279
[0m15:52:16.362635 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m15:52:16.363042 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m15:52:16.450451 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c0050>]}
[0m15:52:16.456257 [info ] [Thread-4 (]: 4 of 8 OK created sql view model FAWDBTCORE.ranked_web_events .................. [[32mOK[0m in 1.74s]
[0m15:52:16.458624 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:52:16.460795 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:52:16.462417 [info ] [Thread-4 (]: 8 of 8 START sql view model FAWDBTCORE.web_events_counts ....................... [RUN]
[0m15:52:16.464725 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.ranked_web_events, now model.oracle_dbt.web_events_counts)
[0m15:52:16.465564 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m15:52:16.471581 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m15:52:16.475328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505f650>]}
[0m15:52:16.477827 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d1e10>]}
[0m15:52:16.479704 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d16d0>]}
[0m15:52:16.480459 [info ] [Thread-1 (]: 7 of 8 OK created sql view model FAWDBTCORE.mobile_event_durations ............. [[32mOK[0m in 1.76s]
[0m15:52:16.481173 [info ] [Thread-2 (]: 6 of 8 OK created sql view model FAWDBTCORE.event_counts_by_platform ........... [[32mOK[0m in 1.77s]
[0m15:52:16.481921 [info ] [Thread-3 (]: 5 of 8 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 1.77s]
[0m15:52:16.482572 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:52:16.482972 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:52:16.483311 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:52:16.492870 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 15:52:16.465948 => 15:52:16.492419
[0m15:52:16.493368 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.web_events_counts
[0m15:52:16.496306 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m15:52:16.498988 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:52:16.499223 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:52:17.676063 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:52:17.676972 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_event_counts


[0m15:52:17.782932 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10436606407165527 seconds
[0m15:52:17.789968 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m15:52:17.791006 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:52:17.792166 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: fCOMMIT
[0m15:52:17.888775 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09513998031616211 seconds
[0m15:52:17.899932 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:52:17.901792 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:52:17.999547 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09612107276916504 seconds
[0m15:52:18.008255 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 15:52:16.493529 => 15:52:18.007828
[0m15:52:18.009120 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_counts: Close
[0m15:52:18.114653 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923d78bc-81eb-4789-82f2-3ceeeae002bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105095b90>]}
[0m15:52:18.117144 [info ] [Thread-4 (]: 8 of 8 OK created sql view model FAWDBTCORE.web_events_counts .................. [[32mOK[0m in 1.65s]
[0m15:52:18.119699 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:52:18.124902 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:52:18.125869 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:52:19.335324 [debug] [MainThread]: On master: COMMIT
[0m15:52:19.339943 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:52:19.342024 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:52:19.437349 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.0939950942993164 seconds
[0m15:52:19.438285 [debug] [MainThread]: On master: Close
[0m15:52:19.545631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:19.545922 [debug] [MainThread]: Connection 'model.oracle_dbt.mobile_event_durations' was properly closed.
[0m15:52:19.546041 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m15:52:19.546142 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m15:52:19.546239 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m15:52:19.546393 [info ] [MainThread]: 
[0m15:52:19.546578 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 11.52 seconds (11.52s).
[0m15:52:19.547435 [debug] [MainThread]: Command end result
[0m15:52:19.568932 [info ] [MainThread]: 
[0m15:52:19.569246 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:52:19.569408 [info ] [MainThread]: 
[0m15:52:19.569562 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m15:52:19.569709 [error] [MainThread]:   ORA-00942: table or view does not exist
[0m15:52:19.569845 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:52:19.570013 [info ] [MainThread]: 
[0m15:52:19.570175 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m15:52:19.570648 [debug] [MainThread]: Command `dbt run` failed at 15:52:19.570570 after 11.94 seconds
[0m15:52:19.570967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104217d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100556a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100554c90>]}
[0m15:52:19.571622 [debug] [MainThread]: Flushing usage events
[0m15:55:03.617652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccffd0>]}


============================== 15:55:03.625476 | 596ad074-b156-4874-9b11-2a294016af66 ==============================
[0m15:55:03.625476 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:55:03.625868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Downloads/', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:55:03.706274 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:55:03.740077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce4390>]}
[0m15:55:03.763295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce5cd0>]}
[0m15:55:03.788154 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:55:03.793589 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:55:03.793857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10824fc10>]}
[0m15:55:04.139595 [debug] [MainThread]: 1699: static parser successfully parsed web_events_counts.sql
[0m15:55:04.145907 [debug] [MainThread]: 1699: static parser successfully parsed event_counts_by_platform.sql
[0m15:55:04.147745 [debug] [MainThread]: 1699: static parser successfully parsed average_duration_by_platform_country.sql
[0m15:55:04.149991 [debug] [MainThread]: 1699: static parser successfully parsed mobile_event_durations.sql
[0m15:55:04.151895 [debug] [MainThread]: 1699: static parser successfully parsed ranked_web_events.sql
[0m15:55:04.153527 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
[0m15:55:04.155209 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_web_events.sql
[0m15:55:04.156796 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_mobile_events.sql
[0m15:55:04.182823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e4190>]}
[0m15:55:04.190942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108536e10>]}
[0m15:55:04.191157 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:55:04.191337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849fb50>]}
[0m15:55:04.192312 [info ] [MainThread]: 
[0m15:55:04.192707 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:55:04.193298 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:55:04.198263 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:55:04.198532 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:55:04.198663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:04.198787 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:55:05.649280 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.449887990951538 seconds
[0m15:55:05.752332 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:55:05.862072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:55:05.869384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:05.869875 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:55:07.062526 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:55:07.064583 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:55:07.183262 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11795377731323242 seconds
[0m15:55:07.365012 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:55:07.459001 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:55:07.702536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108418b50>]}
[0m15:55:07.703362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:07.703707 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:55:08.894557 [debug] [MainThread]: On master: COMMIT
[0m15:55:08.897410 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:55:08.897987 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:55:08.993412 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09437203407287598 seconds
[0m15:55:08.995263 [debug] [MainThread]: On master: Close
[0m15:55:09.102859 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:55:09.103712 [info ] [MainThread]: 
[0m15:55:09.115060 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:55:09.115576 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m15:55:09.115989 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:55:09.116548 [info ] [Thread-1 (]: 1 of 8 START sql view model FAWDBTCORE.stg_mobile_events ....................... [RUN]
[0m15:55:09.117036 [info ] [Thread-2 (]: 2 of 8 START sql view model FAWDBTCORE.stg_users ............................... [RUN]
[0m15:55:09.117505 [info ] [Thread-3 (]: 3 of 8 START sql view model FAWDBTCORE.stg_web_events .......................... [RUN]
[0m15:55:09.118332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:55:09.118943 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m15:55:09.119499 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:55:09.119867 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:55:09.120179 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m15:55:09.120642 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:55:09.122713 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:55:09.125233 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m15:55:09.126477 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:55:09.129062 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:55:09.120961 => 15:55:09.128830
[0m15:55:09.129443 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 15:55:09.122968 => 15:55:09.129275
[0m15:55:09.129720 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:55:09.125465 => 15:55:09.129614
[0m15:55:09.129964 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:55:09.130226 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m15:55:09.130457 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:55:09.145420 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:55:09.147474 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m15:55:09.149152 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:55:09.152749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:09.153018 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:55:09.159318 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:55:09.159528 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:55:09.159751 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:55:09.159961 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:55:10.328312 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:55:10.329892 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:55:10.330690 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    select * from FAWDBTCORE.raw_users


[0m15:55:10.331300 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:55:10.332206 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m15:55:10.333159 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m15:55:10.431968 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09789800643920898 seconds
[0m15:55:10.439154 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.1055290699005127 seconds
[0m15:55:10.445844 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m15:55:10.447428 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:55:10.447841 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:55:10.448206 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:55:10.448498 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m15:55:10.448771 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:55:10.527023 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00942: table or view does not exist
[0m15:55:10.528714 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m15:55:10.546122 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09685778617858887 seconds
[0m15:55:10.546946 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09759736061096191 seconds
[0m15:55:10.555024 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:55:10.556930 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:55:10.557216 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:55:10.557503 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:55:10.625176 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m15:55:10.660719 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10199713706970215 seconds
[0m15:55:10.662461 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10416197776794434 seconds
[0m15:55:10.678615 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:55:09.147697 => 15:55:10.678418
[0m15:55:10.680279 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:55:09.130613 => 15:55:10.680131
[0m15:55:10.680624 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:55:10.680939 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:55:10.721095 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 15:55:09.145689 => 15:55:10.720915
[0m15:55:10.737310 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00942: table or view does not exist
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:55:10.739722 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10866f690>]}
[0m15:55:10.740396 [error] [Thread-2 (]: 2 of 8 ERROR creating sql view model FAWDBTCORE.stg_users ...................... [[31mERROR[0m in 1.62s]
[0m15:55:10.740978 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m15:55:10.781292 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e76d0>]}
[0m15:55:10.782262 [info ] [Thread-3 (]: 3 of 8 OK created sql view model FAWDBTCORE.stg_web_events ..................... [[32mOK[0m in 1.66s]
[0m15:55:10.782916 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:55:10.783605 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:55:10.784018 [info ] [Thread-4 (]: 4 of 8 START sql view model FAWDBTCORE.ranked_web_events ....................... [RUN]
[0m15:55:10.784708 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.ranked_web_events'
[0m15:55:10.784987 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m15:55:10.787867 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m15:55:10.790035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108491810>]}
[0m15:55:10.790511 [info ] [Thread-1 (]: 1 of 8 OK created sql view model FAWDBTCORE.stg_mobile_events .................. [[32mOK[0m in 1.67s]
[0m15:55:10.790958 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:55:10.791467 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:55:10.791736 [debug] [Thread-2 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:55:10.791999 [info ] [Thread-3 (]: 5 of 8 START sql view model FAWDBTCORE.average_duration_by_platform_country .... [RUN]
[0m15:55:10.792299 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:55:10.792562 [info ] [Thread-2 (]: 6 of 8 START sql view model FAWDBTCORE.event_counts_by_platform ................ [RUN]
[0m15:55:10.793573 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.average_duration_by_platform_country)
[0m15:55:10.793981 [info ] [Thread-1 (]: 7 of 8 START sql view model FAWDBTCORE.mobile_event_durations .................. [RUN]
[0m15:55:10.794446 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 15:55:10.785158 => 15:55:10.794240
[0m15:55:10.795017 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.event_counts_by_platform)
[0m15:55:10.795278 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m15:55:10.795720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m15:55:10.796027 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m15:55:10.796292 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m15:55:10.798470 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:55:10.798709 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m15:55:10.800658 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m15:55:10.803009 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m15:55:10.805107 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m15:55:10.811096 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:55:10.811444 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 15:55:10.796455 => 15:55:10.811298
[0m15:55:10.811731 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 15:55:10.800888 => 15:55:10.811581
[0m15:55:10.812005 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 15:55:10.803270 => 15:55:10.811892
[0m15:55:10.812223 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:55:10.812447 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m15:55:10.812639 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m15:55:10.812820 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m15:55:10.814912 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:55:10.816536 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m15:55:10.818012 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m15:55:10.826001 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:55:10.826199 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:55:10.826376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:10.826581 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:55:10.826767 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:55:10.826971 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:55:12.017739 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:55:12.018345 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:55:12.018883 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:55:12.019298 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m15:55:12.019712 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:55:12.020221 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m15:55:12.020720 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m15:55:12.021414 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m15:55:12.120859 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.0992588996887207 seconds
[0m15:55:12.125195 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: COMMIT
[0m15:55:12.125477 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:55:12.125621 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: fCOMMIT
[0m15:55:12.128840 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10647773742675781 seconds
[0m15:55:12.129343 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10741400718688965 seconds
[0m15:55:12.131316 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m15:55:12.131798 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10961103439331055 seconds
[0m15:55:12.133538 [debug] [Thread-2 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m15:55:12.133940 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:55:12.135232 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m15:55:12.135598 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:55:12.135941 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: fCOMMIT
[0m15:55:12.136264 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:55:12.136570 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: fCOMMIT
[0m15:55:12.137033 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: fCOMMIT
[0m15:55:12.222505 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09645485877990723 seconds
[0m15:55:12.226230 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:55:12.226647 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.ranked_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:55:12.231471 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09457683563232422 seconds
[0m15:55:12.233967 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:55:12.234324 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09681200981140137 seconds
[0m15:55:12.234672 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09726190567016602 seconds
[0m15:55:12.235012 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:55:12.237458 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:55:12.241174 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:55:12.241686 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:55:12.242054 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:55:12.322738 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.0955512523651123 seconds
[0m15:55:12.324978 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 15:55:10.798855 => 15:55:12.324836
[0m15:55:12.325276 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: Close
[0m15:55:12.335915 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.0943610668182373 seconds
[0m15:55:12.338068 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 15:55:10.813168 => 15:55:12.337885
[0m15:55:12.338378 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09586095809936523 seconds
[0m15:55:12.338642 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09629321098327637 seconds
[0m15:55:12.338950 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m15:55:12.340395 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 15:55:10.815111 => 15:55:12.340275
[0m15:55:12.341466 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 15:55:10.816690 => 15:55:12.341364
[0m15:55:12.341789 [debug] [Thread-2 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m15:55:12.341995 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m15:55:12.426061 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b83d0>]}
[0m15:55:12.426955 [info ] [Thread-4 (]: 4 of 8 OK created sql view model FAWDBTCORE.ranked_web_events .................. [[32mOK[0m in 1.64s]
[0m15:55:12.427771 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:55:12.428287 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:55:12.428974 [info ] [Thread-4 (]: 8 of 8 START sql view model FAWDBTCORE.web_events_counts ....................... [RUN]
[0m15:55:12.430026 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.ranked_web_events, now model.oracle_dbt.web_events_counts)
[0m15:55:12.430482 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m15:55:12.434409 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m15:55:12.440258 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085baed0>]}
[0m15:55:12.443079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bb450>]}
[0m15:55:12.445143 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087db8d0>]}
[0m15:55:12.445702 [info ] [Thread-3 (]: 5 of 8 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 1.65s]
[0m15:55:12.446262 [info ] [Thread-1 (]: 7 of 8 OK created sql view model FAWDBTCORE.mobile_event_durations ............. [[32mOK[0m in 1.65s]
[0m15:55:12.446983 [info ] [Thread-2 (]: 6 of 8 OK created sql view model FAWDBTCORE.event_counts_by_platform ........... [[32mOK[0m in 1.65s]
[0m15:55:12.447765 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:55:12.448169 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:55:12.448573 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:55:12.462738 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 15:55:12.430749 => 15:55:12.462384
[0m15:55:12.463196 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.web_events_counts
[0m15:55:12.466440 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m15:55:12.474347 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:55:12.474750 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:55:13.645965 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:55:13.647916 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_event_counts


[0m15:55:13.751751 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10248804092407227 seconds
[0m15:55:13.756652 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m15:55:13.757324 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:55:13.757780 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: fCOMMIT
[0m15:55:13.852245 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09363889694213867 seconds
[0m15:55:13.859825 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:55:13.860364 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:55:13.957040 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09521889686584473 seconds
[0m15:55:13.961976 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 15:55:12.463386 => 15:55:13.961794
[0m15:55:13.962419 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_counts: Close
[0m15:55:14.063970 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596ad074-b156-4874-9b11-2a294016af66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10876b3d0>]}
[0m15:55:14.064732 [info ] [Thread-4 (]: 8 of 8 OK created sql view model FAWDBTCORE.web_events_counts .................. [[32mOK[0m in 1.63s]
[0m15:55:14.065583 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:55:14.068081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:14.068597 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:55:15.548423 [debug] [MainThread]: On master: COMMIT
[0m15:55:15.551359 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:55:15.551968 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:55:15.647808 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09470701217651367 seconds
[0m15:55:15.649546 [debug] [MainThread]: On master: Close
[0m15:55:15.752426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:15.753729 [debug] [MainThread]: Connection 'model.oracle_dbt.mobile_event_durations' was properly closed.
[0m15:55:15.754115 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m15:55:15.754457 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m15:55:15.754781 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m15:55:15.755467 [info ] [MainThread]: 
[0m15:55:15.756208 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 11.56 seconds (11.56s).
[0m15:55:15.757764 [debug] [MainThread]: Command end result
[0m15:55:15.770436 [info ] [MainThread]: 
[0m15:55:15.771166 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:55:15.771489 [info ] [MainThread]: 
[0m15:55:15.771798 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m15:55:15.772093 [error] [MainThread]:   ORA-00942: table or view does not exist
[0m15:55:15.772359 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:55:15.772668 [info ] [MainThread]: 
[0m15:55:15.772978 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m15:55:15.773573 [debug] [MainThread]: Command `dbt run` failed at 15:55:15.773482 after 12.19 seconds
[0m15:55:15.773926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104606a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104604c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107caf050>]}
[0m15:55:15.774239 [debug] [MainThread]: Flushing usage events
[0m15:56:34.843334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f7510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106217f90>]}


============================== 15:56:34.939878 | d5c895fd-32b4-4220-90de-f473edd0a17e ==============================
[0m15:56:34.939878 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:56:34.940851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:56:35.291406 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:56:35.339835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5c895fd-32b4-4220-90de-f473edd0a17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106228a10>]}
[0m15:56:35.347546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5c895fd-32b4-4220-90de-f473edd0a17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106934a50>]}
[0m15:56:35.384783 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:56:35.447934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:56:35.448184 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:56:35.451422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5c895fd-32b4-4220-90de-f473edd0a17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106276c90>]}
[0m15:56:35.461757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5c895fd-32b4-4220-90de-f473edd0a17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691fe10>]}
[0m15:56:35.461974 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:56:35.462170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5c895fd-32b4-4220-90de-f473edd0a17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688a790>]}
[0m15:56:35.463092 [info ] [MainThread]: 
[0m15:56:35.463535 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:56:35.464020 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:56:35.469526 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:56:35.469787 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:56:35.469941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:35.470080 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:56:36.989747 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.5192277431488037 seconds
[0m15:56:37.091646 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:56:37.191936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:56:37.198407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:37.198978 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:56:38.369457 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:56:38.370929 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:56:38.489294 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11717009544372559 seconds
[0m15:56:38.675848 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:56:38.777834 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:56:38.888093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5c895fd-32b4-4220-90de-f473edd0a17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e6250>]}
[0m15:56:38.889004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:38.889413 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:56:40.049198 [debug] [MainThread]: On master: COMMIT
[0m15:56:40.050979 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:56:40.051537 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:56:40.145385 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09321904182434082 seconds
[0m15:56:40.146139 [debug] [MainThread]: On master: Close
[0m15:56:40.243587 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:56:40.244219 [info ] [MainThread]: 
[0m15:56:40.271235 [debug] [Thread-1 (]: Began running node seed.oracle_dbt.raw_users
[0m15:56:40.271884 [info ] [Thread-1 (]: 1 of 1 START seed file FAWDBTCORE.raw_users .................................... [RUN]
[0m15:56:40.272604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now seed.oracle_dbt.raw_users)
[0m15:56:40.272874 [debug] [Thread-1 (]: Began compiling node seed.oracle_dbt.raw_users
[0m15:56:40.273177 [debug] [Thread-1 (]: Timing info for seed.oracle_dbt.raw_users (compile): 15:56:40.273052 => 15:56:40.273055
[0m15:56:40.273406 [debug] [Thread-1 (]: Began executing node seed.oracle_dbt.raw_users
[0m15:56:40.298247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:40.298571 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:56:41.452612 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "seed.oracle_dbt.raw_users".
[0m15:56:41.453211 [debug] [Thread-1 (]: oracle adapter: On seed.oracle_dbt.raw_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "seed.oracle_dbt.raw_users"} */

    create table FAWDBTCORE.raw_users (user_id number,name varchar2(21))
  
[0m15:56:41.649737 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.1957378387451172 seconds
[0m15:56:41.667849 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "seed.oracle_dbt.raw_users".
[0m15:56:41.668415 [debug] [Thread-1 (]: oracle adapter: On seed.oracle_dbt.raw_users: f
            insert all
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2...
[0m15:56:42.012348 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.3433198928833008 seconds
[0m15:56:42.016966 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "seed.oracle_dbt.raw_users".
[0m15:56:42.017525 [debug] [Thread-1 (]: oracle adapter: On seed.oracle_dbt.raw_users: f
            insert all
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2...
[0m15:56:42.125279 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10680294036865234 seconds
[0m15:56:42.129807 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "seed.oracle_dbt.raw_users".
[0m15:56:42.130338 [debug] [Thread-1 (]: oracle adapter: On seed.oracle_dbt.raw_users: f
            insert all
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2...
[0m15:56:42.236571 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10532808303833008 seconds
[0m15:56:42.243119 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "seed.oracle_dbt.raw_users".
[0m15:56:42.243873 [debug] [Thread-1 (]: oracle adapter: On seed.oracle_dbt.raw_users: f
            insert all
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2...
[0m15:56:42.370379 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.1253681182861328 seconds
[0m15:56:42.376497 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "seed.oracle_dbt.raw_users".
[0m15:56:42.377224 [debug] [Thread-1 (]: oracle adapter: On seed.oracle_dbt.raw_users: f
            insert all
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2...
[0m15:56:42.484908 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10671496391296387 seconds
[0m15:56:42.490781 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "seed.oracle_dbt.raw_users".
[0m15:56:42.491442 [debug] [Thread-1 (]: oracle adapter: On seed.oracle_dbt.raw_users: f
            insert all
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2...
[0m15:56:42.597143 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.1047358512878418 seconds
[0m15:56:42.603456 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "seed.oracle_dbt.raw_users".
[0m15:56:42.603954 [debug] [Thread-1 (]: oracle adapter: On seed.oracle_dbt.raw_users: f
            insert all
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2...
[0m15:56:42.724176 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.11915373802185059 seconds
[0m15:56:42.728475 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "seed.oracle_dbt.raw_users".
[0m15:56:42.728887 [debug] [Thread-1 (]: oracle adapter: On seed.oracle_dbt.raw_users: f
            insert all
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2...
[0m15:56:42.837549 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10776829719543457 seconds
[0m15:56:42.843874 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "seed.oracle_dbt.raw_users".
[0m15:56:42.844357 [debug] [Thread-1 (]: oracle adapter: On seed.oracle_dbt.raw_users: f
            insert all
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2...
[0m15:56:42.949842 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10458588600158691 seconds
[0m15:56:42.954125 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "seed.oracle_dbt.raw_users".
[0m15:56:42.954526 [debug] [Thread-1 (]: oracle adapter: On seed.oracle_dbt.raw_users: f
            insert all
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2)
            into FAWDBTCORE.raw_users (user_id, name) values(:p1,:p2...
[0m15:56:43.080770 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.12551021575927734 seconds
[0m15:56:43.091137 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.oracle_dbt.raw_users"
[0m15:56:43.111028 [debug] [Thread-1 (]: On seed.oracle_dbt.raw_users: COMMIT
[0m15:56:43.111390 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "seed.oracle_dbt.raw_users".
[0m15:56:43.111620 [debug] [Thread-1 (]: oracle adapter: On seed.oracle_dbt.raw_users: fCOMMIT
[0m15:56:43.206699 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09433126449584961 seconds
[0m15:56:43.210244 [debug] [Thread-1 (]: Timing info for seed.oracle_dbt.raw_users (execute): 15:56:40.273579 => 15:56:43.209227
[0m15:56:43.211311 [debug] [Thread-1 (]: On seed.oracle_dbt.raw_users: Close
[0m15:56:43.311444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c895fd-32b4-4220-90de-f473edd0a17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b30e90>]}
[0m15:56:43.312490 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file FAWDBTCORE.raw_users ................................ [[32mINSERT 1000[0m in 3.04s]
[0m15:56:43.313432 [debug] [Thread-1 (]: Finished running node seed.oracle_dbt.raw_users
[0m15:56:43.315718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:43.316184 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:56:44.473649 [debug] [MainThread]: On master: COMMIT
[0m15:56:44.476064 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:56:44.476490 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:56:44.577926 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.1001579761505127 seconds
[0m15:56:44.579806 [debug] [MainThread]: On master: Close
[0m15:56:44.696166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:44.696968 [debug] [MainThread]: Connection 'seed.oracle_dbt.raw_users' was properly closed.
[0m15:56:44.697412 [info ] [MainThread]: 
[0m15:56:44.697921 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 9.23 seconds (9.23s).
[0m15:56:44.698806 [debug] [MainThread]: Command end result
[0m15:56:44.713267 [info ] [MainThread]: 
[0m15:56:44.713907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:56:44.714291 [info ] [MainThread]: 
[0m15:56:44.714644 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:56:44.715227 [debug] [MainThread]: Command `dbt seed` succeeded at 15:56:44.715116 after 10.25 seconds
[0m15:56:44.715570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f5e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010c0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10101e8d0>]}
[0m15:56:44.716087 [debug] [MainThread]: Flushing usage events
[0m15:56:49.125938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a0bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119f7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a17fd0>]}


============================== 15:56:49.128997 | db9d28a2-9101-4993-a6a9-bfa1601122ae ==============================
[0m15:56:49.128997 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:56:49.129397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:56:49.208616 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:56:49.213919 [error] [MainThread]: Encountered an error:

[0m15:56:49.291050 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 139, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/runtime.py", line 69, in load_profile
    profile = Profile.render(
              ^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/factory.py", line 202, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/factory.py", line 57, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.3/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1206, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1178, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1149, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/oracle/__init__.py", line 17, in <module>
    from dbt.adapters.oracle.connections import OracleAdapterConnectionManager
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/oracle/connections.py", line 72, in <module>
    class OracleAdapterCredentials(Credentials):
  File "<frozen abc>", line 106, in __new__
  File "/opt/homebrew/lib/python3.11/site-packages/mashumaro/mixins/dict.py", line 25, in __init_subclass__
    compile_mixin_packer(cls, **builder_params["packer"])
  File "/opt/homebrew/lib/python3.11/site-packages/mashumaro/core/meta/mixin.py", line 29, in compile_mixin_packer
    builder.add_pack_method()
  File "/opt/homebrew/lib/python3.11/site-packages/mashumaro/core/meta/code/builder.py", line 887, in add_pack_method
    self.compile()
  File "/opt/homebrew/lib/python3.11/site-packages/mashumaro/core/meta/code/builder.py", line 249, in compile
    exec(code, self.globals, self.__dict__)
  File "<string>", line 0, in <module>
KeyboardInterrupt

[0m15:56:49.292124 [debug] [MainThread]: Command `dbt seed` failed at 15:56:49.292033 after 0.21 seconds
[0m15:56:49.292400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a17cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112173210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bccc10>]}
[0m15:56:49.292663 [debug] [MainThread]: Flushing usage events
[0m15:56:54.368832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a0bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f7510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a17f90>]}


============================== 15:56:54.372646 | 9f55a754-3049-489c-a322-651f623571a4 ==============================
[0m15:56:54.372646 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:56:54.373010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Downloads/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:56:54.466481 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:56:54.501236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a0a010>]}
[0m15:56:54.525227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922e590>]}
[0m15:56:54.549219 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:56:54.703588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:56:54.703881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:56:54.707673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108395ad0>]}
[0m15:56:54.715525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a0bc10>]}
[0m15:56:54.715836 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:56:54.716073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092da550>]}
[0m15:56:54.717226 [info ] [MainThread]: 
[0m15:56:54.717704 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:56:54.718449 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:56:54.724253 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:56:54.724523 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:56:54.724685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:54.724832 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:56:56.385875 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.6604537963867188 seconds
[0m15:56:56.487812 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:56:56.599106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:56:56.605896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:56.606350 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:56:57.827259 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:56:57.828119 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:56:57.947588 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11727213859558105 seconds
[0m15:56:58.130432 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:56:58.226759 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:56:58.344898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082bea50>]}
[0m15:56:58.346332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:58.349035 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:56:59.548795 [debug] [MainThread]: On master: COMMIT
[0m15:56:59.551821 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:56:59.556435 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:56:59.658123 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09946274757385254 seconds
[0m15:56:59.659259 [debug] [MainThread]: On master: Close
[0m15:56:59.762315 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:56:59.764201 [info ] [MainThread]: 
[0m15:56:59.817026 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:56:59.817589 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m15:56:59.818018 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:56:59.818656 [info ] [Thread-1 (]: 1 of 8 START sql view model FAWDBTCORE.stg_mobile_events ....................... [RUN]
[0m15:56:59.819356 [info ] [Thread-2 (]: 2 of 8 START sql view model FAWDBTCORE.stg_users ............................... [RUN]
[0m15:56:59.820001 [info ] [Thread-3 (]: 3 of 8 START sql view model FAWDBTCORE.stg_web_events .......................... [RUN]
[0m15:56:59.821353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:56:59.822453 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m15:56:59.823394 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:56:59.823868 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:56:59.824290 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m15:56:59.824652 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:56:59.826952 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:56:59.829940 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m15:56:59.831953 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:56:59.842860 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:56:59.830273 => 15:56:59.842524
[0m15:56:59.843497 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 15:56:59.827245 => 15:56:59.843117
[0m15:56:59.844029 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:56:59.844341 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m15:56:59.844749 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:56:59.824902 => 15:56:59.844528
[0m15:56:59.865048 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:56:59.867026 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m15:56:59.867305 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:56:59.869288 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:56:59.870411 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:56:59.870640 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:56:59.870864 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:56:59.871063 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:56:59.871618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:59.871837 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:01.136586 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:57:01.137053 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m15:57:01.138253 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:57:01.138501 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m15:57:01.139392 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:57:01.139614 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    select * from FAWDBTCORE.raw_users


[0m15:57:01.268641 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.12963485717773438 seconds
[0m15:57:01.269334 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.13188719749450684 seconds
[0m15:57:01.275786 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.13584303855895996 seconds
[0m15:57:01.280242 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m15:57:01.281676 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:57:01.282811 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m15:57:01.283135 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:57:01.283498 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:57:01.284111 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:57:01.284580 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m15:57:01.284906 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:57:01.285200 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: fCOMMIT
[0m15:57:01.398918 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.11287593841552734 seconds
[0m15:57:01.407165 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:57:01.407628 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.12167596817016602 seconds
[0m15:57:01.407945 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.12221479415893555 seconds
[0m15:57:01.408344 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:01.411075 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:57:01.413423 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:57:01.414142 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:01.414752 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:01.511272 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09535002708435059 seconds
[0m15:57:01.512465 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.0972449779510498 seconds
[0m15:57:01.513624 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09977293014526367 seconds
[0m15:57:01.529989 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:56:59.867658 => 15:57:01.529777
[0m15:57:01.531765 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 15:56:59.865246 => 15:57:01.531613
[0m15:57:01.533339 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:56:59.845021 => 15:57:01.533194
[0m15:57:01.533689 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:57:01.533982 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m15:57:01.534246 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:57:01.641963 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ddb10>]}
[0m15:57:01.643166 [info ] [Thread-2 (]: 2 of 8 OK created sql view model FAWDBTCORE.stg_users .......................... [[32mOK[0m in 1.82s]
[0m15:57:01.644035 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m15:57:01.647984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945f510>]}
[0m15:57:01.650849 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092fcbd0>]}
[0m15:57:01.651678 [info ] [Thread-1 (]: 1 of 8 OK created sql view model FAWDBTCORE.stg_mobile_events .................. [[32mOK[0m in 1.83s]
[0m15:57:01.652338 [info ] [Thread-3 (]: 3 of 8 OK created sql view model FAWDBTCORE.stg_web_events ..................... [[32mOK[0m in 1.83s]
[0m15:57:01.652900 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:57:01.653313 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:57:01.654438 [debug] [Thread-4 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:57:01.654935 [debug] [Thread-2 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:57:01.655303 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:57:01.655704 [debug] [Thread-3 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:57:01.656127 [info ] [Thread-4 (]: 4 of 8 START sql view model FAWDBTCORE.average_duration_by_platform_country .... [RUN]
[0m15:57:01.656715 [info ] [Thread-2 (]: 5 of 8 START sql view model FAWDBTCORE.event_counts_by_platform ................ [RUN]
[0m15:57:01.657346 [info ] [Thread-1 (]: 6 of 8 START sql view model FAWDBTCORE.mobile_event_durations .................. [RUN]
[0m15:57:01.657817 [info ] [Thread-3 (]: 7 of 8 START sql view model FAWDBTCORE.ranked_web_events ....................... [RUN]
[0m15:57:01.658645 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.average_duration_by_platform_country'
[0m15:57:01.659239 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.event_counts_by_platform)
[0m15:57:01.659964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m15:57:01.660571 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.ranked_web_events)
[0m15:57:01.660882 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m15:57:01.661133 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m15:57:01.661362 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m15:57:01.661578 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m15:57:01.665403 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:57:01.668038 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m15:57:01.670189 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m15:57:01.671976 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m15:57:01.673216 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 15:57:01.668271 => 15:57:01.673007
[0m15:57:01.673588 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 15:57:01.661738 => 15:57:01.673425
[0m15:57:01.673914 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m15:57:01.674222 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 15:57:01.670389 => 15:57:01.674100
[0m15:57:01.674477 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 15:57:01.665771 => 15:57:01.674352
[0m15:57:01.674704 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m15:57:01.676862 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m15:57:01.677136 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m15:57:01.677362 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m15:57:01.678957 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:57:01.680727 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m15:57:01.683996 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m15:57:01.688405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:01.688687 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:01.694493 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:57:01.694718 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:01.694935 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:01.695152 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:01.695365 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:01.695570 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:02.921123 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:57:02.922448 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:57:02.923216 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:57:02.923819 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:57:02.924428 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m15:57:02.925318 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m15:57:02.926061 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m15:57:02.926853 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m15:57:03.028320 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.1004180908203125 seconds
[0m15:57:03.033778 [debug] [Thread-3 (]: On model.oracle_dbt.ranked_web_events: COMMIT
[0m15:57:03.034357 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10632014274597168 seconds
[0m15:57:03.034820 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10708212852478027 seconds
[0m15:57:03.035209 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10686206817626953 seconds
[0m15:57:03.035715 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:57:03.037595 [debug] [Thread-2 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m15:57:03.039149 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m15:57:03.041228 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m15:57:03.041749 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: fCOMMIT
[0m15:57:03.042207 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:57:03.042573 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:57:03.042933 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:57:03.043490 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: fCOMMIT
[0m15:57:03.043855 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: fCOMMIT
[0m15:57:03.044289 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: fCOMMIT
[0m15:57:03.137873 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09411787986755371 seconds
[0m15:57:03.139080 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09427022933959961 seconds
[0m15:57:03.139762 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09467291831970215 seconds
[0m15:57:03.144419 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:57:03.144813 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.0999460220336914 seconds
[0m15:57:03.147206 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:57:03.149510 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:57:03.149868 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.ranked_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:03.151967 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:57:03.152316 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:03.152684 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:03.153257 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:03.267041 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.11309003829956055 seconds
[0m15:57:03.268457 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.11461091041564941 seconds
[0m15:57:03.269006 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.11509490013122559 seconds
[0m15:57:03.269520 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.11548590660095215 seconds
[0m15:57:03.273051 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 15:57:01.679158 => 15:57:03.272790
[0m15:57:03.275349 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 15:57:01.680880 => 15:57:03.275135
[0m15:57:03.277247 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 15:57:01.677518 => 15:57:03.277079
[0m15:57:03.278889 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 15:57:01.674902 => 15:57:03.278725
[0m15:57:03.279277 [debug] [Thread-3 (]: On model.oracle_dbt.ranked_web_events: Close
[0m15:57:03.279618 [debug] [Thread-2 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m15:57:03.279945 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m15:57:03.280268 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m15:57:03.382324 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10954b450>]}
[0m15:57:03.385706 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10959f410>]}
[0m15:57:03.386535 [info ] [Thread-3 (]: 7 of 8 OK created sql view model FAWDBTCORE.ranked_web_events .................. [[32mOK[0m in 1.72s]
[0m15:57:03.389404 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a45f90>]}
[0m15:57:03.392035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095902d0>]}
[0m15:57:03.392698 [info ] [Thread-2 (]: 5 of 8 OK created sql view model FAWDBTCORE.event_counts_by_platform ........... [[32mOK[0m in 1.73s]
[0m15:57:03.393281 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:57:03.393726 [info ] [Thread-4 (]: 4 of 8 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 1.73s]
[0m15:57:03.394585 [info ] [Thread-1 (]: 6 of 8 OK created sql view model FAWDBTCORE.mobile_event_durations ............. [[32mOK[0m in 1.73s]
[0m15:57:03.395302 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:57:03.395712 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:57:03.396147 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:57:03.396952 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:57:03.397820 [info ] [Thread-3 (]: 8 of 8 START sql view model FAWDBTCORE.web_events_counts ....................... [RUN]
[0m15:57:03.398819 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.ranked_web_events, now model.oracle_dbt.web_events_counts)
[0m15:57:03.399101 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m15:57:03.402482 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m15:57:03.407982 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 15:57:03.399281 => 15:57:03.407605
[0m15:57:03.408378 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_counts
[0m15:57:03.410758 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m15:57:03.415667 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:03.416016 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:04.659897 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:57:04.661553 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_event_counts


[0m15:57:04.778915 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.11602997779846191 seconds
[0m15:57:04.785955 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m15:57:04.786603 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:57:04.787039 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: fCOMMIT
[0m15:57:04.883013 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09495401382446289 seconds
[0m15:57:04.888979 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:57:04.889695 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:04.995909 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.1054987907409668 seconds
[0m15:57:04.999123 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 15:57:03.408613 => 15:57:04.998915
[0m15:57:04.999546 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: Close
[0m15:57:05.107756 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f55a754-3049-489c-a322-651f623571a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ae810>]}
[0m15:57:05.108992 [info ] [Thread-3 (]: 8 of 8 OK created sql view model FAWDBTCORE.web_events_counts .................. [[32mOK[0m in 1.71s]
[0m15:57:05.109832 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:57:05.112271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:05.112747 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:06.614681 [debug] [MainThread]: On master: COMMIT
[0m15:57:06.615540 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:57:06.615927 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:57:06.712487 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09606695175170898 seconds
[0m15:57:06.712864 [debug] [MainThread]: On master: Close
[0m15:57:06.810764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:06.811514 [debug] [MainThread]: Connection 'model.oracle_dbt.mobile_event_durations' was properly closed.
[0m15:57:06.811854 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m15:57:06.812166 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m15:57:06.812434 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m15:57:06.812819 [info ] [MainThread]: 
[0m15:57:06.813247 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 12.10 seconds (12.10s).
[0m15:57:06.814997 [debug] [MainThread]: Command end result
[0m15:57:06.829602 [info ] [MainThread]: 
[0m15:57:06.830162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:06.830454 [info ] [MainThread]: 
[0m15:57:06.830746 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:57:06.831602 [debug] [MainThread]: Command `dbt run` succeeded at 15:57:06.831399 after 12.49 seconds
[0m15:57:06.832046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbe310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e23710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e22a50>]}
[0m15:57:06.832357 [debug] [MainThread]: Flushing usage events
[0m15:57:13.974117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de8450>]}


============================== 15:57:13.982554 | 82e59d74-8b2a-466d-988f-dc3d3ca64631 ==============================
[0m15:57:13.982554 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:57:13.982975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/rosreen/Downloads/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:57:14.088323 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:57:14.118786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a2e0d0>]}
[0m15:57:14.142864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11806f0d0>]}
[0m15:57:14.165626 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:57:14.264891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:14.265297 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_users.sql
[0m15:57:14.275794 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
[0m15:57:14.285803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183da010>]}
[0m15:57:14.295223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a47a90>]}
[0m15:57:14.295452 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:57:14.295646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118457010>]}
[0m15:57:14.296608 [info ] [MainThread]: 
[0m15:57:14.297022 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:57:14.297739 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:57:14.302941 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:57:14.303219 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:57:14.303366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:14.303495 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:15.797937 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.4943647384643555 seconds
[0m15:57:15.899180 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:57:16.055610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:57:16.061196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:16.061579 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:17.274316 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:57:17.276233 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:57:17.404419 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12629985809326172 seconds
[0m15:57:17.696867 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:57:17.793947 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:57:17.910137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a586d0>]}
[0m15:57:17.910806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:17.911015 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:19.119526 [debug] [MainThread]: On master: COMMIT
[0m15:57:19.120134 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:57:19.120323 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:57:19.215229 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09439206123352051 seconds
[0m15:57:19.218379 [debug] [MainThread]: On master: Close
[0m15:57:19.322980 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:57:19.325116 [info ] [MainThread]: 
[0m15:57:19.346524 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:57:19.347272 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m15:57:19.347810 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:57:19.348739 [info ] [Thread-1 (]: 1 of 8 START sql view model FAWDBTCORE.stg_mobile_events ....................... [RUN]
[0m15:57:19.349497 [info ] [Thread-2 (]: 2 of 8 START sql view model FAWDBTCORE.stg_users ............................... [RUN]
[0m15:57:19.350128 [info ] [Thread-3 (]: 3 of 8 START sql view model FAWDBTCORE.stg_web_events .......................... [RUN]
[0m15:57:19.351710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:57:19.353284 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m15:57:19.354358 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:57:19.354948 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:57:19.355468 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m15:57:19.355900 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:57:19.358837 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:57:19.362337 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m15:57:19.364039 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:57:19.366242 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:57:19.362636 => 15:57:19.365975
[0m15:57:19.366667 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 15:57:19.359218 => 15:57:19.366473
[0m15:57:19.367268 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:57:19.356206 => 15:57:19.366889
[0m15:57:19.367584 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:57:19.367920 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m15:57:19.368229 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:57:19.387806 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:57:19.390063 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m15:57:19.392166 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:57:19.404360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:19.404718 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:57:19.404988 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:57:19.405311 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:19.405611 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:19.405882 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:20.620921 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:57:20.625223 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m15:57:20.621951 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:57:20.623468 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:57:20.628801 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m15:57:20.629582 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users;
)

select * from users_cleaned


[0m15:57:20.728408 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10127711296081543 seconds
[0m15:57:20.738330 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10801100730895996 seconds
[0m15:57:20.755161 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m15:57:20.757919 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:57:20.758639 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:57:20.759112 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:57:20.759524 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m15:57:20.759923 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:57:20.824928 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m15:57:20.827086 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: ROLLBACK
[0m15:57:20.856079 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09486508369445801 seconds
[0m15:57:20.857320 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09690380096435547 seconds
[0m15:57:20.874781 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:57:20.878081 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:57:20.878618 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:20.879095 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:20.923028 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m15:57:20.977548 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09717416763305664 seconds
[0m15:57:20.987219 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10755610466003418 seconds
[0m15:57:21.011101 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:57:19.368464 => 15:57:21.010875
[0m15:57:21.012288 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:57:19.390346 => 15:57:21.012077
[0m15:57:21.012800 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:57:21.013127 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:57:21.019883 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 15:57:19.388029 => 15:57:21.019730
[0m15:57:21.032184 [debug] [Thread-2 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:57:21.033886 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184ab3d0>]}
[0m15:57:21.034307 [error] [Thread-2 (]: 2 of 8 ERROR creating sql view model FAWDBTCORE.stg_users ...................... [[31mERROR[0m in 1.68s]
[0m15:57:21.034669 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m15:57:21.112885 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183ebd90>]}
[0m15:57:21.113551 [info ] [Thread-3 (]: 3 of 8 OK created sql view model FAWDBTCORE.stg_web_events ..................... [[32mOK[0m in 1.76s]
[0m15:57:21.115408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118464d90>]}
[0m15:57:21.115880 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:57:21.116342 [info ] [Thread-1 (]: 1 of 8 OK created sql view model FAWDBTCORE.stg_mobile_events .................. [[32mOK[0m in 1.76s]
[0m15:57:21.116934 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:57:21.117277 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:57:21.117610 [info ] [Thread-4 (]: 4 of 8 START sql view model FAWDBTCORE.ranked_web_events ....................... [RUN]
[0m15:57:21.118457 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.ranked_web_events'
[0m15:57:21.118734 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:57:21.118998 [debug] [Thread-2 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:57:21.119209 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m15:57:21.119423 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:57:21.119732 [info ] [Thread-3 (]: 5 of 8 START sql view model FAWDBTCORE.average_duration_by_platform_country .... [RUN]
[0m15:57:21.120059 [info ] [Thread-2 (]: 6 of 8 START sql view model FAWDBTCORE.event_counts_by_platform ................ [RUN]
[0m15:57:21.122545 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m15:57:21.122865 [info ] [Thread-1 (]: 7 of 8 START sql view model FAWDBTCORE.mobile_event_durations .................. [RUN]
[0m15:57:21.123380 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.average_duration_by_platform_country)
[0m15:57:21.123792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.event_counts_by_platform)
[0m15:57:21.124272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m15:57:21.124509 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m15:57:21.124717 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m15:57:21.124920 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m15:57:21.127016 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:57:21.129078 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m15:57:21.129320 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 15:57:21.120269 => 15:57:21.129213
[0m15:57:21.131211 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m15:57:21.131569 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m15:57:21.133427 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m15:57:21.133953 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 15:57:21.125061 => 15:57:21.133838
[0m15:57:21.134173 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 15:57:21.127217 => 15:57:21.134065
[0m15:57:21.134378 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m15:57:21.134580 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m15:57:21.136148 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:57:21.137600 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m15:57:21.138008 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 15:57:21.129462 => 15:57:21.137911
[0m15:57:21.138186 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:57:21.138366 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m15:57:21.138553 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:21.140031 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m15:57:21.144990 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:21.145177 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:21.145372 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:21.145560 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:21.151617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:21.151806 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:22.384291 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:57:22.385431 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:57:22.386166 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:57:22.386687 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:57:22.387441 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m15:57:22.388070 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m15:57:22.388828 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m15:57:22.389599 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m15:57:22.491212 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10025596618652344 seconds
[0m15:57:22.501419 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: COMMIT
[0m15:57:22.502402 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.11145710945129395 seconds
[0m15:57:22.502897 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.11232280731201172 seconds
[0m15:57:22.503364 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.11212921142578125 seconds
[0m15:57:22.504215 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:57:22.506808 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m15:57:22.509817 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m15:57:22.512578 [debug] [Thread-2 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m15:57:22.513210 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: fCOMMIT
[0m15:57:22.513715 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:57:22.514109 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:57:22.514486 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:57:22.515135 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: fCOMMIT
[0m15:57:22.515644 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: fCOMMIT
[0m15:57:22.516082 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: fCOMMIT
[0m15:57:22.612251 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09673810005187988 seconds
[0m15:57:22.622205 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10528802871704102 seconds
[0m15:57:22.622814 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10616087913513184 seconds
[0m15:57:22.623245 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10672903060913086 seconds
[0m15:57:22.627168 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:57:22.631509 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:57:22.635083 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:57:22.640429 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:57:22.640958 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.ranked_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:22.641491 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:22.642008 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:22.642512 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:22.751792 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10791397094726562 seconds
[0m15:57:22.759750 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 15:57:21.138688 => 15:57:22.759424
[0m15:57:22.760390 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m15:57:22.760884 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.11787295341491699 seconds
[0m15:57:22.761574 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.11831808090209961 seconds
[0m15:57:22.762227 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.11856317520141602 seconds
[0m15:57:22.767742 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 15:57:21.131755 => 15:57:22.767477
[0m15:57:22.774372 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 15:57:21.136283 => 15:57:22.774092
[0m15:57:22.777654 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 15:57:21.134711 => 15:57:22.777355
[0m15:57:22.780577 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m15:57:22.779428 [debug] [Thread-2 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m15:57:22.778615 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: Close
[0m15:57:22.865220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118bd4c90>]}
[0m15:57:22.869462 [info ] [Thread-1 (]: 7 of 8 OK created sql view model FAWDBTCORE.mobile_event_durations ............. [[32mOK[0m in 1.74s]
[0m15:57:22.871549 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:57:22.874666 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:57:22.878184 [info ] [Thread-1 (]: 8 of 8 START sql view model FAWDBTCORE.web_events_counts ....................... [RUN]
[0m15:57:22.881282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.mobile_event_durations, now model.oracle_dbt.web_events_counts)
[0m15:57:22.883118 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m15:57:22.888661 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m15:57:22.890922 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b5ec10>]}
[0m15:57:22.893037 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b5d610>]}
[0m15:57:22.894816 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b5fb10>]}
[0m15:57:22.895339 [info ] [Thread-4 (]: 4 of 8 OK created sql view model FAWDBTCORE.ranked_web_events .................. [[32mOK[0m in 1.77s]
[0m15:57:22.895932 [info ] [Thread-3 (]: 5 of 8 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 1.77s]
[0m15:57:22.896811 [info ] [Thread-2 (]: 6 of 8 OK created sql view model FAWDBTCORE.event_counts_by_platform ........... [[32mOK[0m in 1.77s]
[0m15:57:22.897549 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:57:22.898119 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:57:22.898587 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:57:22.905770 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 15:57:22.883591 => 15:57:22.905581
[0m15:57:22.906084 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_counts
[0m15:57:22.909509 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m15:57:22.918649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:22.919005 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:24.179788 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:57:24.181590 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_event_counts


[0m15:57:24.284608 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10143399238586426 seconds
[0m15:57:24.289915 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m15:57:24.290884 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:57:24.291539 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.web_events_counts: fCOMMIT
[0m15:57:24.387549 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.0951690673828125 seconds
[0m15:57:24.398576 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:57:24.399398 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:57:24.495967 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09526610374450684 seconds
[0m15:57:24.502526 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 15:57:22.906261 => 15:57:24.502215
[0m15:57:24.503316 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_counts: Close
[0m15:57:24.610500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82e59d74-8b2a-466d-988f-dc3d3ca64631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118455390>]}
[0m15:57:24.612442 [info ] [Thread-1 (]: 8 of 8 OK created sql view model FAWDBTCORE.web_events_counts .................. [[32mOK[0m in 1.73s]
[0m15:57:24.613325 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:57:24.615715 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:24.616199 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:25.817984 [debug] [MainThread]: On master: COMMIT
[0m15:57:25.818638 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:57:25.819001 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:57:25.913519 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09344196319580078 seconds
[0m15:57:25.914145 [debug] [MainThread]: On master: Close
[0m15:57:26.012727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:26.012999 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m15:57:26.013131 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m15:57:26.013250 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m15:57:26.013362 [debug] [MainThread]: Connection 'model.oracle_dbt.ranked_web_events' was properly closed.
[0m15:57:26.013528 [info ] [MainThread]: 
[0m15:57:26.013721 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 11.72 seconds (11.72s).
[0m15:57:26.014401 [debug] [MainThread]: Command end result
[0m15:57:26.022006 [info ] [MainThread]: 
[0m15:57:26.022420 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:57:26.022706 [info ] [MainThread]: 
[0m15:57:26.022904 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
[0m15:57:26.023089 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m15:57:26.023259 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/staging/stg_users.sql
[0m15:57:26.023437 [info ] [MainThread]: 
[0m15:57:26.023634 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m15:57:26.024163 [debug] [MainThread]: Command `dbt run` failed at 15:57:26.024063 after 12.09 seconds
[0m15:57:26.024549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183f0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ca8c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0a1d0>]}
[0m15:57:26.024901 [debug] [MainThread]: Flushing usage events
[0m15:57:58.095435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11100bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107f7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107094450>]}


============================== 15:57:58.102570 | 699f34fa-0da5-4653-9ace-e3495fa18dd8 ==============================
[0m15:57:58.102570 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:57:58.103025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:57:58.200795 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m15:57:58.234784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11100bed0>]}
[0m15:57:58.259476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111896e50>]}
[0m15:57:58.275837 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:57:58.367618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:58.368046 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/staging/stg_users.sql
[0m15:57:58.378373 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
[0m15:57:58.387972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a72b50>]}
[0m15:57:58.402478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111089c50>]}
[0m15:57:58.402708 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:57:58.402892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118ba950>]}
[0m15:57:58.403875 [info ] [MainThread]: 
[0m15:57:58.404307 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m15:57:58.404985 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m15:57:58.409969 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m15:57:58.410221 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m15:57:58.410357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:58.410478 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:57:59.829438 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.4182960987091064 seconds
[0m15:57:59.937679 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m15:58:00.050969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m15:58:00.063800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:00.064384 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:58:01.234214 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m15:58:01.236879 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m15:58:01.360389 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12091612815856934 seconds
[0m15:58:01.546241 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m15:58:01.644851 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m15:58:01.752403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11053a390>]}
[0m15:58:01.753755 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:01.754424 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:58:02.967118 [debug] [MainThread]: On master: COMMIT
[0m15:58:02.969739 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:58:02.972476 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:58:03.070057 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09599518775939941 seconds
[0m15:58:03.072504 [debug] [MainThread]: On master: Close
[0m15:58:03.189985 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:03.197957 [info ] [MainThread]: 
[0m15:58:03.230046 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m15:58:03.230584 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m15:58:03.231007 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m15:58:03.231671 [info ] [Thread-1 (]: 1 of 8 START sql view model FAWDBTCORE.stg_mobile_events ....................... [RUN]
[0m15:58:03.232631 [info ] [Thread-2 (]: 2 of 8 START sql view model FAWDBTCORE.stg_users ............................... [RUN]
[0m15:58:03.233231 [info ] [Thread-3 (]: 3 of 8 START sql view model FAWDBTCORE.stg_web_events .......................... [RUN]
[0m15:58:03.234002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m15:58:03.234550 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m15:58:03.235671 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m15:58:03.235521 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m15:58:03.237730 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m15:58:03.239291 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m15:58:03.235265 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m15:58:03.240189 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m15:58:03.241625 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m15:58:03.242167 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 15:58:03.237911 => 15:58:03.242005
[0m15:58:03.242361 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m15:58:03.255818 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 15:58:03.235776 => 15:58:03.255592
[0m15:58:03.260739 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m15:58:03.261184 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m15:58:03.261541 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 15:58:03.240448 => 15:58:03.261371
[0m15:58:03.263789 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m15:58:03.264094 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m15:58:03.266102 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m15:58:03.266577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:03.266821 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:58:03.267138 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:58:03.267386 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:58:03.274521 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:58:03.274863 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:58:04.439691 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:58:04.442229 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users
)

select * from users_cleaned


[0m15:58:04.457863 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:58:04.459354 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m15:58:04.460118 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:58:04.461339 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m15:58:04.554129 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.11041712760925293 seconds
[0m15:58:04.565819 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10363507270812988 seconds
[0m15:58:04.576372 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.11547231674194336 seconds
[0m15:58:04.575923 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m15:58:04.578890 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m15:58:04.582477 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m15:58:04.583172 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:58:04.583656 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:58:04.584079 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:58:04.584485 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m15:58:04.585087 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m15:58:04.585692 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: fCOMMIT
[0m15:58:04.727154 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.1403210163116455 seconds
[0m15:58:04.753542 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.16681122779846191 seconds
[0m15:58:04.754244 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m15:58:04.759837 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m15:58:04.760102 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.17333674430847168 seconds
[0m15:58:04.760620 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:58:04.761220 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:58:04.764935 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m15:58:04.765875 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:58:04.860986 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09459781646728516 seconds
[0m15:58:04.862131 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09667491912841797 seconds
[0m15:58:04.862569 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09630489349365234 seconds
[0m15:58:04.894025 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 15:58:03.242473 => 15:58:04.893778
[0m15:58:04.897810 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 15:58:03.264399 => 15:58:04.897611
[0m15:58:04.899869 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 15:58:03.261876 => 15:58:04.899690
[0m15:58:04.900316 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m15:58:04.900728 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m15:58:04.901094 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m15:58:05.022856 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b37550>]}
[0m15:58:05.025991 [info ] [Thread-2 (]: 2 of 8 OK created sql view model FAWDBTCORE.stg_users .......................... [[32mOK[0m in 1.79s]
[0m15:58:05.027529 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m15:58:05.032093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a731d0>]}
[0m15:58:05.035819 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c73690>]}
[0m15:58:05.036905 [info ] [Thread-1 (]: 1 of 8 OK created sql view model FAWDBTCORE.stg_mobile_events .................. [[32mOK[0m in 1.80s]
[0m15:58:05.038073 [info ] [Thread-3 (]: 3 of 8 OK created sql view model FAWDBTCORE.stg_web_events ..................... [[32mOK[0m in 1.80s]
[0m15:58:05.039111 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m15:58:05.039748 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m15:58:05.041210 [debug] [Thread-4 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m15:58:05.041893 [debug] [Thread-2 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m15:58:05.042472 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m15:58:05.042848 [debug] [Thread-3 (]: Began running node model.oracle_dbt.ranked_web_events
[0m15:58:05.043329 [info ] [Thread-4 (]: 4 of 8 START sql view model FAWDBTCORE.average_duration_by_platform_country .... [RUN]
[0m15:58:05.044087 [info ] [Thread-2 (]: 5 of 8 START sql view model FAWDBTCORE.event_counts_by_platform ................ [RUN]
[0m15:58:05.044654 [info ] [Thread-1 (]: 6 of 8 START sql view model FAWDBTCORE.mobile_event_durations .................. [RUN]
[0m15:58:05.045162 [info ] [Thread-3 (]: 7 of 8 START sql view model FAWDBTCORE.ranked_web_events ....................... [RUN]
[0m15:58:05.046098 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.average_duration_by_platform_country'
[0m15:58:05.046720 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.event_counts_by_platform)
[0m15:58:05.047392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m15:58:05.048006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.ranked_web_events)
[0m15:58:05.048363 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m15:58:05.048697 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m15:58:05.049007 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m15:58:05.049694 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m15:58:05.054581 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:58:05.057512 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m15:58:05.060161 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m15:58:05.062403 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m15:58:05.067940 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 15:58:05.054939 => 15:58:05.067646
[0m15:58:05.068276 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 15:58:05.050181 => 15:58:05.068133
[0m15:58:05.068557 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m15:58:05.068829 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 15:58:05.060424 => 15:58:05.068694
[0m15:58:05.069210 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 15:58:05.057767 => 15:58:05.068990
[0m15:58:05.069565 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m15:58:05.071734 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m15:58:05.072010 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m15:58:05.072223 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m15:58:05.074239 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m15:58:05.076085 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m15:58:05.078070 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m15:58:05.082382 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:05.082754 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:58:05.086065 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:58:05.086423 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:58:05.086671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:05.087028 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:58:05.087472 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:58:05.087735 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:58:06.322494 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:58:06.324812 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m15:58:06.326127 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:58:06.327443 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m15:58:06.340842 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:58:06.342069 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m15:58:06.426240 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.0998537540435791 seconds
[0m15:58:06.433131 [debug] [Thread-3 (]: On model.oracle_dbt.ranked_web_events: COMMIT
[0m15:58:06.433809 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10463070869445801 seconds
[0m15:58:06.447323 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:58:06.447929 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10513520240783691 seconds
[0m15:58:06.452407 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m15:58:06.454401 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: fCOMMIT
[0m15:58:06.458475 [debug] [Thread-2 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m15:58:06.459224 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:58:06.460164 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:58:06.460865 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: fCOMMIT
[0m15:58:06.461310 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: fCOMMIT
[0m15:58:06.554842 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09478282928466797 seconds
[0m15:58:06.563424 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10151028633117676 seconds
[0m15:58:06.564729 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10269498825073242 seconds
[0m15:58:06.566133 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m15:58:06.567000 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:58:06.575654 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m15:58:06.581597 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m15:58:06.584947 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.ranked_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:58:06.585640 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m15:58:06.586258 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:58:06.586811 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:58:06.689869 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10158395767211914 seconds
[0m15:58:06.692457 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10484695434570312 seconds
[0m15:58:06.693356 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.1053929328918457 seconds
[0m15:58:06.693970 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10638427734375 seconds
[0m15:58:06.700379 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 15:58:05.072357 => 15:58:06.699992
[0m15:58:06.704085 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 15:58:05.074578 => 15:58:06.703782
[0m15:58:06.707820 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 15:58:05.069779 => 15:58:06.707440
[0m15:58:06.709762 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m15:58:06.710262 [debug] [Thread-4 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m15:58:06.710693 [debug] [Thread-3 (]: On model.oracle_dbt.ranked_web_events: Close
[0m15:58:06.711092 [debug] [Thread-2 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m15:58:06.711504 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:58:06.712232 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: fCOMMIT
[0m15:58:06.815517 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11224e6d0>]}
[0m15:58:06.819830 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112212f50>]}
[0m15:58:06.820316 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10766100883483887 seconds
[0m15:58:06.822379 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122002d0>]}
[0m15:58:06.823202 [info ] [Thread-3 (]: 7 of 8 OK created sql view model FAWDBTCORE.ranked_web_events .................. [[32mOK[0m in 1.77s]
[0m15:58:06.823912 [info ] [Thread-2 (]: 5 of 8 OK created sql view model FAWDBTCORE.event_counts_by_platform ........... [[32mOK[0m in 1.77s]
[0m15:58:06.827109 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m15:58:06.827830 [info ] [Thread-4 (]: 4 of 8 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 1.78s]
[0m15:58:06.828965 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m15:58:06.829633 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m15:58:06.830147 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:58:06.830802 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m15:58:06.831344 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_counts
[0m15:58:06.832750 [info ] [Thread-3 (]: 8 of 8 START sql view model FAWDBTCORE.web_events_counts ....................... [RUN]
[0m15:58:06.833804 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.ranked_web_events, now model.oracle_dbt.web_events_counts)
[0m15:58:06.834271 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m15:58:06.838993 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m15:58:06.841128 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 15:58:06.834551 => 15:58:06.840876
[0m15:58:06.841548 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_counts
[0m15:58:06.844993 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m15:58:06.851237 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:58:06.851596 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:58:06.941660 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.1089320182800293 seconds
[0m15:58:06.947851 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 15:58:05.076319 => 15:58:06.947480
[0m15:58:06.948580 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m15:58:07.056981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11224e6d0>]}
[0m15:58:07.059000 [info ] [Thread-1 (]: 6 of 8 OK created sql view model FAWDBTCORE.mobile_event_durations ............. [[32mOK[0m in 2.01s]
[0m15:58:07.060137 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m15:58:08.062883 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:58:08.064554 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_event_counts


[0m15:58:08.169975 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10381412506103516 seconds
[0m15:58:08.176529 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m15:58:08.178304 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:58:08.179298 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: fCOMMIT
[0m15:58:08.275827 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09469008445739746 seconds
[0m15:58:08.285332 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m15:58:08.286299 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m15:58:08.385044 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09752988815307617 seconds
[0m15:58:08.390848 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 15:58:06.841796 => 15:58:08.390233
[0m15:58:08.392010 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: Close
[0m15:58:08.498169 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699f34fa-0da5-4653-9ace-e3495fa18dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118ad590>]}
[0m15:58:08.500504 [info ] [Thread-3 (]: 8 of 8 OK created sql view model FAWDBTCORE.web_events_counts .................. [[32mOK[0m in 1.66s]
[0m15:58:08.502214 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_counts
[0m15:58:08.507171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:08.508194 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m15:58:09.716779 [debug] [MainThread]: On master: COMMIT
[0m15:58:09.719636 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m15:58:09.720781 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m15:58:09.825870 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10398316383361816 seconds
[0m15:58:09.827612 [debug] [MainThread]: On master: Close
[0m15:58:09.940952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:09.943145 [debug] [MainThread]: Connection 'model.oracle_dbt.mobile_event_durations' was properly closed.
[0m15:58:09.943569 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m15:58:09.943878 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m15:58:09.944265 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m15:58:09.944896 [info ] [MainThread]: 
[0m15:58:09.945523 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 11.54 seconds (11.54s).
[0m15:58:09.947985 [debug] [MainThread]: Command end result
[0m15:58:09.958134 [info ] [MainThread]: 
[0m15:58:09.958909 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:09.959680 [info ] [MainThread]: 
[0m15:58:09.960232 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:58:09.961126 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:09.960997 after 11.90 seconds
[0m15:58:09.961596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11102cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10492a8d0>]}
[0m15:58:09.961963 [debug] [MainThread]: Flushing usage events
[0m16:01:00.118197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119f7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f44450>]}


============================== 16:01:00.121359 | e1a203b3-694a-43b8-83bd-221f25a339fc ==============================
[0m16:01:00.121359 [info ] [MainThread]: Running with dbt=1.5.0
[0m16:01:00.121699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:01:00.198374 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m16:01:00.236424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0a2d0>]}
[0m16:01:00.259713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119f5bd0>]}
[0m16:01:00.276133 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m16:01:00.329892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:01:00.330214 [debug] [MainThread]: Partial parsing: added file: oracle_dbt://models/frequent_mobile_users.sql
[0m16:01:00.330365 [debug] [MainThread]: Partial parsing: added file: oracle_dbt://models/frequent_web_users.sql
[0m16:01:00.339808 [debug] [MainThread]: 1699: static parser successfully parsed frequent_mobile_users.sql
[0m16:01:00.346753 [debug] [MainThread]: 1699: static parser successfully parsed frequent_web_users.sql
[0m16:01:00.351947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11224b490>]}
[0m16:01:00.361087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112335010>]}
[0m16:01:00.361302 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:01:00.361477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122e9fd0>]}
[0m16:01:00.362459 [info ] [MainThread]: 
[0m16:01:00.362855 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m16:01:00.363574 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m16:01:00.368676 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m16:01:00.368943 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m16:01:00.369087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:00.369221 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:01.989068 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.6192729473114014 seconds
[0m16:01:02.091637 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m16:01:02.204458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m16:01:02.212562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:02.213033 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:03.398538 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m16:01:03.400417 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m16:01:03.519749 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11820006370544434 seconds
[0m16:01:03.710160 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m16:01:03.804996 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m16:01:03.915053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b08b50>]}
[0m16:01:03.915823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:03.916161 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:05.087404 [debug] [MainThread]: On master: COMMIT
[0m16:01:05.089888 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m16:01:05.091015 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m16:01:05.187414 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.0954732894897461 seconds
[0m16:01:05.189198 [debug] [MainThread]: On master: Close
[0m16:01:05.299275 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:01:05.300222 [info ] [MainThread]: 
[0m16:01:05.321739 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m16:01:05.322187 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m16:01:05.322510 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m16:01:05.323055 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m16:01:05.323484 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m16:01:05.323855 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m16:01:05.324618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m16:01:05.325137 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m16:01:05.325614 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m16:01:05.325856 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m16:01:05.326084 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m16:01:05.326356 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m16:01:05.328393 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m16:01:05.330842 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m16:01:05.332104 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m16:01:05.333269 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 16:01:05.326572 => 16:01:05.333108
[0m16:01:05.333498 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 16:01:05.331187 => 16:01:05.333410
[0m16:01:05.333770 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 16:01:05.328734 => 16:01:05.333581
[0m16:01:05.333917 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m16:01:05.334124 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m16:01:05.334384 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m16:01:05.348025 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m16:01:05.349809 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m16:01:05.351310 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m16:01:05.358051 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:01:05.358327 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:01:05.358580 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:05.358788 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:05.359293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:05.359520 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:06.552877 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m16:01:06.554851 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m16:01:06.555595 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m16:01:06.556282 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m16:01:06.557268 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m16:01:06.557858 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users
)

select * from users_cleaned


[0m16:01:06.657792 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10077881813049316 seconds
[0m16:01:06.658338 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09980082511901855 seconds
[0m16:01:06.664395 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10595202445983887 seconds
[0m16:01:06.667456 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m16:01:06.668678 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m16:01:06.669708 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m16:01:06.669996 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m16:01:06.670252 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m16:01:06.670489 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m16:01:06.670717 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m16:01:06.670944 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: fCOMMIT
[0m16:01:06.671167 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m16:01:06.767002 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09547710418701172 seconds
[0m16:01:06.767642 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09580397605895996 seconds
[0m16:01:06.768122 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09653472900390625 seconds
[0m16:01:06.775784 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m16:01:06.777708 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m16:01:06.779535 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m16:01:06.779846 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:01:06.780165 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:01:06.780466 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:01:06.875558 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09470987319946289 seconds
[0m16:01:06.876116 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09503293037414551 seconds
[0m16:01:06.876501 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.0955502986907959 seconds
[0m16:01:06.890073 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 16:01:05.348262 => 16:01:06.889872
[0m16:01:06.891893 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 16:01:05.349983 => 16:01:06.891743
[0m16:01:06.893343 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 16:01:05.334567 => 16:01:06.893214
[0m16:01:06.893634 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m16:01:06.893886 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m16:01:06.894122 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m16:01:06.991952 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126094d0>]}
[0m16:01:06.995232 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112237090>]}
[0m16:01:06.996186 [info ] [Thread-3 (]: 3 of 10 OK created sql view model FAWDBTCORE.stg_web_events .................... [[32mOK[0m in 1.67s]
[0m16:01:06.996960 [info ] [Thread-2 (]: 2 of 10 OK created sql view model FAWDBTCORE.stg_users ......................... [[32mOK[0m in 1.67s]
[0m16:01:06.999385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112437e10>]}
[0m16:01:07.000005 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m16:01:07.000506 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m16:01:07.001069 [info ] [Thread-1 (]: 1 of 10 OK created sql view model FAWDBTCORE.stg_mobile_events ................. [[32mOK[0m in 1.68s]
[0m16:01:07.002170 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m16:01:07.002829 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m16:01:07.003265 [info ] [Thread-4 (]: 4 of 10 START sql view model FAWDBTCORE.ranked_web_events ...................... [RUN]
[0m16:01:07.004444 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.ranked_web_events'
[0m16:01:07.004804 [debug] [Thread-2 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m16:01:07.005127 [debug] [Thread-3 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m16:01:07.005436 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m16:01:07.005813 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m16:01:07.006391 [info ] [Thread-2 (]: 5 of 10 START sql view model FAWDBTCORE.average_duration_by_platform_country ... [RUN]
[0m16:01:07.006928 [info ] [Thread-3 (]: 6 of 10 START sql view model FAWDBTCORE.event_counts_by_platform ............... [RUN]
[0m16:01:07.007401 [info ] [Thread-1 (]: 7 of 10 START sql view model FAWDBTCORE.frequent_mobile_users .................. [RUN]
[0m16:01:07.010261 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m16:01:07.010839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.average_duration_by_platform_country)
[0m16:01:07.011748 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.event_counts_by_platform)
[0m16:01:07.012206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.frequent_mobile_users)
[0m16:01:07.012585 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m16:01:07.012832 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m16:01:07.013101 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.frequent_mobile_users
[0m16:01:07.015555 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m16:01:07.018025 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m16:01:07.020110 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.frequent_mobile_users"
[0m16:01:07.020439 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 16:01:07.007708 => 16:01:07.020264
[0m16:01:07.021143 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m16:01:07.023375 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m16:01:07.023812 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.frequent_mobile_users (compile): 16:01:07.018304 => 16:01:07.023682
[0m16:01:07.024071 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 16:01:07.013292 => 16:01:07.023964
[0m16:01:07.024404 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 16:01:07.015786 => 16:01:07.024196
[0m16:01:07.024645 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.frequent_mobile_users
[0m16:01:07.024889 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m16:01:07.025093 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m16:01:07.026740 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.frequent_mobile_users"
[0m16:01:07.028448 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m16:01:07.030304 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m16:01:07.030690 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:01:07.031143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:07.031409 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:07.031644 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:07.043260 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:07.043553 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:07.043750 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:07.044120 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:08.235143 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m16:01:08.236376 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m16:01:08.236890 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.frequent_mobile_users".
[0m16:01:08.237495 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m16:01:08.238458 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m16:01:08.239390 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m16:01:08.240080 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.frequent_mobile_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.frequent_mobile_users"} */

  
  create or replace view FAWDBTCORE.frequent_mobile_users as
    with start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
),


freq_mobile_user_ids as (
SELECT user_id, COUNT(*) AS frequency
FROM mobile_events_cleaned
GROUP BY user_id
ORDER BY frequency DESC
)

freq_mobile_user_names as (
SELECT u.name, COUNT(*) AS frequency
FROM mobile_events_extracted AS m
JOIN users_cleaned AS u ON u.user_id = m.user_id
GROUP BY u.user_id
ORDER BY frequency DESC
)

select * from freq_mobile_user_names


[0m16:01:08.240753 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m16:01:08.341816 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09953784942626953 seconds
[0m16:01:08.343044 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10142016410827637 seconds
[0m16:01:08.346086 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m16:01:08.346580 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10431623458862305 seconds
[0m16:01:08.348437 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: COMMIT
[0m16:01:08.348907 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m16:01:08.350491 [debug] [Thread-2 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m16:01:08.350920 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m16:01:08.351253 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: fCOMMIT
[0m16:01:08.351583 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m16:01:08.351891 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: fCOMMIT
[0m16:01:08.352331 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: fCOMMIT
[0m16:01:08.434194 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m16:01:08.436570 [debug] [Thread-1 (]: On model.oracle_dbt.frequent_mobile_users: ROLLBACK
[0m16:01:08.448118 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09580397605895996 seconds
[0m16:01:08.448581 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09575819969177246 seconds
[0m16:01:08.449058 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09631204605102539 seconds
[0m16:01:08.451954 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m16:01:08.454083 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m16:01:08.456178 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m16:01:08.456477 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:01:08.456793 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:01:08.457096 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.ranked_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:01:08.534306 [debug] [Thread-1 (]: On model.oracle_dbt.frequent_mobile_users: Close
[0m16:01:08.553214 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09522080421447754 seconds
[0m16:01:08.558523 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10101509094238281 seconds
[0m16:01:08.558992 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10107302665710449 seconds
[0m16:01:08.561844 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 16:01:07.026892 => 16:01:08.561591
[0m16:01:08.563828 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 16:01:07.028629 => 16:01:08.563654
[0m16:01:08.565498 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 16:01:07.021422 => 16:01:08.565332
[0m16:01:08.565887 [debug] [Thread-2 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m16:01:08.566238 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m16:01:08.566557 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: Close
[0m16:01:08.638883 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.frequent_mobile_users (execute): 16:01:07.025238 => 16:01:08.637850
[0m16:01:08.662342 [debug] [Thread-1 (]: Database Error in model frequent_mobile_users (models/frequent_mobile_users.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/frequent_mobile_users.sql
[0m16:01:08.665469 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b03550>]}
[0m16:01:08.667930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f7110>]}
[0m16:01:08.670144 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b34690>]}
[0m16:01:08.672576 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b2ecd0>]}
[0m16:01:08.673250 [info ] [Thread-2 (]: 5 of 10 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 1.65s]
[0m16:01:08.673920 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model FAWDBTCORE.frequent_mobile_users ......... [[31mERROR[0m in 1.66s]
[0m16:01:08.674701 [info ] [Thread-3 (]: 6 of 10 OK created sql view model FAWDBTCORE.event_counts_by_platform .......... [[32mOK[0m in 1.66s]
[0m16:01:08.675516 [info ] [Thread-4 (]: 4 of 10 OK created sql view model FAWDBTCORE.ranked_web_events ................. [[32mOK[0m in 1.67s]
[0m16:01:08.676224 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m16:01:08.676587 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m16:01:08.677170 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m16:01:08.677647 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m16:01:08.678056 [debug] [Thread-2 (]: Began running node model.oracle_dbt.frequent_web_users
[0m16:01:08.678533 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m16:01:08.679003 [debug] [Thread-3 (]: Began running node model.oracle_dbt.web_events_counts
[0m16:01:08.679667 [info ] [Thread-2 (]: 8 of 10 START sql view model FAWDBTCORE.frequent_web_users ..................... [RUN]
[0m16:01:08.680163 [info ] [Thread-1 (]: 9 of 10 START sql view model FAWDBTCORE.mobile_event_durations ................. [RUN]
[0m16:01:08.680577 [info ] [Thread-3 (]: 10 of 10 START sql view model FAWDBTCORE.web_events_counts ..................... [RUN]
[0m16:01:08.681332 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.average_duration_by_platform_country, now model.oracle_dbt.frequent_web_users)
[0m16:01:08.682026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.frequent_mobile_users, now model.oracle_dbt.mobile_event_durations)
[0m16:01:08.682527 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.event_counts_by_platform, now model.oracle_dbt.web_events_counts)
[0m16:01:08.682823 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.frequent_web_users
[0m16:01:08.683081 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m16:01:08.683473 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m16:01:08.686665 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.frequent_web_users"
[0m16:01:08.689533 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m16:01:08.691952 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m16:01:08.692691 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.frequent_web_users (compile): 16:01:08.683775 => 16:01:08.692552
[0m16:01:08.692931 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.frequent_web_users
[0m16:01:08.694857 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.frequent_web_users"
[0m16:01:08.695356 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 16:01:08.686938 => 16:01:08.695233
[0m16:01:08.695573 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 16:01:08.689878 => 16:01:08.695479
[0m16:01:08.695780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:08.695987 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m16:01:08.696218 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.web_events_counts
[0m16:01:08.696455 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:08.698222 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m16:01:08.699902 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m16:01:08.711740 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:08.711975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:08.712205 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:08.712442 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:09.867973 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m16:01:09.870007 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m16:01:09.871456 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_event_counts


[0m16:01:09.872063 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.frequent_web_users".
[0m16:01:09.872566 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m16:01:09.873340 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.frequent_web_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.frequent_web_users"} */

  
  create or replace view FAWDBTCORE.frequent_web_users as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
), 

freq_web_users_ids as (
SELECT user_id, COUNT(*) AS frequency
FROM web_events_cleaned
GROUP BY user_id
ORDER BY frequency DESC
)

freq_mobile_user_ids as (
SELECT user_id, COUNT(*) AS frequency
FROM mobile_events_cleaned
GROUP BY user_id
ORDER BY frequency DESC
)

freq_web_user_names as (
SELECT u.name, COUNT(*) AS frequency
FROM freq_web_users_ids AS w
JOIN users_cleaned AS u ON u.user_id = w.user_id
GROUP BY u.user_id
ORDER BY frequency DESC
)

freq_mobile_user_names as (
SELECT u.name, COUNT(*) AS frequency
FROM mobile_events_extracted AS m
JOIN users_cleaned AS u ON u.user_id = m.user_id
GROUP BY u.user_id
ORDER BY frequency DESC
)

select * from freq_mobile_user_names


[0m16:01:09.977264 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10306382179260254 seconds
[0m16:01:09.978195 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.1050572395324707 seconds
[0m16:01:09.982083 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m16:01:09.984067 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m16:01:09.984560 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m16:01:09.985000 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m16:01:09.985402 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: fCOMMIT
[0m16:01:09.985781 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: fCOMMIT
[0m16:01:10.067113 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00928: missing SELECT keyword
[0m16:01:10.070021 [debug] [Thread-2 (]: On model.oracle_dbt.frequent_web_users: ROLLBACK
[0m16:01:10.082647 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09634113311767578 seconds
[0m16:01:10.085940 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m16:01:10.086309 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:01:10.089185 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10276412963867188 seconds
[0m16:01:10.092043 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m16:01:10.092603 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:01:10.166338 [debug] [Thread-2 (]: On model.oracle_dbt.frequent_web_users: Close
[0m16:01:10.182296 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.095001220703125 seconds
[0m16:01:10.187649 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 16:01:08.696602 => 16:01:10.187388
[0m16:01:10.188103 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09508490562438965 seconds
[0m16:01:10.188635 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m16:01:10.191028 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 16:01:08.698398 => 16:01:10.190817
[0m16:01:10.191620 [debug] [Thread-3 (]: On model.oracle_dbt.web_events_counts: Close
[0m16:01:10.267511 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.frequent_web_users (execute): 16:01:08.693103 => 16:01:10.263937
[0m16:01:10.275570 [debug] [Thread-2 (]: Database Error in model frequent_web_users (models/frequent_web_users.sql)
  ORA-00928: missing SELECT keyword
  compiled Code at target/run/oracle_dbt/models/frequent_web_users.sql
[0m16:01:10.277889 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123e5f50>]}
[0m16:01:10.278496 [error] [Thread-2 (]: 8 of 10 ERROR creating sql view model FAWDBTCORE.frequent_web_users ............ [[31mERROR[0m in 1.60s]
[0m16:01:10.278955 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m16:01:10.291155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11266a090>]}
[0m16:01:10.293772 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1a203b3-694a-43b8-83bd-221f25a339fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112661d10>]}
[0m16:01:10.294665 [info ] [Thread-1 (]: 9 of 10 OK created sql view model FAWDBTCORE.mobile_event_durations ............ [[32mOK[0m in 1.61s]
[0m16:01:10.295164 [info ] [Thread-3 (]: 10 of 10 OK created sql view model FAWDBTCORE.web_events_counts ................ [[32mOK[0m in 1.61s]
[0m16:01:10.295691 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m16:01:10.296071 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.web_events_counts
[0m16:01:10.298108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:01:10.298446 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:01:11.510676 [debug] [MainThread]: On master: COMMIT
[0m16:01:11.512772 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m16:01:11.513392 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m16:01:11.607475 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09305381774902344 seconds
[0m16:01:11.609059 [debug] [MainThread]: On master: Close
[0m16:01:11.712137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:11.712816 [debug] [MainThread]: Connection 'model.oracle_dbt.mobile_event_durations' was properly closed.
[0m16:01:11.713142 [debug] [MainThread]: Connection 'model.oracle_dbt.frequent_web_users' was properly closed.
[0m16:01:11.713439 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m16:01:11.713727 [debug] [MainThread]: Connection 'model.oracle_dbt.ranked_web_events' was properly closed.
[0m16:01:11.714192 [info ] [MainThread]: 
[0m16:01:11.714713 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 11.35 seconds (11.35s).
[0m16:01:11.716667 [debug] [MainThread]: Command end result
[0m16:01:11.735099 [info ] [MainThread]: 
[0m16:01:11.735854 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:01:11.736218 [info ] [MainThread]: 
[0m16:01:11.736514 [error] [MainThread]: [33mDatabase Error in model frequent_mobile_users (models/frequent_mobile_users.sql)[0m
[0m16:01:11.736800 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m16:01:11.737077 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/frequent_mobile_users.sql
[0m16:01:11.737372 [info ] [MainThread]: 
[0m16:01:11.737634 [error] [MainThread]: [33mDatabase Error in model frequent_web_users (models/frequent_web_users.sql)[0m
[0m16:01:11.737919 [error] [MainThread]:   ORA-00928: missing SELECT keyword
[0m16:01:11.738195 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/frequent_web_users.sql
[0m16:01:11.738480 [info ] [MainThread]: 
[0m16:01:11.738781 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m16:01:11.739429 [debug] [MainThread]: Command `dbt run` failed at 16:01:11.739338 after 11.65 seconds
[0m16:01:11.739817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b2c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104acea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11222bc10>]}
[0m16:01:11.740148 [debug] [MainThread]: Flushing usage events
[0m16:02:48.332882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d17d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d17f90>]}


============================== 16:02:48.335999 | 58634d13-f4e1-472c-a807-6234f95453e3 ==============================
[0m16:02:48.335999 [info ] [MainThread]: Running with dbt=1.5.0
[0m16:02:48.336384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:02:48.408808 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m16:02:48.432511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106391bd0>]}
[0m16:02:48.456623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10444c5d0>]}
[0m16:02:48.473548 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m16:02:48.520371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:02:48.520745 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/frequent_mobile_users.sql
[0m16:02:48.520929 [debug] [MainThread]: Partial parsing: updated file: oracle_dbt://models/frequent_web_users.sql
[0m16:02:48.530152 [debug] [MainThread]: 1699: static parser successfully parsed frequent_mobile_users.sql
[0m16:02:48.536528 [debug] [MainThread]: 1699: static parser successfully parsed frequent_web_users.sql
[0m16:02:48.541695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064094d0>]}
[0m16:02:48.552052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d8d10>]}
[0m16:02:48.552276 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:02:48.552458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4e090>]}
[0m16:02:48.553485 [info ] [MainThread]: 
[0m16:02:48.553878 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m16:02:48.554549 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m16:02:48.559861 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m16:02:48.560174 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m16:02:48.560339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:48.560478 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:02:50.095928 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.5345768928527832 seconds
[0m16:02:50.206232 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m16:02:50.315407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m16:02:50.322870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:50.323313 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:02:51.608484 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m16:02:51.610830 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m16:02:51.738961 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.12692594528198242 seconds
[0m16:02:51.932395 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m16:02:52.039395 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m16:02:52.155319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644be50>]}
[0m16:02:52.156096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:52.156462 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:02:53.390510 [debug] [MainThread]: On master: COMMIT
[0m16:02:53.392510 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m16:02:53.393291 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m16:02:53.495687 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10135865211486816 seconds
[0m16:02:53.497582 [debug] [MainThread]: On master: Close
[0m16:02:53.608818 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:02:53.609733 [info ] [MainThread]: 
[0m16:02:53.618920 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m16:02:53.619391 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m16:02:53.619855 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m16:02:53.620367 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m16:02:53.621106 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m16:02:53.621690 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m16:02:53.622580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m16:02:53.623390 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m16:02:53.624016 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m16:02:53.624344 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m16:02:53.624640 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m16:02:53.625065 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m16:02:53.627363 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m16:02:53.630086 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m16:02:53.631421 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m16:02:53.636496 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 16:02:53.627682 => 16:02:53.636270
[0m16:02:53.636923 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 16:02:53.630348 => 16:02:53.636698
[0m16:02:53.637300 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 16:02:53.625359 => 16:02:53.637089
[0m16:02:53.637611 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m16:02:53.637887 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m16:02:53.638125 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m16:02:53.653006 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m16:02:53.654853 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m16:02:53.656388 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m16:02:53.661762 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:02:53.661985 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:02:53.662180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:53.662347 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:02:53.662544 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:02:53.662715 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:02:54.931427 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m16:02:54.933961 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users
)

select * from users_cleaned


[0m16:02:54.935709 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m16:02:54.936201 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m16:02:54.936724 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m16:02:54.937227 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m16:02:55.049909 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.11127305030822754 seconds
[0m16:02:55.058327 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.12357687950134277 seconds
[0m16:02:55.058840 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.12094402313232422 seconds
[0m16:02:55.067719 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m16:02:55.069086 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m16:02:55.070204 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m16:02:55.070538 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m16:02:55.070827 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m16:02:55.071079 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m16:02:55.071318 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m16:02:55.071558 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: fCOMMIT
[0m16:02:55.071791 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m16:02:55.180239 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10727810859680176 seconds
[0m16:02:55.182199 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10935401916503906 seconds
[0m16:02:55.183151 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.11089777946472168 seconds
[0m16:02:55.191904 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m16:02:55.194483 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m16:02:55.196931 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m16:02:55.197286 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:02:55.197648 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:02:55.198000 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:02:55.306097 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10686111450195312 seconds
[0m16:02:55.308511 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10946106910705566 seconds
[0m16:02:55.316057 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.11766815185546875 seconds
[0m16:02:55.323478 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 16:02:53.655027 => 16:02:55.323278
[0m16:02:55.325156 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 16:02:53.638279 => 16:02:55.325001
[0m16:02:55.326693 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 16:02:53.653260 => 16:02:55.326548
[0m16:02:55.327055 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m16:02:55.327349 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m16:02:55.327613 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m16:02:55.437535 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d93d0>]}
[0m16:02:55.439586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106670750>]}
[0m16:02:55.441493 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106788750>]}
[0m16:02:55.442076 [info ] [Thread-3 (]: 3 of 10 OK created sql view model FAWDBTCORE.stg_web_events .................... [[32mOK[0m in 1.81s]
[0m16:02:55.442556 [info ] [Thread-1 (]: 1 of 10 OK created sql view model FAWDBTCORE.stg_mobile_events ................. [[32mOK[0m in 1.82s]
[0m16:02:55.442987 [info ] [Thread-2 (]: 2 of 10 OK created sql view model FAWDBTCORE.stg_users ......................... [[32mOK[0m in 1.82s]
[0m16:02:55.443425 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m16:02:55.443779 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m16:02:55.444121 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m16:02:55.444666 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m16:02:55.445158 [debug] [Thread-2 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m16:02:55.445369 [debug] [Thread-3 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m16:02:55.445677 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m16:02:55.446151 [info ] [Thread-4 (]: 4 of 10 START sql view model FAWDBTCORE.ranked_web_events ...................... [RUN]
[0m16:02:55.446587 [info ] [Thread-2 (]: 5 of 10 START sql view model FAWDBTCORE.average_duration_by_platform_country ... [RUN]
[0m16:02:55.446936 [info ] [Thread-3 (]: 6 of 10 START sql view model FAWDBTCORE.event_counts_by_platform ............... [RUN]
[0m16:02:55.447399 [info ] [Thread-1 (]: 7 of 10 START sql view model FAWDBTCORE.mobile_event_durations ................. [RUN]
[0m16:02:55.448064 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.ranked_web_events'
[0m16:02:55.448540 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.average_duration_by_platform_country)
[0m16:02:55.448967 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.event_counts_by_platform)
[0m16:02:55.449356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m16:02:55.449596 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m16:02:55.449819 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m16:02:55.450031 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m16:02:55.450362 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m16:02:55.452785 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m16:02:55.454826 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m16:02:55.456922 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m16:02:55.458776 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m16:02:55.460227 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 16:02:55.453010 => 16:02:55.460038
[0m16:02:55.460548 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 16:02:55.450596 => 16:02:55.460403
[0m16:02:55.460786 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 16:02:55.457089 => 16:02:55.460681
[0m16:02:55.461052 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m16:02:55.461311 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 16:02:55.454994 => 16:02:55.461204
[0m16:02:55.461514 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m16:02:55.461727 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m16:02:55.463616 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m16:02:55.463893 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m16:02:55.465390 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m16:02:55.466997 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m16:02:55.468520 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m16:02:55.476313 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:55.476614 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:02:55.483040 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:02:55.483245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:55.483446 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:55.483635 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:02:55.483827 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:02:55.484014 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:02:56.744937 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m16:02:56.745358 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m16:02:56.763588 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m16:02:56.763980 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m16:02:56.764409 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m16:02:56.765069 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m16:02:56.766571 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m16:02:56.766887 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m16:02:56.854895 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10873293876647949 seconds
[0m16:02:56.859646 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: COMMIT
[0m16:02:56.860114 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m16:02:56.860503 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: fCOMMIT
[0m16:02:56.873239 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10793685913085938 seconds
[0m16:02:56.874674 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10893487930297852 seconds
[0m16:02:56.877895 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m16:02:56.878288 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.11105060577392578 seconds
[0m16:02:56.880115 [debug] [Thread-2 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m16:02:56.880553 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m16:02:56.882064 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m16:02:56.882430 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m16:02:56.882761 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: fCOMMIT
[0m16:02:56.883089 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m16:02:56.883414 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: fCOMMIT
[0m16:02:56.883896 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: fCOMMIT
[0m16:02:56.961464 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.1001119613647461 seconds
[0m16:02:56.966865 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m16:02:56.967465 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.ranked_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:02:56.986438 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10239815711975098 seconds
[0m16:02:56.987379 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10298490524291992 seconds
[0m16:02:56.988371 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10395407676696777 seconds
[0m16:02:56.994103 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m16:02:56.995967 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m16:02:56.997639 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m16:02:56.997928 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:02:56.998223 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:02:56.998509 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:02:57.075818 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10731101036071777 seconds
[0m16:02:57.080563 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 16:02:55.464041 => 16:02:57.080327
[0m16:02:57.081035 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: Close
[0m16:02:57.101722 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10208606719970703 seconds
[0m16:02:57.104390 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10537600517272949 seconds
[0m16:02:57.107575 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 16:02:55.465560 => 16:02:57.107358
[0m16:02:57.107962 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10894489288330078 seconds
[0m16:02:57.110177 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 16:02:55.467211 => 16:02:57.109967
[0m16:02:57.110620 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m16:02:57.112635 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 16:02:55.461863 => 16:02:57.112464
[0m16:02:57.112987 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m16:02:57.113449 [debug] [Thread-2 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m16:02:57.185723 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106604750>]}
[0m16:02:57.186265 [info ] [Thread-4 (]: 4 of 10 OK created sql view model FAWDBTCORE.ranked_web_events ................. [[32mOK[0m in 1.74s]
[0m16:02:57.186637 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m16:02:57.186866 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_counts
[0m16:02:57.187306 [info ] [Thread-4 (]: 8 of 10 START sql view model FAWDBTCORE.web_events_counts ...................... [RUN]
[0m16:02:57.187866 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.ranked_web_events, now model.oracle_dbt.web_events_counts)
[0m16:02:57.188071 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m16:02:57.190188 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m16:02:57.191032 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 16:02:57.188200 => 16:02:57.190904
[0m16:02:57.191239 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.web_events_counts
[0m16:02:57.192940 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m16:02:57.196077 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:02:57.196348 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:02:57.216514 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4e290>]}
[0m16:02:57.217830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b8e90>]}
[0m16:02:57.219245 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673a4d0>]}
[0m16:02:57.219569 [info ] [Thread-3 (]: 6 of 10 OK created sql view model FAWDBTCORE.event_counts_by_platform .......... [[32mOK[0m in 1.77s]
[0m16:02:57.219946 [info ] [Thread-1 (]: 7 of 10 OK created sql view model FAWDBTCORE.mobile_event_durations ............ [[32mOK[0m in 1.77s]
[0m16:02:57.220293 [info ] [Thread-2 (]: 5 of 10 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 1.77s]
[0m16:02:57.220741 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m16:02:57.221028 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m16:02:57.221268 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m16:02:57.221484 [debug] [Thread-3 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m16:02:57.221762 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_web_users
[0m16:02:57.222101 [info ] [Thread-3 (]: 9 of 10 START sql view model FAWDBTCORE.frequent_mobile_users .................. [RUN]
[0m16:02:57.222364 [info ] [Thread-1 (]: 10 of 10 START sql view model FAWDBTCORE.frequent_web_users .................... [RUN]
[0m16:02:57.222743 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.event_counts_by_platform, now model.oracle_dbt.frequent_mobile_users)
[0m16:02:57.223129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.mobile_event_durations, now model.oracle_dbt.frequent_web_users)
[0m16:02:57.223323 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.frequent_mobile_users
[0m16:02:57.223575 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.frequent_web_users
[0m16:02:57.225383 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.frequent_mobile_users"
[0m16:02:57.227412 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.frequent_web_users"
[0m16:02:57.231486 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.frequent_web_users (compile): 16:02:57.225563 => 16:02:57.231353
[0m16:02:57.231704 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.frequent_mobile_users (compile): 16:02:57.223825 => 16:02:57.231604
[0m16:02:57.231902 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.frequent_web_users
[0m16:02:57.232055 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.frequent_mobile_users
[0m16:02:57.233623 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.frequent_web_users"
[0m16:02:57.234957 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.frequent_mobile_users"
[0m16:02:57.238277 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:57.238527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:57.238791 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:02:57.239045 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:02:58.421218 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m16:02:58.425920 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_event_counts


[0m16:02:58.491174 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.frequent_web_users".
[0m16:02:58.492694 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.frequent_web_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.frequent_web_users"} */

  
  create or replace view FAWDBTCORE.frequent_web_users as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
), 

freq_web_users_ids as (
SELECT user_id, COUNT(*) AS frequency
FROM web_events_cleaned
GROUP BY user_id
ORDER BY frequency DESC
),

freq_mobile_user_ids as (
SELECT user_id, COUNT(*) AS frequency
FROM mobile_events_cleaned
GROUP BY user_id
ORDER BY frequency DESC
),

freq_web_user_names as (
SELECT u.name, COUNT(*) AS frequency
FROM freq_web_users_ids AS w
JOIN users_cleaned AS u ON u.user_id = w.user_id
GROUP BY u.user_id
ORDER BY frequency DESC
),

freq_mobile_user_names as (
SELECT u.name, COUNT(*) AS frequency
FROM mobile_events_extracted AS m
JOIN users_cleaned AS u ON u.user_id = m.user_id
GROUP BY u.user_id
ORDER BY frequency DESC
)

select * from freq_mobile_user_names


[0m16:02:58.503804 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.frequent_mobile_users".
[0m16:02:58.504504 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.frequent_mobile_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.frequent_mobile_users"} */

  
  create or replace view FAWDBTCORE.frequent_mobile_users as
    with start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
),


freq_mobile_user_ids as (
SELECT user_id, COUNT(*) AS frequency
FROM mobile_events_cleaned
GROUP BY user_id
ORDER BY frequency DESC
),

freq_mobile_user_names as (
SELECT u.name, COUNT(*) AS frequency
FROM mobile_events_extracted AS m
JOIN users_cleaned AS u ON u.user_id = m.user_id
GROUP BY u.user_id
ORDER BY frequency DESC
)

select * from freq_mobile_user_names


[0m16:02:58.537862 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.11099004745483398 seconds
[0m16:02:58.541806 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m16:02:58.543986 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m16:02:58.545034 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: fCOMMIT
[0m16:02:58.647162 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10062885284423828 seconds
[0m16:02:58.653532 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m16:02:58.654144 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:02:58.695448 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m16:02:58.697691 [debug] [Thread-1 (]: On model.oracle_dbt.frequent_web_users: ROLLBACK
[0m16:02:58.709451 [info ] [Thread-3 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m16:02:58.710197 [debug] [Thread-3 (]: On model.oracle_dbt.frequent_mobile_users: ROLLBACK
[0m16:02:58.756284 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10144686698913574 seconds
[0m16:02:58.759139 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 16:02:57.191365 => 16:02:58.758922
[0m16:02:58.759586 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_counts: Close
[0m16:02:58.799176 [debug] [Thread-1 (]: On model.oracle_dbt.frequent_web_users: Close
[0m16:02:58.813765 [debug] [Thread-3 (]: On model.oracle_dbt.frequent_mobile_users: Close
[0m16:02:58.874886 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b8bd0>]}
[0m16:02:58.875502 [info ] [Thread-4 (]: 8 of 10 OK created sql view model FAWDBTCORE.web_events_counts ................. [[32mOK[0m in 1.69s]
[0m16:02:58.875892 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_counts
[0m16:02:58.906494 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.frequent_web_users (execute): 16:02:57.232158 => 16:02:58.906136
[0m16:02:58.915222 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.frequent_mobile_users (execute): 16:02:57.233758 => 16:02:58.914997
[0m16:02:58.928449 [debug] [Thread-3 (]: Database Error in model frequent_mobile_users (models/frequent_mobile_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/frequent_mobile_users.sql
[0m16:02:58.929673 [debug] [Thread-1 (]: Database Error in model frequent_web_users (models/frequent_web_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/frequent_web_users.sql
[0m16:02:58.931699 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1eb10>]}
[0m16:02:58.933457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58634d13-f4e1-472c-a807-6234f95453e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106990390>]}
[0m16:02:58.934052 [error] [Thread-3 (]: 9 of 10 ERROR creating sql view model FAWDBTCORE.frequent_mobile_users ......... [[31mERROR[0m in 1.71s]
[0m16:02:58.934632 [error] [Thread-1 (]: 10 of 10 ERROR creating sql view model FAWDBTCORE.frequent_web_users ........... [[31mERROR[0m in 1.71s]
[0m16:02:58.935089 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m16:02:58.935424 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m16:02:58.937371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:58.937747 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:03:00.293902 [debug] [MainThread]: On master: COMMIT
[0m16:03:00.295461 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m16:03:00.295921 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m16:03:00.397626 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.10066723823547363 seconds
[0m16:03:00.399519 [debug] [MainThread]: On master: Close
[0m16:03:00.514081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:00.514837 [debug] [MainThread]: Connection 'model.oracle_dbt.frequent_web_users' was properly closed.
[0m16:03:00.515178 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m16:03:00.515488 [debug] [MainThread]: Connection 'model.oracle_dbt.frequent_mobile_users' was properly closed.
[0m16:03:00.515773 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m16:03:00.516230 [info ] [MainThread]: 
[0m16:03:00.517167 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 11.96 seconds (11.96s).
[0m16:03:00.519117 [debug] [MainThread]: Command end result
[0m16:03:00.540645 [info ] [MainThread]: 
[0m16:03:00.541185 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:03:00.541459 [info ] [MainThread]: 
[0m16:03:00.541687 [error] [MainThread]: [33mDatabase Error in model frequent_mobile_users (models/frequent_mobile_users.sql)[0m
[0m16:03:00.541887 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m16:03:00.542061 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/frequent_mobile_users.sql
[0m16:03:00.542225 [info ] [MainThread]: 
[0m16:03:00.542393 [error] [MainThread]: [33mDatabase Error in model frequent_web_users (models/frequent_web_users.sql)[0m
[0m16:03:00.542552 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m16:03:00.542716 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/frequent_web_users.sql
[0m16:03:00.542906 [info ] [MainThread]: 
[0m16:03:00.543123 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m16:03:00.543566 [debug] [MainThread]: Command `dbt run` failed at 16:03:00.543503 after 12.24 seconds
[0m16:03:00.543840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100468c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100468cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036a7b90>]}
[0m16:03:00.544050 [debug] [MainThread]: Flushing usage events
[0m16:22:11.731472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b80bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b817b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b817f90>]}


============================== 16:22:11.734469 | f1ceaf32-27c8-4715-adeb-3fe88ec98ff7 ==============================
[0m16:22:11.734469 [info ] [MainThread]: Running with dbt=1.5.0
[0m16:22:11.734822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:22:11.823698 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m16:22:11.857596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1ceaf32-27c8-4715-adeb-3fe88ec98ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd0e50>]}
[0m16:22:11.863563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1ceaf32-27c8-4715-adeb-3fe88ec98ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0de210>]}
[0m16:22:11.899733 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m16:22:11.960481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:22:11.960713 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:22:11.963738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1ceaf32-27c8-4715-adeb-3fe88ec98ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107858dd0>]}
[0m16:22:11.969268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1ceaf32-27c8-4715-adeb-3fe88ec98ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0ce590>]}
[0m16:22:11.969495 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:22:11.969677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ceaf32-27c8-4715-adeb-3fe88ec98ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0ecd90>]}
[0m16:22:11.970445 [info ] [MainThread]: 
[0m16:22:11.970830 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m16:22:11.971344 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m16:22:11.976555 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m16:22:11.976814 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m16:22:11.976952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:11.977075 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:22:13.598807 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.621600866317749 seconds
[0m16:22:13.699351 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m16:22:13.801287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m16:22:13.808281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:13.808726 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:22:15.005053 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m16:22:15.006548 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m16:22:15.124371 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11684703826904297 seconds
[0m16:22:15.250197 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m16:22:15.364403 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m16:22:15.488761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ceaf32-27c8-4715-adeb-3fe88ec98ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ff7390>]}
[0m16:22:15.489715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:15.490283 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:22:16.766058 [debug] [MainThread]: On master: COMMIT
[0m16:22:16.768178 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m16:22:16.770376 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m16:22:16.866971 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.095184326171875 seconds
[0m16:22:16.869137 [debug] [MainThread]: On master: Close
[0m16:22:16.983686 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:22:16.984707 [info ] [MainThread]: 
[0m16:22:17.028501 [debug] [Thread-1 (]: Began running node seed.oracle_dbt.raw_users
[0m16:22:17.029229 [info ] [Thread-1 (]: 1 of 1 START seed file FAWDBTCORE.raw_users .................................... [RUN]
[0m16:22:17.030024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now seed.oracle_dbt.raw_users)
[0m16:22:17.030337 [debug] [Thread-1 (]: Began compiling node seed.oracle_dbt.raw_users
[0m16:22:17.030701 [debug] [Thread-1 (]: Timing info for seed.oracle_dbt.raw_users (compile): 16:22:17.030538 => 16:22:17.030540
[0m16:22:17.030978 [debug] [Thread-1 (]: Began executing node seed.oracle_dbt.raw_users
[0m16:22:17.060053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:17.060386 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:22:18.234448 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "seed.oracle_dbt.raw_users".
[0m16:22:18.236157 [debug] [Thread-1 (]: oracle adapter: On seed.oracle_dbt.raw_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "seed.oracle_dbt.raw_users"} */

    create table FAWDBTCORE.raw_users (user_id number,name varchar2(21))
  
[0m16:22:18.439374 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00955: name is already used by an existing object
[0m16:22:18.441207 [debug] [Thread-1 (]: On seed.oracle_dbt.raw_users: ROLLBACK
[0m16:22:18.537454 [debug] [Thread-1 (]: On seed.oracle_dbt.raw_users: Close
[0m16:22:18.636111 [debug] [Thread-1 (]: Timing info for seed.oracle_dbt.raw_users (execute): 16:22:17.031151 => 16:22:18.635085
[0m16:22:18.661565 [debug] [Thread-1 (]: Database Error in seed raw_users (seeds/raw_users.csv)
  ORA-00955: name is already used by an existing object
[0m16:22:18.664629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ceaf32-27c8-4715-adeb-3fe88ec98ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3395d0>]}
[0m16:22:18.665305 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file FAWDBTCORE.raw_users ............................ [[31mERROR[0m in 1.63s]
[0m16:22:18.665899 [debug] [Thread-1 (]: Finished running node seed.oracle_dbt.raw_users
[0m16:22:18.668015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:18.668623 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:22:19.841603 [debug] [MainThread]: On master: COMMIT
[0m16:22:19.843323 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m16:22:19.843855 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m16:22:19.941160 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.09638214111328125 seconds
[0m16:22:19.942830 [debug] [MainThread]: On master: Close
[0m16:22:20.043718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:20.044318 [debug] [MainThread]: Connection 'seed.oracle_dbt.raw_users' was properly closed.
[0m16:22:20.044688 [info ] [MainThread]: 
[0m16:22:20.045126 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m16:22:20.045734 [debug] [MainThread]: Command end result
[0m16:22:20.060940 [info ] [MainThread]: 
[0m16:22:20.061581 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:22:20.061862 [info ] [MainThread]: 
[0m16:22:20.062126 [error] [MainThread]: [33mDatabase Error in seed raw_users (seeds/raw_users.csv)[0m
[0m16:22:20.062386 [error] [MainThread]:   ORA-00955: name is already used by an existing object
[0m16:22:20.062642 [info ] [MainThread]: 
[0m16:22:20.062928 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:22:20.063553 [debug] [MainThread]: Command `dbt seed` failed at 16:22:20.063451 after 8.37 seconds
[0m16:22:20.063944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c6aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c68c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b828210>]}
[0m16:22:20.064251 [debug] [MainThread]: Flushing usage events
[0m16:22:53.321912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106473ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647ffd0>]}


============================== 16:22:53.327474 | 4ae32367-4651-4c36-b8b8-ddbdd57114a8 ==============================
[0m16:22:53.327474 [info ] [MainThread]: Running with dbt=1.5.0
[0m16:22:53.327877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rosreen/Downloads/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:22:53.391637 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m16:22:53.414926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ad090>]}
[0m16:22:53.420989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b91a50>]}
[0m16:22:53.458607 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m16:22:53.525733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:22:53.525984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:22:53.529096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106533ad0>]}
[0m16:22:53.537556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bce150>]}
[0m16:22:53.537766 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:22:53.537958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b93fd0>]}
[0m16:22:53.538844 [info ] [MainThread]: 
[0m16:22:53.539244 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m16:22:53.540017 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m16:22:53.545461 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m16:22:53.545699 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m16:22:53.545839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:53.545970 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:22:55.034633 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 1.4887182712554932 seconds
[0m16:22:55.132045 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m16:22:55.239719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m16:22:55.246183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:55.246622 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:22:56.425718 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m16:22:56.427396 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m16:22:56.544485 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.11612272262573242 seconds
[0m16:22:56.726351 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m16:22:56.821201 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m16:22:56.932497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cac110>]}
[0m16:22:56.933191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:56.933534 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:22:58.100518 [debug] [MainThread]: On master: COMMIT
[0m16:22:58.102270 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m16:22:58.102845 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m16:22:58.201859 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.0978078842163086 seconds
[0m16:22:58.203242 [debug] [MainThread]: On master: Close
[0m16:22:58.310694 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:22:58.311463 [info ] [MainThread]: 
[0m16:22:58.323535 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m16:22:58.324065 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m16:22:58.324537 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m16:22:58.325259 [info ] [Thread-1 (]: 1 of 10 START sql view model FAWDBTCORE.stg_mobile_events ...................... [RUN]
[0m16:22:58.326059 [info ] [Thread-2 (]: 2 of 10 START sql view model FAWDBTCORE.stg_users .............................. [RUN]
[0m16:22:58.326692 [info ] [Thread-3 (]: 3 of 10 START sql view model FAWDBTCORE.stg_web_events ......................... [RUN]
[0m16:22:58.327612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m16:22:58.328370 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m16:22:58.328987 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m16:22:58.329280 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m16:22:58.329559 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m16:22:58.329817 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m16:22:58.331835 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m16:22:58.334766 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m16:22:58.336423 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m16:22:58.337916 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 16:22:58.330018 => 16:22:58.337662
[0m16:22:58.338443 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 16:22:58.332065 => 16:22:58.338253
[0m16:22:58.338796 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m16:22:58.339200 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m16:22:58.339590 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 16:22:58.335102 => 16:22:58.339446
[0m16:22:58.357516 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m16:22:58.359325 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m16:22:58.359562 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m16:22:58.361642 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m16:22:58.363387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:58.363604 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:22:58.363830 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:22:58.364042 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:22:58.377122 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:22:58.377341 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:22:59.585867 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m16:22:59.587091 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m16:22:59.587826 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m16:22:59.589060 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users
)

select * from users_cleaned


[0m16:22:59.594730 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m16:22:59.595734 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m16:22:59.695374 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.1049962043762207 seconds
[0m16:22:59.696249 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09990286827087402 seconds
[0m16:22:59.696713 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10659980773925781 seconds
[0m16:22:59.704302 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m16:22:59.705616 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m16:22:59.706561 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m16:22:59.706779 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m16:22:59.706972 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m16:22:59.707152 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m16:22:59.707334 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m16:22:59.707505 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m16:22:59.707677 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: fCOMMIT
[0m16:22:59.803297 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09514117240905762 seconds
[0m16:22:59.803960 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.0958709716796875 seconds
[0m16:22:59.804425 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09624409675598145 seconds
[0m16:22:59.811676 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m16:22:59.814164 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m16:22:59.816368 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m16:22:59.816714 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:22:59.817073 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:22:59.817405 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:22:59.917369 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09948897361755371 seconds
[0m16:22:59.917873 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09986686706542969 seconds
[0m16:22:59.918241 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10014677047729492 seconds
[0m16:22:59.930436 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 16:22:58.359942 => 16:22:59.930196
[0m16:22:59.931906 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 16:22:58.339826 => 16:22:59.931774
[0m16:22:59.933195 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 16:22:58.357757 => 16:22:59.933070
[0m16:22:59.933502 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m16:22:59.933756 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m16:22:59.933988 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m16:23:00.032011 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db7f90>]}
[0m16:23:00.034814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cff150>]}
[0m16:23:00.033127 [info ] [Thread-3 (]: 3 of 10 OK created sql view model FAWDBTCORE.stg_web_events .................... [[32mOK[0m in 1.70s]
[0m16:23:00.035595 [info ] [Thread-1 (]: 1 of 10 OK created sql view model FAWDBTCORE.stg_mobile_events ................. [[32mOK[0m in 1.71s]
[0m16:23:00.037292 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db7590>]}
[0m16:23:00.037808 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m16:23:00.038111 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m16:23:00.038559 [info ] [Thread-2 (]: 2 of 10 OK created sql view model FAWDBTCORE.stg_users ......................... [[32mOK[0m in 1.71s]
[0m16:23:00.039310 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m16:23:00.040023 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m16:23:00.040272 [debug] [Thread-3 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m16:23:00.040579 [info ] [Thread-4 (]: 4 of 10 START sql view model FAWDBTCORE.ranked_web_events ...................... [RUN]
[0m16:23:00.040910 [debug] [Thread-1 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m16:23:00.041284 [debug] [Thread-2 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m16:23:00.041776 [info ] [Thread-3 (]: 5 of 10 START sql view model FAWDBTCORE.average_duration_by_platform_country ... [RUN]
[0m16:23:00.042434 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.ranked_web_events'
[0m16:23:00.042736 [info ] [Thread-1 (]: 6 of 10 START sql view model FAWDBTCORE.event_counts_by_platform ............... [RUN]
[0m16:23:00.043072 [info ] [Thread-2 (]: 7 of 10 START sql view model FAWDBTCORE.mobile_event_durations ................. [RUN]
[0m16:23:00.043643 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.average_duration_by_platform_country)
[0m16:23:00.043916 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m16:23:00.044321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.event_counts_by_platform)
[0m16:23:00.044731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.mobile_event_durations)
[0m16:23:00.045067 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m16:23:00.047885 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m16:23:00.048280 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m16:23:00.048722 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m16:23:00.051305 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m16:23:00.053949 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m16:23:00.056833 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m16:23:00.057577 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 16:23:00.045296 => 16:23:00.057388
[0m16:23:00.057929 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m16:23:00.060057 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m16:23:00.060662 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 16:23:00.048964 => 16:23:00.060526
[0m16:23:00.060902 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m16:23:00.061262 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 16:23:00.051588 => 16:23:00.061019
[0m16:23:00.061565 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 16:23:00.054246 => 16:23:00.061392
[0m16:23:00.063624 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m16:23:00.064006 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m16:23:00.064310 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m16:23:00.066342 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m16:23:00.069263 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m16:23:00.069588 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:23:00.069900 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:23:00.079177 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:23:00.079431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:00.079702 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:23:00.079890 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:23:00.080120 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:23:00.080490 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:23:01.219643 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m16:23:01.221309 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m16:23:01.226823 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m16:23:01.227665 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m16:23:01.229821 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m16:23:01.230732 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m16:23:01.239942 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m16:23:01.240989 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m16:23:01.329711 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10582780838012695 seconds
[0m16:23:01.335035 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: COMMIT
[0m16:23:01.335593 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10417413711547852 seconds
[0m16:23:01.336002 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10763812065124512 seconds
[0m16:23:01.336486 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m16:23:01.338284 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m16:23:01.339744 [debug] [Thread-2 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m16:23:01.340112 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: fCOMMIT
[0m16:23:01.340471 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m16:23:01.340806 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m16:23:01.341341 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: fCOMMIT
[0m16:23:01.341727 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: fCOMMIT
[0m16:23:01.342037 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10047793388366699 seconds
[0m16:23:01.343545 [debug] [Thread-1 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m16:23:01.343904 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m16:23:01.344231 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: fCOMMIT
[0m16:23:01.436038 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09446310997009277 seconds
[0m16:23:01.437336 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09482192993164062 seconds
[0m16:23:01.442775 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m16:23:01.443263 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09867310523986816 seconds
[0m16:23:01.443625 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.10112214088439941 seconds
[0m16:23:01.446492 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m16:23:01.446902 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.ranked_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:23:01.449428 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m16:23:01.451845 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m16:23:01.452183 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:23:01.452713 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:23:01.453065 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:23:01.549693 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09509682655334473 seconds
[0m16:23:01.552926 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 16:23:00.058157 => 16:23:01.552755
[0m16:23:01.553257 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09982919692993164 seconds
[0m16:23:01.553550 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09992671012878418 seconds
[0m16:23:01.553796 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10029101371765137 seconds
[0m16:23:01.554227 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: Close
[0m16:23:01.556529 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 16:23:00.061770 => 16:23:01.556310
[0m16:23:01.558501 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 16:23:00.066522 => 16:23:01.558337
[0m16:23:01.560147 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 16:23:00.064560 => 16:23:01.559987
[0m16:23:01.560635 [debug] [Thread-3 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m16:23:01.560996 [debug] [Thread-2 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m16:23:01.561324 [debug] [Thread-1 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m16:23:01.662539 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5c2d0>]}
[0m16:23:01.665469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df5c50>]}
[0m16:23:01.668463 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106470d90>]}
[0m16:23:01.666135 [info ] [Thread-4 (]: 4 of 10 OK created sql view model FAWDBTCORE.ranked_web_events ................. [[32mOK[0m in 1.62s]
[0m16:23:01.669219 [info ] [Thread-2 (]: 7 of 10 OK created sql view model FAWDBTCORE.mobile_event_durations ............ [[32mOK[0m in 1.62s]
[0m16:23:01.669813 [info ] [Thread-1 (]: 6 of 10 OK created sql view model FAWDBTCORE.event_counts_by_platform .......... [[32mOK[0m in 1.62s]
[0m16:23:01.672333 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb9ad0>]}
[0m16:23:01.673055 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m16:23:01.673537 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m16:23:01.673952 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m16:23:01.674602 [info ] [Thread-3 (]: 5 of 10 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 1.63s]
[0m16:23:01.675208 [debug] [Thread-4 (]: Began running node model.oracle_dbt.web_events_counts
[0m16:23:01.675633 [debug] [Thread-2 (]: Began running node model.oracle_dbt.frequent_mobile_users
[0m16:23:01.676000 [debug] [Thread-1 (]: Began running node model.oracle_dbt.frequent_web_users
[0m16:23:01.676435 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m16:23:01.676766 [info ] [Thread-4 (]: 8 of 10 START sql view model FAWDBTCORE.web_events_counts ...................... [RUN]
[0m16:23:01.677136 [info ] [Thread-2 (]: 9 of 10 START sql view model FAWDBTCORE.frequent_mobile_users .................. [RUN]
[0m16:23:01.677567 [info ] [Thread-1 (]: 10 of 10 START sql view model FAWDBTCORE.frequent_web_users .................... [RUN]
[0m16:23:01.678387 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.ranked_web_events, now model.oracle_dbt.web_events_counts)
[0m16:23:01.678958 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.mobile_event_durations, now model.oracle_dbt.frequent_mobile_users)
[0m16:23:01.679482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.event_counts_by_platform, now model.oracle_dbt.frequent_web_users)
[0m16:23:01.679791 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m16:23:01.680050 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.frequent_mobile_users
[0m16:23:01.680512 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.frequent_web_users
[0m16:23:01.683666 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m16:23:01.685622 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.frequent_mobile_users"
[0m16:23:01.687794 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.frequent_web_users"
[0m16:23:01.694258 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.frequent_mobile_users (compile): 16:23:01.683928 => 16:23:01.694084
[0m16:23:01.694679 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.frequent_web_users (compile): 16:23:01.685814 => 16:23:01.694461
[0m16:23:01.695021 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 16:23:01.680824 => 16:23:01.694878
[0m16:23:01.695259 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.frequent_mobile_users
[0m16:23:01.695503 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.frequent_web_users
[0m16:23:01.695717 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.web_events_counts
[0m16:23:01.697829 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.frequent_mobile_users"
[0m16:23:01.699861 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.frequent_web_users"
[0m16:23:01.701615 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m16:23:01.718670 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:23:01.718990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:01.719238 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:23:01.719496 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:23:01.719706 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:23:01.719966 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:23:02.892896 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m16:23:02.895195 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_event_counts


[0m16:23:02.896102 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.frequent_mobile_users".
[0m16:23:02.896751 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.frequent_web_users".
[0m16:23:02.897706 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.frequent_mobile_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.frequent_mobile_users"} */

  
  create or replace view FAWDBTCORE.frequent_mobile_users as
    with start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
),


freq_mobile_user_ids as (
SELECT user_id, COUNT(*) AS frequency
FROM mobile_events_cleaned
GROUP BY user_id
ORDER BY frequency DESC
),

freq_mobile_user_names as (
SELECT u.name, COUNT(*) AS frequency
FROM mobile_events_extracted AS m
JOIN users_cleaned AS u ON u.user_id = m.user_id
GROUP BY u.user_id
ORDER BY frequency DESC
)

select * from freq_mobile_user_names


[0m16:23:02.898321 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.frequent_web_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.frequent_web_users"} */

  
  create or replace view FAWDBTCORE.frequent_web_users as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

start_users_cleaned as (

    select * from FAWDBTCORE.stg_users
), 

freq_web_users_ids as (
SELECT user_id, COUNT(*) AS frequency
FROM web_events_cleaned
GROUP BY user_id
ORDER BY frequency DESC
),

freq_mobile_user_ids as (
SELECT user_id, COUNT(*) AS frequency
FROM mobile_events_cleaned
GROUP BY user_id
ORDER BY frequency DESC
),

freq_web_user_names as (
SELECT u.name, COUNT(*) AS frequency
FROM freq_web_users_ids AS w
JOIN users_cleaned AS u ON u.user_id = w.user_id
GROUP BY u.user_id
ORDER BY frequency DESC
),

freq_mobile_user_names as (
SELECT u.name, COUNT(*) AS frequency
FROM mobile_events_extracted AS m
JOIN users_cleaned AS u ON u.user_id = m.user_id
GROUP BY u.user_id
ORDER BY frequency DESC
)

select * from freq_mobile_user_names


[0m16:23:03.001367 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.10367798805236816 seconds
[0m16:23:03.005399 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m16:23:03.006237 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m16:23:03.006870 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: fCOMMIT
[0m16:23:03.087315 [info ] [Thread-2 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m16:23:03.089713 [debug] [Thread-2 (]: On model.oracle_dbt.frequent_mobile_users: ROLLBACK
[0m16:23:03.090235 [info ] [Thread-1 (]: oracle adapter: Oracle error: ORA-00907: missing right parenthesis
[0m16:23:03.091720 [debug] [Thread-1 (]: On model.oracle_dbt.frequent_web_users: ROLLBACK
[0m16:23:03.102071 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09461283683776855 seconds
[0m16:23:03.105688 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m16:23:03.106089 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m16:23:03.186574 [debug] [Thread-2 (]: On model.oracle_dbt.frequent_mobile_users: Close
[0m16:23:03.187642 [debug] [Thread-1 (]: On model.oracle_dbt.frequent_web_users: Close
[0m16:23:03.202612 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09588098526000977 seconds
[0m16:23:03.207242 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 16:23:01.700050 => 16:23:03.206987
[0m16:23:03.207822 [debug] [Thread-4 (]: On model.oracle_dbt.web_events_counts: Close
[0m16:23:03.284622 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.frequent_web_users (execute): 16:23:01.697993 => 16:23:03.283875
[0m16:23:03.288307 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.frequent_mobile_users (execute): 16:23:01.695874 => 16:23:03.288060
[0m16:23:03.307055 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e43a90>]}
[0m16:23:03.307927 [info ] [Thread-4 (]: 8 of 10 OK created sql view model FAWDBTCORE.web_events_counts ................. [[32mOK[0m in 1.63s]
[0m16:23:03.308739 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.web_events_counts
[0m16:23:06.828223 [debug] [Thread-2 (]: Database Error in model frequent_mobile_users (models/frequent_mobile_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/frequent_mobile_users.sql
[0m16:23:06.829079 [debug] [Thread-1 (]: Database Error in model frequent_web_users (models/frequent_web_users.sql)
  ORA-00907: missing right parenthesis
  compiled Code at target/run/oracle_dbt/models/frequent_web_users.sql
[0m16:23:06.830949 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d26d10>]}
[0m16:23:06.832616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae32367-4651-4c36-b8b8-ddbdd57114a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3f290>]}
[0m16:23:06.832960 [error] [Thread-2 (]: 9 of 10 ERROR creating sql view model FAWDBTCORE.frequent_mobile_users ......... [[31mERROR[0m in 5.15s]
[0m16:23:06.833301 [error] [Thread-1 (]: 10 of 10 ERROR creating sql view model FAWDBTCORE.frequent_web_users ........... [[31mERROR[0m in 5.15s]
[0m16:23:06.833589 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.frequent_mobile_users
[0m16:23:06.834080 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.frequent_web_users
[0m16:23:06.835596 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:23:06.835840 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m16:23:07.987678 [debug] [MainThread]: On master: COMMIT
[0m16:23:07.989917 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m16:23:07.990451 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m16:23:08.086084 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.094696044921875 seconds
[0m16:23:08.087653 [debug] [MainThread]: On master: Close
[0m16:23:08.191821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:08.193681 [debug] [MainThread]: Connection 'model.oracle_dbt.frequent_web_users' was properly closed.
[0m16:23:08.194040 [debug] [MainThread]: Connection 'model.oracle_dbt.frequent_mobile_users' was properly closed.
[0m16:23:08.194301 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m16:23:08.194542 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m16:23:08.194949 [info ] [MainThread]: 
[0m16:23:08.195357 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 14.66 seconds (14.66s).
[0m16:23:08.196950 [debug] [MainThread]: Command end result
[0m16:23:11.080352 [info ] [MainThread]: 
[0m16:23:11.083126 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:23:11.084114 [info ] [MainThread]: 
[0m16:23:11.084692 [error] [MainThread]: [33mDatabase Error in model frequent_mobile_users (models/frequent_mobile_users.sql)[0m
[0m16:23:11.085145 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m16:23:11.085562 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/frequent_mobile_users.sql
[0m16:23:11.085940 [info ] [MainThread]: 
[0m16:23:11.086317 [error] [MainThread]: [33mDatabase Error in model frequent_web_users (models/frequent_web_users.sql)[0m
[0m16:23:11.086707 [error] [MainThread]:   ORA-00907: missing right parenthesis
[0m16:23:11.087155 [error] [MainThread]:   compiled Code at target/run/oracle_dbt/models/frequent_web_users.sql
[0m16:23:11.087643 [info ] [MainThread]: 
[0m16:23:11.088098 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m16:23:11.089037 [debug] [MainThread]: Command `dbt run` failed at 16:23:11.088895 after 17.82 seconds
[0m16:23:11.089585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102db6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102db4c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b72f10>]}
[0m16:23:11.089991 [debug] [MainThread]: Flushing usage events
[0m17:14:16.432182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b3bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b27950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b47e90>]}


============================== 17:14:16.434802 | aad83b25-fa7b-4c64-b7b0-8ad25d25fec2 ==============================
[0m17:14:16.434802 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:14:16.435134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rosreen/Desktop/oracle-dbt/logs', 'profiles_dir': '/Users/rosreen/Downloads/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:14:16.494391 [info ] [MainThread]: oracle adapter: Running in thin mode
[0m17:14:16.520909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b74dd0>]}
[0m17:14:16.544989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bb9d50>]}
[0m17:14:16.560099 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:14:16.603945 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m17:14:16.604233 [debug] [MainThread]: Partial parsing: deleted file: oracle_dbt://models/frequent_web_users.sql
[0m17:14:16.604361 [debug] [MainThread]: Partial parsing: deleted file: oracle_dbt://models/frequent_mobile_users.sql
[0m17:14:16.609679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10427e150>]}
[0m17:14:16.618572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104318790>]}
[0m17:14:16.618810 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:14:16.618995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039f6610>]}
[0m17:14:16.620057 [info ] [MainThread]: 
[0m17:14:16.620470 [debug] [MainThread]: Acquiring new oracle connection 'master'
[0m17:14:16.621166 [debug] [ThreadPool]: Acquiring new oracle connection 'list_FAWDBTCORE'
[0m17:14:16.626311 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE".
[0m17:14:16.626540 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE"} */
select username as "name"
      from sys.all_users
      order by username
  
[0m17:14:16.626683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:16.626805 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m17:14:24.979569 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 8.35216999053955 seconds
[0m17:14:25.077327 [debug] [ThreadPool]: On list_FAWDBTCORE: Close
[0m17:14:25.177907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FAWDBTCORE, now list_FAWDBTCORE_FAWDBTCORE)
[0m17:14:25.186504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:25.187113 [debug] [ThreadPool]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m17:14:26.343695 [debug] [ThreadPool]: oracle adapter: Using oracle connection "list_FAWDBTCORE_FAWDBTCORE".
[0m17:14:26.345054 [debug] [ThreadPool]: oracle adapter: On list_FAWDBTCORE_FAWDBTCORE: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "connection_name": "list_FAWDBTCORE_FAWDBTCORE"} */
with tables as
      (select SYS_CONTEXT('userenv', 'DB_NAME') table_catalog,
         owner table_schema,
         table_name,
         case
           when iot_type = 'Y'
           then 'IOT'
           when temporary = 'Y'
           then 'TEMP'
           else 'BASE TABLE'
         end table_type
       from sys.all_tables
       union all
       select SYS_CONTEXT('userenv', 'DB_NAME'),
         owner,
         view_name,
         'VIEW'
       from sys.all_views
  )
  select table_catalog as "database_name"
    ,table_name as "name"
    ,table_schema as "schema_name"
    ,case table_type
      when 'BASE TABLE' then 'table'
      when 'VIEW' then 'view'
    end as "kind"
  from tables
  where table_type in ('BASE TABLE', 'VIEW')
    and upper(table_schema) = upper('FAWDBTCORE')
  
[0m17:14:26.675351 [debug] [ThreadPool]: oracle adapter: SQL status: OK in 0.329265832901001 seconds
[0m17:14:26.857430 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: ROLLBACK
[0m17:14:26.952800 [debug] [ThreadPool]: On list_FAWDBTCORE_FAWDBTCORE: Close
[0m17:14:27.060527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b90950>]}
[0m17:14:27.061384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:27.061727 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m17:14:28.207003 [debug] [MainThread]: On master: COMMIT
[0m17:14:28.208337 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m17:14:28.208765 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m17:14:28.342402 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.1326770782470703 seconds
[0m17:14:28.344132 [debug] [MainThread]: On master: Close
[0m17:14:28.447745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:14:28.450683 [info ] [MainThread]: 
[0m17:14:29.199336 [debug] [Thread-1 (]: Began running node model.oracle_dbt.stg_mobile_events
[0m17:14:29.200104 [debug] [Thread-2 (]: Began running node model.oracle_dbt.stg_users
[0m17:14:29.200624 [debug] [Thread-3 (]: Began running node model.oracle_dbt.stg_web_events
[0m17:14:29.201337 [info ] [Thread-1 (]: 1 of 8 START sql view model FAWDBTCORE.stg_mobile_events ....................... [RUN]
[0m17:14:29.201928 [info ] [Thread-2 (]: 2 of 8 START sql view model FAWDBTCORE.stg_users ............................... [RUN]
[0m17:14:29.202446 [info ] [Thread-3 (]: 3 of 8 START sql view model FAWDBTCORE.stg_web_events .......................... [RUN]
[0m17:14:29.203355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FAWDBTCORE_FAWDBTCORE, now model.oracle_dbt.stg_mobile_events)
[0m17:14:29.204070 [debug] [Thread-2 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_users'
[0m17:14:29.204718 [debug] [Thread-3 (]: Acquiring new oracle connection 'model.oracle_dbt.stg_web_events'
[0m17:14:29.205062 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.stg_mobile_events
[0m17:14:29.205369 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.stg_users
[0m17:14:29.205657 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.stg_web_events
[0m17:14:29.207688 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.stg_mobile_events"
[0m17:14:29.210727 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.stg_users"
[0m17:14:29.212357 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.stg_web_events"
[0m17:14:29.216411 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (compile): 17:14:29.207923 => 17:14:29.216207
[0m17:14:29.216761 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (compile): 17:14:29.205869 => 17:14:29.216585
[0m17:14:29.217132 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.stg_users
[0m17:14:29.217482 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (compile): 17:14:29.211041 => 17:14:29.217333
[0m17:14:29.217757 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.stg_mobile_events
[0m17:14:29.233780 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.stg_users"
[0m17:14:29.234120 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.stg_web_events
[0m17:14:29.236131 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.stg_mobile_events"
[0m17:14:29.238204 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.stg_web_events"
[0m17:14:29.240272 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:14:29.240554 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m17:14:29.241023 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:14:29.241245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:29.241437 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m17:14:29.241642 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m17:14:30.397203 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m17:14:30.399807 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */

  
  create or replace view FAWDBTCORE.stg_web_events as
    with web_events_extracted as (

    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status
    FROM web_events
),

web_events_cleaned as (
    SELECT DISTINCT *
    FROM web_events_extracted
)

select * from web_events_cleaned


[0m17:14:30.402267 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m17:14:30.402907 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m17:14:30.403540 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */

  
  create or replace view FAWDBTCORE.stg_users as
    with users as (

    select * from FAWDBTCORE.raw_users
),

users_cleaned as (
    SELECT DISTINCT *
    FROM users
)

select * from users_cleaned


[0m17:14:30.404190 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */

  
  create or replace view FAWDBTCORE.stg_mobile_events as
    with mobile_events_extracted as (

 SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status
FROM mobile_events
),

mobile_events_cleaned as (
    SELECT DISTINCT *
    FROM mobile_events_extracted
)

select * from mobile_events_cleaned


[0m17:14:30.504066 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10281896591186523 seconds
[0m17:14:30.505438 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10021305084228516 seconds
[0m17:14:30.511843 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.1070249080657959 seconds
[0m17:14:30.517290 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: COMMIT
[0m17:14:30.518916 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: COMMIT
[0m17:14:30.520169 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: COMMIT
[0m17:14:30.520499 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m17:14:30.520792 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m17:14:30.521069 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m17:14:30.521332 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: fCOMMIT
[0m17:14:30.521598 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: fCOMMIT
[0m17:14:30.521855 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: fCOMMIT
[0m17:14:30.616921 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09389710426330566 seconds
[0m17:14:30.618371 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09585809707641602 seconds
[0m17:14:30.619216 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09688282012939453 seconds
[0m17:14:30.628597 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_users".
[0m17:14:30.631129 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_mobile_events".
[0m17:14:30.633621 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.stg_web_events".
[0m17:14:30.633995 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.stg_users: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_users"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_users__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m17:14:30.634343 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.stg_mobile_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_mobile_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_mobile_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m17:14:30.634693 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.stg_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.stg_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.stg_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m17:14:30.730842 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09514594078063965 seconds
[0m17:14:30.732163 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09675478935241699 seconds
[0m17:14:30.740175 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.10478711128234863 seconds
[0m17:14:30.750035 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.stg_users (execute): 17:14:29.217937 => 17:14:30.749830
[0m17:14:30.751688 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.stg_mobile_events (execute): 17:14:29.234352 => 17:14:30.751527
[0m17:14:30.753149 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.stg_web_events (execute): 17:14:29.236420 => 17:14:30.753006
[0m17:14:30.753476 [debug] [Thread-2 (]: On model.oracle_dbt.stg_users: Close
[0m17:14:30.753768 [debug] [Thread-1 (]: On model.oracle_dbt.stg_mobile_events: Close
[0m17:14:30.754049 [debug] [Thread-3 (]: On model.oracle_dbt.stg_web_events: Close
[0m17:14:30.861115 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042e1010>]}
[0m17:14:30.861437 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104374610>]}
[0m17:14:30.862247 [info ] [Thread-3 (]: 3 of 8 OK created sql view model FAWDBTCORE.stg_web_events ..................... [[32mOK[0m in 1.66s]
[0m17:14:30.863333 [info ] [Thread-2 (]: 2 of 8 OK created sql view model FAWDBTCORE.stg_users .......................... [[32mOK[0m in 1.65s]
[0m17:14:30.866473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104238690>]}
[0m17:14:30.867111 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.stg_web_events
[0m17:14:30.867604 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.stg_users
[0m17:14:30.868168 [info ] [Thread-1 (]: 1 of 8 OK created sql view model FAWDBTCORE.stg_mobile_events .................. [[32mOK[0m in 1.66s]
[0m17:14:30.869178 [debug] [Thread-4 (]: Began running node model.oracle_dbt.ranked_web_events
[0m17:14:30.870062 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.stg_mobile_events
[0m17:14:30.870572 [info ] [Thread-4 (]: 4 of 8 START sql view model FAWDBTCORE.ranked_web_events ....................... [RUN]
[0m17:14:30.871595 [debug] [Thread-2 (]: Began running node model.oracle_dbt.average_duration_by_platform_country
[0m17:14:30.872121 [debug] [Thread-3 (]: Began running node model.oracle_dbt.event_counts_by_platform
[0m17:14:30.872825 [debug] [Thread-4 (]: Acquiring new oracle connection 'model.oracle_dbt.ranked_web_events'
[0m17:14:30.873109 [debug] [Thread-1 (]: Began running node model.oracle_dbt.mobile_event_durations
[0m17:14:30.873555 [info ] [Thread-2 (]: 5 of 8 START sql view model FAWDBTCORE.average_duration_by_platform_country .... [RUN]
[0m17:14:30.874005 [info ] [Thread-3 (]: 6 of 8 START sql view model FAWDBTCORE.event_counts_by_platform ................ [RUN]
[0m17:14:30.874363 [debug] [Thread-4 (]: Began compiling node model.oracle_dbt.ranked_web_events
[0m17:14:30.874682 [info ] [Thread-1 (]: 7 of 8 START sql view model FAWDBTCORE.mobile_event_durations .................. [RUN]
[0m17:14:30.875513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_users, now model.oracle_dbt.average_duration_by_platform_country)
[0m17:14:30.876159 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_web_events, now model.oracle_dbt.event_counts_by_platform)
[0m17:14:30.879348 [debug] [Thread-4 (]: Writing injected SQL for node "model.oracle_dbt.ranked_web_events"
[0m17:14:30.880132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.stg_mobile_events, now model.oracle_dbt.mobile_event_durations)
[0m17:14:30.880561 [debug] [Thread-2 (]: Began compiling node model.oracle_dbt.average_duration_by_platform_country
[0m17:14:30.880833 [debug] [Thread-3 (]: Began compiling node model.oracle_dbt.event_counts_by_platform
[0m17:14:30.881347 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.mobile_event_durations
[0m17:14:30.883999 [debug] [Thread-2 (]: Writing injected SQL for node "model.oracle_dbt.average_duration_by_platform_country"
[0m17:14:30.886375 [debug] [Thread-3 (]: Writing injected SQL for node "model.oracle_dbt.event_counts_by_platform"
[0m17:14:30.890186 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.mobile_event_durations"
[0m17:14:30.890874 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (compile): 17:14:30.876401 => 17:14:30.890663
[0m17:14:30.891254 [debug] [Thread-4 (]: Began executing node model.oracle_dbt.ranked_web_events
[0m17:14:30.893229 [debug] [Thread-4 (]: Writing runtime sql for node "model.oracle_dbt.ranked_web_events"
[0m17:14:30.895762 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (compile): 17:14:30.881536 => 17:14:30.895648
[0m17:14:30.896018 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (compile): 17:14:30.884254 => 17:14:30.895875
[0m17:14:30.896248 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (compile): 17:14:30.886670 => 17:14:30.896147
[0m17:14:30.896493 [debug] [Thread-2 (]: Began executing node model.oracle_dbt.average_duration_by_platform_country
[0m17:14:30.896796 [debug] [Thread-3 (]: Began executing node model.oracle_dbt.event_counts_by_platform
[0m17:14:30.897041 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.mobile_event_durations
[0m17:14:30.898888 [debug] [Thread-2 (]: Writing runtime sql for node "model.oracle_dbt.average_duration_by_platform_country"
[0m17:14:30.900957 [debug] [Thread-3 (]: Writing runtime sql for node "model.oracle_dbt.event_counts_by_platform"
[0m17:14:30.901216 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:14:30.902979 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.mobile_event_durations"
[0m17:14:30.903364 [debug] [Thread-4 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m17:14:30.915376 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:14:30.915643 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:14:30.915840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:30.916062 [debug] [Thread-2 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m17:14:30.916266 [debug] [Thread-3 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m17:14:30.916457 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m17:14:32.044452 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m17:14:32.045407 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */

  
  create or replace view FAWDBTCORE.ranked_web_events as
    with start_ranked_web_events as (

    select * from FAWDBTCORE.stg_web_events

),

ranked_web_events as (

SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  RANK() OVER (PARTITION BY device_type ORDER BY duration_seconds DESC) AS duration_rank
FROM start_ranked_web_events

)

select * from ranked_web_events


[0m17:14:32.051103 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m17:14:32.052231 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */

  
  create or replace view FAWDBTCORE.mobile_event_durations as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

mobile_event_durations as (
SELECT
  operating_system,
  AVG(mobile_duration_seconds) AS avg_duration
FROM combined_events
GROUP BY operating_system
)

select * from mobile_event_durations


[0m17:14:32.062265 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m17:14:32.063578 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */

  
  create or replace view FAWDBTCORE.event_counts_by_platform as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

event_counts_by_platform as (

    SELECT
  platform,

  COUNT(*) AS event_count
FROM combined_categorized_events
GROUP BY platform
)

select * from event_counts_by_platform


[0m17:14:32.064485 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m17:14:32.065820 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */

  
  create or replace view FAWDBTCORE.average_duration_by_platform_country as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
), 

categorized_web_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN duration_seconds < 60 THEN 'Short'
    WHEN duration_seconds < 300 THEN 'Medium'
    ELSE 'Long'
  END AS duration_category
FROM web_events_cleaned


),

 categorized_mobile_events as (
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  app_name,
  operating_system,
  country,
  duration_seconds,
  conversion_status,
  CASE
    WHEN conversion_status = 'Completed' THEN 'Successful'
    ELSE 'Unsuccessful'
  END AS conversion_category
FROM mobile_events_cleaned
),


combined_categorized_events as (
    SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  page_url,
  browser,
  device_type,
  country,
  duration_seconds,
  conversion_status,
  NULL AS app_name,
  
  CASE
    WHEN device_type = 'Desktop' THEN 'Web'
    ELSE 'Mobile'
  END AS platform,
  CASE
    WHEN device_type = 'Desktop' THEN duration_seconds
    ELSE NULL
  END AS web_duration_seconds,
  CASE
    WHEN device_type = 'Mobile' THEN duration_seconds
    ELSE NULL
  END AS mobile_duration_seconds
FROM categorized_web_events
UNION ALL
SELECT
  event_id,
  event_type,
  event_timestamp,
  user_id,
  NULL AS page_url,
  NULL AS browser,
  NULL AS device_type,
  country,
  duration_seconds,
  conversion_status,
  app_name,
  
  'Mobile' AS platform,
  NULL AS web_duration_seconds,
  duration_seconds AS mobile_duration_seconds
FROM categorized_mobile_events
),

average_duration_by_platform_country as (

SELECT
  platform,
  country,
  AVG(CASE WHEN platform = 'Web' THEN web_duration_seconds ELSE mobile_duration_seconds END) AS avg_duration
FROM combined_categorized_events
GROUP BY platform, country
)

select * from average_duration_by_platform_country


[0m17:14:32.144757 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09823894500732422 seconds
[0m17:14:32.149667 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: COMMIT
[0m17:14:32.150642 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m17:14:32.151470 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: fCOMMIT
[0m17:14:32.153678 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10085797309875488 seconds
[0m17:14:32.155327 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: COMMIT
[0m17:14:32.155661 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m17:14:32.155954 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: fCOMMIT
[0m17:14:32.165986 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09906005859375 seconds
[0m17:14:32.166926 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.1018071174621582 seconds
[0m17:14:32.169633 [debug] [Thread-2 (]: On model.oracle_dbt.average_duration_by_platform_country: COMMIT
[0m17:14:32.171672 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: COMMIT
[0m17:14:32.172178 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m17:14:32.172592 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m17:14:32.172989 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: fCOMMIT
[0m17:14:32.173380 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: fCOMMIT
[0m17:14:32.245945 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.09338212013244629 seconds
[0m17:14:32.253560 [debug] [Thread-4 (]: oracle adapter: Using oracle connection "model.oracle_dbt.ranked_web_events".
[0m17:14:32.254027 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.0977010726928711 seconds
[0m17:14:32.254592 [debug] [Thread-4 (]: oracle adapter: On model.oracle_dbt.ranked_web_events: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.ranked_web_events"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.ranked_web_events__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m17:14:32.257769 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.mobile_event_durations".
[0m17:14:32.258354 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.mobile_event_durations: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.mobile_event_durations"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.mobile_event_durations__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m17:14:32.266763 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09300899505615234 seconds
[0m17:14:32.269586 [debug] [Thread-2 (]: oracle adapter: Using oracle connection "model.oracle_dbt.average_duration_by_platform_country".
[0m17:14:32.269932 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09603691101074219 seconds
[0m17:14:32.270304 [debug] [Thread-2 (]: oracle adapter: On model.oracle_dbt.average_duration_by_platform_country: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.average_duration_by_platform_country"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.average_duration_by_platform_country__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m17:14:32.272803 [debug] [Thread-3 (]: oracle adapter: Using oracle connection "model.oracle_dbt.event_counts_by_platform".
[0m17:14:32.273354 [debug] [Thread-3 (]: oracle adapter: On model.oracle_dbt.event_counts_by_platform: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.event_counts_by_platform"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.event_counts_by_platform__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m17:14:32.353336 [debug] [Thread-4 (]: oracle adapter: SQL status: OK in 0.0944218635559082 seconds
[0m17:14:32.354758 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09580373764038086 seconds
[0m17:14:32.359176 [debug] [Thread-4 (]: Timing info for model.oracle_dbt.ranked_web_events (execute): 17:14:30.891416 => 17:14:32.358939
[0m17:14:32.361419 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.mobile_event_durations (execute): 17:14:30.901374 => 17:14:32.361212
[0m17:14:32.361858 [debug] [Thread-4 (]: On model.oracle_dbt.ranked_web_events: Close
[0m17:14:32.362257 [debug] [Thread-1 (]: On model.oracle_dbt.mobile_event_durations: Close
[0m17:14:32.366717 [debug] [Thread-2 (]: oracle adapter: SQL status: OK in 0.09352302551269531 seconds
[0m17:14:32.368789 [debug] [Thread-2 (]: Timing info for model.oracle_dbt.average_duration_by_platform_country (execute): 17:14:30.897241 => 17:14:32.368578
[0m17:14:32.369176 [debug] [Thread-3 (]: oracle adapter: SQL status: OK in 0.09542393684387207 seconds
[0m17:14:32.369580 [debug] [Thread-2 (]: On model.oracle_dbt.average_duration_by_platform_country: Close
[0m17:14:32.371452 [debug] [Thread-3 (]: Timing info for model.oracle_dbt.event_counts_by_platform (execute): 17:14:30.899112 => 17:14:32.371281
[0m17:14:32.371864 [debug] [Thread-3 (]: On model.oracle_dbt.event_counts_by_platform: Close
[0m17:14:32.463217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104291250>]}
[0m17:14:32.464605 [info ] [Thread-1 (]: 7 of 8 OK created sql view model FAWDBTCORE.mobile_event_durations ............. [[32mOK[0m in 1.58s]
[0m17:14:32.465199 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.mobile_event_durations
[0m17:14:32.465563 [debug] [Thread-1 (]: Began running node model.oracle_dbt.web_events_counts
[0m17:14:32.466014 [info ] [Thread-1 (]: 8 of 8 START sql view model FAWDBTCORE.web_events_counts ....................... [RUN]
[0m17:14:32.466675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.oracle_dbt.mobile_event_durations, now model.oracle_dbt.web_events_counts)
[0m17:14:32.466964 [debug] [Thread-1 (]: Began compiling node model.oracle_dbt.web_events_counts
[0m17:14:32.470558 [debug] [Thread-1 (]: Writing injected SQL for node "model.oracle_dbt.web_events_counts"
[0m17:14:32.473030 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a7350>]}
[0m17:14:32.475021 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104304090>]}
[0m17:14:32.476716 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104334b50>]}
[0m17:14:32.477205 [info ] [Thread-4 (]: 4 of 8 OK created sql view model FAWDBTCORE.ranked_web_events .................. [[32mOK[0m in 1.60s]
[0m17:14:32.477745 [info ] [Thread-2 (]: 5 of 8 OK created sql view model FAWDBTCORE.average_duration_by_platform_country  [[32mOK[0m in 1.60s]
[0m17:14:32.478231 [info ] [Thread-3 (]: 6 of 8 OK created sql view model FAWDBTCORE.event_counts_by_platform ........... [[32mOK[0m in 1.60s]
[0m17:14:32.478826 [debug] [Thread-4 (]: Finished running node model.oracle_dbt.ranked_web_events
[0m17:14:32.479180 [debug] [Thread-2 (]: Finished running node model.oracle_dbt.average_duration_by_platform_country
[0m17:14:32.479489 [debug] [Thread-3 (]: Finished running node model.oracle_dbt.event_counts_by_platform
[0m17:14:32.480398 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_counts (compile): 17:14:32.467147 => 17:14:32.480229
[0m17:14:32.480663 [debug] [Thread-1 (]: Began executing node model.oracle_dbt.web_events_counts
[0m17:14:32.482725 [debug] [Thread-1 (]: Writing runtime sql for node "model.oracle_dbt.web_events_counts"
[0m17:14:32.484114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:32.484387 [debug] [Thread-1 (]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m17:14:33.632553 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m17:14:33.636117 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */

  
  create or replace view FAWDBTCORE.web_events_counts as
    with start_web_events_cleaned as (

    select * from FAWDBTCORE.stg_web_events
),

start_mobile_events_cleaned as (

    select * from FAWDBTCORE.stg_mobile_events
),

combined_events as (
    
SELECT
  w.event_id,
  w.event_type AS web_event_type,
  w.event_timestamp AS web_event_timestamp,
  w.user_id AS web_user_id,
  w.page_url,
  w.browser,
  w.device_type AS web_device_type,
  w.country AS web_country,
  w.duration_seconds AS web_duration_seconds,
  w.conversion_status AS web_conversion_status,
  m.event_type AS mobile_event_type,
  m.event_timestamp AS mobile_event_timestamp,
  m.user_id AS mobile_user_id,
  m.app_name,
  m.operating_system,
  m.country AS mobile_country,
  m.duration_seconds AS mobile_duration_seconds,
  m.conversion_status AS mobile_conversion_status
FROM start_web_events_cleaned w
JOIN start_mobile_events_cleaned m ON w.event_id = m.event_id

),

web_event_counts as (
    SELECT
  web_event_type,
  COUNT(*) AS event_count
FROM combined_events
GROUP BY web_event_type
)

select * from web_event_counts


[0m17:14:33.739744 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.10246992111206055 seconds
[0m17:14:33.744265 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_counts: COMMIT
[0m17:14:33.744964 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m17:14:33.745407 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.web_events_counts: fCOMMIT
[0m17:14:33.839600 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09319496154785156 seconds
[0m17:14:33.846799 [debug] [Thread-1 (]: oracle adapter: Using oracle connection "model.oracle_dbt.web_events_counts".
[0m17:14:33.847325 [debug] [Thread-1 (]: oracle adapter: On model.oracle_dbt.web_events_counts: f/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "oracle_dbt", "target_name": "dev", "node_id": "model.oracle_dbt.web_events_counts"} */
DECLARE
     dne_942    EXCEPTION;
     PRAGMA EXCEPTION_INIT(dne_942, -942);
     attempted_ddl_on_in_use_GTT EXCEPTION;
     pragma EXCEPTION_INIT(attempted_ddl_on_in_use_GTT, -14452);
  BEGIN
     SAVEPOINT start_transaction;
     EXECUTE IMMEDIATE 'DROP view FAWDBTCORE.web_events_counts__dbt_backup cascade constraint';
     COMMIT;
  EXCEPTION
     WHEN attempted_ddl_on_in_use_GTT THEN
        NULL; -- if it its a global temporary table, leave it alone.
     WHEN dne_942 THEN
        NULL;
  END;
[0m17:14:33.943011 [debug] [Thread-1 (]: oracle adapter: SQL status: OK in 0.09451413154602051 seconds
[0m17:14:33.949242 [debug] [Thread-1 (]: Timing info for model.oracle_dbt.web_events_counts (execute): 17:14:32.480812 => 17:14:33.949013
[0m17:14:33.949685 [debug] [Thread-1 (]: On model.oracle_dbt.web_events_counts: Close
[0m17:14:34.054045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad83b25-fa7b-4c64-b7b0-8ad25d25fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042e0610>]}
[0m17:14:34.054805 [info ] [Thread-1 (]: 8 of 8 OK created sql view model FAWDBTCORE.web_events_counts .................. [[32mOK[0m in 1.59s]
[0m17:14:34.055463 [debug] [Thread-1 (]: Finished running node model.oracle_dbt.web_events_counts
[0m17:14:34.057498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:34.057855 [debug] [MainThread]: oracle adapter: Attempting to connect using Oracle method: 'OracleConnectionMethod.TNS' and dsn: 'cfg57adw_low'
[0m17:14:35.213148 [debug] [MainThread]: On master: COMMIT
[0m17:14:35.215105 [debug] [MainThread]: oracle adapter: Using oracle connection "master".
[0m17:14:35.216028 [debug] [MainThread]: oracle adapter: On master: fCOMMIT
[0m17:14:35.311349 [debug] [MainThread]: oracle adapter: SQL status: OK in 0.0941622257232666 seconds
[0m17:14:35.312879 [debug] [MainThread]: On master: Close
[0m17:14:35.415316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:35.416408 [debug] [MainThread]: Connection 'model.oracle_dbt.web_events_counts' was properly closed.
[0m17:14:35.416786 [debug] [MainThread]: Connection 'model.oracle_dbt.average_duration_by_platform_country' was properly closed.
[0m17:14:35.417041 [debug] [MainThread]: Connection 'model.oracle_dbt.event_counts_by_platform' was properly closed.
[0m17:14:35.417269 [debug] [MainThread]: Connection 'model.oracle_dbt.ranked_web_events' was properly closed.
[0m17:14:35.417652 [info ] [MainThread]: 
[0m17:14:35.418096 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 18.80 seconds (18.80s).
[0m17:14:35.419626 [debug] [MainThread]: Command end result
[0m17:14:35.441813 [info ] [MainThread]: 
[0m17:14:35.442531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:35.442855 [info ] [MainThread]: 
[0m17:14:35.443198 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:14:35.443976 [debug] [MainThread]: Command `dbt run` succeeded at 17:14:35.443866 after 19.03 seconds
[0m17:14:35.444397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10031a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10047f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10047ea50>]}
[0m17:14:35.444753 [debug] [MainThread]: Flushing usage events
